<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- Mirrored from docs.racket-lang.org/graphite-tutorial/Data_wrangling__101.html by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 07 Sep 2022 03:27:14 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><meta name="viewport" content="width=device-width, initial-scale=0.8"/><title>6&nbsp;Data wrangling, 101</title><link rel="stylesheet" type="text/css" href="../scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="../racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-style.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../doc-site.css" title="default"/><script type="text/javascript" src="../scribble-common.js"></script><script type="text/javascript" src="../manual-racket.js"></script><script type="text/javascript" src="../manual-racket.js"></script><script type="text/javascript" src="../doc-site.js"></script><script type="text/javascript" src="../local-redirect/local-redirect.js"></script><script type="text/javascript" src="../local-redirect/local-user-redirect.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="doc-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9660;</a></td><td></td><td><a href="index.html" class="tocviewlink" data-pltdoc="x">Graphite:<span class="mywbr"> &nbsp;</span> a guided tour</a></td></tr></table></div><div class="tocviewsublistonly" style="display: block;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="Deciding_what_library_to_use.html" class="tocviewlink" data-pltdoc="x">Deciding what library to use</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="Key_forms.html" class="tocviewlink" data-pltdoc="x">Key forms</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="Gapminder.html" class="tocviewlink" data-pltdoc="x">Gapminder</a></td></tr><tr><td align="right">4&nbsp;</td><td><a href="Bar_charts.html" class="tocviewlink" data-pltdoc="x">Bar charts</a></td></tr><tr><td align="right">5&nbsp;</td><td><a href="Faceting.html" class="tocviewlink" data-pltdoc="x">Faceting</a></td></tr><tr><td align="right">6&nbsp;</td><td><a href="#" class="tocviewselflink" data-pltdoc="x">Data wrangling, 101</a></td></tr><tr><td align="right">7&nbsp;</td><td><a href="Data_wrangling__201__Wrangle_harder.html" class="tocviewlink" data-pltdoc="x">Data wrangling, 201:<span class="mywbr"> &nbsp;</span> Wrangle harder</a></td></tr></table></div></div></div></div><div class="maincolumn"><div class="main"><div class="navsettop"><span class="navleft"><form class="searchform"><input class="searchbox" id="searchbox" type="text" tabindex="1" placeholder="...search manuals..." title="Enter a search string to search the manuals" onkeypress="return DoSearchKey(event, this, &quot;8.6&quot;, &quot;../&quot;);"/></form>&nbsp;&nbsp;<a href="../index-2.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;8.6&quot;);">top</a><span class="tocsettoggle">&nbsp;&nbsp;<a href="javascript:void(0);" title="show/hide table of contents" onclick="TocsetToggle();">contents</a></span></span><span class="navright">&nbsp;&nbsp;<a href="Faceting.html" title="backward to &quot;5 Faceting&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="index.html" title="up to &quot;Graphite: a guided tour&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="Data_wrangling__201__Wrangle_harder.html" title="forward to &quot;7 Data wrangling, 201: Wrangle harder&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div><h3 x-source-module="(lib &quot;graphite-tutorial/graphite-tutorial.scrbl&quot;)" x-source-pkg="graphite-tutorial" x-part-tag="&quot;Data_wrangling__101&quot;">6<tt>&nbsp;</tt><a name="(part._.Data_wrangling__101)"></a>Data wrangling, 101</h3><p>Graphite does some of the work for us with regards to data processing. Note the <span class="RktVal">'</span><span class="RktVal">count</span> and <span class="RktVal">'</span><span class="RktVal">prop</span> modes
in the earlier bar charts: we didn&rsquo;t have to handle that. But Graphite is not a data wrangling library, and oftentimes
it makes more sense to process our data first.</p><p>For example, in the last example, we got GDP per capita summary statistics for each continent. But what if we want the
<span style="font-style: italic">average, global</span> GDP per capita over time? That&rsquo;s too complex of a transformation for Graphite to do for us.</p><p>For this purpose, we need the Sawzall library, whose documentation is available at
<a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=index.html&amp;version=8.6" class="Sq" data-pltdoc="x">Sawzall: A grammar for chopping up data</a>. This library is designed to take in data-frames, and produce new ones
with some transformation applied &ndash; with operations chaining together using the <a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=threading&amp;rel=index.html&amp;version=8.6" class="RktModLink Sq" data-pltdoc="x"><span class="RktSym">threading</span></a> library.</p><p><div class="SIntrapara">Let&rsquo;s say we want to perform the above transformation on the Gapminder dataset. Effectively, what we want to do is:
</div><div class="SIntrapara"><ul><li><p>Take all the data in each year, ignoring country,</p></li><li><p>average the GDP per capita within each year,</p></li><li><p>then collect the results of that sum into a new data-frame.</p></li></ul></div></p><p><div class="SIntrapara">This translates naturally to the following Sawzall pipeline:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">sum</span><span class="hspace">&nbsp;</span><span class="RktSym">vec</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=for.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._for%252Fsum%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">for/sum</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">v</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=sequences.html%23%2528def._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._in-vector%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">in-vector</a></span><span class="hspace">&nbsp;</span><span class="RktSym">vec</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">avg</span><span class="hspace">&nbsp;</span><span class="RktSym">vec</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=generic-numbers.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._%252F%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">/</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">sum</span><span class="hspace">&nbsp;</span><span class="RktSym">vec</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=vectors.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._vector-length%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">vector-length</a></span><span class="hspace">&nbsp;</span><span class="RktSym">vec</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=threading&amp;rel=index.html%23%2528form._%2528%2528lib._threading%252Fmain..rkt%2529._%7E7e%7E3e%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~&gt;</a></span><span class="hspace">&nbsp;</span><span class="RktSym">gapminder</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=grouping.html%23%2528def._%2528%2528lib._sawzall%252Fmain..rkt%2529._group-with%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">group-with</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"year"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=aggregate.html%23%2528form._%2528%2528lib._sawzall%252Fmain..rkt%2529._aggregate%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">aggregate</a></span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">avgGdpPercap</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">gdpPercap</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">avg</span><span class="hspace">&nbsp;</span><span class="RktSym">gdpPercap</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=display.html%23%2528form._%2528%2528lib._sawzall%252Fmain..rkt%2529._show%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">show</a></span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="RktOut">data-frame: 12 rows x 2 columns</span></p></td></tr><tr><td><p><span class="RktOut">&#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9488;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;avgGdpPercap</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;year&#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9500;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9508;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;3725.276045801409 &#9474;1952&#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9500;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9508;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;4299.4083448760575&#9474;1957&#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9500;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9508;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;4725.812341961976 &#9474;1962&#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9500;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9508;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;5483.653046835208 &#9474;1967&#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9500;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9508;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;6770.082815282392 &#9474;1972&#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9500;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9508;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;7313.166420794365 &#9474;1977&#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9524;&#9472;&#9472;&#9472;&#9472;&#9496;</span></p></td></tr><tr><td><p><span class="RktOut">6 rows, 0 cols elided</span></p></td></tr><tr><td><p><span class="RktOut">(use (show df everything #:n-rows 'all) for full frame)</span></p></td></tr></table></td></tr></table></blockquote></div></p><p><div class="SIntrapara">Let&rsquo;s break down this code.
</div><div class="SIntrapara"><ul><li><p>The <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=threading&amp;rel=index.html%23%2528form._%2528%2528lib._threading%252Fmain..rkt%2529._%7E7e%7E3e%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~&gt;</a></span> operator is effectively "spicy function composition"; <span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=threading&amp;rel=index.html%23%2528form._%2528%2528lib._threading%252Fmain..rkt%2529._%7E7e%7E3e%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~&gt;</a></span><span class="stt"> </span><span class="RktSym">h</span><span class="stt"> </span><span class="RktSym">g</span><span class="stt"> </span><span class="RktSym">f</span><span class="stt"> </span><span class="RktSym">x</span><span class="RktPn">)</span> translates at
compile-time to <span class="RktPn">(</span><span class="RktSym">f</span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym">g</span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym">h</span><span class="stt"> </span><span class="RktSym">x</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span>. We use it here to express the idea of "do-this-then-that".</p></li><li><p><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=grouping.html%23%2528def._%2528%2528lib._sawzall%252Fmain..rkt%2529._group-with%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">group-with</a></span><span class="stt"> </span><span class="RktVal">"year"</span><span class="RktPn">)</span> takes <span class="RktSym">gapminder</span>, and groups it with respect to the variable <span class="RktVal">"year"</span>.
This tells sequential operations that we want to treat each different possibility of year seperately.</p></li><li><p><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=aggregate.html%23%2528form._%2528%2528lib._sawzall%252Fmain..rkt%2529._aggregate%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">aggregate</a></span><span class="stt"> </span><span class="RktPn">[</span><span class="RktSym">avgGdpPercap</span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym">gdpPercap</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym">avg</span><span class="stt"> </span><span class="RktSym">gdpPercap</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span> aggregates each group into a single value.
<span class="RktSym">avgGdpPercap</span> tells us what the new column name should be, <span class="RktPn">(</span><span class="RktSym">gdpPercap</span><span class="RktPn">)</span> tells us that we want to
bind the variable <span class="RktSym">gdpPercap</span> as a vector in the body, and <span class="RktPn">(</span><span class="RktSym">avg</span><span class="stt"> </span><span class="RktSym">gdpPercap</span><span class="RktPn">)</span> computes the average
value of each vector.</p><p>This is a lot to break down, but more or less it takes each year, gets all the GDP per capita values that
correspond to it, and averages them.</p><p>This also strips down the group structure, since we now only have one row for each year.</p></li><li><p><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=display.html%23%2528form._%2528%2528lib._sawzall%252Fmain..rkt%2529._show%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">show</a></span> prints out the result, and returns nothing, being the last thing in the pipeline.</p></li></ul></div></p><p><div class="SIntrapara">Instead of merely printing out the data, we can use <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529.__%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">_</a></span> to tell <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=threading&amp;rel=index.html%23%2528form._%2528%2528lib._threading%252Fmain..rkt%2529._%7E7e%7E3e%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~&gt;</a></span> where to put the next input, and feed
it directly into <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=graphite&amp;rel=index.html%23%2528def._%2528%2528lib._graphite%252Fmain..rkt%2529._graph%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">graph</a></span>, printing out a time series of global GDP per capita:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=threading&amp;rel=index.html%23%2528form._%2528%2528lib._threading%252Fmain..rkt%2529._%7E7e%7E3e%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~&gt;</a></span><span class="hspace">&nbsp;</span><span class="RktSym">gapminder</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=grouping.html%23%2528def._%2528%2528lib._sawzall%252Fmain..rkt%2529._group-with%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">group-with</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"year"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=aggregate.html%23%2528form._%2528%2528lib._sawzall%252Fmain..rkt%2529._aggregate%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">aggregate</a></span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">avgGdpPercap</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">gdpPercap</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">avg</span><span class="hspace">&nbsp;</span><span class="RktSym">gdpPercap</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=graphite&amp;rel=index.html%23%2528def._%2528%2528lib._graphite%252Fmain..rkt%2529._graph%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">graph</a></span><span class="hspace">&nbsp;</span><span class="RktPn">#:data</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529.__%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">_</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:mapping</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=graphite&amp;rel=index.html%23%2528def._%2528%2528lib._graphite%252Fmain..rkt%2529._aes%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">aes</a></span><span class="hspace">&nbsp;</span><span class="RktPn">#:x</span><span class="hspace">&nbsp;</span><span class="RktVal">"year"</span><span class="hspace">&nbsp;</span><span class="RktPn">#:y</span><span class="hspace">&nbsp;</span><span class="RktVal">"avgGdpPercap"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=graphite&amp;rel=index.html%23%2528def._%2528%2528lib._graphite%252Fmain..rkt%2529._lines%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">lines</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><p><img style="vertical-align: -0.0px; margin: -3px -3px -3px -3px;" src="pict_17.png" alt="image" width="406.0" height="406.0"/></p></td></tr></table></blockquote></div></p><p>This works, but isn&rsquo;t a very useful example, and doesn&rsquo;t teach us anything about how to work with NA values, et cetera.
So, for a more complex example, we&rsquo;ll take a look at the GSS again. We saw already that <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=graphite&amp;rel=index.html%23%2528def._%2528%2528lib._graphite%252Fmain..rkt%2529._bar%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">bar</a></span> can plot counts
and relative frequencies. However, oftentimes it makes more sense to get the data in the shape you want it first, and
then have Graphite focus its effort on plotting the data, rather than messing with it on-the-fly.</p><p><div class="SIntrapara">Say we want to plot the row-marginals of region within religion (so, within each region, what is the % of each religion).
We start from our <span class="RktSym">gss</span> table, which has individual-level observations, and go from there. Effectively, what
we want to do is:
</div><div class="SIntrapara"><ul><li><p>Take our individual-level data,</p></li><li><p>group it with respect to region, and then religion within region,</p></li><li><p>summarize each religion into a count of respondents,</p></li><li><p>then calculate the percentage of each religion within region.</p></li></ul></div></p><p><div class="SIntrapara">Once again, we&rsquo;ll build a Sawzall pipeline, but this time we&rsquo;ll approach it incrementally. First off, we group with
respect to the variables <span class="RktVal">"bigregion"</span> and <span class="RktVal">"religion"</span>. This means that the result is internally
different, but the result of <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=display.html%23%2528form._%2528%2528lib._sawzall%252Fmain..rkt%2529._show%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">show</a></span> does not change. It&rsquo;s merely a marker to tell future operations what to
do.
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=threading&amp;rel=index.html%23%2528form._%2528%2528lib._threading%252Fmain..rkt%2529._%7E7e%7E3e%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~&gt;</a></span><span class="hspace">&nbsp;</span><span class="RktSym">gss</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=grouping.html%23%2528def._%2528%2528lib._sawzall%252Fmain..rkt%2529._group-with%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">group-with</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"bigregion"</span><span class="hspace">&nbsp;</span><span class="RktVal">"religion"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=display.html%23%2528form._%2528%2528lib._sawzall%252Fmain..rkt%2529._show%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">show</a></span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="RktOut">data-frame: 2867 rows x 33 columns</span></p></td></tr><tr><td><p><span class="RktOut">groups: (religion bigregion)</span></p></td></tr><tr><td><p><span class="RktOut">&#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;obama&#9474;grass&#9474;marital</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;kids&#9474;siblings&#9474;relig </span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9500;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9508;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;NA </span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;NA </span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;Married</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;1 </span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;6+</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;Catholic&#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9500;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9508;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;1</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;Legal&#9474;Married</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;0 </span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;4 </span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;Catholic&#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9500;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9508;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;NA </span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;Legal&#9474;Married</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;2 </span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;6+</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;Catholic&#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9500;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9508;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;1</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;Legal&#9474;Married</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;2 </span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;6+</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;Catholic&#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9500;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9508;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;NA </span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;NA </span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;Married</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;0 </span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;2 </span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;Catholic&#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9500;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9508;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;1</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;Legal&#9474;Separated&#9474;4+</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;4 </span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;Catholic&#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9524;&#9472;&#9472;&#9472;&#9472;&#9472;&#9524;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9524;&#9472;&#9472;&#9472;&#9472;&#9524;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9524;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;</span></p></td></tr><tr><td><p><span class="RktOut">2861 rows, 27 cols elided</span></p></td></tr><tr><td><p><span class="RktOut">(use (show df everything #:n-rows 'all) for full frame)</span></p></td></tr></table></td></tr></table></blockquote></div><div class="SIntrapara">Note that multiple arguments to <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=grouping.html%23%2528def._%2528%2528lib._sawzall%252Fmain..rkt%2529._group-with%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">group-with</a></span> say "group with respect to the first, then within each possibility
for the first, group with respect to the second" and so on. Successive calls to <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=grouping.html%23%2528def._%2528%2528lib._sawzall%252Fmain..rkt%2529._group-with%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">group-with</a></span> do not work.</div></p><p><div class="SIntrapara">We then want to get the number of observations within each religion. Note that <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=aggregate.html%23%2528form._%2528%2528lib._sawzall%252Fmain..rkt%2529._aggregate%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">aggregate</a></span> above bound a variable,
and computed something with it. Here, we just want to compute the length of the input, so we call <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=vectors.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._vector-length%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">vector-length</a></span>
on whatever variable we feel like, and turn it into a new variable <span class="RktVal">"count"</span>.
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=threading&amp;rel=index.html%23%2528form._%2528%2528lib._threading%252Fmain..rkt%2529._%7E7e%7E3e%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~&gt;</a></span><span class="hspace">&nbsp;</span><span class="RktSym">gss</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=grouping.html%23%2528def._%2528%2528lib._sawzall%252Fmain..rkt%2529._group-with%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">group-with</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"bigregion"</span><span class="hspace">&nbsp;</span><span class="RktVal">"religion"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=aggregate.html%23%2528form._%2528%2528lib._sawzall%252Fmain..rkt%2529._aggregate%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">aggregate</a></span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528lib._racket%252Flist..rkt%2529._count%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">count</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">bigregion</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=vectors.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._vector-length%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">vector-length</a></span><span class="hspace">&nbsp;</span><span class="RktSym">bigregion</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=display.html%23%2528form._%2528%2528lib._sawzall%252Fmain..rkt%2529._show%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">show</a></span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="RktOut">data-frame: 24 rows x 3 columns</span></p></td></tr><tr><td><p><span class="RktOut">groups: (bigregion)</span></p></td></tr><tr><td><p><span class="RktOut">&#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;bigregion&#9474;count&#9474;religion</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9500;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9508;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;Midwest</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;172</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;Catholic</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9500;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9508;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;Midwest</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;3</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;Jewish</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9500;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9508;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;Midwest</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;5</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;NA</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9500;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9508;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;Midwest</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;157</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;None</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9500;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9508;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;Midwest</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;33 </span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;Other </span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9500;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9508;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;Midwest</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;325</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;Protestant&#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9524;&#9472;&#9472;&#9472;&#9472;&#9472;&#9524;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;</span></p></td></tr><tr><td><p><span class="RktOut">18 rows, 0 cols elided</span></p></td></tr><tr><td><p><span class="RktOut">(use (show df everything #:n-rows 'all) for full frame)</span></p></td></tr></table></td></tr></table></blockquote></div><div class="SIntrapara">Note that this both removed a layer of grouping, and significantly stripped down our table. <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=aggregate.html%23%2528form._%2528%2528lib._sawzall%252Fmain..rkt%2529._aggregate%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">aggregate</a></span> removes all
columns except groups and the columns created (because where would it put the other observations?).</div></p><p><div class="SIntrapara">We then want to take this result, and then create new variables at the current level of grouping (with respect to region),
telling us the percent preference by region. So, what we want to do is calculate the <span style="font-style: italic">frequency</span> of each religion
in each region (so the count divided by the total), and then multiply it by 100 (to turn it into a percentage). We
use Sawzall&rsquo;s <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=create.html%23%2528form._%2528%2528lib._sawzall%252Fmain..rkt%2529._create%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">create</a></span> operation for this:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">v/</span><span class="hspace">&nbsp;</span><span class="RktSym">vec</span><span class="hspace">&nbsp;</span><span class="RktSym">c</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=vectors.html%23%2528def._%2528%2528lib._racket%252Fvector..rkt%2529._vector-map%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">vector-map</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=lambda.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._%7Ece%7Ebb%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">&#955;</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">x</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=generic-numbers.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._%252F%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">/</a></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">c</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">vec</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=threading&amp;rel=index.html%23%2528form._%2528%2528lib._threading%252Fmain..rkt%2529._%7E7e%7E3e%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~&gt;</a></span><span class="hspace">&nbsp;</span><span class="RktSym">gss</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=grouping.html%23%2528def._%2528%2528lib._sawzall%252Fmain..rkt%2529._group-with%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">group-with</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"bigregion"</span><span class="hspace">&nbsp;</span><span class="RktVal">"religion"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=aggregate.html%23%2528form._%2528%2528lib._sawzall%252Fmain..rkt%2529._aggregate%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">aggregate</a></span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528lib._racket%252Flist..rkt%2529._count%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">count</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">bigregion</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=vectors.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._vector-length%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">vector-length</a></span><span class="hspace">&nbsp;</span><span class="RktSym">bigregion</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=create.html%23%2528form._%2528%2528lib._sawzall%252Fmain..rkt%2529._create%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">create</a></span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">frequency</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528lib._racket%252Flist..rkt%2529._count%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">count</a></span><span class="hspace">&nbsp;</span><span class="RktSym">:</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=vectors.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._vector%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">vector</a></span><span class="RktPn">]</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">v/</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528lib._racket%252Flist..rkt%2529._count%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">count</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">sum</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528lib._racket%252Flist..rkt%2529._count%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">count</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">percentage</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">frequency</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=generic-numbers.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._round%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">round</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=generic-numbers.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._%252A%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">*</a></span><span class="hspace">&nbsp;</span><span class="RktSym">frequency</span><span class="hspace">&nbsp;</span><span class="RktVal">100</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=display.html%23%2528form._%2528%2528lib._sawzall%252Fmain..rkt%2529._show%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">show</a></span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="RktOut">data-frame: 24 rows x 5 columns</span></p></td></tr><tr><td><p><span class="RktOut">groups: (bigregion)</span></p></td></tr><tr><td><p><span class="RktOut">&#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;frequency&#9474;count&#9474;bigregion&#9474;religion</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;percentage&#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9500;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9508;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;172/695</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;172</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;Midwest</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;Catholic</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;25</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9500;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9508;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;3/695</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;3</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;Midwest</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;Jewish</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;0 </span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9500;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9508;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;1/139</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;5</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;Midwest</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;NA</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;1 </span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9500;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9508;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;157/695</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;157</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;Midwest</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;None</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;23</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9500;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9508;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;33/695 </span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;33 </span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;Midwest</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;Other </span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;5 </span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9500;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9508;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;65/139 </span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;325</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;Midwest</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;Protestant&#9474;47</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9524;&#9472;&#9472;&#9472;&#9472;&#9472;&#9524;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9524;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9524;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;</span></p></td></tr><tr><td><p><span class="RktOut">18 rows, 0 cols elided</span></p></td></tr><tr><td><p><span class="RktOut">(use (show df everything #:n-rows 'all) for full frame)</span></p></td></tr></table></td></tr></table></blockquote></div></p><p><div class="SIntrapara">Let&rsquo;s break down this code a bit:
</div><div class="SIntrapara"><ul><li><p><span class="RktSym">v/</span> is a helper function to divide every element of a vector by a scalar.</p></li><li><p>The first clause of this <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=create.html%23%2528form._%2528%2528lib._sawzall%252Fmain..rkt%2529._create%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">create</a></span>, <span class="RktPn">[</span><span class="RktSym">frequency</span><span class="stt"> </span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528lib._racket%252Flist..rkt%2529._count%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">count</a></span><span class="stt"> </span><span class="RktSym">:</span><span class="stt"> </span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=vectors.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._vector%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">vector</a></span><span class="RktPn">]</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym">v/</span><span class="stt"> </span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528lib._racket%252Flist..rkt%2529._count%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">count</a></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym">sum</span><span class="stt"> </span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528lib._racket%252Flist..rkt%2529._count%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">count</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span>,
binds the variable <span class="RktVal">"count"</span> as a vector (hence the annotation), divides each element by the sum of
the entire vector, and returns the vector.</p><p>When every bound variable is of type <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=vectors.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._vector%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">vector</a></span>, the body of that clause should return a vector.</p></li><li><p>The second clause of this <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=create.html%23%2528form._%2528%2528lib._sawzall%252Fmain..rkt%2529._create%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">create</a></span>, <span class="RktPn">[</span><span class="RktSym">percentage</span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym">frequency</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=generic-numbers.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._round%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">round</a></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=generic-numbers.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._%252A%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">*</a></span><span class="stt"> </span><span class="RktSym">frequency</span><span class="stt"> </span><span class="RktVal">100</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span>,
binds the variable <span class="RktVal">"frequency"</span> as type <span class="RktSym">element</span>, which means that the body will map over
each element of the vector implicitly. So, <span class="RktSym">frequency</span> is bound to a number, and we treat it as such,
iterating over every element of the column.</p><p>We couldn&rsquo;t do this for the above, because we needed the entire vector at once in order to get the sum.</p></li></ul></div></p><p><div class="SIntrapara">Finally, we strip grouping, save our result as a bare data-frame, and do a sanity check to make sure everything sums
up to 100%. Try breaking down what this code does on your own, with the knowledge above.
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">religion-by-region</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=threading&amp;rel=index.html%23%2528form._%2528%2528lib._threading%252Fmain..rkt%2529._%7E7e%7E3e%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~&gt;</a></span><span class="hspace">&nbsp;</span><span class="RktSym">gss</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=grouping.html%23%2528def._%2528%2528lib._sawzall%252Fmain..rkt%2529._group-with%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">group-with</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"bigregion"</span><span class="hspace">&nbsp;</span><span class="RktVal">"religion"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=aggregate.html%23%2528form._%2528%2528lib._sawzall%252Fmain..rkt%2529._aggregate%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">aggregate</a></span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528lib._racket%252Flist..rkt%2529._count%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">count</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">bigregion</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=vectors.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._vector-length%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">vector-length</a></span><span class="hspace">&nbsp;</span><span class="RktSym">bigregion</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=create.html%23%2528form._%2528%2528lib._sawzall%252Fmain..rkt%2529._create%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">create</a></span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">frequency</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528lib._racket%252Flist..rkt%2529._count%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">count</a></span><span class="hspace">&nbsp;</span><span class="RktSym">:</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=vectors.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._vector%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">vector</a></span><span class="RktPn">]</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">v/</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528lib._racket%252Flist..rkt%2529._count%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">count</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">sum</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528lib._racket%252Flist..rkt%2529._count%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">count</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">percentage</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">frequency</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=generic-numbers.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._round%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">round</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=generic-numbers.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._%252A%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">*</a></span><span class="hspace">&nbsp;</span><span class="RktSym">frequency</span><span class="hspace">&nbsp;</span><span class="RktVal">100</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=grouping.html%23%2528def._%2528%2528lib._sawzall%252Fmain..rkt%2529._ungroup%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">ungroup</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=threading&amp;rel=index.html%23%2528form._%2528%2528lib._threading%252Fmain..rkt%2529._%7E7e%7E3e%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~&gt;</a></span><span class="hspace">&nbsp;</span><span class="RktSym">religion-by-region</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=grouping.html%23%2528def._%2528%2528lib._sawzall%252Fmain..rkt%2529._group-with%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">group-with</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"bigregion"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=aggregate.html%23%2528form._%2528%2528lib._sawzall%252Fmain..rkt%2529._aggregate%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">aggregate</a></span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">total</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">percentage</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">sum</span><span class="hspace">&nbsp;</span><span class="RktSym">percentage</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=display.html%23%2528form._%2528%2528lib._sawzall%252Fmain..rkt%2529._show%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">show</a></span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="RktOut">data-frame: 4 rows x 2 columns</span></p></td></tr><tr><td><p><span class="RktOut">&#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;total&#9474;bigregion&#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9500;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9508;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;101</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;Midwest</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9500;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9508;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;100</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;Northeast&#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9500;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9508;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;100</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;South</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9500;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9508;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;101</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;West </span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9524;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;</span></p></td></tr></table></td></tr></table></blockquote></div></p><p>Looks good! Some error was added by rounding, hence the 101s.</p><p><div class="SIntrapara">We can then feed this data into Graphite, faceting on the variable <span class="RktVal">"bigregion"</span>. We use the <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=graphite&amp;rel=index.html%23%2528def._%2528%2528lib._graphite%252Fmain..rkt%2529._col%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">col</a></span>
renderer, which is like <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=graphite&amp;rel=index.html%23%2528def._%2528%2528lib._graphite%252Fmain..rkt%2529._bar%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">bar</a></span>, except it takes its data <span style="font-style: italic">literally</span> &ndash; the value in the data corresponds
directly to the height of each bar, no computations involved.
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=graphite&amp;rel=index.html%23%2528def._%2528%2528lib._graphite%252Fmain..rkt%2529._graph%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">graph</a></span><span class="hspace">&nbsp;</span><span class="RktPn">#:data</span><span class="hspace">&nbsp;</span><span class="RktSym">religion-by-region</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:mapping</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=graphite&amp;rel=index.html%23%2528def._%2528%2528lib._graphite%252Fmain..rkt%2529._aes%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">aes</a></span><span class="hspace">&nbsp;</span><span class="RktPn">#:x</span><span class="hspace">&nbsp;</span><span class="RktVal">"religion"</span><span class="hspace">&nbsp;</span><span class="RktPn">#:y</span><span class="hspace">&nbsp;</span><span class="RktVal">"percentage"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:fill</span><span class="hspace">&nbsp;</span><span class="RktVal">"religion"</span><span class="hspace">&nbsp;</span><span class="RktPn">#:facet</span><span class="hspace">&nbsp;</span><span class="RktVal">"bigregion"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:x-label</span><span class="hspace">&nbsp;</span><span class="RktVal">"Religion"</span><span class="hspace">&nbsp;</span><span class="RktPn">#:y-label</span><span class="hspace">&nbsp;</span><span class="RktVal">"Percent"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:width</span><span class="hspace">&nbsp;</span><span class="RktVal">700</span><span class="hspace">&nbsp;</span><span class="RktPn">#:height</span><span class="hspace">&nbsp;</span><span class="RktVal">700</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=graphite&amp;rel=index.html%23%2528def._%2528%2528lib._graphite%252Fmain..rkt%2529._col%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">col</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><p><img style="vertical-align: -0.0px; margin: -3px -3px -3px -3px;" src="pict_18.png" alt="image" width="703.0" height="656.0"/></p></td></tr></table></blockquote></div></p><p>Voil&#224;.</p><div class="navsetbottom"><span class="navleft"><form class="searchform"><input class="searchbox" id="searchbox" type="text" tabindex="1" placeholder="...search manuals..." title="Enter a search string to search the manuals" onkeypress="return DoSearchKey(event, this, &quot;8.6&quot;, &quot;../&quot;);"/></form>&nbsp;&nbsp;<a href="../index-2.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;8.6&quot;);">top</a><span class="tocsettoggle">&nbsp;&nbsp;<a href="javascript:void(0);" title="show/hide table of contents" onclick="TocsetToggle();">contents</a></span></span><span class="navright">&nbsp;&nbsp;<a href="Faceting.html" title="backward to &quot;5 Faceting&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="index.html" title="up to &quot;Graphite: a guided tour&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="Data_wrangling__201__Wrangle_harder.html" title="forward to &quot;7 Data wrangling, 201: Wrangle harder&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body>
<!-- Mirrored from docs.racket-lang.org/graphite-tutorial/Data_wrangling__101.html by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 07 Sep 2022 03:27:15 GMT -->
</html>