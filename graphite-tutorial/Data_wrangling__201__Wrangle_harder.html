<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- Mirrored from docs.racket-lang.org/graphite-tutorial/Data_wrangling__201__Wrangle_harder.html by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 07 Sep 2022 03:27:15 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><meta name="viewport" content="width=device-width, initial-scale=0.8"/><title>7&nbsp;Data wrangling, 201: Wrangle harder</title><link rel="stylesheet" type="text/css" href="../scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="../racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-style.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../doc-site.css" title="default"/><script type="text/javascript" src="../scribble-common.js"></script><script type="text/javascript" src="../manual-racket.js"></script><script type="text/javascript" src="../manual-racket.js"></script><script type="text/javascript" src="../doc-site.js"></script><script type="text/javascript" src="../local-redirect/local-redirect.js"></script><script type="text/javascript" src="../local-redirect/local-user-redirect.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="doc-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9660;</a></td><td></td><td><a href="index.html" class="tocviewlink" data-pltdoc="x">Graphite:<span class="mywbr"> &nbsp;</span> a guided tour</a></td></tr></table></div><div class="tocviewsublistonly" style="display: block;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="Deciding_what_library_to_use.html" class="tocviewlink" data-pltdoc="x">Deciding what library to use</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="Key_forms.html" class="tocviewlink" data-pltdoc="x">Key forms</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="Gapminder.html" class="tocviewlink" data-pltdoc="x">Gapminder</a></td></tr><tr><td align="right">4&nbsp;</td><td><a href="Bar_charts.html" class="tocviewlink" data-pltdoc="x">Bar charts</a></td></tr><tr><td align="right">5&nbsp;</td><td><a href="Faceting.html" class="tocviewlink" data-pltdoc="x">Faceting</a></td></tr><tr><td align="right">6&nbsp;</td><td><a href="Data_wrangling__101.html" class="tocviewlink" data-pltdoc="x">Data wrangling, 101</a></td></tr><tr><td align="right">7&nbsp;</td><td><a href="#" class="tocviewselflink" data-pltdoc="x">Data wrangling, 201:<span class="mywbr"> &nbsp;</span> Wrangle harder</a></td></tr></table></div></div></div></div><div class="maincolumn"><div class="main"><div class="navsettop"><span class="navleft"><form class="searchform"><input class="searchbox" id="searchbox" type="text" tabindex="1" placeholder="...search manuals..." title="Enter a search string to search the manuals" onkeypress="return DoSearchKey(event, this, &quot;8.6&quot;, &quot;../&quot;);"/></form>&nbsp;&nbsp;<a href="../index-2.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;8.6&quot;);">top</a><span class="tocsettoggle">&nbsp;&nbsp;<a href="javascript:void(0);" title="show/hide table of contents" onclick="TocsetToggle();">contents</a></span></span><span class="navright">&nbsp;&nbsp;<a href="Data_wrangling__101.html" title="backward to &quot;6 Data wrangling, 101&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="index.html" title="up to &quot;Graphite: a guided tour&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<span class="nonavigation">next &rarr;</span></span>&nbsp;</div><h3 x-source-module="(lib &quot;graphite-tutorial/graphite-tutorial.scrbl&quot;)" x-source-pkg="graphite-tutorial" x-part-tag="&quot;Data_wrangling__201__Wrangle_harder&quot;">7<tt>&nbsp;</tt><a name="(part._.Data_wrangling__201__.Wrangle_harder)"></a>Data wrangling, 201: Wrangle harder</h3><p>This section of the tutorial is based off of
<a href="https://r4ds.had.co.nz/tidy-data.html">R for Data Science Chapter 12</a>, by Hadley Wickham.</p><p><span style="font-style: italic">The Sawzall API in this section is not finalized. There are no guarantees about backwards compatibility.</span></p><p><div class="SIntrapara">Graphite, and the majority of Sawzall&rsquo;s operations, assume three things about the data:
</div><div class="SIntrapara"><ul><li><p>Each variable has its own column.</p></li><li><p>Each observation has its own row.</p></li><li><p>Each value has its own cell.</p></li></ul></div><div class="SIntrapara">This style of presentation is called "tidy data" (hence the name "tidyverse", the R software collection Graphite
and Sawzall are inspired by). Data that does not satisfy these properties is called "untidy data", and the process
of transforming it into tidy data is called "tidying".</div></p><p>Unfortunately, the overwhelming majority of data that you will encounter in the real world&#8482; is untidy. Most data
is managed through spreadsheet software like Excel, and is optimized for data entry, not analysis or visualization.</p><p><div class="SIntrapara">Let&rsquo;s take a look at some untidy data. In particular, we&rsquo;re going to look at tuberculosis data broken down by country,
year, age, gender, and diagnosis method. This data comes from the
<a href="http://www.who.int/tb/country/data/download/en/">2014 World Health Organization Global Tuberculosis Report</a>.
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">who</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=data-frame&amp;rel=index.html%23%2528def._%2528%2528lib._data-frame%252Fmain..rkt%2529._df-read%252Fcsv%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">df-read/csv</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"data/who.csv"</span><span class="hspace">&nbsp;</span><span class="RktPn">#:na</span><span class="hspace">&nbsp;</span><span class="RktVal">"NA"</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=data-frame&amp;rel=index.html%23%2528def._%2528%2528lib._data-frame%252Fmain..rkt%2529._df-del-series%2521%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">df-del-series!</a></span><span class="hspace">&nbsp;</span><span class="RktSym">who</span><span class="hspace">&nbsp;</span><span class="RktVal">""</span><span class="RktPn">)</span></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=display.html%23%2528form._%2528%2528lib._sawzall%252Fmain..rkt%2529._show%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">show</a></span><span class="hspace">&nbsp;</span><span class="RktSym">who</span><span class="RktPn">)</span></td></tr><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="RktOut">data-frame: 7240 rows x 60 columns</span></p></td></tr><tr><td><p><span class="RktOut">&#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;newrel_f65&#9474;new_ep_f4554&#9474;new_ep_f3544&#9474;new_sp_m3544&#9474;new_sp_f014&#9474;new_sp_f65&#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9500;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9508;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;#f</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;#f</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;#f</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;#f</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;#f </span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;#f</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9500;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9508;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;#f</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;#f</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;#f</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;#f</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;#f </span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;#f</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9500;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9508;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;#f</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;#f</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;#f</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;#f</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;#f </span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;#f</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9500;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9508;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;#f</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;#f</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;#f</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;#f</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;#f </span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;#f</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9500;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9508;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;#f</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;#f</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;#f</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;#f</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;#f </span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;#f</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9500;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9508;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;#f</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;#f</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;#f</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;#f</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;#f </span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;#f</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9524;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9524;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9524;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9524;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9524;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;</span></p></td></tr><tr><td><p><span class="RktOut">7234 rows, 54 cols elided</span></p></td></tr><tr><td><p><span class="RktOut">(use (show df everything #:n-rows 'all) for full frame)</span></p></td></tr></table></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=data-frame&amp;rel=index.html%23%2528def._%2528%2528lib._data-frame%252Fmain..rkt%2529._df-series-names%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">df-series-names</a></span><span class="hspace">&nbsp;</span><span class="RktSym">who</span><span class="RktPn">)</span></td></tr><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="RktRes">'("newrel_f65"</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">"new_ep_f4554"</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">"new_ep_f3544"</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">"new_sp_m3544"</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">"new_sp_f014"</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">"new_sp_f65"</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">"new_sn_m3544"</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">"new_ep_f65"</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">"newrel_f5564"</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">"newrel_f1524"</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">"iso2"</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">"country"</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">"new_sn_m65"</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">"new_sn_f5564"</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">"newrel_m1524"</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">"new_ep_f1524"</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">"newrel_m4554"</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">"new_ep_m5564"</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">"new_sp_f1524"</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">"new_sn_m5564"</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">"newrel_m65"</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">"new_ep_f5564"</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">"new_ep_m1524"</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">"newrel_f014"</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">"iso3"</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">"new_sp_f2534"</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">"new_ep_m4554"</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">"new_sp_f3544"</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">"new_ep_m014"</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">"new_sp_m65"</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">"new_ep_m2534"</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">"newrel_f4554"</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">"new_sp_m5564"</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">"new_ep_f014"</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">"new_sn_f65"</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">"new_sp_m2534"</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">"new_sn_m014"</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">"new_sn_m2534"</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">"new_sn_f2534"</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">"new_sp_m014"</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">"new_sp_f4554"</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">"new_ep_f2534"</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">"new_sn_f014"</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">"new_sp_m1524"</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">"year"</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">"new_sp_f5564"</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">"newrel_m5564"</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">"new_sn_f3544"</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">"new_sn_m4554"</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">"new_sn_f1524"</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">"new_sn_f4554"</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">"new_sn_m1524"</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">"new_sp_m4554"</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">"new_ep_m3544"</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">"newrel_m014"</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">"newrel_f2534"</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">"newrel_m2534"</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">"newrel_m3544"</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">"new_ep_m65"</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">"newrel_f3544")</span></p></td></tr></table></td></tr></table></blockquote></div><div class="SIntrapara">We remove the empty column because it&rsquo;s a column of IDs, which is irrelevant for our purposes.</div></p><p>Anyway, wow. Ouch. This is a pretty typical dataset: it has redundant columns, weird variable codes, and missing values
abound. Chances are, it was made in spreadsheet software. So, we&rsquo;ll need multiple steps to try and tidy it.</p><p><div class="SIntrapara">Here&rsquo;s a breakdown of what we can deduce for now:
</div><div class="SIntrapara"><ul><li><p><span class="stt">country</span>, <span class="stt">iso2</span>, and <span class="stt">iso3</span> are variables that specify the country, the latter two being country
codes. We don&rsquo;t need the latter two, then.</p></li><li><p><span class="stt">year</span> is clearly a variable.</p></li><li><p>Given names like <span class="stt">newrel_f65</span> and <span class="stt">new_ep_f4554</span>, we can reasonably infer that these are values of some
mega-variable.</p></li></ul></div></p><p>So, what we want to do is take the names of each <span class="stt">new...</span>, and the values of each of those columns, and turn them
into two columns: one representing the former name of the column, and one representing the value. Sawzall provides an
operation for turning column names that are actually values into a new column: <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=pivoting.html%23%2528form._%2528%2528lib._sawzall%252Fmain..rkt%2529._pivot-longer%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">pivot-longer</a></span>.</p><p>To use <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=pivoting.html%23%2528form._%2528%2528lib._sawzall%252Fmain..rkt%2529._pivot-longer%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">pivot-longer</a></span>, we need three things: the set of columns whose names are values and not variables
(in this case, everything starting with <span class="stt">new</span>), a name of a variable to move the column names to (in this case,
<span class="stt">key</span>, since we don&rsquo;t know what these names mean yet), and a name of a variable to move the column values
to (we know it&rsquo;s TB cases, so we&rsquo;ll call it <span class="stt">cases</span>).</p><p><div class="SIntrapara">So, that looks something like this:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=threading&amp;rel=index.html%23%2528form._%2528%2528lib._threading%252Fmain..rkt%2529._%7E7e%7E3e%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~&gt;</a></span><span class="hspace">&nbsp;</span><span class="RktSym">who</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=pivoting.html%23%2528form._%2528%2528lib._sawzall%252Fmain..rkt%2529._pivot-longer%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">pivot-longer</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=slice.html%23%2528form._%2528%2528lib._sawzall%252Fmain..rkt%2529._starting-with%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">starting-with</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"new"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:names-to</span><span class="hspace">&nbsp;</span><span class="RktVal">"key"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:values-to</span><span class="hspace">&nbsp;</span><span class="RktVal">"cases"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=display.html%23%2528form._%2528%2528lib._sawzall%252Fmain..rkt%2529._show%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">show</a></span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="RktOut">data-frame: 405440 rows x 6 columns</span></p></td></tr><tr><td><p><span class="RktOut">&#9484;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9488;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;year&#9474;key </span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;iso2&#9474;country</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;cases&#9474;iso3&#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9500;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9508;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;1980&#9474;newrel_f65&#9474;AF</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;Afghanistan&#9474;#f </span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;AFG &#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9500;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9508;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;1981&#9474;newrel_f65&#9474;AF</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;Afghanistan&#9474;#f </span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;AFG &#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9500;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9508;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;1982&#9474;newrel_f65&#9474;AF</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;Afghanistan&#9474;#f </span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;AFG &#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9500;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9508;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;1983&#9474;newrel_f65&#9474;AF</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;Afghanistan&#9474;#f </span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;AFG &#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9500;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9508;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;1984&#9474;newrel_f65&#9474;AF</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;Afghanistan&#9474;#f </span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;AFG &#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9500;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9508;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;1985&#9474;newrel_f65&#9474;AF</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;Afghanistan&#9474;#f </span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;AFG &#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9492;&#9472;&#9472;&#9472;&#9472;&#9524;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9524;&#9472;&#9472;&#9472;&#9472;&#9524;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9524;&#9472;&#9472;&#9472;&#9472;&#9472;&#9524;&#9472;&#9472;&#9472;&#9472;&#9496;</span></p></td></tr><tr><td><p><span class="RktOut">405434 rows, 0 cols elided</span></p></td></tr><tr><td><p><span class="RktOut">(use (show df everything #:n-rows 'all) for full frame)</span></p></td></tr></table></td></tr></table></blockquote></div></p><p>We now have significantly fewer columns, and way more rows, since we transformed all of those messy columns into two.
Note the <span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=slice.html%23%2528form._%2528%2528lib._sawzall%252Fmain..rkt%2529._starting-with%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">starting-with</a></span><span class="stt"> </span><span class="RktVal">"new"</span><span class="RktPn">)</span>: this is a <span style="font-style: italic">slice spec</span>, a domain-specific language for selecting
columns from data. See <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=slice.html%23%2528form._%2528%2528lib._sawzall%252Fmain..rkt%2529._slice%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">slice</a></span>&rsquo;s documentation for more details.</p><p><div class="SIntrapara">We can also assume that rows where there are no entered data (so, <span class="RktVal">#f</span> is in them) are irrelevant. To get rid of
them, we can use <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=missing-values.html%23%2528form._%2528%2528lib._sawzall%252Fmain..rkt%2529._drop-na%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">drop-na</a></span>, which does what it says on the tin:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=threading&amp;rel=index.html%23%2528form._%2528%2528lib._threading%252Fmain..rkt%2529._%7E7e%7E3e%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~&gt;</a></span><span class="hspace">&nbsp;</span><span class="RktSym">who</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=pivoting.html%23%2528form._%2528%2528lib._sawzall%252Fmain..rkt%2529._pivot-longer%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">pivot-longer</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=slice.html%23%2528form._%2528%2528lib._sawzall%252Fmain..rkt%2529._starting-with%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">starting-with</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"new"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:names-to</span><span class="hspace">&nbsp;</span><span class="RktVal">"key"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:values-to</span><span class="hspace">&nbsp;</span><span class="RktVal">"cases"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=missing-values.html%23%2528form._%2528%2528lib._sawzall%252Fmain..rkt%2529._drop-na%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">drop-na</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"cases"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=display.html%23%2528form._%2528%2528lib._sawzall%252Fmain..rkt%2529._show%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">show</a></span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="RktOut">data-frame: 76046 rows x 6 columns</span></p></td></tr><tr><td><p><span class="RktOut">&#9484;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9488;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;year&#9474;iso2&#9474;key </span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;country</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;cases&#9474;iso3&#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9500;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9508;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;2013&#9474;AL</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;newrel_f65&#9474;Albania</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;34 </span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;ALB &#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9500;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9508;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;2013&#9474;DZ</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;newrel_f65&#9474;Algeria</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;352</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;DZA &#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9500;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9508;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;2013&#9474;AD</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;newrel_f65&#9474;Andorra</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;0</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;AND &#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9500;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9508;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;2013&#9474;AO</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;newrel_f65&#9474;Angola </span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;314</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;AGO &#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9500;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9508;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;2013&#9474;AI</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;newrel_f65&#9474;Anguilla </span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;0</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;AIA &#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9500;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9508;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;2013&#9474;AG</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;newrel_f65&#9474;Antigua and Barbuda&#9474;1</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;ATG &#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9492;&#9472;&#9472;&#9472;&#9472;&#9524;&#9472;&#9472;&#9472;&#9472;&#9524;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9524;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9524;&#9472;&#9472;&#9472;&#9472;&#9472;&#9524;&#9472;&#9472;&#9472;&#9472;&#9496;</span></p></td></tr><tr><td><p><span class="RktOut">76040 rows, 0 cols elided</span></p></td></tr><tr><td><p><span class="RktOut">(use (show df everything #:n-rows 'all) for full frame)</span></p></td></tr></table></td></tr></table></blockquote></div></p><p><div class="SIntrapara">Annoyingly, we don&rsquo;t understand what <span class="stt">key</span> is supposed to mean. Luckily, I&rsquo;m basing this tutorial off other people&rsquo;s
work, who have conveniently provided the information for me. So, here&rsquo;s the anatomy of, for example,
<span class="RktVal">"new_ep_f4554"</span>:
</div><div class="SIntrapara"><ul><li><p>The first three letters are either <span class="stt">new</span> or <span class="stt">old</span>, denoting new or old cases of TB. We don&rsquo;t have any old
cases in the provided data. So, in this case, we have a new case</p></li><li><p><div class="SIntrapara">The next two letters denote the type of TB:
</div><div class="SIntrapara"><ul><li><p><span class="stt">rel</span> stands for relapse</p></li><li><p><span class="stt">ep</span> stands for extrapulmonary TB (this case)</p></li><li><p><span class="stt">sn</span> stands for pulmonary TB that could not be diagnosed by a pulmonary smear (smear negative)</p></li><li><p><span class="stt">sp</span> stands for pulmonary TB that could be diagnosed by a pulmonary smear (smear positive)</p></li></ul></div></p></li><li><p>The sixth letter gives the sex of the patient, either <span class="stt">m</span> or <span class="stt">f</span> for male and female, respectively.</p></li><li><p>The remaining numbers give an age group. For example, <span class="stt">014</span> is 0-14 years old, <span class="stt">4554</span> is 45-54 years
old, and <span class="stt">65</span> is 65+.</p></li></ul></div></p><p><div class="SIntrapara">Unfortunately, the cases of relapse are formatted like <span class="stt">newrel_f65</span>. So, we&rsquo;ll use <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=create.html%23%2528form._%2528%2528lib._sawzall%252Fmain..rkt%2529._create%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">create</a></span> to replace all
instances of <span class="RktVal">"newrel"</span> with <span class="RktVal">"new_rel"</span>, so we have a common baseline to split our variable on. Note
that binding the variable and making a new column with the same name replaces the old one:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=threading&amp;rel=index.html%23%2528form._%2528%2528lib._threading%252Fmain..rkt%2529._%7E7e%7E3e%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~&gt;</a></span><span class="hspace">&nbsp;</span><span class="RktSym">who</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=pivoting.html%23%2528form._%2528%2528lib._sawzall%252Fmain..rkt%2529._pivot-longer%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">pivot-longer</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=slice.html%23%2528form._%2528%2528lib._sawzall%252Fmain..rkt%2529._starting-with%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">starting-with</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"new"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:names-to</span><span class="hspace">&nbsp;</span><span class="RktVal">"key"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:values-to</span><span class="hspace">&nbsp;</span><span class="RktVal">"cases"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=missing-values.html%23%2528form._%2528%2528lib._sawzall%252Fmain..rkt%2529._drop-na%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">drop-na</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"cases"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=create.html%23%2528form._%2528%2528lib._sawzall%252Fmain..rkt%2529._create%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">create</a></span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">key</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">key</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528lib._racket%252Fstring..rkt%2529._string-replace%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">string-replace</a></span><span class="hspace">&nbsp;</span><span class="RktSym">key</span><span class="hspace">&nbsp;</span><span class="RktVal">"newrel"</span><span class="hspace">&nbsp;</span><span class="RktVal">"new_rel"</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=display.html%23%2528form._%2528%2528lib._sawzall%252Fmain..rkt%2529._show%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">show</a></span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="RktOut">data-frame: 76046 rows x 6 columns</span></p></td></tr><tr><td><p><span class="RktOut">&#9484;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9488;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;year&#9474;key</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;iso2&#9474;country</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;cases&#9474;iso3&#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9500;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9508;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;2013&#9474;new_rel_f65&#9474;AL</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;Albania</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;34 </span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;ALB &#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9500;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9508;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;2013&#9474;new_rel_f65&#9474;DZ</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;Algeria</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;352</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;DZA &#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9500;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9508;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;2013&#9474;new_rel_f65&#9474;AD</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;Andorra</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;0</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;AND &#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9500;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9508;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;2013&#9474;new_rel_f65&#9474;AO</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;Angola </span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;314</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;AGO &#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9500;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9508;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;2013&#9474;new_rel_f65&#9474;AI</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;Anguilla </span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;0</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;AIA &#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9500;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9508;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;2013&#9474;new_rel_f65&#9474;AG</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;Antigua and Barbuda&#9474;1</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;ATG &#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9492;&#9472;&#9472;&#9472;&#9472;&#9524;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9524;&#9472;&#9472;&#9472;&#9472;&#9524;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9524;&#9472;&#9472;&#9472;&#9472;&#9472;&#9524;&#9472;&#9472;&#9472;&#9472;&#9496;</span></p></td></tr><tr><td><p><span class="RktOut">76040 rows, 0 cols elided</span></p></td></tr><tr><td><p><span class="RktOut">(use (show df everything #:n-rows 'all) for full frame)</span></p></td></tr></table></td></tr></table></blockquote></div></p><p><div class="SIntrapara">Then, we want to split up each variable along the separator <span class="RktVal">"_"</span>, pulling apart each value of <span class="stt">key</span> into
three variables: <span class="stt">new</span>, <span class="stt">type</span>, and <span class="stt">sex-age</span> (since, for example, <span class="RktVal">"f4554"</span>) is both the sex and
age variable). Sawzall provides the <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=separate.html%23%2528def._%2528%2528lib._sawzall%252Fmain..rkt%2529._separate%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">separate</a></span> function for this purpose:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=threading&amp;rel=index.html%23%2528form._%2528%2528lib._threading%252Fmain..rkt%2529._%7E7e%7E3e%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~&gt;</a></span><span class="hspace">&nbsp;</span><span class="RktSym">who</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=pivoting.html%23%2528form._%2528%2528lib._sawzall%252Fmain..rkt%2529._pivot-longer%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">pivot-longer</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=slice.html%23%2528form._%2528%2528lib._sawzall%252Fmain..rkt%2529._starting-with%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">starting-with</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"new"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:names-to</span><span class="hspace">&nbsp;</span><span class="RktVal">"key"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:values-to</span><span class="hspace">&nbsp;</span><span class="RktVal">"cases"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=missing-values.html%23%2528form._%2528%2528lib._sawzall%252Fmain..rkt%2529._drop-na%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">drop-na</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"cases"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=create.html%23%2528form._%2528%2528lib._sawzall%252Fmain..rkt%2529._create%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">create</a></span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">key</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">key</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528lib._racket%252Fstring..rkt%2529._string-replace%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">string-replace</a></span><span class="hspace">&nbsp;</span><span class="RktSym">key</span><span class="hspace">&nbsp;</span><span class="RktVal">"newrel"</span><span class="hspace">&nbsp;</span><span class="RktVal">"new_rel"</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=separate.html%23%2528def._%2528%2528lib._sawzall%252Fmain..rkt%2529._separate%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">separate</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"key"</span><span class="hspace">&nbsp;</span><span class="RktPn">#:into</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">"new"</span><span class="hspace">&nbsp;</span><span class="RktVal">"type"</span><span class="hspace">&nbsp;</span><span class="RktVal">"sex-age"</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktPn">#:separator</span><span class="hspace">&nbsp;</span><span class="RktVal">"_"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=display.html%23%2528form._%2528%2528lib._sawzall%252Fmain..rkt%2529._show%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">show</a></span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktVal">"country"</span><span class="hspace">&nbsp;</span><span class="RktVal">"new"</span><span class="hspace">&nbsp;</span><span class="RktVal">"type"</span><span class="hspace">&nbsp;</span><span class="RktVal">"sex-age"</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="RktOut">data-frame: 76046 rows x 8 columns</span></p></td></tr><tr><td><p><span class="RktOut">&#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;country</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;new&#9474;type&#9474;sex-age&#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9500;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9508;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;Albania</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;new&#9474;rel &#9474;f65</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9500;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9508;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;Algeria</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;new&#9474;rel &#9474;f65</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9500;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9508;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;Andorra</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;new&#9474;rel &#9474;f65</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9500;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9508;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;Angola </span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;new&#9474;rel &#9474;f65</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9500;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9508;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;Anguilla </span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;new&#9474;rel &#9474;f65</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9500;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9508;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;Antigua and Barbuda&#9474;new&#9474;rel &#9474;f65</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9524;&#9472;&#9472;&#9472;&#9524;&#9472;&#9472;&#9472;&#9472;&#9524;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;</span></p></td></tr><tr><td><p><span class="RktOut">76040 rows, 4 cols elided</span></p></td></tr><tr><td><p><span class="RktOut">(use (show df everything #:n-rows 'all) for full frame)</span></p></td></tr></table></td></tr></table></blockquote></div><div class="SIntrapara">The <span class="RktPn">#:into</span> keyword argument determines what column names to split the variable into, and
<span class="RktPn">#:separator</span> determines a string to split each value on. Also note how <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=display.html%23%2528form._%2528%2528lib._sawzall%252Fmain..rkt%2529._show%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">show</a></span> also takes a
<span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=slice.html%23%2528form._%2528%2528lib._sawzall%252Fmain..rkt%2529._slice%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">slice</a></span>-spec, so we can determine what columns we want to show.</div></p><p><div class="SIntrapara">We have some useless variables now. Namely, <span class="stt">new</span> is just <span class="RktVal">"new"</span> repeated over and over, and <span class="stt">iso2</span>
and <span class="stt">iso3</span> are country codes, which are irrelevant for our purposes. We can use the <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=slice.html%23%2528form._%2528%2528lib._sawzall%252Fmain..rkt%2529._slice%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">slice</a></span> operator,
alongside a slice-spec that takes everything aside from these variables, to remove them from the data:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=threading&amp;rel=index.html%23%2528form._%2528%2528lib._threading%252Fmain..rkt%2529._%7E7e%7E3e%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~&gt;</a></span><span class="hspace">&nbsp;</span><span class="RktSym">who</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=pivoting.html%23%2528form._%2528%2528lib._sawzall%252Fmain..rkt%2529._pivot-longer%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">pivot-longer</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=slice.html%23%2528form._%2528%2528lib._sawzall%252Fmain..rkt%2529._starting-with%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">starting-with</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"new"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:names-to</span><span class="hspace">&nbsp;</span><span class="RktVal">"key"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:values-to</span><span class="hspace">&nbsp;</span><span class="RktVal">"cases"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=missing-values.html%23%2528form._%2528%2528lib._sawzall%252Fmain..rkt%2529._drop-na%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">drop-na</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"cases"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=create.html%23%2528form._%2528%2528lib._sawzall%252Fmain..rkt%2529._create%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">create</a></span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">key</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">key</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528lib._racket%252Fstring..rkt%2529._string-replace%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">string-replace</a></span><span class="hspace">&nbsp;</span><span class="RktSym">key</span><span class="hspace">&nbsp;</span><span class="RktVal">"newrel"</span><span class="hspace">&nbsp;</span><span class="RktVal">"new_rel"</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=separate.html%23%2528def._%2528%2528lib._sawzall%252Fmain..rkt%2529._separate%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">separate</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"key"</span><span class="hspace">&nbsp;</span><span class="RktPn">#:into</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">"new"</span><span class="hspace">&nbsp;</span><span class="RktVal">"type"</span><span class="hspace">&nbsp;</span><span class="RktVal">"sex-age"</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktPn">#:separator</span><span class="hspace">&nbsp;</span><span class="RktVal">"_"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=slice.html%23%2528form._%2528%2528lib._sawzall%252Fmain..rkt%2529._slice%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">slice</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=slice.html%23%2528form._%2528%2528lib._sawzall%252Fmain..rkt%2529._not%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">not</a></span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktVal">"new"</span><span class="hspace">&nbsp;</span><span class="RktVal">"iso2"</span><span class="hspace">&nbsp;</span><span class="RktVal">"iso3"</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=display.html%23%2528form._%2528%2528lib._sawzall%252Fmain..rkt%2529._show%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">show</a></span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="RktOut">data-frame: 76046 rows x 5 columns</span></p></td></tr><tr><td><p><span class="RktOut">&#9484;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;type&#9474;year&#9474;country</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;cases&#9474;sex-age&#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9500;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9508;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;rel &#9474;2013&#9474;Albania</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;34 </span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;f65</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9500;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9508;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;rel &#9474;2013&#9474;Algeria</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;352</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;f65</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9500;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9508;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;rel &#9474;2013&#9474;Andorra</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;0</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;f65</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9500;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9508;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;rel &#9474;2013&#9474;Angola </span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;314</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;f65</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9500;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9508;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;rel &#9474;2013&#9474;Anguilla </span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;0</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;f65</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9500;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9508;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;rel &#9474;2013&#9474;Antigua and Barbuda&#9474;1</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;f65</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9492;&#9472;&#9472;&#9472;&#9472;&#9524;&#9472;&#9472;&#9472;&#9472;&#9524;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9524;&#9472;&#9472;&#9472;&#9472;&#9472;&#9524;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;</span></p></td></tr><tr><td><p><span class="RktOut">76040 rows, 0 cols elided</span></p></td></tr><tr><td><p><span class="RktOut">(use (show df everything #:n-rows 'all) for full frame)</span></p></td></tr></table></td></tr></table></blockquote></div></p><p><div class="SIntrapara">Finally, we can seperate the <span class="stt">sex-age</span> variable into two variables, <span class="stt">sex</span> and <span class="stt">age</span>, with the
<span class="RktPn">#:separator</span> <span class="RktVal">1</span> &ndash; we can specify a number, in which case the variable will be split at this
character index.
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=threading&amp;rel=index.html%23%2528form._%2528%2528lib._threading%252Fmain..rkt%2529._%7E7e%7E3e%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~&gt;</a></span><span class="hspace">&nbsp;</span><span class="RktSym">who</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=pivoting.html%23%2528form._%2528%2528lib._sawzall%252Fmain..rkt%2529._pivot-longer%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">pivot-longer</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=slice.html%23%2528form._%2528%2528lib._sawzall%252Fmain..rkt%2529._starting-with%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">starting-with</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"new"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:names-to</span><span class="hspace">&nbsp;</span><span class="RktVal">"key"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:values-to</span><span class="hspace">&nbsp;</span><span class="RktVal">"cases"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=missing-values.html%23%2528form._%2528%2528lib._sawzall%252Fmain..rkt%2529._drop-na%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">drop-na</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"cases"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=create.html%23%2528form._%2528%2528lib._sawzall%252Fmain..rkt%2529._create%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">create</a></span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">key</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">key</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528lib._racket%252Fstring..rkt%2529._string-replace%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">string-replace</a></span><span class="hspace">&nbsp;</span><span class="RktSym">key</span><span class="hspace">&nbsp;</span><span class="RktVal">"newrel"</span><span class="hspace">&nbsp;</span><span class="RktVal">"new_rel"</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=separate.html%23%2528def._%2528%2528lib._sawzall%252Fmain..rkt%2529._separate%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">separate</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"key"</span><span class="hspace">&nbsp;</span><span class="RktPn">#:into</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">"new"</span><span class="hspace">&nbsp;</span><span class="RktVal">"type"</span><span class="hspace">&nbsp;</span><span class="RktVal">"sex-age"</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktPn">#:separator</span><span class="hspace">&nbsp;</span><span class="RktVal">"_"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=slice.html%23%2528form._%2528%2528lib._sawzall%252Fmain..rkt%2529._slice%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">slice</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=slice.html%23%2528form._%2528%2528lib._sawzall%252Fmain..rkt%2529._not%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">not</a></span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktVal">"new"</span><span class="hspace">&nbsp;</span><span class="RktVal">"iso2"</span><span class="hspace">&nbsp;</span><span class="RktVal">"iso3"</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=separate.html%23%2528def._%2528%2528lib._sawzall%252Fmain..rkt%2529._separate%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">separate</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"sex-age"</span><span class="hspace">&nbsp;</span><span class="RktPn">#:into</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">"sex"</span><span class="hspace">&nbsp;</span><span class="RktVal">"age"</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktPn">#:separator</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=display.html%23%2528form._%2528%2528lib._sawzall%252Fmain..rkt%2529._show%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">show</a></span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="RktOut">data-frame: 76046 rows x 6 columns</span></p></td></tr><tr><td><p><span class="RktOut">&#9484;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9488;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;year&#9474;country</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;type&#9474;cases&#9474;age&#9474;sex&#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9500;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9508;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;2013&#9474;Albania</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;rel &#9474;34 </span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;65 &#9474;f</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9500;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9508;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;2013&#9474;Algeria</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;rel &#9474;352</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;65 &#9474;f</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9500;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9508;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;2013&#9474;Andorra</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;rel &#9474;0</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;65 &#9474;f</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9500;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9508;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;2013&#9474;Angola </span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;rel &#9474;314</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;65 &#9474;f</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9500;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9508;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;2013&#9474;Anguilla </span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;rel &#9474;0</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;65 &#9474;f</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9500;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9508;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;2013&#9474;Antigua and Barbuda&#9474;rel &#9474;1</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;65 &#9474;f</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9492;&#9472;&#9472;&#9472;&#9472;&#9524;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9524;&#9472;&#9472;&#9472;&#9472;&#9524;&#9472;&#9472;&#9472;&#9472;&#9472;&#9524;&#9472;&#9472;&#9472;&#9524;&#9472;&#9472;&#9472;&#9496;</span></p></td></tr><tr><td><p><span class="RktOut">76040 rows, 0 cols elided</span></p></td></tr><tr><td><p><span class="RktOut">(use (show df everything #:n-rows 'all) for full frame)</span></p></td></tr></table></td></tr></table></blockquote></div></p><p><div class="SIntrapara">Finally, we have some tidy data! Let&rsquo;s save it:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">tidy-who</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=threading&amp;rel=index.html%23%2528form._%2528%2528lib._threading%252Fmain..rkt%2529._%7E7e%7E3e%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~&gt;</a></span><span class="hspace">&nbsp;</span><span class="RktSym">who</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=pivoting.html%23%2528form._%2528%2528lib._sawzall%252Fmain..rkt%2529._pivot-longer%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">pivot-longer</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=slice.html%23%2528form._%2528%2528lib._sawzall%252Fmain..rkt%2529._starting-with%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">starting-with</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"new"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:names-to</span><span class="hspace">&nbsp;</span><span class="RktVal">"key"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:values-to</span><span class="hspace">&nbsp;</span><span class="RktVal">"cases"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=missing-values.html%23%2528form._%2528%2528lib._sawzall%252Fmain..rkt%2529._drop-na%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">drop-na</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"cases"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=create.html%23%2528form._%2528%2528lib._sawzall%252Fmain..rkt%2529._create%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">create</a></span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">key</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">key</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528lib._racket%252Fstring..rkt%2529._string-replace%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">string-replace</a></span><span class="hspace">&nbsp;</span><span class="RktSym">key</span><span class="hspace">&nbsp;</span><span class="RktVal">"newrel"</span><span class="hspace">&nbsp;</span><span class="RktVal">"new_rel"</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=separate.html%23%2528def._%2528%2528lib._sawzall%252Fmain..rkt%2529._separate%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">separate</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"key"</span><span class="hspace">&nbsp;</span><span class="RktPn">#:into</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">"new"</span><span class="hspace">&nbsp;</span><span class="RktVal">"type"</span><span class="hspace">&nbsp;</span><span class="RktVal">"sex-age"</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktPn">#:separator</span><span class="hspace">&nbsp;</span><span class="RktVal">"_"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=slice.html%23%2528form._%2528%2528lib._sawzall%252Fmain..rkt%2529._slice%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">slice</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=slice.html%23%2528form._%2528%2528lib._sawzall%252Fmain..rkt%2529._not%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">not</a></span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktVal">"new"</span><span class="hspace">&nbsp;</span><span class="RktVal">"iso2"</span><span class="hspace">&nbsp;</span><span class="RktVal">"iso3"</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=separate.html%23%2528def._%2528%2528lib._sawzall%252Fmain..rkt%2529._separate%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">separate</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"sex-age"</span><span class="hspace">&nbsp;</span><span class="RktPn">#:into</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">"sex"</span><span class="hspace">&nbsp;</span><span class="RktVal">"age"</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktPn">#:separator</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr></table></blockquote></div></p><p><div class="SIntrapara">Now that we finally have some tidy data, we can make some nice looking plots. Let&rsquo;s turn this into
a plot of TB cases in Afghanistan. We want to use <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=where.html%23%2528form._%2528%2528lib._sawzall%252Fmain..rkt%2529._where%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">where</a></span> in order to "filter" down this data
into just cases for Afghanistan:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=threading&amp;rel=index.html%23%2528form._%2528%2528lib._threading%252Fmain..rkt%2529._%7E7e%7E3e%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~&gt;</a></span><span class="hspace">&nbsp;</span><span class="RktSym">tidy-who</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=where.html%23%2528form._%2528%2528lib._sawzall%252Fmain..rkt%2529._where%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">where</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">country</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string%7E3d%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">string=?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">country</span><span class="hspace">&nbsp;</span><span class="RktVal">"Afghanistan"</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=display.html%23%2528form._%2528%2528lib._sawzall%252Fmain..rkt%2529._show%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">show</a></span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="RktOut">data-frame: 244 rows x 6 columns</span></p></td></tr><tr><td><p><span class="RktOut">&#9484;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9488;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;year&#9474;age &#9474;type&#9474;country</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;cases&#9474;sex&#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9500;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9508;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;1997&#9474;3544&#9474;sp</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;Afghanistan&#9474;3</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;m</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9500;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9508;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;1998&#9474;3544&#9474;sp</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;Afghanistan&#9474;90 </span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;m</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9500;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9508;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;1999&#9474;3544&#9474;sp</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;Afghanistan&#9474;47 </span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;m</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9500;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9508;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;2000&#9474;3544&#9474;sp</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;Afghanistan&#9474;149</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;m</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9500;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9508;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;2001&#9474;3544&#9474;sp</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;Afghanistan&#9474;274</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;m</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9500;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9508;</span></p></td></tr><tr><td><p><span class="RktOut">&#9474;2002&#9474;3544&#9474;sp</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;Afghanistan&#9474;368</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;m</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9474;</span></p></td></tr><tr><td><p><span class="RktOut">&#9492;&#9472;&#9472;&#9472;&#9472;&#9524;&#9472;&#9472;&#9472;&#9472;&#9524;&#9472;&#9472;&#9472;&#9472;&#9524;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9524;&#9472;&#9472;&#9472;&#9472;&#9472;&#9524;&#9472;&#9472;&#9472;&#9496;</span></p></td></tr><tr><td><p><span class="RktOut">238 rows, 0 cols elided</span></p></td></tr><tr><td><p><span class="RktOut">(use (show df everything #:n-rows 'all) for full frame)</span></p></td></tr></table></td></tr></table></blockquote></div><div class="SIntrapara"><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=where.html%23%2528form._%2528%2528lib._sawzall%252Fmain..rkt%2529._where%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">where</a></span> works similarly to each clause of <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=create.html%23%2528form._%2528%2528lib._sawzall%252Fmain..rkt%2529._create%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">create</a></span> or <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=aggregate.html%23%2528form._%2528%2528lib._sawzall%252Fmain..rkt%2529._aggregate%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">aggregate</a></span> &ndash; we bind the
variable <span class="stt">country</span> as an element, and then filter the rows of the data-frame for those where the
body returns true.</div></p><p><div class="SIntrapara">Then, if we try to plot this stratified by age, we run into an issue:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=threading&amp;rel=index.html%23%2528form._%2528%2528lib._threading%252Fmain..rkt%2529._%7E7e%7E3e%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~&gt;</a></span><span class="hspace">&nbsp;</span><span class="RktSym">tidy-who</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=where.html%23%2528form._%2528%2528lib._sawzall%252Fmain..rkt%2529._where%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">where</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">country</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string%7E3d%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">string=?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">country</span><span class="hspace">&nbsp;</span><span class="RktVal">"Afghanistan"</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=graphite&amp;rel=index.html%23%2528def._%2528%2528lib._graphite%252Fmain..rkt%2529._graph%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">graph</a></span><span class="hspace">&nbsp;</span><span class="RktPn">#:data</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529.__%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">_</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:mapping</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=graphite&amp;rel=index.html%23%2528def._%2528%2528lib._graphite%252Fmain..rkt%2529._aes%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">aes</a></span><span class="hspace">&nbsp;</span><span class="RktPn">#:x</span><span class="hspace">&nbsp;</span><span class="RktVal">"year"</span><span class="hspace">&nbsp;</span><span class="RktPn">#:y</span><span class="hspace">&nbsp;</span><span class="RktVal">"cases"</span><span class="hspace">&nbsp;</span><span class="RktPn">#:discrete-color</span><span class="hspace">&nbsp;</span><span class="RktVal">"age"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=graphite&amp;rel=index.html%23%2528def._%2528%2528lib._graphite%252Fmain..rkt%2529._lines%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">lines</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><p><img style="vertical-align: -0.0px; margin: -3px -3px -3px -3px;" src="pict_19.png" alt="image" width="406.0" height="406.0"/></p></td></tr></table></blockquote></div></p><p><div class="SIntrapara">This is a giant mess! The issue is the <span class="stt">sex</span> variable &ndash; Graphite doesn&rsquo;t know what to do with this
information, since you end up with multiple data-points for year/case. So, we want to group by year and
age, sum the case data within them, and then ungroup: this effectively eliminates the sex variable.
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=threading&amp;rel=index.html%23%2528form._%2528%2528lib._threading%252Fmain..rkt%2529._%7E7e%7E3e%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~&gt;</a></span><span class="hspace">&nbsp;</span><span class="RktSym">tidy-who</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=where.html%23%2528form._%2528%2528lib._sawzall%252Fmain..rkt%2529._where%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">where</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">country</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string%7E3d%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">string=?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">country</span><span class="hspace">&nbsp;</span><span class="RktVal">"Afghanistan"</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=grouping.html%23%2528def._%2528%2528lib._sawzall%252Fmain..rkt%2529._group-with%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">group-with</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"year"</span><span class="hspace">&nbsp;</span><span class="RktVal">"age"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=aggregate.html%23%2528form._%2528%2528lib._sawzall%252Fmain..rkt%2529._aggregate%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">aggregate</a></span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">cases</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cases</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">sum</span><span class="hspace">&nbsp;</span><span class="RktSym">cases</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=sawzall&amp;rel=grouping.html%23%2528def._%2528%2528lib._sawzall%252Fmain..rkt%2529._ungroup%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">ungroup</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=graphite&amp;rel=index.html%23%2528def._%2528%2528lib._graphite%252Fmain..rkt%2529._graph%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">graph</a></span><span class="hspace">&nbsp;</span><span class="RktPn">#:data</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529.__%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">_</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:mapping</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=graphite&amp;rel=index.html%23%2528def._%2528%2528lib._graphite%252Fmain..rkt%2529._aes%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">aes</a></span><span class="hspace">&nbsp;</span><span class="RktPn">#:x</span><span class="hspace">&nbsp;</span><span class="RktVal">"year"</span><span class="hspace">&nbsp;</span><span class="RktPn">#:y</span><span class="hspace">&nbsp;</span><span class="RktVal">"cases"</span><span class="hspace">&nbsp;</span><span class="RktPn">#:discrete-color</span><span class="hspace">&nbsp;</span><span class="RktVal">"age"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=graphite&amp;rel=index.html%23%2528def._%2528%2528lib._graphite%252Fmain..rkt%2529._lines%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">lines</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><p><img style="vertical-align: -0.0px; margin: -3px -3px -3px -3px;" src="pict_20.png" alt="image" width="406.0" height="406.0"/></p></td></tr></table></blockquote></div></p><p>Finally, we have a plot, and we can determine that Afghanistan had a sudden spike in TB cases among ages
0-14 in 2010-2013.</p><div class="navsetbottom"><span class="navleft"><form class="searchform"><input class="searchbox" id="searchbox" type="text" tabindex="1" placeholder="...search manuals..." title="Enter a search string to search the manuals" onkeypress="return DoSearchKey(event, this, &quot;8.6&quot;, &quot;../&quot;);"/></form>&nbsp;&nbsp;<a href="../index-2.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;8.6&quot;);">top</a><span class="tocsettoggle">&nbsp;&nbsp;<a href="javascript:void(0);" title="show/hide table of contents" onclick="TocsetToggle();">contents</a></span></span><span class="navright">&nbsp;&nbsp;<a href="Data_wrangling__101.html" title="backward to &quot;6 Data wrangling, 101&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="index.html" title="up to &quot;Graphite: a guided tour&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<span class="nonavigation">next &rarr;</span></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body>
<!-- Mirrored from docs.racket-lang.org/graphite-tutorial/Data_wrangling__201__Wrangle_harder.html by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 07 Sep 2022 03:27:17 GMT -->
</html>