<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- Mirrored from docs.racket-lang.org/scribble-lp2-manual/index.html by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 07 Sep 2022 03:02:29 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><meta name="viewport" content="width=device-width, initial-scale=0.8"/><title>Literate programming in style</title><link rel="stylesheet" type="text/css" href="../scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="../racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-style.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../doc-site.css" title="default"/><script type="text/javascript" src="../scribble-common.js"></script><script type="text/javascript" src="../manual-racket.js"></script><script type="text/javascript" src="../manual-racket.js"></script><script type="text/javascript" src="../doc-site.js"></script><script type="text/javascript" src="../local-redirect/local-redirect.js"></script><script type="text/javascript" src="../local-redirect/local-user-redirect.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="doc-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9658;</a></td><td></td><td><a href="#" class="tocviewselflink" data-pltdoc="x">Literate programming in style</a></td></tr></table></div><div class="tocviewsublistonly" style="display: none;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="#%28part._.About_this_document%29" class="tocviewlink" data-pltdoc="x">About this document</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="#%28part._.Building_scribble_lp2_manual%29" class="tocviewlink" data-pltdoc="x">Building <span class="RktModLink"><span class="RktSym">scribble/<span class="mywbr"> &nbsp;</span>lp2/<span class="mywbr"> &nbsp;</span>manual</span></span></a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="#%28part._.Putting_it_all_together%29" class="tocviewlink" data-pltdoc="x">Putting it all together</a></td></tr></table></div></div></div><div class="tocsub"><table class="tocsublist" cellspacing="0"><tr><td><span class="tocsublinknumber"></span><a href="#%28part._top%29" class="tocsubseclink" data-pltdoc="x">Literate programming in style</a></td></tr><tr><td><span class="tocsublinknumber">1<tt>&nbsp;</tt></span><a href="#%28part._.About_this_document%29" class="tocsubseclink" data-pltdoc="x">About this document</a></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28chunk._~3cmain-module~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;main-module&gt;</a></span></td></tr><tr><td><span class="tocsublinknumber">2<tt>&nbsp;</tt></span><a href="#%28part._.Building_scribble_lp2_manual%29" class="tocsubseclink" data-pltdoc="x">Building <span class="RktModLink"><span class="RktSym">scribble/<span class="mywbr"> &nbsp;</span>lp2/<span class="mywbr"> &nbsp;</span>manual</span></span></a></td></tr><tr><td><span class="tocsublinknumber">2.1<tt>&nbsp;</tt></span><a href="#%28part._.Reader%29" class="tocsubseclink" data-pltdoc="x">Reader</a></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28chunk._~3creader~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;reader&gt;</a></span></td></tr><tr><td><span class="tocsublinknumber">2.2<tt>&nbsp;</tt></span><a href="#%28part._.Expander%29" class="tocsubseclink" data-pltdoc="x">Expander</a></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28chunk._~3cexpander~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;expander&gt;</a></span></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28chunk._~3cexpander-provides~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;expander-provides&gt;</a></span></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28chunk._~3cexpander-impl~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;expander-impl&gt;</a></span></td></tr><tr><td><span class="tocsublinknumber">3<tt>&nbsp;</tt></span><a href="#%28part._.Putting_it_all_together%29" class="tocsubseclink" data-pltdoc="x">Putting it all together</a></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28chunk._~3c%2A~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;*&gt;</a></span></td></tr></table></div></div><div class="maincolumn"><div class="main"><div class="versionbox"><span class="version">8.6</span></div><div class="navsettop"><span class="navleft"><form class="searchform"><input class="searchbox" id="searchbox" type="text" tabindex="1" placeholder="...search manuals..." title="Enter a search string to search the manuals" onkeypress="return DoSearchKey(event, this, &quot;8.6&quot;, &quot;../&quot;);"/></form>&nbsp;&nbsp;<a href="../index-2.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;8.6&quot;);">top</a><span class="tocsettoggle">&nbsp;&nbsp;<a href="javascript:void(0);" title="show/hide table of contents" onclick="TocsetToggle();">contents</a></span></span><span class="navright">&nbsp;&nbsp;<span class="nonavigation">&larr; prev</span>&nbsp;&nbsp;<a href="../index-2.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;8.6&quot;);">up</a>&nbsp;&nbsp;<span class="nonavigation">next &rarr;</span></span>&nbsp;</div><h2 x-source-module="(lib &quot;scribble/lp2/manual/scribblings/scribble-lp2-manual.scrbl&quot;)" x-source-pkg="scribble-lp2-manual" x-part-tag="&quot;top&quot;"><a name="(part._top)"></a><a name="(part._.Literate_programming_in_style)"></a><a name="(mod-path._scribble/lp2/manual)"></a>Literate programming in style</h2><div class="SAuthorListBox"><span class="SAuthorList"><p class="author">D. Ben Knoble</p></span></div><p><table cellspacing="0" cellpadding="0" class="defmodule"><tr><td align="left"><span class="hspace">&nbsp;</span><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=guide&amp;rel=Module_Syntax.html%23%2528part._hash-lang%2529&amp;version=8.6" class="RktModLink Sq" data-pltdoc="x"><span class="RktMod">#lang</span></a><span class="hspace">&nbsp;</span><a href="#" class="RktModLink" data-pltdoc="x"><span class="RktSym">scribble/lp2/manual</span></a></td><td align="right"><span class="RpackageSpec"><span class="Smaller">&nbsp;package:</span> <a href="https://pkgs.racket-lang.org/package/scribble-lp2-manual" title="Install this package using `raco pkg install scribble-lp2-manual`"><span class="stt">scribble-lp2-manual</span></a></span></td></tr></table></p><p>The <a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=scribble&amp;rel=lp.html%23%2528mod-path._scribble%252Flp2%2529&amp;version=8.6" class="RktModLink Sq" data-pltdoc="x"><span class="RktSym">scribble/lp2</span></a> language with <a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=scribble&amp;rel=manual.html&amp;version=8.6" class="RktModLink Sq" data-pltdoc="x"><span class="RktSym">scribble/manual</span></a>
style. You must call <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=scribble&amp;rel=base.html%23%2528def._%2528%2528lib._scribble%252Fbase..rkt%2529._title%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">title</a></span> for the new style to be applied, but really,
what program document doesn&rsquo;t have a title?</p><h3 x-source-module="(lib &quot;scribble/lp2/manual/scribblings/scribble-lp2-manual.scrbl&quot;)" x-source-pkg="scribble-lp2-manual" x-part-tag="&quot;About_this_document&quot;">1<tt>&nbsp;</tt><a name="(part._.About_this_document)"></a>About this document</h3><p>This document is written in <a href="#" class="RktModLink" data-pltdoc="x"><span class="RktSym">scribble/lp2/manual</span></a> and thus serves as both
test and example for the language. This document also embeds an implementation
of the language, which the main sources use to expose the language.</p><ul><li><p>If it renders at all, then it successfully integrates with
<a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=scribble&amp;rel=index.html&amp;version=8.6" class="Sq" data-pltdoc="x">Scribble: The Racket Documentation Tool</a>.</p></li><li><p>If it renders in the style of <a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=scribble&amp;rel=manual.html&amp;version=8.6" class="RktModLink Sq" data-pltdoc="x"><span class="RktSym">scribble/manual</span></a>, then it
successfuly applies the style.</p></li><li><p>If it can be run as a racket program and reports <span class="RktVal">2</span>, then it
successfully integrates with <a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=scribble&amp;rel=lp.html%23%2528mod-path._scribble%252Flp2%2529&amp;version=8.6" class="RktModLink Sq" data-pltdoc="x"><span class="RktSym">scribble/lp2</span></a>. See
<a href="#%28elem._%28chunk._~3cmain-module~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;main-module&gt;</a>.</p></li></ul><p>This <span class="RktSym">chunk</span> is the main-module that produces <span class="RktVal">2</span> when this code
is run with <span class="RktMeta">racket</span><span class="hspace">&nbsp;</span><span class="RktMeta">&lt;source&gt;.scrbl</span>.</p><p><div class="SIntrapara"><a name="(elem._(chunk._~3cmain-module~3e~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28chunk._~3cmain-module~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;main-module&gt;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=module.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._module%252B%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">module+</a></span><span class="hspace">&nbsp;</span><span class="RktSym">main</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=generic-numbers.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._%252B%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span><span class="RktPn">)</span></p></blockquote></div></p><h3 x-source-module="(lib &quot;scribble/lp2/manual/scribblings/scribble-lp2-manual.scrbl&quot;)" x-source-pkg="scribble-lp2-manual" x-part-tag="&quot;Building_scribble_lp2_manual&quot;">2<tt>&nbsp;</tt><a name="(part._.Building_scribble_lp2_manual)"></a>Building <a href="#" class="RktModLink" data-pltdoc="x"><span class="RktSym">scribble/lp2/manual</span></a></h3><p>Let&rsquo;s walkthrough how the language is built as an exercise in using the
language.</p><p>First, we have to figure out how to apply the <a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=scribble&amp;rel=manual.html&amp;version=8.6" class="RktModLink Sq" data-pltdoc="x"><span class="RktSym">scribble/manual</span></a>
style to an existing <a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=scribble&amp;rel=lp.html%23%2528mod-path._scribble%252Flp2%2529&amp;version=8.6" class="RktModLink Sq" data-pltdoc="x"><span class="RktSym">scribble/lp2</span></a> document. Since <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=scribble&amp;rel=base.html%23%2528def._%2528%2528lib._scribble%252Fbase..rkt%2529._title%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">title</a></span>
takes <span class="RktPn">#:style</span> to control the document&rsquo;s style, we&rsquo;ll use that with
<span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=scribble&amp;rel=Miscellaneous.html%23%2528def._%2528%2528lib._scribble%252Fmanual..rkt%2529._manual-doc-style%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">manual-doc-style</a></span> to get what we want:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=guide&amp;rel=Module_Syntax.html%23%2528part._hash-lang%2529&amp;version=8.6" class="RktModLink Sq" data-pltdoc="x"><span class="RktMod">#lang</span></a><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=scribble&amp;rel=lp.html%23%2528mod-path._scribble%252Flp2%2529&amp;version=8.6" class="RktModLink Sq" data-pltdoc="x"><span class="RktSym">scribble/lp2</span></a><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="RktMeta">&#160;</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="RktPn">@</span><span class="RktPn">(</span><span class="RktMeta">require</span><span class="hspace">&nbsp;</span><span class="RktMeta">scribble/manual</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="RktMeta">&#160;</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="RktPn">@</span><span class="RktMeta">title</span><span class="RktPn">[</span><span class="RktPn">#:style</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta">manual-doc-style</span><span class="RktPn">]</span><span class="RktPn">{</span><span class="RktMeta">My</span><span class="hspace">&nbsp;</span><span class="RktMeta">program</span><span class="RktPn">}</span><span class="RktMeta"></span></td></tr></table></blockquote><blockquote class="refpara"><blockquote class="refcolumn"><blockquote class="refcontent"><p>Thankfully, <a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=scribble&amp;rel=manual.html&amp;version=8.6" class="RktModLink Sq" data-pltdoc="x"><span class="RktSym">scribble/manual</span></a> <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._provide%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">provide</a></span>s
<span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=scribble&amp;rel=Miscellaneous.html%23%2528def._%2528%2528lib._scribble%252Fmanual..rkt%2529._manual-doc-style%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">manual-doc-style</a></span>, which we know by looking at
<a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=scribble&amp;rel=manual-render-style.html&amp;version=8.6" class="Sq" data-pltdoc="x">Manual Rendering Style</a>.</p></blockquote></blockquote></blockquote><p>This works, but we have to do it for any <a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=scribble&amp;rel=lp.html%23%2528mod-path._scribble%252Flp2%2529&amp;version=8.6" class="RktModLink Sq" data-pltdoc="x"><span class="RktSym">scribble/lp2</span></a> program we
want to render with style. Let&rsquo;s make a language to fix this.</p><h4 x-source-module="(lib &quot;scribble/lp2/manual/scribblings/scribble-lp2-manual.scrbl&quot;)" x-source-pkg="scribble-lp2-manual" x-part-tag="&quot;Reader&quot;">2.1<tt>&nbsp;</tt><a name="(part._.Reader)"></a>Reader</h4><p>All <a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=guide&amp;rel=Module_Syntax.html%23%2528part._hash-lang%2529&amp;version=8.6" class="RktModLink Sq" data-pltdoc="x"><span class="RktMod">#lang</span></a>s need a reader, so here&rsquo;s ours:</p><p><div class="SIntrapara"><a name="(elem._(chunk._~3creader~3e~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28chunk._~3creader~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;reader&gt;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=module.html%23%2528form._%2528%2528quote._%7E23%7E25kernel%2529._module%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">module</a></span><span class="hspace">&nbsp;</span><span class="RktSym">reader</span><span class="hspace">&nbsp;</span><span class="RktSym">syntax/module-reader</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">Name of the expander module</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">scribble/lp2/manual</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">#:read</span><span class="hspace">&nbsp;</span><span class="RktSym">read-inside</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">#:read-syntax</span><span class="hspace">&nbsp;</span><span class="RktSym">read-syntax-inside</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">#:whole-body-readers?</span><span class="hspace">&nbsp;</span><span class="RktVal">#t</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">#:language-info</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">scribble-base-language-info</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">#:info</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">scribble-base-info</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._require%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">require</a></span><span class="hspace">&nbsp;</span><span class="RktSym">scribble/reader</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._only-in%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">only-in</a></span><span class="hspace">&nbsp;</span><span class="RktSym">scribble/base/reader</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">scribble-base-info</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">scribble-base-language-info</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">cf. <a href="https://github.com/racket/scribble/blob/master/scribble-lib/scribble/lp2.rkt"><span class="url">https://github.com/racket/scribble/blob/master/scribble-lib/scribble/lp2.rkt</span></a></span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><p>We base it on the existing scribble readers, such as that of
<a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=scribble&amp;rel=lp.html%23%2528mod-path._scribble%252Flp2%2529&amp;version=8.6" class="RktModLink Sq" data-pltdoc="x"><span class="RktSym">scribble/lp2</span></a>, but we use our own expander module.</p><h4 x-source-module="(lib &quot;scribble/lp2/manual/scribblings/scribble-lp2-manual.scrbl&quot;)" x-source-pkg="scribble-lp2-manual" x-part-tag="&quot;Expander&quot;">2.2<tt>&nbsp;</tt><a name="(part._.Expander)"></a>Expander</h4><p>Next we provide a module implementing the expander:</p><p><div class="SIntrapara"><a name="(elem._(chunk._~3cexpander~3e~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28chunk._~3cexpander~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;expander&gt;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=module.html%23%2528form._%2528%2528quote._%7E23%7E25kernel%2529._module%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">module</a></span><span class="hspace">&nbsp;</span><span class="RktSym">expander</span><span class="hspace">&nbsp;</span><span class="RktSym">racket/base</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><a href="#%28elem._%28chunk._~3cexpander-provides~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;expander-provides&gt;</a></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><a href="#%28elem._%28chunk._~3cexpander-impl~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;expander-impl&gt;</a><span class="RktPn">)</span></td></tr></table></blockquote></div></p><p>The expander needs to provide base bindings for the language, including a
<span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=module.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._%7E23%7E25module-begin%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">#%module-begin</a></span> syntax. We&rsquo;ll re-use bindings
from <a href="https://github.com/racket/scribble/blob/master/scribble-lib/scribble/lp/lang/lang2.rkt">scribble/lp/lang/lang2</a>, since that what
<a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=scribble&amp;rel=lp.html%23%2528mod-path._scribble%252Flp2%2529&amp;version=8.6" class="RktModLink Sq" data-pltdoc="x"><span class="RktSym">scribble/lp2</span></a> uses, but we&rsquo;ll supplement with our own
<span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=module.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._%7E23%7E25module-begin%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">#%module-begin</a></span>:</p><p><div class="SIntrapara"><a name="(elem._(chunk._~3cexpander-provides~3e~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28chunk._~3cexpander-provides~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;expander-provides&gt;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._provide%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">provide</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._except-out%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">except-out</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._all-from-out%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">all-from-out</a></span><span class="hspace">&nbsp;</span><span class="RktSym">scribble/lp/lang/lang2</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">lp2:mb</span></span></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._rename-out%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">rename-out</a></span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">mb</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=module.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._%7E23%7E25module-begin%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">#%module-begin</a></span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><p>Our <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=module.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._%7E23%7E25module-begin%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">#%module-begin</a></span> needs to force <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=scribble&amp;rel=base.html%23%2528def._%2528%2528lib._scribble%252Fbase..rkt%2529._title%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">title</a></span> to use
<span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=scribble&amp;rel=Miscellaneous.html%23%2528def._%2528%2528lib._scribble%252Fmanual..rkt%2529._manual-doc-style%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">manual-doc-style</a></span>, then invoke <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=module.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._%7E23%7E25module-begin%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">#%module-begin</a></span> from
<a href="https://github.com/racket/scribble/blob/master/scribble-lib/scribble/lp/lang/lang2.rkt">scribble/lp/lang/lang2</a>:</p><p><div class="SIntrapara"><a name="(elem._(chunk._~3cexpander-impl~3e~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28chunk._~3cexpander-impl~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;expander-impl&gt;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._require%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">require</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._rename-in%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">rename-in</a></span><span class="hspace">&nbsp;</span><span class="RktSym">scribble/lp/lang/lang2</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=module.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._%7E23%7E25module-begin%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">#%module-begin</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">lp2:mb</span></span></span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">syntax/parse/define</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Defining_Simple_Macros.html%23%2528form._%2528%2528lib._syntax%252Fparse%252Fdefine..rkt%2529._define-syntax-parse-rule%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define-syntax-parse-rule</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">mb</span><span class="hspace">&nbsp;</span><span class="RktSym">body</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">lp2:mb</span></span></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=scribble&amp;rel=base.html%23%2528def._%2528%2528lib._scribble%252Fbase..rkt%2529._title%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">title</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">Avoid polluting the module-body with require's by using dynamic-require.</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">But it's odd that we still have to bind title, since we know title will</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">be bound by the (require scribble/manual) in the expansion of lp2:mb.</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">Perhaps hygiene is in the way? (require scribble/manual) in this module</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">doesn't work either, though I suspect the strip-context call of being</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">at fault at that point.</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=let.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fletstx-scheme..rkt%2529._let%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">let</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">curryr</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=Module_Names_and_Loading.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._dynamic-require%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">dynamic-require</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">racket/function</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">curryr</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=scribble&amp;rel=base.html%23%2528def._%2528%2528lib._scribble%252Fbase..rkt%2529._title%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">title</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=Module_Names_and_Loading.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._dynamic-require%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">dynamic-require</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">scribble/manual</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">title</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">curryr</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=scribble&amp;rel=base.html%23%2528def._%2528%2528lib._scribble%252Fbase..rkt%2529._title%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">title</a></span><span class="hspace">&nbsp;</span><span class="RktPn">#:style</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=scribble&amp;rel=Miscellaneous.html%23%2528def._%2528%2528lib._scribble%252Fmanual..rkt%2529._manual-doc-style%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">manual-doc-style</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">body</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><h3 x-source-module="(lib &quot;scribble/lp2/manual/scribblings/scribble-lp2-manual.scrbl&quot;)" x-source-pkg="scribble-lp2-manual" x-part-tag="&quot;Putting_it_all_together&quot;">3<tt>&nbsp;</tt><a name="(part._.Putting_it_all_together)"></a>Putting it all together</h3><p>That&rsquo;s it! The actual implementation uses files that provide exactly this code.
Because this is a literate program, we <span style="font-style: italic">could</span> <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._require%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">require</a></span> its
submodules to get a reader or expander. If the actual language implementation
did that, though, there would be a circular dependency! In order to understand
the source of this document, we consult the language definition, which requires
this document to compile, <span style="font-style: italic">etc.</span>, <span style="font-style: italic">ad infinitum</span>. So we won&rsquo;t do
that, though it is a neat trick (<span style="font-style: italic">e.g.</span>,
<a href="https://github.com/mbutterick/pollen-tfl">pollen-tfl</a>
implements part of its codebase as a literal program).</p><p>Put the code in the following order:</p><p><div class="SIntrapara"><a name="(elem._(chunk._~3c*~3e~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28chunk._~3c%2A~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;*&gt;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><a href="#%28elem._%28chunk._~3creader~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;reader&gt;</a></td></tr><tr><td><a href="#%28elem._%28chunk._~3cexpander~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;expander&gt;</a></td></tr><tr><td><a href="#%28elem._%28chunk._~3cmain-module~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;main-module&gt;</a></td></tr></table></blockquote></div></p><div class="navsetbottom"><span class="navleft"><form class="searchform"><input class="searchbox" id="searchbox" type="text" tabindex="1" placeholder="...search manuals..." title="Enter a search string to search the manuals" onkeypress="return DoSearchKey(event, this, &quot;8.6&quot;, &quot;../&quot;);"/></form>&nbsp;&nbsp;<a href="../index-2.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;8.6&quot;);">top</a><span class="tocsettoggle">&nbsp;&nbsp;<a href="javascript:void(0);" title="show/hide table of contents" onclick="TocsetToggle();">contents</a></span></span><span class="navright">&nbsp;&nbsp;<span class="nonavigation">&larr; prev</span>&nbsp;&nbsp;<a href="../index-2.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;8.6&quot;);">up</a>&nbsp;&nbsp;<span class="nonavigation">next &rarr;</span></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body>
<!-- Mirrored from docs.racket-lang.org/scribble-lp2-manual/index.html by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 07 Sep 2022 03:02:29 GMT -->
</html>