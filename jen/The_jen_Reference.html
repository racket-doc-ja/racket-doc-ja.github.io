<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- Mirrored from docs.racket-lang.org/jen/The_jen_Reference.html by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 07 Sep 2022 03:27:19 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><meta name="viewport" content="width=device-width, initial-scale=0.8"/><title>2&nbsp;The jen Reference</title><link rel="stylesheet" type="text/css" href="../scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="../racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-style.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../doc-site.css" title="default"/><script type="text/javascript" src="../scribble-common.js"></script><script type="text/javascript" src="../manual-racket.js"></script><script type="text/javascript" src="../manual-racket.js"></script><script type="text/javascript" src="../doc-site.js"></script><script type="text/javascript" src="../local-redirect/local-redirect.js"></script><script type="text/javascript" src="../local-redirect/local-user-redirect.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="doc-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9660;</a></td><td></td><td><a href="index.html" class="tocviewlink" data-pltdoc="x">The jen Library</a></td></tr></table></div><div class="tocviewsublisttop" style="display: block;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="The_jen_Guide.html" class="tocviewlink" data-pltdoc="x">The jen Guide</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="#" class="tocviewselflink" data-pltdoc="x">The jen Reference</a></td></tr><tr><td align="right"></td><td><a href="doc-index.html" class="tocviewlink" data-pltdoc="x">Index</a></td></tr></table></div></div><div class="tocviewlist"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_1&quot;);">&#9658;</a></td><td>2&nbsp;</td><td><a href="#" class="tocviewselflink" data-pltdoc="x">The jen Reference</a></td></tr></table><div class="tocviewsublistbottom" style="display: none;" id="tocview_1"><table cellspacing="0" cellpadding="0"><tr><td align="right">2.1&nbsp;</td><td><a href="#%28part._.Semantics%29" class="tocviewlink" data-pltdoc="x">Semantics</a></td></tr><tr><td align="right">2.2&nbsp;</td><td><a href="#%28part._.Syntax%29" class="tocviewlink" data-pltdoc="x">Syntax</a></td></tr><tr><td align="right">2.3&nbsp;</td><td><a href="#%28part._.Preconditions%29" class="tocviewlink" data-pltdoc="x">Preconditions</a></td></tr><tr><td align="right">2.4&nbsp;</td><td><a href="#%28part._.Sequences%29" class="tocviewlink" data-pltdoc="x">Sequences</a></td></tr></table></div></div></div><div class="tocsub"><div class="tocsubtitle">On this page:</div><table class="tocsublist" cellspacing="0"><tr><td><span class="tocsublinknumber">2.1<tt>&nbsp;</tt></span><a href="#%28part._.Semantics%29" class="tocsubseclink" data-pltdoc="x">Semantics</a></td></tr><tr><td><a href="#%28def._%28%28lib._jen%2Fbase..rkt%29._rule-struct%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">rule-<wbr></wbr>struct</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._jen%2Fbase..rkt%29._weight~3f%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">weight?</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._jen%2Fbase..rkt%29._rule-evaluate%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">rule-<wbr></wbr>evaluate</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._jen%2Fbase..rkt%29._backtrack%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">backtrack</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._jen%2Fbase..rkt%29._exn~3abacktrack%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">exn:<span class="mywbr"> &nbsp;</span>backtrack</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._jen%2Fbase..rkt%29._make-rule-parameter%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">make-<wbr></wbr>rule-<wbr></wbr>parameter</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._jen%2Fbase..rkt%29._current-clause-selector%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">current-<wbr></wbr>clause-<wbr></wbr>selector</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._jen%2Fbase..rkt%29._default-clause-selector%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">default-<wbr></wbr>clause-<wbr></wbr>selector</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._jen%2Fbase..rkt%29._clause-selector%2Fc%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">clause-<wbr></wbr>selector/<span class="mywbr"> &nbsp;</span>c</span></span></a></td></tr><tr><td><span class="tocsublinknumber">2.2<tt>&nbsp;</tt></span><a href="#%28part._.Syntax%29" class="tocsubseclink" data-pltdoc="x">Syntax</a></td></tr><tr><td><a href="#%28form._%28%28lib._jen%2Fsyntax..rkt%29._rule%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">rule</span></span></a></td></tr><tr><td><a href="#%28form._%28%28lib._jen%2Fsyntax..rkt%29._define-rule%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">define-<wbr></wbr>rule</span></span></a></td></tr><tr><td><a href="#%28form._%28%28lib._jen%2Fsyntax..rkt%29._simple-rule%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">simple-<wbr></wbr>rule</span></span></a></td></tr><tr><td><a href="#%28form._%28%28lib._jen%2Fsyntax..rkt%29._define-simple-rule%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">define-<wbr></wbr>simple-<wbr></wbr>rule</span></span></a></td></tr><tr><td><a href="#%28form._%28%28lib._jen%2Fsyntax..rkt%29._~7e~3e%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">~&gt;</span></span></a></td></tr><tr><td><span class="tocsublinknumber">2.3<tt>&nbsp;</tt></span><a href="#%28part._.Preconditions%29" class="tocsubseclink" data-pltdoc="x">Preconditions</a></td></tr><tr><td><a href="#%28def._%28%28lib._jen%2Fpreconditions..rkt%29._need%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">need</span></span></a></td></tr><tr><td><a href="#%28form._%28%28lib._jen%2Fpreconditions..rkt%29._once%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">once</span></span></a></td></tr><tr><td><a href="#%28form._%28%28lib._jen%2Fpreconditions..rkt%29._n-times%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">n-<wbr></wbr>times</span></span></a></td></tr><tr><td><span class="tocsublinknumber">2.4<tt>&nbsp;</tt></span><a href="#%28part._.Sequences%29" class="tocsubseclink" data-pltdoc="x">Sequences</a></td></tr><tr><td><a href="#%28form._%28%28lib._jen%2Fsequential..rkt%29._cycle%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">cycle</span></span></a></td></tr><tr><td><a href="#%28form._%28%28lib._jen%2Fsequential..rkt%29._cycle%2Frepeat-last%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">cycle/<span class="mywbr"> &nbsp;</span>repeat-<wbr></wbr>last</span></span></a></td></tr></table></div></div><div class="maincolumn"><div class="main"><div class="versionbox"><span class="version">8.6</span></div><div class="navsettop"><span class="navleft"><form class="searchform"><input class="searchbox" id="searchbox" type="text" tabindex="1" placeholder="...search manuals..." title="Enter a search string to search the manuals" onkeypress="return DoSearchKey(event, this, &quot;8.6&quot;, &quot;../&quot;);"/></form>&nbsp;&nbsp;<a href="../index-2.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;8.6&quot;);">top</a><span class="tocsettoggle">&nbsp;&nbsp;<a href="javascript:void(0);" title="show/hide table of contents" onclick="TocsetToggle();">contents</a></span></span><span class="navright">&nbsp;&nbsp;<a href="The_jen_Guide.html" title="backward to &quot;1 The jen Guide&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="index.html" title="up to &quot;The jen Library&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="doc-index.html" title="forward to &quot;Index&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div><h3 x-source-module="(lib &quot;jen/scribblings/jen.scrbl&quot;)" x-source-pkg="jen-doc" x-part-tag="&quot;The_jen_Reference&quot;">2<tt>&nbsp;</tt><a name="(part._.The_jen_.Reference)"></a><a name="(mod-path._jen)"></a>The jen Reference</h3><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="defmodule"><tr><td align="left"><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._require%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">require</a></span><span class="stt"> </span><a href="#" class="RktModLink" data-pltdoc="x"><span class="RktSym">jen</span></a><span class="RktPn">)</span></td><td align="right"><span class="RpackageSpec"><span class="Smaller">&nbsp;package:</span> <a href="https://pkgs.racket-lang.org/package/jen-lib" title="Install this package using `raco pkg install jen-lib`"><span class="stt">jen-lib</span></a></span></td></tr></table></div><div class="SIntrapara"><a href="#" class="RktModLink" data-pltdoc="x"><span class="RktSym">jen</span></a> reprovides all of the modules in this package.</div></p><h4 x-source-module="(lib &quot;jen/scribblings/jen.scrbl&quot;)" x-source-pkg="jen-doc" x-part-tag="&quot;Semantics&quot;">2.1<tt>&nbsp;</tt><a name="(part._.Semantics)"></a><a name="(mod-path._jen/base)"></a>Semantics</h4><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="defmodule"><tr><td align="left"><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._require%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">require</a></span><span class="stt"> </span><a href="#%28mod-path._jen%2Fbase%29" class="RktModLink" data-pltdoc="x"><span class="RktSym">jen/base</span></a><span class="RktPn">)</span></td><td align="right"><span class="RpackageSpec"><span class="Smaller">&nbsp;package:</span> <a href="https://pkgs.racket-lang.org/package/jen-lib" title="Install this package using `raco pkg install jen-lib`"><span class="stt">jen-lib</span></a></span></td></tr></table></div><div class="SIntrapara"><a href="#%28mod-path._jen%2Fbase%29" class="RktModLink" data-pltdoc="x"><span class="RktSym">jen/base</span></a> provides the low-level semantics and tools for
working with rules and clauses.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>struct</p></div></div><p class="RForeground"><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=define-struct.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._struct%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">struct</a></span><span class="stt"> </span><a name="(def._((lib._jen/base..rkt)._rule-struct-clauses))"></a><a name="(def._((lib._jen/base..rkt)._rule-struct~3f))"></a><a name="(def._((lib._jen/base..rkt)._struct~3arule-struct))"></a><a name="(def._((lib._jen/base..rkt)._rule-struct))"></a><span title="Provided from: jen/base | Package: jen-lib"><span class="RktSym"><a href="#%28def._%28%28lib._jen%2Fbase..rkt%29._rule-struct%29%29" class="RktValDef RktValLink" data-pltdoc="x">rule-struct</a></span></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym">clauses</span><span class="RktPn">)</span><span class="RktPn">)</span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">clauses</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._listof%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">listof</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._cons%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">cons/c</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=function-contracts.html%23%2528form._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._-%7E3e%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">any/c</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=function-contracts.html%23%2528form._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._-%7E3e%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._jen%2Fbase..rkt%29._weight~3f%29%29" class="RktValLink" data-pltdoc="x">weight?</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">The <span class="RktSym"><a href="#%28def._%28%28lib._jen%2Fbase..rkt%29._rule-struct%29%29" class="RktValLink" data-pltdoc="x">rule-struct</a></span> structure represents procedural generation rules, the
central concept of this library.</div></p><p><span class="RktSym">clauses</span> is an association list where each pair represents a clause
that may be randomly selected. The key is the <span class="emph">try thunk</span>, a nullary
procedure that&rsquo;s applied when the clause is selected; and the value is the
<span class="emph">weight thunk</span>, also a nullary procedure, which is applied to determine
the clause&rsquo;s likelihood of being selected (see <span class="RktSym"><a href="#%28def._%28%28lib._jen%2Fbase..rkt%29._weight~3f%29%29" class="RktValLink" data-pltdoc="x">weight?</a></span>).</p><p>Applying a <span class="RktSym"><a href="#%28def._%28%28lib._jen%2Fbase..rkt%29._rule-struct%29%29" class="RktValLink" data-pltdoc="x">rule-struct</a></span> value is the same as applying
<span class="RktSym"><a href="#%28def._%28%28lib._jen%2Fbase..rkt%29._rule-evaluate%29%29" class="RktValLink" data-pltdoc="x">rule-evaluate</a></span> to it.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._jen/base..rkt)._weight~3f))"></a><span title="Provided from: jen/base | Package: jen-lib"><span class="RktSym"><a href="#%28def._%28%28lib._jen%2Fbase..rkt%29._weight~3f%29%29" class="RktValDef RktValLink" data-pltdoc="x">weight?</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">a-value</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=booleans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._boolean%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">boolean?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">a-value</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">any/c</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Recognizes weights, which are numbers used to describe the relative likelihood
of a clause being selected. A weight is <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=number-types.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._rational%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">rational?</a></span> (including
integers), non-<span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=number-types.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._negative%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">negative?</a></span>, and <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=number-types.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._exact%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">exact?</a></span>.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><table cellspacing="0" cellpadding="0" class="prototype RForeground"><tr><td valign="top"><span class="RktPn">(</span><a name="(def._((lib._jen/base..rkt)._rule-evaluate))"></a><span title="Provided from: jen/base | Package: jen-lib"><span class="RktSym"><a href="#%28def._%28%28lib._jen%2Fbase..rkt%29._rule-evaluate%29%29" class="RktValDef RktValLink" data-pltdoc="x">rule-evaluate</a></span></span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">a-rule-struct</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span><span class="RktOpt">[</span></td><td valign="top"><span class="RktPn">#:default</span><span class="hspace">&nbsp;</span><span class="RktVar">default-value</span><span class="RktOpt">]</span><span class="RktPn">)</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">&rarr;</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">any/c</a></span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">a-rule-struct</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._jen%2Fbase..rkt%29._rule-struct~3f%29%29" class="RktValLink" data-pltdoc="x">rule-struct?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">default-value</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">any/c</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="emph">an opaque value</span></td></tr></table></blockquote></div><div class="SIntrapara">Evaluates a rule as follows:</div></p><p>The rule&rsquo;s clauses&rsquo; weight thunks are all evaluated, then try thunks are
selected according to <span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._jen%2Fbase..rkt%29._current-clause-selector%29%29" class="RktValLink" data-pltdoc="x">current-clause-selector</a></span><span class="RktPn">)</span> and evaluated until
one of them succeeds, i.e., doesn&rsquo;t backtrack. (See <span class="RktSym"><a href="#%28def._%28%28lib._jen%2Fbase..rkt%29._backtrack%29%29" class="RktValLink" data-pltdoc="x">backtrack</a></span> and
<span class="RktSym"><a href="#%28def._%28%28lib._jen%2Fbase..rkt%29._exn~3abacktrack%29%29" class="RktValLink" data-pltdoc="x">exn:backtrack</a></span>.) If a clause succeeds, <span class="RktSym"><a href="#%28def._%28%28lib._jen%2Fbase..rkt%29._rule-evaluate%29%29" class="RktValLink" data-pltdoc="x">rule-evaluate</a></span> returns
the result of its try thunk. If <span class="emph">no</span> clause succeeds, then the entire
rule backtracks.</p><p>The probability of a clause being chosen is its computed weight divided by the
total of all clauses&rsquo; computed weights.</p><p>If a <span class="RktPn">#:default</span> argument is provided, it will be the return value in
case the rule would have otherwise backtracked. This is useful for keeping the
backtrack signal from bubbling to the top when a rule is being evaluated
outside of any other rule. (See <span class="RktSym"><a href="#%28def._%28%28lib._jen%2Fbase..rkt%29._exn~3abacktrack%29%29" class="RktValLink" data-pltdoc="x">exn:backtrack</a></span> for how to deal with it
in general.)</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._jen/base..rkt)._backtrack))"></a><span title="Provided from: jen/base | Package: jen-lib"><span class="RktSym"><a href="#%28def._%28%28lib._jen%2Fbase..rkt%29._backtrack%29%29" class="RktValDef RktValLink" data-pltdoc="x">backtrack</a></span></span><span class="hspace">&nbsp;</span><span class="RktOpt">[</span><span class="RktVar">message</span><span class="RktOpt">]</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._none%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">none/c</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">message</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">string?</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#f</span></td></tr></table></blockquote></div><div class="SIntrapara">Signals a backtrack by raising an <span class="RktSym"><a href="#%28def._%28%28lib._jen%2Fbase..rkt%29._exn~3abacktrack%29%29" class="RktValLink" data-pltdoc="x">exn:backtrack</a></span> value.</div></p><p>If <span class="RktVar">message</span> is provided, it will be used to provide a more descriptive
error message for debugging purposes.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>struct</p></div></div><p class="RForeground"><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=define-struct.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._struct%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">struct</a></span><span class="stt"> </span><a name="(def._((lib._jen/base..rkt)._exn~3abacktrack~3f))"></a><a name="(def._((lib._jen/base..rkt)._struct~3aexn~3abacktrack))"></a><a name="(def._((lib._jen/base..rkt)._exn~3abacktrack))"></a><span title="Provided from: jen/base | Package: jen-lib"><span class="RktSym"><a href="#%28def._%28%28lib._jen%2Fbase..rkt%29._exn~3abacktrack%29%29" class="RktValDef RktValLink" data-pltdoc="x">exn:backtrack</a></span></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=exns.html%23%2528def._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._exn%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">exn</a></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktPn">)</span><span class="RktPn">)</span></p></blockquote></td></tr></table></blockquote></div><div class="SIntrapara"><span class="RktSym"><a href="#%28def._%28%28lib._jen%2Fbase..rkt%29._exn~3abacktrack%29%29" class="RktValLink" data-pltdoc="x">exn:backtrack</a></span> represents the backtrack signal.</div></p><p>Although usually unnecessary (see <span class="RktSym"><a href="#%28def._%28%28lib._jen%2Fbase..rkt%29._rule-evaluate%29%29" class="RktValLink" data-pltdoc="x">rule-evaluate</a></span>), it&rsquo;s possible to
catch a backtrack manually by installing an <span class="RktSym"><a href="#%28def._%28%28lib._jen%2Fbase..rkt%29._exn~3abacktrack~3f%29%29" class="RktValLink" data-pltdoc="x">exn:backtrack?</a></span> handler.
For example:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._jen%2Fsyntax..rkt%29._define-rule%29%29" class="RktStxLink" data-pltdoc="x">define-rule</a></span><span class="hspace">&nbsp;</span><span class="RktSym">start</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=exns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fmore-scheme..rkt%2529._with-handlers%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">with-handlers</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._jen%2Fbase..rkt%29._exn~3abacktrack~3f%29%29" class="RktValLink" data-pltdoc="x">exn:backtrack?</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=procedures.html%23%2528def._%2528%2528lib._racket%252Ffunction..rkt%2529._const%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">const</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"It backtracked!"</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">start</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p><span class="RktRes">"It backtracked!"</span></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._jen/base..rkt)._make-rule-parameter))"></a><span title="Provided from: jen/base | Package: jen-lib"><span class="RktSym"><a href="#%28def._%28%28lib._jen%2Fbase..rkt%29._make-rule-parameter%29%29" class="RktValDef RktValLink" data-pltdoc="x">make-rule-parameter</a></span></span><span class="hspace">&nbsp;</span><span class="RktOpt">[</span><span class="RktVar">initial-value</span><span class="RktOpt">]</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=parameters.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._parameter%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">parameter?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">initial-value</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">any/c</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#f</span></td></tr></table></blockquote></div><div class="SIntrapara">Makes a <span class="emph">rule parameter</span>, which, whenever a clause backtracks, reverts
its value to whatever it was just before the clause was tried.</div></p><p>This is useful for tagging rules with additional state that needs to remain
consistent with respect to clauses being tried but failing.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>parameter</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._jen/base..rkt)._current-clause-selector))"></a><span title="Provided from: jen/base | Package: jen-lib"><span class="RktSym"><a href="#%28def._%28%28lib._jen%2Fbase..rkt%29._current-clause-selector%29%29" class="RktValDef RktValLink" data-pltdoc="x">current-clause-selector</a></span></span><span class="RktPn"></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._jen%2Fbase..rkt%29._clause-selector%2Fc%29%29" class="RktValLink" data-pltdoc="x">clause-selector/c</a></span></p></blockquote></td></tr><tr><td><span class="RktPn">(</span><span title="Provided from: jen/base | Package: jen-lib"><span class="RktSym"><a href="#%28def._%28%28lib._jen%2Fbase..rkt%29._current-clause-selector%29%29" class="RktValDef RktValLink" data-pltdoc="x">current-clause-selector</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">clause-selector</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=void.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._void%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">void?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">clause-selector</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._jen%2Fbase..rkt%29._clause-selector%2Fc%29%29" class="RktValLink" data-pltdoc="x">clause-selector/c</a></span></td></tr></table></blockquote></div><div class="SIntrapara">A parameter that decides which clause to try whenever one is called for by
<span class="RktSym"><a href="#%28def._%28%28lib._jen%2Fbase..rkt%29._rule-evaluate%29%29" class="RktValLink" data-pltdoc="x">rule-evaluate</a></span>. Its value is a procedure, called a
<span class="emph">clause selector</span>, that accepts two arguments: the total weight of all
clauses currently being considered, and an association list of said clauses.
The total weight is a <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=generic-numbers.html%23%2528def._%2528%2528lib._racket%252Fmath..rkt%2529._natural%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">natural?</a></span> and the procedure must produce a
<span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=generic-numbers.html%23%2528def._%2528%2528lib._racket%252Fmath..rkt%2529._natural%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">natural?</a></span> strictly less than that one. The total weight is guaranteed
not to be <span class="RktVal">0</span>. (See <span class="RktSym"><a href="#%28def._%28%28lib._jen%2Fbase..rkt%29._clause-selector%2Fc%29%29" class="RktValLink" data-pltdoc="x">clause-selector/c</a></span> for the exact
specification of the contract.)</div></p><p>Note that the total weight and the individual weights of the clauses passed as
arguments may have been multiplied by a shared factor to guaranteed that
they&rsquo;re natural numbers. The relationship that a clause&rsquo;s likelihood of being
selected equals its weight divided by the total weight is preserved.</p><p>Clause selectors may feel free to ignore their second argument; it&rsquo;s provided
for when extra introspection is desired, but a "fair" selector most likely has
no use for it.</p><p>The default clause selector implements a "fair" random selection; see
<span class="RktSym"><a href="#%28def._%28%28lib._jen%2Fbase..rkt%29._default-clause-selector%29%29" class="RktValLink" data-pltdoc="x">default-clause-selector</a></span> for specifics.</p><p>Beware that a rule that is well behaved with the default clause selector may
not terminate if a different one were to be used. For example:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._jen%2Fsyntax..rkt%29._define-rule%29%29" class="RktStxLink" data-pltdoc="x">define-rule</a></span><span class="hspace">&nbsp;</span><span class="RktSym">very-small</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._jen%2Fsyntax..rkt%29._~7e~3e%29%29" class="RktStxLink" data-pltdoc="x">~&gt;</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"very "</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">very-small</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._jen%2Fsyntax..rkt%29._~7e~3e%29%29" class="RktStxLink" data-pltdoc="x">~&gt;</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"small"</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p>This will not terminate if the selector always produces <span class="RktVal">0</span>.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>value</p></div></div><p class="RForeground"><a name="(def._((lib._jen/base..rkt)._default-clause-selector))"></a><span title="Provided from: jen/base | Package: jen-lib"><span class="RktSym"><a href="#%28def._%28%28lib._jen%2Fbase..rkt%29._default-clause-selector%29%29" class="RktValDef RktValLink" data-pltdoc="x">default-clause-selector</a></span></span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._jen%2Fbase..rkt%29._clause-selector%2Fc%29%29" class="RktValLink" data-pltdoc="x">clause-selector/c</a></span></p></blockquote></td></tr></table></blockquote></div><div class="SIntrapara">The default value of <span class="RktSym"><a href="#%28def._%28%28lib._jen%2Fbase..rkt%29._current-clause-selector%29%29" class="RktValLink" data-pltdoc="x">current-clause-selector</a></span>. It produces
<span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=generic-numbers.html%23%2528def._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._random%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">random</a></span><span class="stt"> </span><span class="RktVal">0</span><span class="stt"> </span><span class="RktSym">total-weight</span><span class="RktPn">)</span>, where <span class="RktSym">total-weight</span> is its first
argument. Because it uses <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=generic-numbers.html%23%2528def._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._random%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">random</a></span>, its output can be controlled with
<span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=generic-numbers.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._current-pseudo-random-generator%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">current-pseudo-random-generator</a></span>.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>value</p></div></div><p class="RForeground"><a name="(def._((lib._jen/base..rkt)._clause-selector/c))"></a><span title="Provided from: jen/base | Package: jen-lib"><span class="RktSym"><a href="#%28def._%28%28lib._jen%2Fbase..rkt%29._clause-selector%2Fc%29%29" class="RktValDef RktValLink" data-pltdoc="x">clause-selector/c</a></span></span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=contract-utilities.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fguts..rkt%2529._contract%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">contract?</a></span></p></blockquote></td></tr></table></blockquote></div><div class="SIntrapara">The contract that applies to the value of <span class="RktSym"><a href="#%28def._%28%28lib._jen%2Fbase..rkt%29._current-clause-selector%29%29" class="RktValLink" data-pltdoc="x">current-clause-selector</a></span>.
It&rsquo;s defined to be:</div></p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=function-contracts.html%23%2528form._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._-%7E3ei%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x"><span class="nobreak">-&gt;</span>i</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">total-weight</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=generic-numbers.html%23%2528def._%2528%2528lib._racket%252Fmath..rkt%2529._natural%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">natural?</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529.__%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">_</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._listof%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">listof</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._cons%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">cons/c</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=function-contracts.html%23%2528form._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._-%7E3e%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">any/c</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=generic-numbers.html%23%2528def._%2528%2528lib._racket%252Fmath..rkt%2529._natural%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">natural?</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529.__%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">_</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">total-weight</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._and%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">and/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=generic-numbers.html%23%2528def._%2528%2528lib._racket%252Fmath..rkt%2529._natural%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">natural?</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._%7E3c%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">&lt;/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym">total-weight</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr></table></blockquote><h4 x-source-module="(lib &quot;jen/scribblings/jen.scrbl&quot;)" x-source-pkg="jen-doc" x-part-tag="&quot;Syntax&quot;">2.2<tt>&nbsp;</tt><a name="(part._.Syntax)"></a><a name="(mod-path._jen/syntax)"></a>Syntax</h4><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="defmodule"><tr><td align="left"><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._require%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">require</a></span><span class="stt"> </span><a href="#%28mod-path._jen%2Fsyntax%29" class="RktModLink" data-pltdoc="x"><span class="RktSym">jen/syntax</span></a><span class="RktPn">)</span></td><td align="right"><span class="RpackageSpec"><span class="Smaller">&nbsp;package:</span> <a href="https://pkgs.racket-lang.org/package/jen-lib" title="Install this package using `raco pkg install jen-lib`"><span class="stt">jen-lib</span></a></span></td></tr></table></div><div class="SIntrapara"><span class="RktSym">jen/syntax</span> provides clean syntax on top of the rule primitives to
make it easier to work with them in common cases.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>syntax</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(form._((lib._jen/syntax..rkt)._rule))"></a><span title="Provided from: jen/syntax | Package: jen-lib"><span class="RktSym"><a href="#%28form._%28%28lib._jen%2Fsyntax..rkt%29._rule%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">rule</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">clause</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span></p></blockquote></td></tr><tr><td><span class="stt">&nbsp;</span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="specgrammar"><tr><td align="right" valign="baseline"><span class="RktVar">clause</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">=</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktVar">proc-expr</span><span class="hspace">&nbsp;</span><span class="RktVar">maybe-weight</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td></tr><tr><td align="right" valign="baseline"><span class="RktVar">maybe-weight</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">=</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td></td></tr></table></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktPn">#:weight</span><span class="hspace">&nbsp;</span><span class="RktVar">weight-expr</span></td></tr></table></td></tr></table></blockquote></div><div class="SIntrapara">Produces a rule whose clauses are given by <span class="RktVar">clause</span>s.</div></p><p>For each clause, <span class="RktVar">proc-expr</span> is evaluated immediately to obtain the
clause&rsquo;s try thunk, while <span class="RktVar">weight-expr</span> (by default, <span class="RktVal">1</span>)
becomes the body of the weight thunk and thus is evaluated only when the rule
is.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>syntax</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(form._((lib._jen/syntax..rkt)._define-rule))"></a><span title="Provided from: jen/syntax | Package: jen-lib"><span class="RktSym"><a href="#%28form._%28%28lib._jen%2Fsyntax..rkt%29._define-rule%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">define-rule</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">id</span><span class="hspace">&nbsp;</span><span class="RktVar">rest</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span></p></blockquote></td></tr></table></blockquote></div><div class="SIntrapara">Shorthand for <span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="stt"> </span><span class="RktVar">id</span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._jen%2Fsyntax..rkt%29._rule%29%29" class="RktStxLink" data-pltdoc="x">rule</a></span><span class="stt"> </span><span class="RktVar">rest</span><span class="stt"> </span><span class="RktMeta"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">)</span>.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>syntax</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(form._((lib._jen/syntax..rkt)._simple-rule))"></a><span title="Provided from: jen/syntax | Package: jen-lib"><span class="RktSym"><a href="#%28form._%28%28lib._jen%2Fsyntax..rkt%29._simple-rule%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">simple-rule</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">expr</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span></p></blockquote></td></tr></table></blockquote></div><div class="SIntrapara">Shorthand for <span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._jen%2Fsyntax..rkt%29._rule%29%29" class="RktStxLink" data-pltdoc="x">rule</a></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=procedures.html%23%2528form._%2528%2528lib._racket%252Ffunction..rkt%2529._thunk%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">thunk</a></span><span class="stt"> </span><span class="RktVar">expr</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktMeta"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktPn">)</span>.</div></p><p>This is useful when each of your clauses only needs to be a single expression
without complex logic, allowing you to omit <span class="RktSym"><a href="#%28form._%28%28lib._jen%2Fsyntax..rkt%29._~7e~3e%29%29" class="RktStxLink" data-pltdoc="x">~&gt;</a></span> or other
procedure-producing forms.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>syntax</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(form._((lib._jen/syntax..rkt)._define-simple-rule))"></a><span title="Provided from: jen/syntax | Package: jen-lib"><span class="RktSym"><a href="#%28form._%28%28lib._jen%2Fsyntax..rkt%29._define-simple-rule%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">define-simple-rule</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">id</span><span class="hspace">&nbsp;</span><span class="RktVar">rest</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span></p></blockquote></td></tr></table></blockquote></div><div class="SIntrapara">Shorthand for <span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="stt"> </span><span class="RktVar">id</span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._jen%2Fsyntax..rkt%29._simple-rule%29%29" class="RktStxLink" data-pltdoc="x">simple-rule</a></span><span class="stt"> </span><span class="RktVar">rest</span><span class="stt"> </span><span class="RktMeta"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">)</span>.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>syntax</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(form._((lib._jen/syntax..rkt)._~7e~3e))"></a><span title="Provided from: jen/syntax | Package: jen-lib"><span class="RktSym"><a href="#%28form._%28%28lib._jen%2Fsyntax..rkt%29._~7e~3e%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">~&gt;</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">expr</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="hspace">&nbsp;</span><span class="RktVar">maybe-combiner</span><span class="RktPn">)</span></p></blockquote></td></tr><tr><td><span class="stt">&nbsp;</span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="specgrammar"><tr><td align="right" valign="baseline"><span class="RktVar">maybe-combiner</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">=</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td></td></tr></table></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktPn">#:combiner</span><span class="hspace">&nbsp;</span><span class="RktVar">combiner-expr</span></td></tr></table></td></tr></table></blockquote></div><div class="SIntrapara">Returns a procedure taking no arguments and returning the result of applying
<span class="RktVar">combiner-expr</span> (by default, <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528lib._racket%252Fformat..rkt%2529._%7E7ea%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">~a</a></span>) to each <span class="RktVar">expr</span>, but
filtering out any values satisfying <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=void.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._void%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">void?</a></span>. This is meant for use with
<span class="RktSym"><a href="#%28form._%28%28lib._jen%2Fsyntax..rkt%29._rule%29%29" class="RktStxLink" data-pltdoc="x">rule</a></span> or <span class="RktSym"><a href="#%28form._%28%28lib._jen%2Fsyntax..rkt%29._define-rule%29%29" class="RktStxLink" data-pltdoc="x">define-rule</a></span> but produces ordinary procedures, much
like <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=procedures.html%23%2528form._%2528%2528lib._racket%252Ffunction..rkt%2529._thunk%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">thunk</a></span> but slightly more specialized.</div></p><p>The <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=void.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._void%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">void?</a></span>-filtering behavior is particularly useful alongside
<a href="#%28mod-path._jen%2Fpreconditions%29" class="RktModLink" data-pltdoc="x"><span class="RktSym">jen/preconditions</span></a>, which contains procedures and forms that
affect clause evaluation and return <span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=void.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._void%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">void</a></span><span class="RktPn">)</span>. If this turns out to be
undesirable for a given use case, it&rsquo;s still possible to use <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=procedures.html%23%2528form._%2528%2528lib._racket%252Ffunction..rkt%2529._thunk%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">thunk</a></span>
with <span class="RktSym"><a href="#%28form._%28%28lib._jen%2Fsyntax..rkt%29._define-rule%29%29" class="RktStxLink" data-pltdoc="x">define-rule</a></span>.</p><h4 x-source-module="(lib &quot;jen/scribblings/jen.scrbl&quot;)" x-source-pkg="jen-doc" x-part-tag="&quot;Preconditions&quot;">2.3<tt>&nbsp;</tt><a name="(part._.Preconditions)"></a><a name="(mod-path._jen/preconditions)"></a>Preconditions</h4><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="defmodule"><tr><td align="left"><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._require%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">require</a></span><span class="stt"> </span><a href="#%28mod-path._jen%2Fpreconditions%29" class="RktModLink" data-pltdoc="x"><span class="RktSym">jen/preconditions</span></a><span class="RktPn">)</span></td><td align="right"><span class="RpackageSpec"><span class="Smaller">&nbsp;package:</span> <a href="https://pkgs.racket-lang.org/package/jen-lib" title="Install this package using `raco pkg install jen-lib`"><span class="stt">jen-lib</span></a></span></td></tr></table></div><div class="SIntrapara"><span class="RktSym">jen/preconditions</span> provides support for clause preconditions, by which
a clause can decide not to execute if its conditions aren&rsquo;t met.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._jen/preconditions..rkt)._need))"></a><span title="Provided from: jen/preconditions | Package: jen-lib"><span class="RktSym"><a href="#%28def._%28%28lib._jen%2Fpreconditions..rkt%29._need%29%29" class="RktValDef RktValLink" data-pltdoc="x">need</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">condition</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=void.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._void%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">void?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">condition</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">any/c</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Returns a <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=void.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._void%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">void?</a></span> value when <span class="RktVar">condition</span> is true; otherwise
signals a backtrack by calling <span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._jen%2Fbase..rkt%29._backtrack%29%29" class="RktValLink" data-pltdoc="x">backtrack</a></span><span class="RktPn">)</span>.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>syntax</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(form._((lib._jen/preconditions..rkt)._once))"></a><span title="Provided from: jen/preconditions | Package: jen-lib"><span class="RktSym"><a href="#%28form._%28%28lib._jen%2Fpreconditions..rkt%29._once%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">once</a></span></span><span class="RktPn">)</span></p></blockquote></td></tr></table></blockquote></div><div class="SIntrapara">Shorthand for <span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._jen%2Fpreconditions..rkt%29._n-times%29%29" class="RktStxLink" data-pltdoc="x">n-times</a></span><span class="stt"> </span><span class="RktVal">1</span><span class="RktPn">)</span>.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>syntax</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(form._((lib._jen/preconditions..rkt)._n-times))"></a><span title="Provided from: jen/preconditions | Package: jen-lib"><span class="RktSym"><a href="#%28form._%28%28lib._jen%2Fpreconditions..rkt%29._n-times%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">n-times</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">n</span><span class="RktPn">)</span></p></blockquote></td></tr><tr><td><span class="stt">&nbsp;</span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="argcontract"><tr><td><span class="hspace">&nbsp;&nbsp;</span></td><td><span class="RktVar">n</span></td><td><span class="hspace">&nbsp;</span></td><td>:</td><td><span class="hspace">&nbsp;</span></td><td><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=generic-numbers.html%23%2528def._%2528%2528lib._racket%252Fmath..rkt%2529._natural%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">natural?</a></span></td></tr></table></td></tr></table></blockquote></div><div class="SIntrapara">During the current top-level rule evaluation, if the clause containing the
call site of this form has previously been committed to less than <span class="RktVar">n</span>
times, the form evaluates to a <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=void.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._void%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">void?</a></span> value. Otherwise, it signals a
backtrack (see <span class="RktSym"><a href="#%28def._%28%28lib._jen%2Fbase..rkt%29._backtrack%29%29" class="RktValLink" data-pltdoc="x">backtrack</a></span>).</div></p><p>The upshot of this is that the clause containing the call to this macro can be
allowed to be committed to at most <span class="RktVar">n</span> times before it always fails.</p><p>Underlyingly, each call site of this macro uses its own <span class="emph">rule parameter</span>
(see <span class="RktSym"><a href="#%28def._%28%28lib._jen%2Fbase..rkt%29._make-rule-parameter%29%29" class="RktValLink" data-pltdoc="x">make-rule-parameter</a></span>) as a counter of how many times it&rsquo;s been
reached (and its clause committed to).</p><h4 x-source-module="(lib &quot;jen/scribblings/jen.scrbl&quot;)" x-source-pkg="jen-doc" x-part-tag="&quot;Sequences&quot;">2.4<tt>&nbsp;</tt><a name="(part._.Sequences)"></a><a name="(mod-path._jen/sequential)"></a>Sequences</h4><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="defmodule"><tr><td align="left"><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._require%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">require</a></span><span class="stt"> </span><a href="#%28mod-path._jen%2Fsequential%29" class="RktModLink" data-pltdoc="x"><span class="RktSym">jen/sequential</span></a><span class="RktPn">)</span></td><td align="right"><span class="RpackageSpec"><span class="Smaller">&nbsp;package:</span> <a href="https://pkgs.racket-lang.org/package/jen-lib" title="Install this package using `raco pkg install jen-lib`"><span class="stt">jen-lib</span></a></span></td></tr></table></div><div class="SIntrapara"><span class="RktSym">jen/sequential</span> contains forms for non-random, ordered evaluation that
nonetheless depends on the current rule state.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>syntax</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(form._((lib._jen/sequential..rkt)._cycle))"></a><span title="Provided from: jen/sequential | Package: jen-lib"><span class="RktSym"><a href="#%28form._%28%28lib._jen%2Fsequential..rkt%29._cycle%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">cycle</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">expr</span><span class="hspace">&nbsp;</span><span class="RktMeta">...+</span><span class="RktPn">)</span></p></blockquote></td></tr></table></blockquote></div><div class="SIntrapara">Cycles through the <span class="RktVar">expr</span>s, returning the value of one each time this
form is evaluated as part of a clause. If the clause has never been committed
to before, the expression will be the first one; if it has been committed to
once, it will be the second one; and so on. Once all expressions have been
exhausted, it begins anew with the first one.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>syntax</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(form._((lib._jen/sequential..rkt)._cycle/repeat-last))"></a><span title="Provided from: jen/sequential | Package: jen-lib"><span class="RktSym"><a href="#%28form._%28%28lib._jen%2Fsequential..rkt%29._cycle%2Frepeat-last%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">cycle/repeat-last</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">expr</span><span class="hspace">&nbsp;</span><span class="RktMeta">...+</span><span class="RktPn">)</span></p></blockquote></td></tr></table></blockquote></div><div class="SIntrapara">Like <span class="RktSym"><a href="#%28form._%28%28lib._jen%2Fsequential..rkt%29._cycle%29%29" class="RktStxLink" data-pltdoc="x">cycle</a></span>, but once all expressions have been exhausted, it repeats
the last one.</div></p><div class="navsetbottom"><span class="navleft"><form class="searchform"><input class="searchbox" id="searchbox" type="text" tabindex="1" placeholder="...search manuals..." title="Enter a search string to search the manuals" onkeypress="return DoSearchKey(event, this, &quot;8.6&quot;, &quot;../&quot;);"/></form>&nbsp;&nbsp;<a href="../index-2.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;8.6&quot;);">top</a><span class="tocsettoggle">&nbsp;&nbsp;<a href="javascript:void(0);" title="show/hide table of contents" onclick="TocsetToggle();">contents</a></span></span><span class="navright">&nbsp;&nbsp;<a href="The_jen_Guide.html" title="backward to &quot;1 The jen Guide&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="index.html" title="up to &quot;The jen Library&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="doc-index.html" title="forward to &quot;Index&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body>
<!-- Mirrored from docs.racket-lang.org/jen/The_jen_Reference.html by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 07 Sep 2022 03:27:19 GMT -->
</html>