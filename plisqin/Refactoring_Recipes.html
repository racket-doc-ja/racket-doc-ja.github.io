<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- Mirrored from docs.racket-lang.org/plisqin/Refactoring_Recipes.html by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 07 Sep 2022 03:29:45 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><meta name="viewport" content="width=device-width, initial-scale=0.8"/><title>5&nbsp;Refactoring Recipes</title><link rel="stylesheet" type="text/css" href="../scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="PStyles.css" title="default"/><link rel="stylesheet" type="text/css" href="../racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-style.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../doc-site.css" title="default"/><script type="text/javascript" src="../scribble-common.js"></script><script type="text/javascript" src="PScripts.js"></script><script type="text/javascript" src="../manual-racket.js"></script><script type="text/javascript" src="../manual-racket.js"></script><script type="text/javascript" src="../doc-site.js"></script><script type="text/javascript" src="../local-redirect/local-redirect.js"></script><script type="text/javascript" src="../local-redirect/local-user-redirect.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="doc-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9660;</a></td><td></td><td><a href="index.html" class="tocviewlink" data-pltdoc="x">Plisqin</a></td></tr></table></div><div class="tocviewsublisttop" style="display: block;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="Read_Me_First.html" class="tocviewlink" data-pltdoc="x">Read Me First</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="using-define-schema.html" class="tocviewlink" data-pltdoc="x">Using define-<wbr></wbr>schema</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="Aggregates.html" class="tocviewlink" data-pltdoc="x">Aggregates</a></td></tr><tr><td align="right">4&nbsp;</td><td><a href="Nullability.html" class="tocviewlink" data-pltdoc="x">Nullability</a></td></tr><tr><td align="right">5&nbsp;</td><td><a href="#" class="tocviewselflink" data-pltdoc="x">Refactoring Recipes</a></td></tr><tr><td align="right">6&nbsp;</td><td><a href="Reference.html" class="tocviewlink" data-pltdoc="x">Reference</a></td></tr><tr><td align="right">7&nbsp;</td><td><a href="research-language.html" class="tocviewlink" data-pltdoc="x">Plisqin as a Research Language</a></td></tr></table></div></div><div class="tocviewlist"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_1&quot;);">&#9658;</a></td><td>5&nbsp;</td><td><a href="#" class="tocviewselflink" data-pltdoc="x">Refactoring Recipes</a></td></tr></table><div class="tocviewsublistbottom" style="display: none;" id="tocview_1"><table cellspacing="0" cellpadding="0"><tr><td align="right">5.1&nbsp;</td><td><a href="#%28part._.Elemental_.Recipes%29" class="tocviewlink" data-pltdoc="x">Elemental Recipes</a></td></tr><tr><td align="right">5.2&nbsp;</td><td><a href="#%28part._.Compound_.Recipes%29" class="tocviewlink" data-pltdoc="x">Compound Recipes</a></td></tr></table></div></div></div><div class="tocsub"><div class="tocsubtitle">On this page:</div><table class="tocsublist" cellspacing="0"><tr><td><span class="tocsublinknumber">5.1<tt>&nbsp;</tt></span><a href="#%28part._.Elemental_.Recipes%29" class="tocsubseclink" data-pltdoc="x">Elemental Recipes</a></td></tr><tr><td><span class="tocsublinknumber">5.1.1<tt>&nbsp;</tt></span><a href="#%28part._join-~3eex%29" class="tocsubseclink" data-pltdoc="x">Join -<wbr></wbr>&gt; Expression</a></td></tr><tr><td><span class="tocsublinknumber">5.1.2<tt>&nbsp;</tt></span><a href="#%28part._ex-~3eproc%29" class="tocsubseclink" data-pltdoc="x">Expression -<wbr></wbr>&gt; Procedure</a></td></tr><tr><td><span class="tocsublinknumber">5.1.3<tt>&nbsp;</tt></span><a href="#%28part._proc-~3eschema%29" class="tocsubseclink" data-pltdoc="x">Procedure -<wbr></wbr>&gt; define-<wbr></wbr>schema</a></td></tr><tr><td><span class="tocsublinknumber">5.1.4<tt>&nbsp;</tt></span><a href="#%28part._join~3c-~3edefine%29" class="tocsubseclink" data-pltdoc="x">Join &lt;-<wbr></wbr>&gt; Define</a></td></tr><tr><td><span class="tocsublinknumber">5.2<tt>&nbsp;</tt></span><a href="#%28part._.Compound_.Recipes%29" class="tocsubseclink" data-pltdoc="x">Compound Recipes</a></td></tr><tr><td><span class="tocsublinknumber">5.2.1<tt>&nbsp;</tt></span><a href="#%28part._join1-~3eschema%29" class="tocsubseclink" data-pltdoc="x">Singular Join -<wbr></wbr>&gt; Schema Definition</a></td></tr><tr><td><span class="tocsublinknumber">5.2.2<tt>&nbsp;</tt></span><a href="#%28part._join.G-~3eschema%29" class="tocsubseclink" data-pltdoc="x">Grouped Join -<wbr></wbr>&gt; Schema Definition</a></td></tr><tr><td><span class="tocsublinknumber">5.2.3<tt>&nbsp;</tt></span><a href="#%28part._scalar-~3eschema%29" class="tocsubseclink" data-pltdoc="x">Scalar -<wbr></wbr>&gt; Schema Definition</a></td></tr><tr><td><span class="tocsublinknumber">5.2.4<tt>&nbsp;</tt></span><a href="#%28part._scalar-flattening%29" class="tocsubseclink" data-pltdoc="x">Scalar Flattening</a></td></tr><tr><td><span class="tocsublinknumber">5.2.5<tt>&nbsp;</tt></span><a href="#%28part._join-~3einline%29" class="tocsubseclink" data-pltdoc="x">Inline Join</a></td></tr><tr><td><span class="tocsublinknumber">5.2.6<tt>&nbsp;</tt></span><a href="#%28part._ds~3arename%29" class="tocsubseclink" data-pltdoc="x">Name Clarification</a></td></tr></table></div></div><div class="maincolumn"><div class="main"><div class="versionbox"><span class="version">8.6</span></div><div class="navsettop"><span class="navleft"><form class="searchform"><input class="searchbox" id="searchbox" type="text" tabindex="1" placeholder="...search manuals..." title="Enter a search string to search the manuals" onkeypress="return DoSearchKey(event, this, &quot;8.6&quot;, &quot;../&quot;);"/></form>&nbsp;&nbsp;<a href="../index-2.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;8.6&quot;);">top</a><span class="tocsettoggle">&nbsp;&nbsp;<a href="javascript:void(0);" title="show/hide table of contents" onclick="TocsetToggle();">contents</a></span></span><span class="navright">&nbsp;&nbsp;<a href="Nullability.html" title="backward to &quot;4 Nullability&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="index.html" title="up to &quot;Plisqin&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="Reference.html" title="forward to &quot;6 Reference&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div><h3 x-source-module="(lib &quot;plisqin-doc/scribblings/plisqin.scrbl&quot;)" x-source-pkg="plisqin" x-part-tag="&quot;Refactoring_Recipes&quot;">5<tt>&nbsp;</tt><a name="(part._.Refactoring_.Recipes)"></a>Refactoring Recipes</h3><p>This section is not meant to be read straight through,
unless you are very studious.</p><p>A green identifier like <span class="PGreen"><span class="RktSym">Team</span></span> indicates something that is being
added to <span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._define-schema%29%29" class="RktStxLink" data-pltdoc="x">define-schema</a></span>.
A red highlight like <span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym">foo</span></span><span class="highlighted"><span class="stt"> </span></span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym">bar</span></span><span class="highlighted"><span class="stt"> </span></span><span class="highlighted"><span class="RktSym">x</span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="highlighted"><span class="RktPn">)</span></span> is used to help you
follow a piece of code as it gets relocated, possibly with small adjustments.</p><h4 x-source-module="(lib &quot;plisqin-doc/scribblings/plisqin.scrbl&quot;)" x-source-pkg="plisqin" x-part-tag="&quot;Elemental_Recipes&quot;">5.1<tt>&nbsp;</tt><a name="(part._.Elemental_.Recipes)"></a>Elemental Recipes</h4><h5 x-source-module="(lib &quot;plisqin-doc/scribblings/plisqin.scrbl&quot;)" x-source-pkg="plisqin" x-part-tag="&quot;join-&gt;ex&quot;">5.1.1<tt>&nbsp;</tt><a name="(part._join-~3eex)"></a>Join -&gt; Expression</h5><p><div class="SIntrapara">This recipe simply rewrites a join into a self-contained expression that can
be relocated in future refactorings.
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">original version:</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._from%29%29" class="RktStxLink" data-pltdoc="x">from</a></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">TableX</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._join%29%29" class="RktStxLink" data-pltdoc="x">join</a></span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym">y</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym">TableY</span></span></td></tr><tr><td><span class="highlighted"><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="highlighted"><span class="RktSym">....</span></span><span class="highlighted"><span class="RktPn">)</span></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">refactored version:</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._from%29%29" class="RktStxLink" data-pltdoc="x">from</a></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">TableX</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">y</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._join%29%29" class="RktStxLink" data-pltdoc="x">join</a></span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym">y</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym">TableY</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktPn">#:to</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym">x</span></span></td></tr><tr><td><span class="highlighted"><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="highlighted"><span class="RktSym">....</span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><p>The refactored code is bigger! Is this a step in the wrong direction?
If we stop refactoring here, you could argue that it is.
The point of this recipe is to set up future refactoring.
In the original version, there was an unwritten <span class="RktPn">#:to</span><span class="stt"> </span><span class="RktSym">x</span> that would
be lost if we relocated the code.
By making <span class="RktPn">#:to</span><span class="stt"> </span><span class="RktSym">x</span> explicit, we can now relocate the code using normal
Racket techniques.</p><h5 x-source-module="(lib &quot;plisqin-doc/scribblings/plisqin.scrbl&quot;)" x-source-pkg="plisqin" x-part-tag="&quot;ex-&gt;proc&quot;">5.1.2<tt>&nbsp;</tt><a name="(part._ex-~3eproc)"></a>Expression -&gt; Procedure</h5><p><div class="SIntrapara">In this recipe, we extract any expression into a procedure.
Unless you are brand new to Racket, you have done this before.
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">original version:</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._from%29%29" class="RktStxLink" data-pltdoc="x">from</a></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">TableX</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib_strict.html#%28def._%28%28lib._plisqin-lib%2Fstrict..rkt%29._select%29%29" class="RktValLink" data-pltdoc="x">select</a></span><span class="hspace">&nbsp;</span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym">foo</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym">bar</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym">x</span></span><span class="highlighted"><span class="RktPn">)</span></span></td></tr><tr><td><span class="highlighted"><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym">baz</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym">x</span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">refactored version:</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">NEW-PROC</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym">foo</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym">bar</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym">x</span></span><span class="highlighted"><span class="RktPn">)</span></span></td></tr><tr><td><span class="highlighted"><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym">baz</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym">x</span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._from%29%29" class="RktStxLink" data-pltdoc="x">from</a></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">TableX</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib_strict.html#%28def._%28%28lib._plisqin-lib%2Fstrict..rkt%29._select%29%29" class="RktValLink" data-pltdoc="x">select</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">NEW-PROC</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><p><div class="SIntrapara">If we assume that <span class="RktSym">foo</span> returns a <span class="RktSym"><a href="plisqin-lib.html#%28def._%28%28lib._plisqin-lib%2Ftypes..rkt%29._.Number~3f%29%29" class="RktValLink" data-pltdoc="x">Number?</a></span>, you can add
a contract to <span class="RktSym">NEW-PROC</span> as follows:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=attaching-contracts-to-values.html%23%2528form._%2528%2528lib._racket%252Fcontract%252Fregion..rkt%2529._define%252Fcontract%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define/contract</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">NEW-PROC</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=function-contracts.html%23%2528form._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._-%7E3e%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib.html#%28def._%28%28lib._plisqin-lib%2Fmain..rkt%29._instanceof%29%29" class="RktValLink" data-pltdoc="x">instanceof</a></span><span class="hspace">&nbsp;</span><span class="RktSym">TableX</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="plisqin-lib.html#%28def._%28%28lib._plisqin-lib%2Ftypes..rkt%29._.Number~3f%29%29" class="RktValLink" data-pltdoc="x">Number?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym">foo</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym">bar</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym">x</span></span><span class="highlighted"><span class="RktPn">)</span></span></td></tr><tr><td><span class="highlighted"><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym">baz</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym">x</span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><p><div class="SIntrapara">Here is one more example. This time the expression is a join.
Remember that you might have to use the <a href="#%28part._join-~3eex%29" data-pltdoc="x">Join -&gt; Expression</a> recipe first if
your join does not have the <span class="RktPn">#:to</span> argument specified.
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">original version:</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._from%29%29" class="RktStxLink" data-pltdoc="x">from</a></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">TableX</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">y</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._join%29%29" class="RktStxLink" data-pltdoc="x">join</a></span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym">y</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym">TableY</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktPn">#:to</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym">x</span></span></td></tr><tr><td><span class="highlighted"><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym"><a href="plisqin-lib_strict.html#%28def._%28%28lib._plisqin-lib%2Fstrict..rkt%29._join-on%29%29" class="RktValLink" data-pltdoc="x">join-on</a></span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym"><a href="plisqin-lib_strict.html#%28def._%28%28lib._plisqin-lib%2Fstrict%2Foperators..rkt%29._~3d%29%29" class="RktValLink" data-pltdoc="x">.=</a></span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym">YID</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym">y</span></span><span class="highlighted"><span class="RktPn">)</span></span></td></tr><tr><td><span class="highlighted"><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym">YID</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym">x</span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">refactored version:</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=attaching-contracts-to-values.html%23%2528form._%2528%2528lib._racket%252Fcontract%252Fregion..rkt%2529._define%252Fcontract%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define/contract</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Y-given-X</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=function-contracts.html%23%2528form._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._-%7E3e%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib.html#%28def._%28%28lib._plisqin-lib%2Fmain..rkt%29._instanceof%29%29" class="RktValLink" data-pltdoc="x">instanceof</a></span><span class="hspace">&nbsp;</span><span class="RktSym">TableX</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib.html#%28def._%28%28lib._plisqin-lib%2Fmain..rkt%29._instanceof%29%29" class="RktValLink" data-pltdoc="x">instanceof</a></span><span class="hspace">&nbsp;</span><span class="RktSym">TableY</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._join%29%29" class="RktStxLink" data-pltdoc="x">join</a></span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym">y</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym">TableY</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktPn">#:to</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym">x</span></span></td></tr><tr><td><span class="highlighted"><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym"><a href="plisqin-lib_strict.html#%28def._%28%28lib._plisqin-lib%2Fstrict..rkt%29._join-on%29%29" class="RktValLink" data-pltdoc="x">join-on</a></span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym"><a href="plisqin-lib_strict.html#%28def._%28%28lib._plisqin-lib%2Fstrict%2Foperators..rkt%29._~3d%29%29" class="RktValLink" data-pltdoc="x">.=</a></span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym">YID</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym">y</span></span><span class="highlighted"><span class="RktPn">)</span></span></td></tr><tr><td><span class="highlighted"><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym">YID</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym">x</span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._from%29%29" class="RktStxLink" data-pltdoc="x">from</a></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">TableX</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Y-given-X</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><h5 x-source-module="(lib &quot;plisqin-doc/scribblings/plisqin.scrbl&quot;)" x-source-pkg="plisqin" x-part-tag="&quot;proc-&gt;schema&quot;">5.1.3<tt>&nbsp;</tt><a name="(part._proc-~3eschema)"></a>Procedure -&gt; define-schema</h5><p><div class="SIntrapara">If you are using <span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._define-schema%29%29" class="RktStxLink" data-pltdoc="x">define-schema</a></span> and you have a procedure like this
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=attaching-contracts-to-values.html%23%2528form._%2528%2528lib._racket%252Fcontract%252Fregion..rkt%2529._define%252Fcontract%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define/contract</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">NEW-PROC</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=function-contracts.html%23%2528form._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._-%7E3e%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib.html#%28def._%28%28lib._plisqin-lib%2Fmain..rkt%29._instanceof%29%29" class="RktValLink" data-pltdoc="x">instanceof</a></span><span class="hspace">&nbsp;</span><span class="RktSym">TableX</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">any/c</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym">foo</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym">bar</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym">x</span></span><span class="highlighted"><span class="RktPn">)</span></span></td></tr><tr><td><span class="highlighted"><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym">baz</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym">x</span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><p><div class="SIntrapara">It is a candidate for being moved into <span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._define-schema%29%29" class="RktStxLink" data-pltdoc="x">define-schema</a></span> assuming that:
</div><div class="SIntrapara"><ul><li><p>It accepts one argument. (The argument is <span class="RktSym">x</span> in this example.)</p></li><li><p>That argument is an <span class="RktSym"><a href="plisqin-lib.html#%28def._%28%28lib._plisqin-lib%2Fmain..rkt%29._instanceof%29%29" class="RktValLink" data-pltdoc="x">instanceof</a></span> a table from your schema definition.
(The table is <span class="RktSym">TableX</span> in this example.)</p></li></ul></div></p><p><div class="SIntrapara">First we need to decide which keyword is appropriate based on what this
procedure returns. Choose from:
</div><div class="SIntrapara"><ul><li><p><span class="RktPn">#:property</span> if the return value is a <span class="RktSym"><a href="plisqin-lib.html#%28def._%28%28lib._plisqin-lib%2Ftypes..rkt%29._.Scalar~3f%29%29" class="RktValLink" data-pltdoc="x">Scalar?</a></span>
(or one of its subtypes)</p></li><li><p><span class="RktPn">#:has-group</span> if the return value is a singular grouped join.
"Singular" means that adding the join to a query of TableX will not increase
the number of rows that will be returned in the result set.
"Grouped" means that the join contains at least one <span class="RktSym"><a href="plisqin-lib_strict.html#%28def._%28%28lib._plisqin-lib%2Fstrict..rkt%29._group-by%29%29" class="RktValLink" data-pltdoc="x">group-by</a></span> clause.</p></li><li><p><span class="RktPn">#:has-one</span> if the return value is a singular simple join.
"Singular" means that adding the join to a query of TableX will not increase
the number of rows that will be returned in the result set.
"Simple" means that each of the join&rsquo;s clauses is either a
<span class="RktSym"><a href="plisqin-lib_strict.html#%28def._%28%28lib._plisqin-lib%2Fstrict..rkt%29._join-on%29%29" class="RktValLink" data-pltdoc="x">join-on</a></span> or <span class="RktSym"><a href="plisqin-lib.html#%28def._%28%28lib._plisqin-lib%2Fmain..rkt%29._join-type%29%29" class="RktValLink" data-pltdoc="x">join-type</a></span> clause.</p></li></ul></div></p><p><div class="SIntrapara">If you were unable to choose a keyword, then <span class="RktSym">NEW-PROC</span> probably does not
belong inside <span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._define-schema%29%29" class="RktStxLink" data-pltdoc="x">define-schema</a></span>, but you can keep it as a separate procedure.
Let&rsquo;s just pretend that <span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym">foo</span></span><span class="highlighted"><span class="stt"> </span></span><span class="highlighted"><span class="RktSym">....</span></span><span class="highlighted"><span class="RktPn">)</span></span> returns a
<span class="RktSym"><a href="plisqin-lib.html#%28def._%28%28lib._plisqin-lib%2Ftypes..rkt%29._.Scalar~3f%29%29" class="RktValLink" data-pltdoc="x">Scalar?</a></span>, so we choose the <span class="RktPn">#:property</span> keyword.
We add that expression into <span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._define-schema%29%29" class="RktStxLink" data-pltdoc="x">define-schema</a></span> and replace the single
argument (which was <span class="RktSym">x</span>) with <span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._this%29%29" class="RktStxLink" data-pltdoc="x">this</a></span> as follows:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._define-schema%29%29" class="RktStxLink" data-pltdoc="x">define-schema</a></span><span class="hspace">&nbsp;</span><span class="RktSym">my-schema</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">....</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">table</span><span class="hspace">&nbsp;</span><span class="RktSym">TableX</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:property</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">NEW-PROC</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym">foo</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym">bar</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._this%29%29" class="RktStxLink" data-pltdoc="x">this</a></span></span><span class="highlighted"><span class="RktPn">)</span></span></td></tr><tr><td><span class="highlighted"><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym">baz</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._this%29%29" class="RktStxLink" data-pltdoc="x">this</a></span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">....</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><p>Warning: this recipe is not complete!
Continue reading the following subsections.</p><p><div class="SIntrapara"><span class="SSubSubSubSection">On Strict Comparisons</span></div><div class="SIntrapara">If you have a <a href="Read_Me_First.html#%28tech._strict%29" class="techoutside" data-pltdoc="x"><span class="techinside">strict</span></a> comparison involving <span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._this%29%29" class="RktStxLink" data-pltdoc="x">this</a></span>, you should
add a <a href="Nullability.html#%28tech._fallback%29" class="techoutside" data-pltdoc="x"><span class="techinside">fallback</span></a> if one is not already present.
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">Notice that `this` is used in a strict comparison...</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib_strict.html#%28def._%28%28lib._plisqin-lib%2Fstrict%2Foperators..rkt%29._~3d%29%29" class="RktValLink" data-pltdoc="x">.=</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">foo</span><span class="hspace">&nbsp;</span><span class="RktSym">bar</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">foo</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._this%29%29" class="RktStxLink" data-pltdoc="x">this</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">... and surround it with a fallback:</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib_strict.html#%28def._%28%28lib._plisqin-lib%2Fstrict%2Foperators..rkt%29._~3d%29%29" class="RktValLink" data-pltdoc="x">.=</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">foo</span><span class="hspace">&nbsp;</span><span class="RktSym">bar</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib_strict.html#%28form._%28%28lib._plisqin-lib%2Fstrict..rkt%29._~3f~3f%29%29" class="RktStxLink" data-pltdoc="x">??</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">foo</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._this%29%29" class="RktStxLink" data-pltdoc="x">this</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="plisqin-lib.html#%28def._%28%28lib._plisqin-lib%2Fmain..rkt%29._%2Fvoid%29%29" class="RktValLink" data-pltdoc="x">/void</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><p>For the purposes of the <a href="using-define-schema.html" data-pltdoc="x">Using define-schema</a> walkthrough,
you can just always add the <span class="RktSym"><a href="plisqin-lib.html#%28def._%28%28lib._plisqin-lib%2Fmain..rkt%29._%2Fvoid%29%29" class="RktValLink" data-pltdoc="x">/void</a></span> fallback as seen above and move on.
Or if you are not satisfied with this hand-waving, you should first read
<a href="Nullability.html" data-pltdoc="x">Nullability</a> and then <a href="plisqin-lib.html#%28part._this-is-nullable%29" data-pltdoc="x">this May Be Null</a>.</p><p>Alternatively, you don&rsquo;t have to add the fallback now.
If your code worked without a fallback prior to applying this recipe, it will
still work without a fallback after applying this recipe.
But future callers of this procedure might get an error.</p><p><div class="SIntrapara"><span class="SSubSubSubSection">On Joins</span></div><div class="SIntrapara">If the definition of <span class="RktSym">NEW-PROC</span> returns a join, you will
have something like the following code.
You can omit the <span class="RktPn">#:to</span><span class="stt"> </span><span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._this%29%29" class="RktStxLink" data-pltdoc="x">this</a></span> if you want, because
<span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._define-schema%29%29" class="RktStxLink" data-pltdoc="x">define-schema</a></span> will automatically add it for you.
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">[</span><span class="RktSym">NEW-PROC</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._join%29%29" class="RktStxLink" data-pltdoc="x">join</a></span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym">y</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym">TableY</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktPn">#:to</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._this%29%29" class="RktStxLink" data-pltdoc="x">this</a></span></span></td></tr><tr><td><span class="highlighted"><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="highlighted"><span class="RktSym">clauses</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym">....</span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="RktPn">]</span></td></tr></table></blockquote></div></p><p><div class="SIntrapara"><span class="SSubSubSubSection">On Left Joins</span></div><div class="SIntrapara">I recommend that every join you add to <span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._define-schema%29%29" class="RktStxLink" data-pltdoc="x">define-schema</a></span> should never
remove rows from the result set.
For example, perhaps a Player <span class="RktPn">#:has-one</span> Team, but this relationship
is optional (that is, a Player might have no current Team).
In this case, the join should have <span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib.html#%28def._%28%28lib._plisqin-lib%2Fmain..rkt%29._join-type%29%29" class="RktValLink" data-pltdoc="x">join-type</a></span><span class="stt"> </span><span class="RktVal">'</span><span class="RktVal">left</span><span class="RktPn">)</span> so that callers
who use this join do not accidentally filter out Players who have no current Team.
If a caller really wants to convert a <span class="RktVal">'</span><span class="RktVal">left</span> join into an
<span class="RktVal">'</span><span class="RktVal">inner</span> join, they can do so as follows:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._from%29%29" class="RktStxLink" data-pltdoc="x">from</a></span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="hspace">&nbsp;</span><span class="RktSym">Player</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">(Team p) returns a 'left join ...</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._join%29%29" class="RktStxLink" data-pltdoc="x">join</a></span><span class="hspace">&nbsp;</span><span class="RktSym">t</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Team</span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">... but we can override that here:</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib.html#%28def._%28%28lib._plisqin-lib%2Fmain..rkt%29._join-type%29%29" class="RktValLink" data-pltdoc="x">join-type</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">inner</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><p>Note that almost every <span class="RktPn">#:has-group</span> relationship should be a left
join, because a group containing zero members is considered a failed join
and unless it is a left join, rows will be filtered from the result.</p><h5 x-source-module="(lib &quot;plisqin-doc/scribblings/plisqin.scrbl&quot;)" x-source-pkg="plisqin" x-part-tag="&quot;join&lt;-&gt;define&quot;">5.1.4<tt>&nbsp;</tt><a name="(part._join~3c-~3edefine)"></a>Join &lt;-&gt; Define</h5><p><div class="SIntrapara">This recipe allows you to convert a join to a definition and back.
This only works if <span class="RktPn">(</span><span class="RktSym">TableY</span><span class="stt"> </span><span class="RktSym">x</span><span class="RktPn">)</span> returns a <span class="RktSym"><a href="plisqin-lib.html#%28def._%28%28lib._plisqin-lib%2Fmain..rkt%29._join~3f%29%29" class="RktValLink" data-pltdoc="x">join?</a></span>:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._from%29%29" class="RktStxLink" data-pltdoc="x">from</a></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">TableX</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._join%29%29" class="RktStxLink" data-pltdoc="x">join</a></span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">TableY</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">is almost equivalent to</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._from%29%29" class="RktStxLink" data-pltdoc="x">from</a></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">TableX</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">TableY</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><p><div class="SIntrapara">The preceding examples are "almost equivalent" because there is a subtle
case in which they are not equivalent.
</div><div class="SIntrapara"><ul><li><p>When <span class="RktSym">y</span> is <span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._join%29%29" class="RktStxLink" data-pltdoc="x">join</a></span>ed, the join is immediately added to
the query and is guaranteed to appear in the generated SQL.</p></li><li><p>When <span class="RktSym">y</span> is <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define</a></span>d, the join is not immediately added
to the query. If <span class="RktSym">y</span> is used as content in some clauses that follow,
it will be added to the query at that time and both versions become equivalent.
But if <span class="RktSym">y</span> is an unused definition, it essentially does not exist
and both versions are not equivalent.</p></li></ul></div></p><h4 x-source-module="(lib &quot;plisqin-doc/scribblings/plisqin.scrbl&quot;)" x-source-pkg="plisqin" x-part-tag="&quot;Compound_Recipes&quot;">5.2<tt>&nbsp;</tt><a name="(part._.Compound_.Recipes)"></a>Compound Recipes</h4><p>These recipes use one or more of the Elemental Recipes.</p><h5 x-source-module="(lib &quot;plisqin-doc/scribblings/plisqin.scrbl&quot;)" x-source-pkg="plisqin" x-part-tag="&quot;join1-&gt;schema&quot;">5.2.1<tt>&nbsp;</tt><a name="(part._join1-~3eschema)"></a>Singular Join -&gt; Schema Definition</h5><p>This recipe moves a singular join into <span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._define-schema%29%29" class="RktStxLink" data-pltdoc="x">define-schema</a></span>.</p><p><span style="font-weight: bold">Caution:</span> In this example, the single-argument procedure <span class="PGreen"><span class="RktSym">Team</span></span>
happens to share its name with the existing table <span class="highlighted"><span class="RktSym">Team</span></span>.
This name-sharing is very common with singular joins, but not required.</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">current code:</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._from%29%29" class="RktStxLink" data-pltdoc="x">from</a></span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="hspace">&nbsp;</span><span class="RktSym">Player</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._join%29%29" class="RktStxLink" data-pltdoc="x">join</a></span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym">t</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym">Team</span></span></td></tr><tr><td><span class="highlighted"><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym"><a href="plisqin-lib_strict.html#%28def._%28%28lib._plisqin-lib%2Fstrict..rkt%29._join-on%29%29" class="RktValLink" data-pltdoc="x">join-on</a></span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym"><a href="plisqin-lib_strict.html#%28def._%28%28lib._plisqin-lib%2Fstrict%2Foperators..rkt%29._~3d%29%29" class="RktValLink" data-pltdoc="x">.=</a></span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym">TeamID</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym">t</span></span><span class="highlighted"><span class="RktPn">)</span></span></td></tr><tr><td><span class="highlighted"><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym">TeamID</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym">p</span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="highlighted"><span class="RktPn">)</span></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">desired code:</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._from%29%29" class="RktStxLink" data-pltdoc="x">from</a></span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="hspace">&nbsp;</span><span class="RktSym">Player</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._join%29%29" class="RktStxLink" data-pltdoc="x">join</a></span><span class="hspace">&nbsp;</span><span class="RktSym">t</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="PGreen"><span class="RktSym">Team</span></span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span><span class="RktPn">)</span></td></tr></table></blockquote><p><div class="SIntrapara">First we use the <a href="#%28part._join-~3eex%29" data-pltdoc="x">Join -&gt; Expression</a> recipe as follows:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._from%29%29" class="RktStxLink" data-pltdoc="x">from</a></span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="hspace">&nbsp;</span><span class="RktSym">Player</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">t</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._join%29%29" class="RktStxLink" data-pltdoc="x">join</a></span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym">t</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym">Team</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktPn">#:to</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym">p</span></span></td></tr><tr><td><span class="highlighted"><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym"><a href="plisqin-lib_strict.html#%28def._%28%28lib._plisqin-lib%2Fstrict..rkt%29._join-on%29%29" class="RktValLink" data-pltdoc="x">join-on</a></span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym"><a href="plisqin-lib_strict.html#%28def._%28%28lib._plisqin-lib%2Fstrict%2Foperators..rkt%29._~3d%29%29" class="RktValLink" data-pltdoc="x">.=</a></span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym">TeamID</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym">t</span></span><span class="highlighted"><span class="RktPn">)</span></span></td></tr><tr><td><span class="highlighted"><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym">TeamID</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym">p</span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><p><div class="SIntrapara">Next we use the <a href="#%28part._ex-~3eproc%29" data-pltdoc="x">Expression -&gt; Procedure</a> recipe as follows:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=attaching-contracts-to-values.html%23%2528form._%2528%2528lib._racket%252Fcontract%252Fregion..rkt%2529._define%252Fcontract%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define/contract</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">NEW-PROC</span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=function-contracts.html%23%2528form._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._-%7E3e%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib.html#%28def._%28%28lib._plisqin-lib%2Fmain..rkt%29._instanceof%29%29" class="RktValLink" data-pltdoc="x">instanceof</a></span><span class="hspace">&nbsp;</span><span class="RktSym">Player</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib.html#%28def._%28%28lib._plisqin-lib%2Fmain..rkt%29._instanceof%29%29" class="RktValLink" data-pltdoc="x">instanceof</a></span><span class="hspace">&nbsp;</span><span class="RktSym">Team</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._join%29%29" class="RktStxLink" data-pltdoc="x">join</a></span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym">t</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym">Team</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktPn">#:to</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym">p</span></span></td></tr><tr><td><span class="highlighted"><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym"><a href="plisqin-lib_strict.html#%28def._%28%28lib._plisqin-lib%2Fstrict..rkt%29._join-on%29%29" class="RktValLink" data-pltdoc="x">join-on</a></span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym"><a href="plisqin-lib_strict.html#%28def._%28%28lib._plisqin-lib%2Fstrict%2Foperators..rkt%29._~3d%29%29" class="RktValLink" data-pltdoc="x">.=</a></span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym">TeamID</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym">t</span></span><span class="highlighted"><span class="RktPn">)</span></span></td></tr><tr><td><span class="highlighted"><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym">TeamID</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym">p</span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._from%29%29" class="RktStxLink" data-pltdoc="x">from</a></span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="hspace">&nbsp;</span><span class="RktSym">Player</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">t</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">NEW-PROC</span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><p><div class="SIntrapara">Next we use the <a href="#%28part._proc-~3eschema%29" data-pltdoc="x">Procedure -&gt; define-schema</a> recipe to move <span class="RktSym">NEW-PROC</span>
into our schema definition. We also immediately rename it to <span class="PGreen"><span class="RktSym">Team</span></span>.
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._define-schema%29%29" class="RktStxLink" data-pltdoc="x">define-schema</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">....</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">table</span><span class="hspace">&nbsp;</span><span class="RktSym">Player</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:has-one</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="PGreen"><span class="RktSym">Team</span></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._join%29%29" class="RktStxLink" data-pltdoc="x">join</a></span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym">t</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym">Team</span></span></td></tr><tr><td><span class="highlighted"><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym"><a href="plisqin-lib_strict.html#%28def._%28%28lib._plisqin-lib%2Fstrict..rkt%29._join-on%29%29" class="RktValLink" data-pltdoc="x">join-on</a></span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym"><a href="plisqin-lib_strict.html#%28def._%28%28lib._plisqin-lib%2Fstrict%2Foperators..rkt%29._~3d%29%29" class="RktValLink" data-pltdoc="x">.=</a></span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym">TeamID</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym">t</span></span><span class="highlighted"><span class="RktPn">)</span></span></td></tr><tr><td><span class="highlighted"><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym"><a href="plisqin-lib_strict.html#%28form._%28%28lib._plisqin-lib%2Fstrict..rkt%29._~3f~3f%29%29" class="RktStxLink" data-pltdoc="x">??</a></span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym">TeamID</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._this%29%29" class="RktStxLink" data-pltdoc="x">this</a></span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym"><a href="plisqin-lib.html#%28def._%28%28lib._plisqin-lib%2Fmain..rkt%29._%2Fvoid%29%29" class="RktValLink" data-pltdoc="x">/void</a></span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">....</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._from%29%29" class="RktStxLink" data-pltdoc="x">from</a></span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="hspace">&nbsp;</span><span class="RktSym">Player</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">t</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="PGreen"><span class="RktSym">Team</span></span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><p><div class="SIntrapara">Finally we use the <a href="#%28part._join~3c-~3edefine%29" data-pltdoc="x">Join &lt;-&gt; Define</a> recipe to make sure we are
equivalent to our starting position:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._from%29%29" class="RktStxLink" data-pltdoc="x">from</a></span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="hspace">&nbsp;</span><span class="RktSym">Player</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._join%29%29" class="RktStxLink" data-pltdoc="x">join</a></span><span class="hspace">&nbsp;</span><span class="RktSym">t</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="PGreen"><span class="RktSym">Team</span></span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><p><div class="SIntrapara"><span class="SSubSubSubSection">Singular Join Naming</span></div><div class="SIntrapara">As mentioned above, the single-argument procedure <span class="PGreen"><span class="RktSym">Team</span></span> shares its
name with the table <span class="highlighted"><span class="RktSym">Team</span></span>.
But this does not have to be the case.
You could, for example, name the procedure <span class="PGreen"><span class="RktSym">CurrentTeam</span></span> instead.
Then the refactored code would look like this:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._define-schema%29%29" class="RktStxLink" data-pltdoc="x">define-schema</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">....</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">table</span><span class="hspace">&nbsp;</span><span class="RktSym">Player</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:has-one</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="PGreen"><span class="RktSym">CurrentTeam</span></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._join%29%29" class="RktStxLink" data-pltdoc="x">join</a></span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym">t</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym">Team</span></span></td></tr><tr><td><span class="highlighted"><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym"><a href="plisqin-lib_strict.html#%28def._%28%28lib._plisqin-lib%2Fstrict..rkt%29._join-on%29%29" class="RktValLink" data-pltdoc="x">join-on</a></span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym"><a href="plisqin-lib_strict.html#%28def._%28%28lib._plisqin-lib%2Fstrict%2Foperators..rkt%29._~3d%29%29" class="RktValLink" data-pltdoc="x">.=</a></span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym">TeamID</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym">t</span></span><span class="highlighted"><span class="RktPn">)</span></span></td></tr><tr><td><span class="highlighted"><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym"><a href="plisqin-lib_strict.html#%28form._%28%28lib._plisqin-lib%2Fstrict..rkt%29._~3f~3f%29%29" class="RktStxLink" data-pltdoc="x">??</a></span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym">TeamID</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._this%29%29" class="RktStxLink" data-pltdoc="x">this</a></span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym"><a href="plisqin-lib.html#%28def._%28%28lib._plisqin-lib%2Fmain..rkt%29._%2Fvoid%29%29" class="RktValLink" data-pltdoc="x">/void</a></span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">....</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._from%29%29" class="RktStxLink" data-pltdoc="x">from</a></span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="hspace">&nbsp;</span><span class="RktSym">Player</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._join%29%29" class="RktStxLink" data-pltdoc="x">join</a></span><span class="hspace">&nbsp;</span><span class="RktSym">t</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="PGreen"><span class="RktSym">CurrentTeam</span></span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><h5 x-source-module="(lib &quot;plisqin-doc/scribblings/plisqin.scrbl&quot;)" x-source-pkg="plisqin" x-part-tag="&quot;joinG-&gt;schema&quot;">5.2.2<tt>&nbsp;</tt><a name="(part._join.G-~3eschema)"></a>Grouped Join -&gt; Schema Definition</h5><p><div class="SIntrapara">This recipe moves a grouped join into <span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._define-schema%29%29" class="RktStxLink" data-pltdoc="x">define-schema</a></span>.
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">current code:</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._from%29%29" class="RktStxLink" data-pltdoc="x">from</a></span><span class="hspace">&nbsp;</span><span class="RktSym">t</span><span class="hspace">&nbsp;</span><span class="RktSym">Team</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._join%29%29" class="RktStxLink" data-pltdoc="x">join</a></span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym">playersG</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym">Player</span></span></td></tr><tr><td><span class="highlighted"><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym"><a href="plisqin-lib_strict.html#%28def._%28%28lib._plisqin-lib%2Fstrict..rkt%29._group-by%29%29" class="RktValLink" data-pltdoc="x">group-by</a></span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym">TeamID</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym">playersG</span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="highlighted"><span class="RktPn">)</span></span></td></tr><tr><td><span class="highlighted"><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym"><a href="plisqin-lib_strict.html#%28def._%28%28lib._plisqin-lib%2Fstrict..rkt%29._join-on%29%29" class="RktValLink" data-pltdoc="x">join-on</a></span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym"><a href="plisqin-lib_strict.html#%28def._%28%28lib._plisqin-lib%2Fstrict%2Foperators..rkt%29._~3d%29%29" class="RktValLink" data-pltdoc="x">.=</a></span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym">TeamID</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym">playersG</span></span><span class="highlighted"><span class="RktPn">)</span></span></td></tr><tr><td><span class="highlighted"><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym">TeamID</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym">t</span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="highlighted"><span class="RktPn">)</span></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">desired code:</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._from%29%29" class="RktStxLink" data-pltdoc="x">from</a></span><span class="hspace">&nbsp;</span><span class="RktSym">t</span><span class="hspace">&nbsp;</span><span class="RktSym">Team</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._join%29%29" class="RktStxLink" data-pltdoc="x">join</a></span><span class="hspace">&nbsp;</span><span class="RktSym">playersG</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="PGreen"><span class="RktSym">PlayersG</span></span><span class="hspace">&nbsp;</span><span class="RktSym">t</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><p><div class="SIntrapara">First we use the <a href="#%28part._join-~3eex%29" data-pltdoc="x">Join -&gt; Expression</a> recipe to produce code like this:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._from%29%29" class="RktStxLink" data-pltdoc="x">from</a></span><span class="hspace">&nbsp;</span><span class="RktSym">t</span><span class="hspace">&nbsp;</span><span class="RktSym">Team</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">playersG</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._join%29%29" class="RktStxLink" data-pltdoc="x">join</a></span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym">playersG</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym">Player</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktPn">#:to</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym">t</span></span></td></tr><tr><td><span class="highlighted"><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym"><a href="plisqin-lib_strict.html#%28def._%28%28lib._plisqin-lib%2Fstrict..rkt%29._group-by%29%29" class="RktValLink" data-pltdoc="x">group-by</a></span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym">TeamID</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym">playersG</span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="highlighted"><span class="RktPn">)</span></span></td></tr><tr><td><span class="highlighted"><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym"><a href="plisqin-lib_strict.html#%28def._%28%28lib._plisqin-lib%2Fstrict..rkt%29._join-on%29%29" class="RktValLink" data-pltdoc="x">join-on</a></span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym"><a href="plisqin-lib_strict.html#%28def._%28%28lib._plisqin-lib%2Fstrict%2Foperators..rkt%29._~3d%29%29" class="RktValLink" data-pltdoc="x">.=</a></span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym">TeamID</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym">playersG</span></span><span class="highlighted"><span class="RktPn">)</span></span></td></tr><tr><td><span class="highlighted"><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym">TeamID</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym">t</span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><p><div class="SIntrapara">Next we use the <a href="#%28part._ex-~3eproc%29" data-pltdoc="x">Expression -&gt; Procedure</a> recipe to produce code like this:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=attaching-contracts-to-values.html%23%2528form._%2528%2528lib._racket%252Fcontract%252Fregion..rkt%2529._define%252Fcontract%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define/contract</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">NEW-PROC</span><span class="hspace">&nbsp;</span><span class="RktSym">t</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=function-contracts.html%23%2528form._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._-%7E3e%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib.html#%28def._%28%28lib._plisqin-lib%2Fmain..rkt%29._instanceof%29%29" class="RktValLink" data-pltdoc="x">instanceof</a></span><span class="hspace">&nbsp;</span><span class="RktSym">Team</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib.html#%28def._%28%28lib._plisqin-lib%2Fmain..rkt%29._instanceof%29%29" class="RktValLink" data-pltdoc="x">instanceof</a></span><span class="hspace">&nbsp;</span><span class="RktSym">Player</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._join%29%29" class="RktStxLink" data-pltdoc="x">join</a></span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym">playersG</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym">Player</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktPn">#:to</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym">t</span></span></td></tr><tr><td><span class="highlighted"><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym"><a href="plisqin-lib_strict.html#%28def._%28%28lib._plisqin-lib%2Fstrict..rkt%29._group-by%29%29" class="RktValLink" data-pltdoc="x">group-by</a></span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym">TeamID</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym">playersG</span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="highlighted"><span class="RktPn">)</span></span></td></tr><tr><td><span class="highlighted"><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym"><a href="plisqin-lib_strict.html#%28def._%28%28lib._plisqin-lib%2Fstrict..rkt%29._join-on%29%29" class="RktValLink" data-pltdoc="x">join-on</a></span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym"><a href="plisqin-lib_strict.html#%28def._%28%28lib._plisqin-lib%2Fstrict%2Foperators..rkt%29._~3d%29%29" class="RktValLink" data-pltdoc="x">.=</a></span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym">TeamID</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym">playersG</span></span><span class="highlighted"><span class="RktPn">)</span></span></td></tr><tr><td><span class="highlighted"><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym">TeamID</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym">t</span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._from%29%29" class="RktStxLink" data-pltdoc="x">from</a></span><span class="hspace">&nbsp;</span><span class="RktSym">t</span><span class="hspace">&nbsp;</span><span class="RktSym">Team</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">playersG</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">NEW-PROC</span><span class="hspace">&nbsp;</span><span class="RktSym">t</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><p><div class="SIntrapara">Next we use the <a href="#%28part._proc-~3eschema%29" data-pltdoc="x">Procedure -&gt; define-schema</a> recipe to move <span class="RktSym">NEW-PROC</span>
into our schema definition. We also immediately rename it to <span class="PGreen"><span class="RktSym">PlayersG</span></span>.
My personal convention is that the name of a grouped join ends with "G".
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._define-schema%29%29" class="RktStxLink" data-pltdoc="x">define-schema</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">....</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">table</span><span class="hspace">&nbsp;</span><span class="RktSym">Team</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:has-group</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="PGreen"><span class="RktSym">PlayersG</span></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._join%29%29" class="RktStxLink" data-pltdoc="x">join</a></span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym">playersG</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym">Player</span></span></td></tr><tr><td><span class="highlighted"><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym"><a href="plisqin-lib_strict.html#%28def._%28%28lib._plisqin-lib%2Fstrict..rkt%29._group-by%29%29" class="RktValLink" data-pltdoc="x">group-by</a></span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym">TeamID</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym">playersG</span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="highlighted"><span class="RktPn">)</span></span></td></tr><tr><td><span class="highlighted"><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym"><a href="plisqin-lib_strict.html#%28def._%28%28lib._plisqin-lib%2Fstrict..rkt%29._join-on%29%29" class="RktValLink" data-pltdoc="x">join-on</a></span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym"><a href="plisqin-lib_strict.html#%28def._%28%28lib._plisqin-lib%2Fstrict%2Foperators..rkt%29._~3d%29%29" class="RktValLink" data-pltdoc="x">.=</a></span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym">TeamID</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym">playersG</span></span><span class="highlighted"><span class="RktPn">)</span></span></td></tr><tr><td><span class="highlighted"><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym"><a href="plisqin-lib_strict.html#%28form._%28%28lib._plisqin-lib%2Fstrict..rkt%29._~3f~3f%29%29" class="RktStxLink" data-pltdoc="x">??</a></span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym">TeamID</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._this%29%29" class="RktStxLink" data-pltdoc="x">this</a></span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym"><a href="plisqin-lib.html#%28def._%28%28lib._plisqin-lib%2Fmain..rkt%29._%2Fvoid%29%29" class="RktValLink" data-pltdoc="x">/void</a></span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">....</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._from%29%29" class="RktStxLink" data-pltdoc="x">from</a></span><span class="hspace">&nbsp;</span><span class="RktSym">t</span><span class="hspace">&nbsp;</span><span class="RktSym">Team</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">playersG</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="PGreen"><span class="RktSym">PlayersG</span></span><span class="hspace">&nbsp;</span><span class="RktSym">t</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><p><div class="SIntrapara">Finally we use the <a href="#%28part._join~3c-~3edefine%29" data-pltdoc="x">Join &lt;-&gt; Define</a> recipe to make sure we are
equivalent to our starting position:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._from%29%29" class="RktStxLink" data-pltdoc="x">from</a></span><span class="hspace">&nbsp;</span><span class="RktSym">t</span><span class="hspace">&nbsp;</span><span class="RktSym">Team</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._join%29%29" class="RktStxLink" data-pltdoc="x">join</a></span><span class="hspace">&nbsp;</span><span class="RktSym">playersG</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="PGreen"><span class="RktSym">PlayersG</span></span><span class="hspace">&nbsp;</span><span class="RktSym">t</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><p>And this recipe is complete.</p><h5 x-source-module="(lib &quot;plisqin-doc/scribblings/plisqin.scrbl&quot;)" x-source-pkg="plisqin" x-part-tag="&quot;scalar-&gt;schema&quot;">5.2.3<tt>&nbsp;</tt><a name="(part._scalar-~3eschema)"></a>Scalar -&gt; Schema Definition</h5><p><div class="SIntrapara">This recipe moves a scalar into <span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._define-schema%29%29" class="RktStxLink" data-pltdoc="x">define-schema</a></span>.
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">current code:</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._from%29%29" class="RktStxLink" data-pltdoc="x">from</a></span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="hspace">&nbsp;</span><span class="RktSym">Player</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib_strict.html#%28def._%28%28lib._plisqin-lib%2Fstrict..rkt%29._select%29%29" class="RktValLink" data-pltdoc="x">select</a></span><span class="hspace">&nbsp;</span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym"><a href="plisqin-lib_strict.html#%28def._%28%28lib._plisqin-lib%2Fstrict%2Foperators..rkt%29._%2F%29%29" class="RktValLink" data-pltdoc="x">./</a></span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym">ShotsMade</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym">p</span></span><span class="highlighted"><span class="RktPn">)</span></span></td></tr><tr><td><span class="highlighted"><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym">ShotsTaken</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym">p</span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">desired code:</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._from%29%29" class="RktStxLink" data-pltdoc="x">from</a></span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="hspace">&nbsp;</span><span class="RktSym">Player</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib_strict.html#%28def._%28%28lib._plisqin-lib%2Fstrict..rkt%29._select%29%29" class="RktValLink" data-pltdoc="x">select</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="PGreen"><span class="RktSym">ShootingPercentage</span></span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><p><div class="SIntrapara">First we use the <a href="#%28part._ex-~3eproc%29" data-pltdoc="x">Expression -&gt; Procedure</a> recipe as follows:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=attaching-contracts-to-values.html%23%2528form._%2528%2528lib._racket%252Fcontract%252Fregion..rkt%2529._define%252Fcontract%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define/contract</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">NEW-PROC</span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=function-contracts.html%23%2528form._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._-%7E3e%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib.html#%28def._%28%28lib._plisqin-lib%2Fmain..rkt%29._instanceof%29%29" class="RktValLink" data-pltdoc="x">instanceof</a></span><span class="hspace">&nbsp;</span><span class="RktSym">Player</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="plisqin-lib.html#%28def._%28%28lib._plisqin-lib%2Ftypes..rkt%29._.Scalar~3f%29%29" class="RktValLink" data-pltdoc="x">Scalar?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym"><a href="plisqin-lib_strict.html#%28def._%28%28lib._plisqin-lib%2Fstrict%2Foperators..rkt%29._%2F%29%29" class="RktValLink" data-pltdoc="x">./</a></span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym">ShotsMade</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym">p</span></span><span class="highlighted"><span class="RktPn">)</span></span></td></tr><tr><td><span class="highlighted"><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym">ShotsTaken</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym">p</span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._from%29%29" class="RktStxLink" data-pltdoc="x">from</a></span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="hspace">&nbsp;</span><span class="RktSym">Player</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib_strict.html#%28def._%28%28lib._plisqin-lib%2Fstrict..rkt%29._select%29%29" class="RktValLink" data-pltdoc="x">select</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">NEW-PROC</span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><p><div class="SIntrapara">Finally we use the <a href="#%28part._proc-~3eschema%29" data-pltdoc="x">Procedure -&gt; define-schema</a> recipe to move <span class="RktSym">NEW-PROC</span>
into our schema definition.
We also immediately rename it to <span class="PGreen"><span class="RktSym">ShootingPercentage</span></span>.
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._define-schema%29%29" class="RktStxLink" data-pltdoc="x">define-schema</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">....</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">table</span><span class="hspace">&nbsp;</span><span class="RktSym">Player</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:property</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="PGreen"><span class="RktSym">ShootingPercentage</span></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym"><a href="plisqin-lib_strict.html#%28def._%28%28lib._plisqin-lib%2Fstrict%2Foperators..rkt%29._%2F%29%29" class="RktValLink" data-pltdoc="x">./</a></span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym">ShotsMade</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._this%29%29" class="RktStxLink" data-pltdoc="x">this</a></span></span><span class="highlighted"><span class="RktPn">)</span></span></td></tr><tr><td><span class="highlighted"><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym">ShotsTaken</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._this%29%29" class="RktStxLink" data-pltdoc="x">this</a></span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">....</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._from%29%29" class="RktStxLink" data-pltdoc="x">from</a></span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="hspace">&nbsp;</span><span class="RktSym">Player</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib_strict.html#%28def._%28%28lib._plisqin-lib%2Fstrict..rkt%29._select%29%29" class="RktValLink" data-pltdoc="x">select</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="PGreen"><span class="RktSym">ShootingPercentage</span></span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><p>And this recipe is complete.</p><h5 x-source-module="(lib &quot;plisqin-doc/scribblings/plisqin.scrbl&quot;)" x-source-pkg="plisqin" x-part-tag="&quot;scalar-flattening&quot;">5.2.4<tt>&nbsp;</tt><a name="(part._scalar-flattening)"></a>Scalar Flattening</h5><p><div class="SIntrapara">This recipe is a special case of the <a href="#%28part._scalar-~3eschema%29" data-pltdoc="x">Scalar -&gt; Schema Definition</a> recipe.
This recipe says that if <span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym">TeamName</span></span><span class="highlighted"><span class="stt"> </span></span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym">Team</span></span><span class="highlighted"><span class="stt"> </span></span><span class="highlighted"><span class="RktSym">p</span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="highlighted"><span class="RktPn">)</span></span> is
already defined, we can easily add a new property <span class="RktPn">(</span><span class="PGreen"><span class="RktSym">TeamName</span></span><span class="stt"> </span><span class="RktSym">p</span><span class="RktPn">)</span>
which will be equal to the original expression.
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">current code:</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._from%29%29" class="RktStxLink" data-pltdoc="x">from</a></span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="hspace">&nbsp;</span><span class="RktSym">Player</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib_strict.html#%28def._%28%28lib._plisqin-lib%2Fstrict..rkt%29._select%29%29" class="RktValLink" data-pltdoc="x">select</a></span><span class="hspace">&nbsp;</span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym">TeamName</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym">Team</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym">p</span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">desired code:</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._from%29%29" class="RktStxLink" data-pltdoc="x">from</a></span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="hspace">&nbsp;</span><span class="RktSym">Player</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib_strict.html#%28def._%28%28lib._plisqin-lib%2Fstrict..rkt%29._select%29%29" class="RktValLink" data-pltdoc="x">select</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="PGreen"><span class="RktSym">TeamName</span></span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><p><div class="SIntrapara">First we use the <a href="#%28part._ex-~3eproc%29" data-pltdoc="x">Expression -&gt; Procedure</a> recipe as follows:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=attaching-contracts-to-values.html%23%2528form._%2528%2528lib._racket%252Fcontract%252Fregion..rkt%2529._define%252Fcontract%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define/contract</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">NEW-PROC</span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=function-contracts.html%23%2528form._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._-%7E3e%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib.html#%28def._%28%28lib._plisqin-lib%2Fmain..rkt%29._instanceof%29%29" class="RktValLink" data-pltdoc="x">instanceof</a></span><span class="hspace">&nbsp;</span><span class="RktSym">Player</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="plisqin-lib.html#%28def._%28%28lib._plisqin-lib%2Ftypes..rkt%29._.Scalar~3f%29%29" class="RktValLink" data-pltdoc="x">Scalar?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym">TeamName</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym">Team</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym">p</span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._from%29%29" class="RktStxLink" data-pltdoc="x">from</a></span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="hspace">&nbsp;</span><span class="RktSym">Player</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib_strict.html#%28def._%28%28lib._plisqin-lib%2Fstrict..rkt%29._select%29%29" class="RktValLink" data-pltdoc="x">select</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">NEW-PROC</span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><p><div class="SIntrapara">Finally we use the <a href="#%28part._proc-~3eschema%29" data-pltdoc="x">Procedure -&gt; define-schema</a> recipe to move <span class="RktSym">NEW-PROC</span>
into our schema definition.
We also immediately rename it to <span class="PGreen"><span class="RktSym">TeamName</span></span>.
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._define-schema%29%29" class="RktStxLink" data-pltdoc="x">define-schema</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">....</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">table</span><span class="hspace">&nbsp;</span><span class="RktSym">Player</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:property</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="PGreen"><span class="RktSym">TeamName</span></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym">TeamName</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym">Team</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._this%29%29" class="RktStxLink" data-pltdoc="x">this</a></span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">....</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._from%29%29" class="RktStxLink" data-pltdoc="x">from</a></span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="hspace">&nbsp;</span><span class="RktSym">Player</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib_strict.html#%28def._%28%28lib._plisqin-lib%2Fstrict..rkt%29._select%29%29" class="RktValLink" data-pltdoc="x">select</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="PGreen"><span class="RktSym">TeamName</span></span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><p>And this recipe is complete.</p><h5 x-source-module="(lib &quot;plisqin-doc/scribblings/plisqin.scrbl&quot;)" x-source-pkg="plisqin" x-part-tag="&quot;join-&gt;inline&quot;">5.2.5<tt>&nbsp;</tt><a name="(part._join-~3einline)"></a>Inline Join</h5><p><div class="SIntrapara">This recipe moves a join inline.
This is mostly used to set up further refactoring.
It does not add anything to <span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._define-schema%29%29" class="RktStxLink" data-pltdoc="x">define-schema</a></span>.
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">current code:</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._from%29%29" class="RktStxLink" data-pltdoc="x">from</a></span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="hspace">&nbsp;</span><span class="RktSym">Player</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._join%29%29" class="RktStxLink" data-pltdoc="x">join</a></span><span class="hspace">&nbsp;</span><span class="RktSym">t</span><span class="hspace">&nbsp;</span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym">Team</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym">p</span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib_strict.html#%28def._%28%28lib._plisqin-lib%2Fstrict..rkt%29._select%29%29" class="RktValLink" data-pltdoc="x">select</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">TeamName</span><span class="hspace">&nbsp;</span><span class="RktSym">t</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">desired code:</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._from%29%29" class="RktStxLink" data-pltdoc="x">from</a></span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="hspace">&nbsp;</span><span class="RktSym">Player</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">this code gets removed:</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PStrike"><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._join%29%29" class="RktStxLink" data-pltdoc="x">join</a></span><span class="stt"> </span><span class="RktSym">t</span><span class="stt"> </span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym">Team</span></span><span class="highlighted"><span class="stt"> </span></span><span class="highlighted"><span class="RktSym">p</span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="RktPn">)</span></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib_strict.html#%28def._%28%28lib._plisqin-lib%2Fstrict..rkt%29._select%29%29" class="RktValLink" data-pltdoc="x">select</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">TeamName</span><span class="hspace">&nbsp;</span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym">Team</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym">p</span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><p><div class="SIntrapara">We first use the <a href="#%28part._join~3c-~3edefine%29" data-pltdoc="x">Join &lt;-&gt; Define</a> recipe as follows:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._from%29%29" class="RktStxLink" data-pltdoc="x">from</a></span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="hspace">&nbsp;</span><span class="RktSym">Player</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">t</span><span class="hspace">&nbsp;</span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym">Team</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym">p</span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib_strict.html#%28def._%28%28lib._plisqin-lib%2Fstrict..rkt%29._select%29%29" class="RktValLink" data-pltdoc="x">select</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">TeamName</span><span class="hspace">&nbsp;</span><span class="RktSym">t</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><p><div class="SIntrapara">Now we just use normal refactoring techniques to replace <span class="RktSym">t</span> with its
definition as follows:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._from%29%29" class="RktStxLink" data-pltdoc="x">from</a></span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="hspace">&nbsp;</span><span class="RktSym">Player</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">this code is removed:</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PStrike"><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="stt"> </span><span class="RktSym">t</span><span class="stt"> </span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym">Team</span></span><span class="highlighted"><span class="stt"> </span></span><span class="highlighted"><span class="RktSym">p</span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="RktPn">)</span></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib_strict.html#%28def._%28%28lib._plisqin-lib%2Fstrict..rkt%29._select%29%29" class="RktValLink" data-pltdoc="x">select</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">TeamName</span><span class="hspace">&nbsp;</span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym">Team</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym">p</span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><p>And this recipe is complete.
They key point is that if we proceed to use the <a href="#%28part._ex-~3eproc%29" data-pltdoc="x">Expression -&gt; Procedure</a> recipe
on <span class="RktPn">(</span><span class="RktSym">TeamName</span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym">Team</span><span class="stt"> </span><span class="RktSym">p</span><span class="RktPn">)</span><span class="RktPn">)</span>, the resulting procedure will now accept one
argument which is an <span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib.html#%28def._%28%28lib._plisqin-lib%2Fmain..rkt%29._instanceof%29%29" class="RktValLink" data-pltdoc="x">instanceof</a></span><span class="stt"> </span><span class="RktSym">Player</span><span class="RktPn">)</span>.
In the original version, it would have wanted an <span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib.html#%28def._%28%28lib._plisqin-lib%2Fmain..rkt%29._instanceof%29%29" class="RktValLink" data-pltdoc="x">instanceof</a></span><span class="stt"> </span><span class="RktSym">Team</span><span class="RktPn">)</span>.</p><h5 x-source-module="(lib &quot;plisqin-doc/scribblings/plisqin.scrbl&quot;)" x-source-pkg="plisqin" x-part-tag="&quot;ds:rename&quot;">5.2.6<tt>&nbsp;</tt><a name="(part._ds~3arename)"></a>Name Clarification</h5><p><div class="SIntrapara">This recipe creates a more descriptive name for a procedure.
This recipe assumes we are using <span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._define-schema%29%29" class="RktStxLink" data-pltdoc="x">define-schema</a></span>.
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">current code:</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._from%29%29" class="RktStxLink" data-pltdoc="x">from</a></span><span class="hspace">&nbsp;</span><span class="RktSym">t</span><span class="hspace">&nbsp;</span><span class="RktSym">Team</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib_strict.html#%28def._%28%28lib._plisqin-lib%2Fstrict..rkt%29._select%29%29" class="RktValLink" data-pltdoc="x">select</a></span><span class="hspace">&nbsp;</span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym">Name</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym">t</span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">desired code:</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._from%29%29" class="RktStxLink" data-pltdoc="x">from</a></span><span class="hspace">&nbsp;</span><span class="RktSym">t</span><span class="hspace">&nbsp;</span><span class="RktSym">Team</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib_strict.html#%28def._%28%28lib._plisqin-lib%2Fstrict..rkt%29._select%29%29" class="RktValLink" data-pltdoc="x">select</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="PGreen"><span class="RktSym">TeamName</span></span><span class="hspace">&nbsp;</span><span class="RktSym">t</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><p><div class="SIntrapara">We want to create <span class="RktSym">TeamName</span> as an alias for <span class="RktSym">Name</span> when
the argument is an <span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib.html#%28def._%28%28lib._plisqin-lib%2Fmain..rkt%29._instanceof%29%29" class="RktValLink" data-pltdoc="x">instanceof</a></span><span class="stt"> </span><span class="RktSym">Team</span><span class="RktPn">)</span>.
First we use the <a href="#%28part._ex-~3eproc%29" data-pltdoc="x">Expression -&gt; Procedure</a> recipe to get the following code:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=attaching-contracts-to-values.html%23%2528form._%2528%2528lib._racket%252Fcontract%252Fregion..rkt%2529._define%252Fcontract%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define/contract</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">NEW-PROC</span><span class="hspace">&nbsp;</span><span class="RktSym">t</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=function-contracts.html%23%2528form._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._-%7E3e%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib.html#%28def._%28%28lib._plisqin-lib%2Fmain..rkt%29._instanceof%29%29" class="RktValLink" data-pltdoc="x">instanceof</a></span><span class="hspace">&nbsp;</span><span class="RktSym">Team</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="plisqin-lib.html#%28def._%28%28lib._plisqin-lib%2Ftypes..rkt%29._.Scalar~3f%29%29" class="RktValLink" data-pltdoc="x">Scalar?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym">Name</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym">t</span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._from%29%29" class="RktStxLink" data-pltdoc="x">from</a></span><span class="hspace">&nbsp;</span><span class="RktSym">t</span><span class="hspace">&nbsp;</span><span class="RktSym">Team</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib_strict.html#%28def._%28%28lib._plisqin-lib%2Fstrict..rkt%29._select%29%29" class="RktValLink" data-pltdoc="x">select</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">NEW-PROC</span><span class="hspace">&nbsp;</span><span class="RktSym">t</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><p><div class="SIntrapara">Finally we use the <a href="#%28part._proc-~3eschema%29" data-pltdoc="x">Procedure -&gt; define-schema</a> recipe to move <span class="RktSym">NEW-PROC</span>
into our schema definition.
We also immediately rename it to <span class="PGreen"><span class="RktSym">TeamName</span></span>.
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._define-schema%29%29" class="RktStxLink" data-pltdoc="x">define-schema</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">....</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">table</span><span class="hspace">&nbsp;</span><span class="RktSym">Team</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:property</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="PGreen"><span class="RktSym">TeamName</span></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym">Name</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._this%29%29" class="RktStxLink" data-pltdoc="x">this</a></span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">....</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._from%29%29" class="RktStxLink" data-pltdoc="x">from</a></span><span class="hspace">&nbsp;</span><span class="RktSym">t</span><span class="hspace">&nbsp;</span><span class="RktSym">Team</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib_strict.html#%28def._%28%28lib._plisqin-lib%2Fstrict..rkt%29._select%29%29" class="RktValLink" data-pltdoc="x">select</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="PGreen"><span class="RktSym">TeamName</span></span><span class="hspace">&nbsp;</span><span class="RktSym">t</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><p>And we are done.</p><p><div class="SIntrapara">Note that <span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._define-schema%29%29" class="RktStxLink" data-pltdoc="x">define-schema</a></span> automatically sets the <span class="RktPn">#:as</span> name of
each <span class="RktPn">#:property</span>, as if you had written the following:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">#:property</span></td></tr><tr><td><span class="RktPn">[</span><span class="PGreen"><span class="RktSym">TeamName</span></span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="plisqin-lib.html#%28def._%28%28lib._plisqin-lib%2Fmain..rkt%29._~3e~3e%29%29" class="RktValLink" data-pltdoc="x">&gt;&gt;</a></span><span class="hspace">&nbsp;</span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym">Name</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym"><a href="plisqin-lib.html#%28form._%28%28lib._plisqin-lib%2Fmain..rkt%29._this%29%29" class="RktStxLink" data-pltdoc="x">this</a></span></span><span class="highlighted"><span class="RktPn">)</span></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:as</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="PGreen"><span class="RktSym">TeamName</span></span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr></table></blockquote></div></p><p>Be aware of this to avoid breaking any existing call sites that depend on the
original name appearing in the result set.
The examples in this documentation ignore this caveat because this recipe
is always used on a brand new query that has no call sites yet.</p><div class="navsetbottom"><span class="navleft"><form class="searchform"><input class="searchbox" id="searchbox" type="text" tabindex="1" placeholder="...search manuals..." title="Enter a search string to search the manuals" onkeypress="return DoSearchKey(event, this, &quot;8.6&quot;, &quot;../&quot;);"/></form>&nbsp;&nbsp;<a href="../index-2.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;8.6&quot;);">top</a><span class="tocsettoggle">&nbsp;&nbsp;<a href="javascript:void(0);" title="show/hide table of contents" onclick="TocsetToggle();">contents</a></span></span><span class="navright">&nbsp;&nbsp;<a href="Nullability.html" title="backward to &quot;4 Nullability&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="index.html" title="up to &quot;Plisqin&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="Reference.html" title="forward to &quot;6 Reference&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body>
<!-- Mirrored from docs.racket-lang.org/plisqin/Refactoring_Recipes.html by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 07 Sep 2022 03:29:46 GMT -->
</html>