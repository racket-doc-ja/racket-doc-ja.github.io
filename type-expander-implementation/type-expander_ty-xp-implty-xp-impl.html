<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- Mirrored from docs.racket-lang.org/type-expander-implementation/type-expander_ty-xp-implty-xp-impl.html by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 07 Sep 2022 03:25:45 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><meta name="viewport" content="width=device-width, initial-scale=0.8"/><title>1&nbsp;Implementation of the type expander library</title><link rel="stylesheet" type="text/css" href="../scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="../racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-style.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../doc-site.css" title="default"/><script type="text/javascript" src="../scribble-common.js"></script><script type="text/javascript" src="../manual-racket.js"></script><script type="text/javascript" src="../manual-racket.js"></script><script type="text/javascript" src="../doc-site.js"></script><script type="text/javascript" src="../local-redirect/local-redirect.js"></script><script type="text/javascript" src="../local-redirect/local-user-redirect.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="doc-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9660;</a></td><td></td><td><a href="index.html" class="tocviewlink" data-pltdoc="x">Type expander:<span class="mywbr"> &nbsp;</span> Implementation</a></td></tr></table></div><div class="tocviewsublisttop" style="display: block;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="#" class="tocviewselflink" data-pltdoc="x">Implementation of the type expander library</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="type-expander_ty-xp-morety-xp-more.html" class="tocviewlink" data-pltdoc="x">Some example type expanders</a></td></tr></table></div></div><div class="tocviewlist"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_1&quot;);">&#9658;</a></td><td>1&nbsp;</td><td><a href="#" class="tocviewselflink" data-pltdoc="x">Implementation of the type expander library</a></td></tr></table><div class="tocviewsublistbottom" style="display: none;" id="tocview_1"><table cellspacing="0" cellpadding="0"><tr><td align="right">1.1&nbsp;</td><td><a href="#%28part._.Introduction%29" class="tocviewlink" data-pltdoc="x">Introduction</a></td></tr><tr><td align="right">1.2&nbsp;</td><td><a href="#%28part._.Expansion_model_for_type_expanders%29" class="tocviewlink" data-pltdoc="x">Expansion model for type expanders</a></td></tr><tr><td align="right">1.3&nbsp;</td><td><a href="#%28part._.The_prop_type-expander_structure_type_property%29" class="tocviewlink" data-pltdoc="x">The <span class="RktSym"><span class="RktValLink">prop:<span class="mywbr"> &nbsp;</span>type-<wbr></wbr>expander</span></span> structure type property</a></td></tr><tr><td align="right">1.4&nbsp;</td><td><a href="#%28part._.Associating_type_expanders_to_identifiers%29" class="tocviewlink" data-pltdoc="x">Associating type expanders to identifiers</a></td></tr><tr><td align="right">1.5&nbsp;</td><td><a href="#%28part._.Expanding_types%29" class="tocviewlink" data-pltdoc="x">Expanding types</a></td></tr><tr><td align="right">1.6&nbsp;</td><td><a href="#%28part._.Overloading_typed_racket_forms%29" class="tocviewlink" data-pltdoc="x">Overloading <span class="RktSym">typed/<span class="mywbr"> &nbsp;</span>racket</span> forms</a></td></tr><tr><td align="right">1.7&nbsp;</td><td><a href="#%28part._.Future_work%29" class="tocviewlink" data-pltdoc="x">Future work</a></td></tr><tr><td align="right">1.8&nbsp;</td><td><a href="#%28part._.Conclusion%29" class="tocviewlink" data-pltdoc="x">Conclusion</a></td></tr></table></div></div></div><div class="tocsub"><div class="tocsubtitle">On this page:</div><table class="tocsublist" cellspacing="0"><tr><td><span class="tocsublinknumber">1.1<tt>&nbsp;</tt></span><a href="#%28part._.Introduction%29" class="tocsubseclink" data-pltdoc="x">Introduction</a></td></tr><tr><td><span class="tocsublinknumber">1.2<tt>&nbsp;</tt></span><a href="#%28part._.Expansion_model_for_type_expanders%29" class="tocsubseclink" data-pltdoc="x">Expansion model for type expanders</a></td></tr><tr><td><span class="tocsublinknumber">1.2.1<tt>&nbsp;</tt></span><a href="#%28part._.Comparison_with_.Te.X_s_macro_expansion_model%29" class="tocsubseclink" data-pltdoc="x">Comparison with Te<span class="mywbr"> &nbsp;</span>X&rsquo;s macro expansion model</a></td></tr><tr><td><span class="tocsublinknumber">1.2.2<tt>&nbsp;</tt></span><a href="#%28part._.Interactions_between_type_expanders_and_scopes%29" class="tocsubseclink" data-pltdoc="x">Interactions between type expanders and scopes</a></td></tr><tr><td><span class="tocsublinknumber">1.3<tt>&nbsp;</tt></span><a href="#%28part._.The_prop_type-expander_structure_type_property%29" class="tocsubseclink" data-pltdoc="x">The <span class="RktSym"><span class="RktValLink">prop:<span class="mywbr"> &nbsp;</span>type-<wbr></wbr>expander</span></span> structure type property</a></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28prefixable._chunk~3a~3cprop~3atype-expander~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;prop:type-expander&#187;</a></span></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28prefixable._chunk~3a~3cprop-guard~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;prop-guard&#187;</a></span></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28prefixable._chunk~3a~3cprop-guard-field-index~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;prop-guard-field-index&#187;</a></span></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28prefixable._chunk~3a~3cprop-guard-field-value~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;prop-guard-field-value&#187;</a></span></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28prefixable._chunk~3a~3cprop-guard-procedure~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;prop-guard-procedure&#187;</a></span></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28prefixable._chunk~3a~3cprop-guard-else-error~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;prop-guard-else-error&#187;</a></span></td></tr><tr><td><span class="tocsublinknumber">1.3.1<tt>&nbsp;</tt></span><a href="#%28part._.The_type-expander_struct%29" class="tocsubseclink" data-pltdoc="x">The <span class="RktSym">type-<wbr></wbr>expander</span> struct</a></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28prefixable._chunk~3a~3ctype-expander-struct~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;type-expander-struct&#187;</a></span></td></tr><tr><td><span class="tocsublinknumber">1.4<tt>&nbsp;</tt></span><a href="#%28part._.Associating_type_expanders_to_identifiers%29" class="tocsubseclink" data-pltdoc="x">Associating type expanders to identifiers</a></td></tr><tr><td><span class="tocsublinknumber">1.4.1<tt>&nbsp;</tt></span><a href="#%28part._.The_type-expander_syntax_class%29" class="tocsubseclink" data-pltdoc="x">The <span class="RktSym">type-<wbr></wbr>expander</span> syntax class</a></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28prefixable._chunk~3a~3cexpand-type-syntax-classes~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;expand-type-syntax-classes&#187;</a></span></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28prefixable._chunk~3a~3ctype-syntax-class~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;type-syntax-class&#187;</a></span></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28prefixable._chunk~3a~3ctype-contract~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;type-contract&#187;</a></span></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28prefixable._chunk~3a~3ctype-expand-syntax-class~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;type-expand-syntax-class&#187;</a></span></td></tr><tr><td><span class="tocsublinknumber">1.4.2<tt>&nbsp;</tt></span><a href="#%28part._.Calling_type_expanders%29" class="tocsubseclink" data-pltdoc="x">Calling type expanders</a></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28prefixable._chunk~3a~3capply-type-expander~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;apply-type-expander&#187;</a></span></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28prefixable._chunk~3a~3capply-type-expander-checks~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;apply-type-expander-checks&#187;</a></span></td></tr><tr><td><span class="tocsublinknumber">1.4.3<tt>&nbsp;</tt></span><a href="#%28part._.Associating_type_expanders_to_already_existing_identifiers%29" class="tocsubseclink" data-pltdoc="x">Associating type expanders to already existing identifiers</a></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28prefixable._chunk~3a~3cpatched~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;patched&#187;</a></span></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28prefixable._chunk~3a~3cpatch~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;patch&#187;</a></span></td></tr><tr><td><span class="tocsublinknumber">1.4.4<tt>&nbsp;</tt></span><a href="#%28part._.Defining_new_type_expanders%29" class="tocsubseclink" data-pltdoc="x">Defining new type expanders</a></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28prefixable._chunk~3a~3cdefine-type-expander~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;define-type-expander&#187;</a></span></td></tr><tr><td><span class="tocsublinknumber">1.4.5<tt>&nbsp;</tt></span><a href="#%28part._shadow%29" class="tocsubseclink" data-pltdoc="x">Locally binding type expanders</a></td></tr><tr><td><span class="tocsublinknumber">1.5<tt>&nbsp;</tt></span><a href="#%28part._.Expanding_types%29" class="tocsubseclink" data-pltdoc="x">Expanding types</a></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28prefixable._chunk~3a~3cexpand-type~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;expand-type&#187;</a></span></td></tr><tr><td><span class="tocsublinknumber">1.5.1<tt>&nbsp;</tt></span><a href="#%28part._.Cases_handled_by_expand-type%29" class="tocsubseclink" data-pltdoc="x">Cases handled by <span class="RktSym"><span class="RktValLink">expand-<wbr></wbr>type</span></span></a></td></tr><tr><td><span class="tocsublinknumber">1.5.2<tt>&nbsp;</tt></span><a href="#%28part._.Applying_type_expanders%29" class="tocsubseclink" data-pltdoc="x">Applying type expanders</a></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28prefixable._chunk~3a~3cexpand-type-case-expander~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;expand-type-case-expander&#187;<span style="vertical-align: sub; font-size: 80%">1</span></a></span></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28prefixable._chunk~3a~3cexpand-type-case-expander~3e~3a2~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;expand-type-case-expander&#187;<span style="vertical-align: sub; font-size: 80%">2</span></a></span></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28prefixable._chunk~3a~3cexpand-type-case-app-expander~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;expand-type-case-app-expander&#187;</a></span></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28prefixable._chunk~3a~3cexpand-type-case-app-other~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;expand-type-case-app-other&#187;</a></span></td></tr><tr><td><span class="tocsublinknumber">1.5.2.1<tt>&nbsp;</tt></span><a href="#%28part._.Polymorphic_types_with_~e2~88~80%29" class="tocsubseclink" data-pltdoc="x">Polymorphic types with <span class="RktSym"><span class="RktStxLink">&#8704;</span></span></a></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28prefixable._chunk~3a~3cexpand-type-case-~e2~88~80-through~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;expand-type-case-&#8704;-through&#187;</a></span></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28prefixable._chunk~3a~3cshadowed~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;shadowed&#187;</a></span></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28prefixable._chunk~3a~3cexpand-type-case-~e2~88~80-later~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;expand-type-case-&#8704;-later&#187;</a></span></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28prefixable._chunk~3a~3cexpand-type-case-~e2~88~80-app~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;expand-type-case-&#8704;-app&#187;</a></span></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28prefixable._chunk~3a~3capp-args-error~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;app-args-error&#187;</a></span></td></tr><tr><td><span class="tocsublinknumber">1.5.2.2<tt>&nbsp;</tt></span><a href="#%28part._.Recursive_types_with_.Rec%29" class="tocsubseclink" data-pltdoc="x">Recursive types with <span class="RktSym"><span class="RktStxLink">Rec</span></span></a></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28prefixable._chunk~3a~3cexpand-type-case-.Rec~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;expand-type-case-Rec&#187;</a></span></td></tr><tr><td><span class="tocsublinknumber">1.5.2.3<tt>&nbsp;</tt></span><a href="#%28part._.Local_bindings_with_.Let_and_.Letrec%29" class="tocsubseclink" data-pltdoc="x">Local bindings with <span class="RktSym"><span class="RktStxLink">Let</span></span> and <span class="RktSym"><span class="RktStxLink">Letrec</span></span></a></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28prefixable._chunk~3a~3cexpand-type-case-.Let~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;expand-type-case-Let&#187;</a></span></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28prefixable._chunk~3a~3cexpand-type-case-.Letrec~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;expand-type-case-Letrec&#187;</a></span></td></tr><tr><td><span class="tocsublinknumber">1.5.2.4<tt>&nbsp;</tt></span><a href="#%28part._.Anonymous_types_with__%29" class="tocsubseclink" data-pltdoc="x">Anonymous types with <span class="RktSym"><span class="RktStxLink">&#923;</span></span></a></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28prefixable._chunk~3a~3ceval-anonymous-expander-code~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;eval-anonymous-expander-code&#187;</a></span></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28prefixable._chunk~3a~3cexpand-type-case-app-~ce~9b~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;expand-type-case-app-&#923;&#187;</a></span></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28prefixable._chunk~3a~3cexpand-type-case-just-~ce~9b%2Fnot-applicable~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;expand-type-case-just-&#923;/not-applicable&#187;</a></span></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28prefixable._chunk~3a~3cexpand-type-case-~ce~9b-later~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;expand-type-case-&#923;-later&#187;</a></span></td></tr><tr><td><span class="tocsublinknumber">1.5.2.5<tt>&nbsp;</tt></span><a href="#%28part._.Preventing_the_expansion_of_types_with_.No-.Expand%29" class="tocsubseclink" data-pltdoc="x">Preventing the expansion of types with <span class="RktSym"><span class="badlink"><span class="RktValLink">No-<wbr></wbr>Expand</span></span></span></a></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28prefixable._chunk~3a~3cexpand-type-case-noexpand~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;expand-type-case-noexpand&#187;</a></span></td></tr><tr><td><span class="tocsublinknumber">1.5.2.6<tt>&nbsp;</tt></span><a href="#%28part._.The_overloaded___identifier%29" class="tocsubseclink" data-pltdoc="x">The overloaded <span class="RktSym"><span class="RktStxLink">:</span></span> identifier</a></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28prefixable._chunk~3a~3cexpand-type-case-~3a~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;expand-type-case-:&#187;</a></span></td></tr><tr><td><span class="tocsublinknumber">1.5.2.7<tt>&nbsp;</tt></span><a href="#%28part._.Last_resort_cases__leaving_the_type_unchanged%29" class="tocsubseclink" data-pltdoc="x">Last resort cases:<span class="mywbr"> &nbsp;</span> leaving the type unchanged</a></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28prefixable._chunk~3a~3cexpand-type-case-app-fallback~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;expand-type-case-app-fallback&#187;</a></span></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28prefixable._chunk~3a~3cexpand-type-case-fallback-.T~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;expand-type-case-fallback-T&#187;</a></span></td></tr><tr><td><span class="tocsublinknumber">1.5.3<tt>&nbsp;</tt></span><a href="#%28part._.Debugging_type_expanders%29" class="tocsubseclink" data-pltdoc="x">Debugging type expanders</a></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28prefixable._chunk~3a~3cexpand-type-debug-outer~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;expand-type-debug-outer&#187;<span style="vertical-align: sub; font-size: 80%">1</span></a></span></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28prefixable._chunk~3a~3cdebug-type-expander~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;debug-type-expander&#187;</a></span></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28prefixable._chunk~3a~3cexpand-type-debug-outer~3e~3a2~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;expand-type-debug-outer&#187;<span style="vertical-align: sub; font-size: 80%">2</span></a></span></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28prefixable._chunk~3a~3cexpand-type-debug-indent~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;expand-type-debug-indent&#187;</a></span></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28prefixable._chunk~3a~3cexpand-type-debug-before~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;expand-type-debug-before&#187;</a></span></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28prefixable._chunk~3a~3cexpand-type-debug-after~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;expand-type-debug-after&#187;</a></span></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28prefixable._chunk~3a~3cexpand-type-debug-rules~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;expand-type-debug-rules&#187;</a></span></td></tr><tr><td><span class="tocsublinknumber">1.6<tt>&nbsp;</tt></span><a href="#%28part._.Overloading_typed_racket_forms%29" class="tocsubseclink" data-pltdoc="x">Overloading <span class="RktSym">typed/<span class="mywbr"> &nbsp;</span>racket</span> forms</a></td></tr><tr><td><span class="tocsublinknumber">1.6.1<tt>&nbsp;</tt></span><a href="#%28part._type-expander~7csyntax-classes%29" class="tocsubseclink" data-pltdoc="x">syntax classes</a></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28prefixable._chunk~3a~3cremove-ddd~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;remove-ddd&#187;</a></span></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28prefixable._chunk~3a~3csyntax-classes~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;syntax-classes&#187;<span style="vertical-align: sub; font-size: 80%">1</span></a></span></td></tr><tr><td><span class="tocsublinknumber">1.6.2<tt>&nbsp;</tt></span><a href="#%28part._.Overview_of_the_overloaded_primitives%29" class="tocsubseclink" data-pltdoc="x">Overview of the overloaded primitives</a></td></tr><tr><td><span class="tocsublinknumber">1.6.3<tt>&nbsp;</tt></span><a href="#%28part.__%29" class="tocsubseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">:</span></span></a></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28prefixable._chunk~3a~3c~3a~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;:&#187;</a></span></td></tr><tr><td><span class="tocsublinknumber">1.6.4<tt>&nbsp;</tt></span><a href="#%28part._define-type%29" class="tocsubseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">define-<wbr></wbr>type</span></span></a></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28prefixable._chunk~3a~3cdefine-type~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;define-type&#187;</a></span></td></tr><tr><td><span class="tocsublinknumber">1.6.5<tt>&nbsp;</tt></span><a href="#%28part._define%29" class="tocsubseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">define</span></span></a></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28prefixable._chunk~3a~3cdefine~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;define&#187;</a></span></td></tr><tr><td><span class="tocsublinknumber">1.6.6<tt>&nbsp;</tt></span><a href="#%28part._lambda%29" class="tocsubseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">lambda</span></span></a></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28prefixable._chunk~3a~3clambda~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;lambda&#187;</a></span></td></tr><tr><td><span class="tocsublinknumber">1.6.7<tt>&nbsp;</tt></span><a href="#%28part._case-lambda%29" class="tocsubseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">case-<wbr></wbr>lambda</span></span></a></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28prefixable._chunk~3a~3ccase-lambda~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;case-lambda&#187;</a></span></td></tr><tr><td><span class="tocsublinknumber">1.6.8<tt>&nbsp;</tt></span><a href="#%28part._struct%29" class="tocsubseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">struct</span></span></a></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28prefixable._chunk~3a~3cstruct~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;struct&#187;</a></span></td></tr><tr><td><span class="tocsublinknumber">1.6.9<tt>&nbsp;</tt></span><a href="#%28part._define-struct_exec%29" class="tocsubseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">define-<wbr></wbr>struct/<span class="mywbr"> &nbsp;</span>exec</span></span></a></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28prefixable._chunk~3a~3cdefine-struct%2Fexec~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;define-struct/exec&#187;</a></span></td></tr><tr><td><span class="tocsublinknumber">1.6.10<tt>&nbsp;</tt></span><a href="#%28part._ann%29" class="tocsubseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">ann</span></span></a></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28prefixable._chunk~3a~3cann~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;ann&#187;</a></span></td></tr><tr><td><span class="tocsublinknumber">1.6.11<tt>&nbsp;</tt></span><a href="#%28part._cast%29" class="tocsubseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">cast</span></span></a></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28prefixable._chunk~3a~3ccast~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;cast&#187;</a></span></td></tr><tr><td><span class="tocsublinknumber">1.6.12<tt>&nbsp;</tt></span><a href="#%28part._unsafe-cast%29" class="tocsubseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">unsafe-<wbr></wbr>cast</span></span></a></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28prefixable._chunk~3a~3cunsafe-cast~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;unsafe-cast&#187;</a></span></td></tr><tr><td><span class="tocsublinknumber">1.6.13<tt>&nbsp;</tt></span><a href="#%28part._inst%29" class="tocsubseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">inst</span></span></a></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28prefixable._chunk~3a~3cinst~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;inst&#187;</a></span></td></tr><tr><td><span class="tocsublinknumber">1.6.14<tt>&nbsp;</tt></span><a href="#%28part._row-inst%29" class="tocsubseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">row-<wbr></wbr>inst</span></span></a></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28prefixable._chunk~3a~3crow-inst~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;row-inst&#187;</a></span></td></tr><tr><td><span class="tocsublinknumber">1.6.15<tt>&nbsp;</tt></span><a href="#%28part._let%29" class="tocsubseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">let</span></span></a></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28prefixable._chunk~3a~3clet~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;let&#187;</a></span></td></tr><tr><td><span class="tocsublinknumber">1.6.16<tt>&nbsp;</tt></span><a href="#%28part._let_%29" class="tocsubseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">let*</span></span></a></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28prefixable._chunk~3a~3clet%2A~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;let*&#187;</a></span></td></tr><tr><td><span class="tocsublinknumber">1.6.17<tt>&nbsp;</tt></span><a href="#%28part._let-values%29" class="tocsubseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">let-<wbr></wbr>values</span></span></a></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28prefixable._chunk~3a~3clet-values~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;let-values&#187;</a></span></td></tr><tr><td><span class="tocsublinknumber">1.6.18<tt>&nbsp;</tt></span><a href="#%28part._make-predicate%29" class="tocsubseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">make-<wbr></wbr>predicate</span></span></a></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28prefixable._chunk~3a~3cmake-predicate~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;make-predicate&#187;</a></span></td></tr><tr><td><span class="tocsublinknumber">1.6.19<tt>&nbsp;</tt></span><a href="#%28part.__type___print-type___query-type_args___query-type_result%29" class="tocsubseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">:<span class="mywbr"> &nbsp;</span>type</span></span>, <span class="RktSym"><span class="RktStxLink">:<span class="mywbr"> &nbsp;</span>print-<wbr></wbr>type</span></span>, <span class="RktSym"><span class="RktStxLink">:<span class="mywbr"> &nbsp;</span>query-<wbr></wbr>type/<span class="mywbr"> &nbsp;</span>args</span></span>,
<span class="RktSym"><span class="RktStxLink">:<span class="mywbr"> &nbsp;</span>query-<wbr></wbr>type/<span class="mywbr"> &nbsp;</span>result</span></span></a></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28prefixable._chunk~3a~3c~3atype~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;:type&#187;</a></span></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28prefixable._chunk~3a~3c~3aprint-type~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;:print-type&#187;</a></span></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28prefixable._chunk~3a~3c~3aquery-type%2Fargs~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;:query-type/args&#187;</a></span></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28prefixable._chunk~3a~3c~3aquery-type%2Fresult~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;:query-type/result&#187;</a></span></td></tr><tr><td><span class="tocsublinknumber">1.6.20<tt>&nbsp;</tt></span><a href="#%28part._.Type_expanders_for_the_typed_classes%29" class="tocsubseclink" data-pltdoc="x">Type expanders for the typed classes</a></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28prefixable._chunk~3a~3csyntax-classes~3e~3a2~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;syntax-classes&#187;<span style="vertical-align: sub; font-size: 80%">2</span></a></span></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28prefixable._chunk~3a~3csyntax-classes~3e~3a3~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;syntax-classes&#187;<span style="vertical-align: sub; font-size: 80%">3</span></a></span></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28prefixable._chunk~3a~3csyntax-classes~3e~3a4~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;syntax-classes&#187;<span style="vertical-align: sub; font-size: 80%">4</span></a></span></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28prefixable._chunk~3a~3csyntax-classes~3e~3a5~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;syntax-classes&#187;<span style="vertical-align: sub; font-size: 80%">5</span></a></span></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28prefixable._chunk~3a~3cclass~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;class&#187;</a></span></td></tr><tr><td><span class="tocsublinknumber">1.6.21<tt>&nbsp;</tt></span><a href="#%28part._type-expander~7cother-forms%29" class="tocsubseclink" data-pltdoc="x">Other <span class="RktSym">typed/<span class="mywbr"> &nbsp;</span>racket</span>
forms</a></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28prefixable._chunk~3a~3cother-forms~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;other-forms&#187;</a></span></td></tr><tr><td><span class="tocsublinknumber">1.7<tt>&nbsp;</tt></span><a href="#%28part._.Future_work%29" class="tocsubseclink" data-pltdoc="x">Future work</a></td></tr><tr><td><span class="tocsublinknumber">1.8<tt>&nbsp;</tt></span><a href="#%28part._.Conclusion%29" class="tocsubseclink" data-pltdoc="x">Conclusion</a></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28prefixable._chunk~3a~3cmodule-expander~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;module-expander&#187;</a></span></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28prefixable._chunk~3a~3cmodule-main~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;module-main&#187;</a></span></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28prefixable._chunk~3a~3c%2A~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;*&#187;</a></span></td></tr></table></div></div><div class="maincolumn"><div class="main"><div class="versionbox"><span class="version">8.6</span></div><div class="navsettop"><span class="navleft"><form class="searchform"><input class="searchbox" id="searchbox" type="text" tabindex="1" placeholder="...search manuals..." title="Enter a search string to search the manuals" onkeypress="return DoSearchKey(event, this, &quot;8.6&quot;, &quot;../&quot;);"/></form>&nbsp;&nbsp;<a href="../index-2.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;8.6&quot;);">top</a><span class="tocsettoggle">&nbsp;&nbsp;<a href="javascript:void(0);" title="show/hide table of contents" onclick="TocsetToggle();">contents</a></span></span><span class="navright">&nbsp;&nbsp;<a href="index.html" title="backward to &quot;Type expander: Implementation&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="index.html" title="up to &quot;Type expander: Implementation&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="type-expander_ty-xp-morety-xp-more.html" title="forward to &quot;2 Some example type expanders&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div><h3 x-source-module="(lib &quot;type-expander/scribblings/type-expander-implementation.scrbl&quot;)" x-source-pkg="type-expander" x-part-tag="&quot;ty-xp-impl&quot;">1<tt>&nbsp;</tt><a name="(part._ty-xp-impl)"></a>Implementation of the type expander library</h3><p></p><p>This document describes the implementation of the
<a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html&amp;version=8.6" class="RktModLink Sq" data-pltdoc="x"><span class="RktSym">type-expander</span></a> library, using literate
programming. For the library&rsquo;s documentation, see the
<a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html&amp;version=8.6" class="Sq" data-pltdoc="x">Type expander library</a>
document instead.</p><h4 x-source-module="(lib &quot;type-expander/scribblings/type-expander-implementation.scrbl&quot;)" x-source-pkg="type-expander" x-part-tag="&quot;Introduction&quot;">1.1<tt>&nbsp;</tt><a name="(part._.Introduction)"></a>Introduction</h4><p>Extensible types would be a nice feature for typed/racket. Unlike
<span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._require%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">require</a></span> and <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._provide%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">provide</a></span>, which come with
<span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Frequire-syntax..rkt%2529._define-require-syntax%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define-require-syntax</a></span> and <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprovide-syntax..rkt%2529._define-provide-syntax%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define-provide-syntax</a></span>, and unlike
<span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=match.html%23%2528form._%2528%2528lib._racket%252Fmatch..rkt%2529._match%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">match</a></span>, which comes with <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=match.html%23%2528form._%2528%2528lib._racket%252Fmatch..rkt%2529._define-match-expander%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define-match-expander</a></span>, <span class="RktSym">typed/racket</span>
doesn&rsquo;t provide a way to define type expanders. The
<a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html&amp;version=8.6" class="RktModLink Sq" data-pltdoc="x"><span class="RktSym">type-expander</span></a> library extends <a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=index.html&amp;version=8.6" class="RktModLink Sq" data-pltdoc="x"><span class="RktSym">typed/racket</span></a>
with the ability to define type expanders, i.e. type-level macros.</p><p>The <a href="type-expander_ty-xp-morety-xp-more.html" data-pltdoc="x">Some example type expanders</a> section
presents a small library of type expanders built upon the mechanism implemented
here.</p><p>We redefine the forms <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._%7E3a%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">:</a></span>, <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._define%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define</a></span>, <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._lambda%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">lambda</a></span> and so on to
equivalents that support type expanders. Type expanders are defined via the
<span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._define-type-expander%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define-type-expander</a></span> macro. Ideally, this would be handled directly by
<span class="RktSym">typed/racket</span>, which would directly expand uses of type expanders.</p><table cellspacing="0" cellpadding="0"><tr><td></td></tr></table><h4 x-source-module="(lib &quot;type-expander/scribblings/type-expander-implementation.scrbl&quot;)" x-source-pkg="type-expander" x-part-tag="&quot;Expansion_model_for_type_expanders&quot;">1.2<tt>&nbsp;</tt><a name="(part._.Expansion_model_for_type_expanders)"></a>Expansion model for type expanders</h4><p><div class="SIntrapara">Type expanders are expanded similarly to macros, with two minor differences:
</div><div class="SIntrapara"><ul><li><p>A form whose first element is a type expander, e.g.
<span class="RktPn">(</span><span class="RktSym">F</span><span class="stt"> </span><span class="RktPn">. </span><span class="RktSym">args&#8321;</span><span class="RktPn">)</span>, can expand to the identifier of another type expander
<span class="RktSym">G</span>. If the form itself appears as the first element of an outer form,
e.g. <span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">F</span><span class="stt"> </span><span class="RktPn">. </span><span class="RktSym">args&#8321;</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktPn">. </span><span class="RktSym">args&#8322;</span><span class="RktPn">)</span>, the first expansion step will result in
<span class="RktPn">(</span><span class="RktSym">G</span><span class="stt"> </span><span class="RktPn">. </span><span class="RktSym">args&#8322;</span><span class="RktPn">)</span>. The official macro expander for Racket would then expand
<span class="RktSym">G</span> on its own, as an
<a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=guide&amp;rel=pattern-macros.html%23%2528tech._identifier._macro%2529&amp;version=8.6" class="techoutside Sq" data-pltdoc="x"><span class="techinside">identifier macro</span></a>, without
passing the <span class="RktSym">args&#8322;</span> to it. In contrast, the type expander will expand
the whole <span class="RktPn">(</span><span class="RktSym">G</span><span class="stt"> </span><span class="RktPn">. </span><span class="RktSym">args&#8322;</span><span class="RktPn">)</span> form, letting <span class="RktSym">G</span> manipulate the
<span class="RktSym">args&#8322;</span> arguments.</p></li><li><p>It is possible to write anonymous macros,</p><p>The <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._%7Ece%7E9b%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">&#923;</a></span> form can be used to create anonymous type expanders. Anonymous
type expanders are to type expanders what anonymous functions are to function
definitions. The following table presents the expression-level and type-level
function and macro forms. Note that <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._.Let%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">Let</a></span> serves as a type-level
equivalent to both <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._let%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">let</a></span> and <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=let.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fletstx-scheme..rkt%2529._let-syntax%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">let-syntax</a></span>, as anonymous macros
can be used in conjunction with <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._.Let%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">Let</a></span> to obtain the equivalent of
<span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=let.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fletstx-scheme..rkt%2529._let-syntax%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">let-syntax</a></span>.</p><p><table cellspacing="0" cellpadding="0" class="boxed" style="border-collapse: collapse;"><tr><td align="right" valign="baseline" style="border-bottom: 1px solid black;; border-right: 1px solid black;"><p></p></td><td align="right" valign="baseline" style="border-bottom: 1px solid black;; border-right: 1px solid black;"><p><span class="hspace">&nbsp;</span></p></td><td align="left" valign="baseline" style="border-bottom: 1px solid black;"><p><span style="font-weight: bold">Definitions</span></p></td><td align="left" valign="baseline" style="border-bottom: 1px solid black;"><p><span class="hspace">&nbsp;</span></p></td><td align="left" valign="baseline" style="border-bottom: 1px solid black;"><p><span style="font-weight: bold">Local binding</span></p></td><td align="left" valign="baseline" style="border-bottom: 1px solid black;"><p><span class="hspace">&nbsp;</span></p></td><td align="left" valign="baseline" style="border-bottom: 1px solid black;"><p><span style="font-weight: bold">Anonymous functions</span></p></td></tr><tr><td align="right" valign="baseline" style="border-right: 1px solid black;"><p><span style="font-weight: bold">Functions</span></p></td><td align="right" valign="baseline" style="border-right: 1px solid black;"><p><span class="hspace">&nbsp;</span></p></td><td align="left" valign="baseline"><p><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._define%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define</a></span></p></td><td align="left" valign="baseline"><p><span class="hspace">&nbsp;</span></p></td><td align="left" valign="baseline"><p><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._let%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">let</a></span></p></td><td align="left" valign="baseline"><p><span class="hspace">&nbsp;</span></p></td><td align="left" valign="baseline"><p><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._%7Ece%7Ebb%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">&#955;</a></span></p></td></tr><tr><td align="right" valign="baseline" style="border-right: 1px solid black;"><p><span style="font-weight: bold">Macros</span></p></td><td align="right" valign="baseline" style="border-right: 1px solid black;"><p><span class="hspace">&nbsp;</span></p></td><td align="left" valign="baseline"><p><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define-syntax%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define-syntax</a></span></p></td><td align="left" valign="baseline"><p><span class="hspace">&nbsp;</span></p></td><td align="left" valign="baseline"><p><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=let.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fletstx-scheme..rkt%2529._let-syntax%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">let-syntax</a></span></p></td><td align="left" valign="baseline"><p><span class="hspace">&nbsp;</span></p></td><td align="left" valign="baseline"><p><span class="emph">N/A</span></p></td></tr><tr><td align="right" valign="baseline" style="border-right: 1px solid black;"><p><span style="font-weight: bold">Type&#8209;level&#160;functions<span style="vertical-align: super; font-size: 80%">a</span></span></p></td><td align="right" valign="baseline" style="border-right: 1px solid black;"><p><span class="hspace">&nbsp;</span></p></td><td align="left" valign="baseline"><p><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._define-type%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define-type</a></span></p></td><td align="left" valign="baseline"><p><span class="hspace">&nbsp;</span></p></td><td align="left" valign="baseline"><p><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._.Let%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">Let</a></span></p></td><td align="left" valign="baseline"><p><span class="hspace">&nbsp;</span></p></td><td align="left" valign="baseline"><p><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=type-ref.html%23%2528form._%2528%2528lib._typed-racket%252Fbase-env%252Fbase-types-extra..rkt%2529._%7Ee2%7E88%7E80%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">&#8704;</a></span></p></td></tr><tr><td align="right" valign="baseline" style="border-right: 1px solid black;"><p><span style="font-weight: bold">Type&#8209;level&#160;macros</span></p></td><td align="right" valign="baseline" style="border-right: 1px solid black;"><p><span class="hspace">&nbsp;</span></p></td><td align="left" valign="baseline"><p><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._define-type-expander%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define-type-expander</a></span></p></td><td align="left" valign="baseline"><p><span class="hspace">&nbsp;</span></p></td><td align="left" valign="baseline"><p><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._.Let%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">Let</a></span></p></td><td align="left" valign="baseline"><p><span class="hspace">&nbsp;</span></p></td><td align="left" valign="baseline"><p><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._%7Ece%7E9b%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">&#923;</a></span></p></td></tr></table></p><p><span style="vertical-align: super; font-size: 80%">a</span>: The type-level functions are simple substitution functions,
and cannot perform any kind of computation. They are, in a sense, closer to
pattern macros defined with <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fmisc..rkt%2529._define-syntax-rule%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define-syntax-rule</a></span> than to actual
functions.</p></li></ul></div></p><p>Combined, these features allow some form of "curried" application of type
expanders: The <span class="RktSym">F</span> type expander could expand to an anonymous
<span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._%7Ece%7E9b%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">&#923;</a></span> type expander which captures the <span class="RktSym">args&#8321;</span> arguments. In the
second expansion step, the <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._%7Ece%7E9b%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">&#923;</a></span> anonymous type expander would then
consume the <span class="RktSym">args&#8322;</span> arguments, allowing <span class="RktSym">F</span> to effectively
rewrite the two nested forms, instead of being constrained to the innermost
form.</p><h5 x-source-module="(lib &quot;type-expander/scribblings/type-expander-implementation.scrbl&quot;)" x-source-pkg="type-expander" x-part-tag="&quot;Comparison_with_TeX_s_macro_expansion_model&quot;">1.2.1<tt>&nbsp;</tt><a name="(part._.Comparison_with_.Te.X_s_macro_expansion_model)"></a>Comparison with TeX&rsquo;s macro expansion model</h5><p>For long-time TeX or LaTeX users, this may raise some concerns. TeX programs
are parsed as a stream of tokens. A TeX commands is a macro. When a TeX macro
occurs in the stream of tokens, it takes its arguments by consuming a certain
number of tokens following it. After consuming these arguments, a TeX macro
may expand to another TeX macro, which in turn consumes more arguments. This
feature is commonly used in TeX to implement macros which consume a variable
number arguments: the macro will initially consume a single argument.
Depending on the value of that argument, it will then expand to a macro taking
<span class="RktVar">n</span> arguments, or another macro taking <span class="RktVar">m</span> arguments. This
pattern, omnipresent in any sufficiently large TeX program, opens the door to
an undesirable class of bugs: when a TeX macro invocation appears in the
source code, it is not clear syntactically how many arguments it will
eventually consume. An incorrect parameter value can easily cause it to
consume more arguments than expected. This makes it possible for the macro to
consume the end markers of surrounding environments, for example in the code:</p><p><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">\begin{someEnvironment}</span></p></td></tr><tr><td><p><span class="stt">\someMacro{arg1}{arg2}</span></p></td></tr><tr><td><p><span class="stt">\end{someEnvironment}</span></p></td></tr></table></p><p>the someMacro command may actually expect three arguments, in
which case it will consume the \end token, but leave the
{someEnvironment} token in the stream. This will result in a badly
broken TeX program, which will most likely throw an error complaining that the
environment \begin{someEnvironment} is not properly closed. The
error may however occur in a completely different location, and may easily
cause a cascade of errors (the missing \end{someEnvironment} may
cause later TeX commands to be interpreted in a different way, causing them to
misinterpret their arguments, which in turn may cause further errors. The end
result is a series of mysterious error messages somewhat unrelated to the
initial problem.</p><p>This problem with TeX macros can be summed up as follows: the number of tokens
following a TeX macro invocation that will be consumed by the macro is
unbounded, and cannot be easily guessed by looking at the raw source code,
despite the presence of programmer-friendly looking syntactic hints, like
wrapping arguments with {&#8230;}.</p><p><div class="SIntrapara">We argue that the expansion model for type expanders is less prone to this
class of problems, for several reasons:
</div><div class="SIntrapara"><ul><li><p>Firstly, macros can only consume outer forms if they appear as the
leftmost leaf of the outer form, i.e. while the <span class="RktSym">F</span> macro in the
expression</p><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">F</span><span class="hspace">&nbsp;</span><span class="RktPn">. </span><span class="RktSym">args&#8321;</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">. </span><span class="RktSym">args&#8322;</span><span class="RktPn">)</span></p></blockquote><p>may access the <span class="RktSym">args&#8322;</span> arguments, it will be constrained within the
<span class="RktPn">(</span><span class="RktSym">F</span><span class="stt"> </span><span class="RktPn">. </span><span class="RktSym">args&#8321;</span><span class="RktPn">)</span> in the following code:</p><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym">H</span><span class="hspace">&nbsp;</span><span class="RktSym">leading-args&#8322;</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">F</span><span class="hspace">&nbsp;</span><span class="RktPn">. </span><span class="RktSym">args&#8321;</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">. </span><span class="RktSym">more-args&#8322;</span><span class="RktPn">)</span></p></blockquote><p>The first case occurs much more rarely than the second, so is less likely to
happen</p></li><li><p>Secondly, all TeX macros will consume an arbitrary number of arguments
in a linear fashion until the end of the enclosing group or a paragraph
separation. In contrast, most type expanders will consume all the arguments
within their enclosing application form, and no more. &ldquo;Curried&rdquo; type
expanders, which expand to a lone macro identifier, will likely only represent
a small subset of all type expanders. For comparison, consider the following
TeX code:</p><p><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">\CommandOne{argA}\CommandTwo{argB}</span></p></td></tr></table></p><p>The \CommandOne TeX macro might consume zero, one, two three or
more arguments. If it consumes zero arguments, {argA} will not be
interpreted as an argument, but instead will represent a scoped expression,
similar to <span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._let%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">let</a></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktSym">argA</span><span class="RktPn">)</span>. If \CommandOne consumes two or
more arguments, \CommandTwo will be passed as an argument,
unevaluated, and may be discarded or applied to other arguments than the
seemingly obvious {argB} argument. The TeX code above could
therefore be equivalent to any the following Racket programs:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">CommandOne</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._let%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">let</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">argA</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">CommandTwo</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._let%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">let</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">argB</span><span class="RktPn">)</span></td></tr></table></blockquote><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">CommandOne</span><span class="hspace">&nbsp;</span><span class="RktSym">argA</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">CommandTwo</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._let%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">let</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">argB</span><span class="RktPn">)</span></td></tr></table></blockquote><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">CommandOne</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._let%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">let</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">argA</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">CommandTwo</span><span class="hspace">&nbsp;</span><span class="RktSym">argB</span><span class="RktPn">)</span></td></tr></table></blockquote><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">CommandOne</span><span class="hspace">&nbsp;</span><span class="RktSym">argA</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">CommandTwo</span><span class="hspace">&nbsp;</span><span class="RktSym">argB</span><span class="RktPn">)</span></td></tr></table></blockquote><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">CommandOne</span><span class="hspace">&nbsp;</span><span class="RktSym">argA</span><span class="hspace">&nbsp;</span><span class="RktSym">CommandTwo</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._let%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">let</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">argB</span><span class="RktPn">)</span></td></tr></table></blockquote><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym">CommandOne</span><span class="hspace">&nbsp;</span><span class="RktSym">argA</span><span class="hspace">&nbsp;</span><span class="RktSym">CommandTwo</span><span class="hspace">&nbsp;</span><span class="RktSym">argB</span><span class="RktPn">)</span></p></blockquote><p>In contrast, the obvious interpretation at a first glance of the TeX program
would be written as follows in Racket:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">CommandOne</span><span class="hspace">&nbsp;</span><span class="RktSym">argA</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">CommandTwo</span><span class="hspace">&nbsp;</span><span class="RktSym">argB</span><span class="RktPn">)</span></td></tr></table></blockquote><p>If these appear as &ldquo;arguments&rdquo; of a larger expression, then their meaning
is unambiguous (unless the larger expression is itself a macro):</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=generic-numbers.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._%252B%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">CommandOne</span><span class="hspace">&nbsp;</span><span class="RktSym">argA</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">CommandTwo</span><span class="hspace">&nbsp;</span><span class="RktSym">argB</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p>If however the <span class="RktPn">(</span><span class="RktSym">CommandOne</span><span class="stt"> </span><span class="RktSym">argA</span><span class="RktPn">)</span> is the first element in its form,
then, if it is a curried macro, it may consume the the
<span class="RktPn">(</span><span class="RktSym">CommandTwo</span><span class="stt"> </span><span class="RktSym">argB</span><span class="RktPn">)</span> form too:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">CommandOne</span><span class="hspace">&nbsp;</span><span class="RktSym">argA</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">CommandTwo</span><span class="hspace">&nbsp;</span><span class="RktSym">argB</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p>As stated earlier, this case will likely be less common, and it is clearer
that the intent of the programmer to pass <span class="RktPn">(</span><span class="RktSym">CommandTwo</span><span class="stt"> </span><span class="RktSym">argB</span><span class="RktPn">)</span> as
arguments to the result of <span class="RktPn">(</span><span class="RktSym">CommandOne</span><span class="stt"> </span><span class="RktSym">argA</span><span class="RktPn">)</span>, either as a macro
application or as a regular run-time function application.</p></li><li><p>Finally, Racket macros (and type expanders) usually perform a somewhat
thorough check of their arguments, using <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Parsing_Syntax.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._syntax-parse%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">syntax-parse</a></span> or
<span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._syntax-case%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">syntax-case</a></span> patterns. Arguments to macros and type expanders which do
not have the correct shape will trigger an error early, thereby limiting the
risk of causing errors in cascade.</p></li></ul></div></p><h5 x-source-module="(lib &quot;type-expander/scribblings/type-expander-implementation.scrbl&quot;)" x-source-pkg="type-expander" x-part-tag="&quot;Interactions_between_type_expanders_and_scopes&quot;">1.2.2<tt>&nbsp;</tt><a name="(part._.Interactions_between_type_expanders_and_scopes)"></a>Interactions between type expanders and scopes</h5><p>Our expansion model for type expanders therefore allows a type expander to
escape the scope in which it was defined before it is actually expanded. For
example, the following type:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._.Let%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">Let</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">A</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=type-ref.html%23%2528form._%2528%2528lib._typed-racket%252Fbase-env%252Fbase-types..rkt%2529._.Number%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">Number</a></span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._.Let%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">Let</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">F</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._%7Ece%7E9b%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">&#923;</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">self</span><span class="hspace">&nbsp;</span><span class="RktSym">T</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktRdr">#`</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=type-ref.html%23%2528form._%2528%2528lib._typed-racket%252Fbase-env%252Fbase-types..rkt%2529._.Pairof%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">Pairof</a></span><span class="hspace">&nbsp;</span><span class="RktRdr">#,</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stxops.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._datum-%7E3esyntax%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">datum-&gt;syntax</a></span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktSym">self</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">A</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">T</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._.Let%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">Let</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">A</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=type-ref.html%23%2528form._%2528%2528lib._typed-racket%252Fbase-env%252Fbase-types..rkt%2529._.String%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">String</a></span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">F</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktSym">A</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p>first expands to:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">F</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktSym">A</span><span class="RktPn">)</span></td></tr></table></blockquote><p>and then expands to:</p><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=type-ref.html%23%2528form._%2528%2528lib._typed-racket%252Fbase-env%252Fbase-types..rkt%2529._.Pairof%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">Pairof</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=type-ref.html%23%2528form._%2528%2528lib._typed-racket%252Fbase-env%252Fbase-types..rkt%2529._.String%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">String</a></span><span class="hspace">&nbsp;</span><span class="RktSym">A</span><span class="RktPn">)</span></p></blockquote><p>and finally expands to:</p><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=type-ref.html%23%2528form._%2528%2528lib._typed-racket%252Fbase-env%252Fbase-types..rkt%2529._.Pairof%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">Pairof</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=type-ref.html%23%2528form._%2528%2528lib._typed-racket%252Fbase-env%252Fbase-types..rkt%2529._.String%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">String</a></span><span class="hspace">&nbsp;</span><span class="RktSym">A</span><span class="RktPn">)</span></p></blockquote><p>Effectively, <span class="RktSym">F</span> captures the scope where its name appears (inside all
three <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._.Let%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">Let</a></span> forms), but is expanded in a different context (outside of
the two innermost <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._.Let%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">Let</a></span> forms).</p><p>Using Matthew Flatt&rsquo;s notation to indicate the scopes present on an
identifier, we can more explicitly show the expansion steps:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._.Let%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">Let</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">A</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=type-ref.html%23%2528form._%2528%2528lib._typed-racket%252Fbase-env%252Fbase-types..rkt%2529._.Number%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">Number</a></span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._.Let%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">Let</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">F</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._%7Ece%7E9b%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">&#923;</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">self</span><span class="hspace">&nbsp;</span><span class="RktSym">T</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktRdr">#`</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=type-ref.html%23%2528form._%2528%2528lib._typed-racket%252Fbase-env%252Fbase-types..rkt%2529._.Pairof%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">Pairof</a></span><span class="hspace">&nbsp;</span><span class="RktRdr">#,</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stxops.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._datum-%7E3esyntax%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">datum-&gt;syntax</a></span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktSym">self</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">A</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">T</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._.Let%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">Let</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">A</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=type-ref.html%23%2528form._%2528%2528lib._typed-racket%252Fbase-env%252Fbase-types..rkt%2529._.String%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">String</a></span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">F</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktSym">A</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p>The first <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._.Let%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">Let</a></span> form annotates the identifier it binds with a fresh
scope, numbered <span class="RktVal">1</span> here, and adds this scope to all identifiers within
its body. It stores the binding in the <span class="RktPn">(</span><span class="RktSym">tl-redirections</span><span class="RktPn">)</span> binding
table, as shown by the comment above the code</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktCmt">;</span><span class="RktCmt">A&#185;   := Number</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">Let&#185;</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">F&#185;</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">&#923;&#185;</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">self&#185;</span><span class="hspace">&nbsp;</span><span class="RktSym">T&#185;</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktRdr">#`</span><span class="RktPn">(</span><span class="RktSym">Pairof&#185;</span><span class="hspace">&nbsp;</span><span class="RktRdr">#,</span><span class="RktPn">(</span><span class="RktSym">datum-&gt;syntax&#185;</span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktSym">self&#185;</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">A&#185;</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">T&#185;</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Let&#185;</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">A&#185;</span><span class="hspace">&nbsp;</span><span class="RktSym">String&#185;</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">F&#185;</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktSym">A&#185;</span><span class="RktPn">)</span></td></tr></table></blockquote><p>The second <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._.Let%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">Let</a></span> form then binds the <span class="RktSym">F</span> identifier, adding a
fresh scope as before:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktCmt">;</span><span class="RktCmt">A&#185;   := Number</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">F&#185;&#178;  := (&#923;&#185; (self&#185; T&#185;)</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">            #`(Pairof&#185; #,(datum-&gt;syntax&#185; #'self&#185; 'A&#185;)</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">                       T&#185;))</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">Let&#185;&#178;</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">A&#185;&#178;</span><span class="hspace">&nbsp;</span><span class="RktSym">String&#185;&#178;</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">F&#185;&#178;</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktSym">A&#185;</span><span class="RktPn">)</span></td></tr></table></blockquote><p>The third <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._.Let%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">Let</a></span> form then binds <span class="RktSym">A</span> within its body, leaving the
outer <span class="RktSym">A</span> unchanged:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktCmt">;</span><span class="RktCmt">A&#185;   := Number</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">F&#185;&#178;  := (&#923;&#185; (self&#185; T&#185;)</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">            #`(Pairof&#185; #,(datum-&gt;syntax&#185; #'self&#185; 'A&#185;)</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">                       T&#185;))</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">A&#185;&#178;&#179; := String&#185;&#178;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">F&#185;&#178;&#179;</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktSym">A&#185;</span><span class="RktPn">)</span></td></tr></table></blockquote><p>The <span class="RktSym">F&#185;&#178;&#179;</span> macro is then expanded, passing as an argument the syntax
object <span class="RktRdr">#'</span><span class="RktPn">(</span><span class="RktSym">F&#185;&#178;&#179;</span><span class="stt"> </span><span class="RktSym">A&#185;</span><span class="RktPn">)</span>. A fresh scope is added to the identifiers
generated by the macro, in order to enforce macro hygiene. The <span class="RktSym">A&#185;</span>
identifier is passed as an input to the macro, so it is left unchanged, and
<span class="RktSym">A&#185;&#178;&#179;</span> is derived from <span class="RktSym">F&#185;&#178;&#179;</span>, via <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stxops.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._datum-%7E3esyntax%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">datum-&gt;syntax</a></span>, and
therefore has the same scopes (<span class="RktSym">F&#185;&#178;&#179;</span> is also a macro input, so it is
not tagged with the fresh scope). The <span class="RktSym">Pairof&#185;</span> identifier, generated by
the macro, is however flagged with the fresh scope <span class="RktVal">4</span>. The result of
the application of <span class="RktSym">F</span> to this syntax object is:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktCmt">;</span><span class="RktCmt">A&#185;   := Number</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">F&#185;&#178;  := (&#923;&#185; (self&#185; T&#185;)</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">            #`(Pairof&#185; #,(datum-&gt;syntax&#185; #'self&#185; 'A&#185;)</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">                       T&#185;))</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">A&#185;&#178;&#179; := String&#185;&#178;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">Pairof&#185;&#8308;</span><span class="hspace">&nbsp;</span><span class="RktSym">A&#185;&#178;&#179;</span><span class="hspace">&nbsp;</span><span class="RktSym">A&#185;</span><span class="RktPn">)</span></td></tr></table></blockquote><p>The <span class="RktSym">Pairof&#185;&#8308;</span> type is resolved to the primitive type constructor
<span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=type-ref.html%23%2528form._%2528%2528lib._typed-racket%252Fbase-env%252Fbase-types..rkt%2529._.Pairof%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">Pairof</a></span>:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktCmt">;</span><span class="RktCmt">A&#185;   := Number</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">F&#185;&#178;  := (&#923;&#185; (self&#185; T&#185;)</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">            #`(Pairof&#185; #,(datum-&gt;syntax&#185; #'self&#185; 'A&#185;)</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">                       T&#185;))</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">A&#185;&#178;&#179; := String&#185;&#178;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=type-ref.html%23%2528form._%2528%2528lib._typed-racket%252Fbase-env%252Fbase-types..rkt%2529._.Pairof%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">Pairof</a></span><span class="hspace">&nbsp;</span><span class="RktSym">A&#185;&#178;&#179;</span><span class="hspace">&nbsp;</span><span class="RktSym">A&#185;</span><span class="RktPn">)</span></td></tr></table></blockquote><p>The type <span class="RktSym">A&#185;&#178;&#179;</span> is then resolved to <span class="RktSym">String&#185;&#178;</span>, which in turn is
resolved to the <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=type-ref.html%23%2528form._%2528%2528lib._typed-racket%252Fbase-env%252Fbase-types..rkt%2529._.String%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">String</a></span> built-in type:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktCmt">;</span><span class="RktCmt">A&#185;   := Number</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">F&#185;&#178;  := (&#923;&#185; (self&#185; T&#185;)</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">            #`(Pairof&#185; #,(datum-&gt;syntax&#185; #'self&#185; 'A&#185;)</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">                       T&#185;))</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">A&#185;&#178;&#179; := String&#185;&#178;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=type-ref.html%23%2528form._%2528%2528lib._typed-racket%252Fbase-env%252Fbase-types..rkt%2529._.Pairof%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">Pairof</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=type-ref.html%23%2528form._%2528%2528lib._typed-racket%252Fbase-env%252Fbase-types..rkt%2529._.String%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">String</a></span><span class="hspace">&nbsp;</span><span class="RktSym">A&#185;</span><span class="RktPn">)</span></td></tr></table></blockquote><p>And the type <span class="RktSym">A&#185;</span> is resolved to <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=type-ref.html%23%2528form._%2528%2528lib._typed-racket%252Fbase-env%252Fbase-types..rkt%2529._.Number%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">Number</a></span>:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktCmt">;</span><span class="RktCmt">A&#185;   := Number</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">F&#185;&#178;  := (&#923;&#185; (self&#185; T&#185;)</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">            #`(Pairof&#185; #,(datum-&gt;syntax&#185; #'self&#185; 'A&#185;)</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">                       T&#185;))</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">A&#185;&#178;&#179; := String&#185;&#178;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=type-ref.html%23%2528form._%2528%2528lib._typed-racket%252Fbase-env%252Fbase-types..rkt%2529._.Pairof%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">Pairof</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=type-ref.html%23%2528form._%2528%2528lib._typed-racket%252Fbase-env%252Fbase-types..rkt%2529._.String%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">String</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=type-ref.html%23%2528form._%2528%2528lib._typed-racket%252Fbase-env%252Fbase-types..rkt%2529._.Number%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">Number</a></span><span class="RktPn">)</span></td></tr></table></blockquote><p>The <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stxtrans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._syntax-local-value%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">syntax-local-value</a></span> function does not support querying the
transformer binding of identifiers outside of the lexical scope in which they
are bound. In our case, however, we need to access the transformer binding of
<span class="RktSym">F&#185;&#178;&#179;</span> outside of the scope of the <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._.Let%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">Let</a></span> binding it, and
similarly for <span class="RktSym">A&#185;&#178;&#179;</span>.</p><h4 x-source-module="(lib &quot;type-expander/scribblings/type-expander-implementation.scrbl&quot;)" x-source-pkg="type-expander" x-part-tag="&quot;The_prop_type-expander_structure_type_property&quot;">1.3<tt>&nbsp;</tt><a name="(part._.The_prop_type-expander_structure_type_property)"></a>The <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528def._%2528%2528submod._%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._expander%2529._prop%7E3atype-expander%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">prop:type-expander</a></span> structure type property</h4><p>Type expanders are identified by the <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528def._%2528%2528submod._%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._expander%2529._prop%7E3atype-expander%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">prop:type-expander</a></span>
<a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=structprops.html%23%2528tech._structure._type._property%2529&amp;version=8.6" class="techoutside Sq" data-pltdoc="x"><span class="techinside">structure type
property</span></a>. Structure type properties allow the same identifier to act as a
rename transformer, a match expander and a type expander, for example. Such an
identifier would have to implement the <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stxtrans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._prop%7E3arename-transformer%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">prop:rename-transformer</a></span>,
<span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=match.html%23%2528def._%2528%2528lib._racket%252Fmatch..rkt%2529._prop%7E3amatch-expander%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">prop:match-expander</a></span> and <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528def._%2528%2528submod._%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._expander%2529._prop%7E3atype-expander%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">prop:type-expander</a></span> properties, respectively.</p><p><div class="SIntrapara"><a name="(elem._(prefixable._chunk~3a~3cprop~3atype-expander~3e~3a1~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28prefixable._chunk~3a~3cprop~3atype-expander~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;prop:type-expander&#187;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528quote._%7E23%7E25kernel%2529._define-values%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define-values</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528def._%2528%2528submod._%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._expander%2529._prop%7E3atype-expander%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">prop:type-expander</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">has-prop:type-expander?</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">get-prop:type-expander-value</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=structprops.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._make-struct-type-property%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">make-struct-type-property</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">type-expander</span><span class="hspace">&nbsp;</span><span class="RktSym">prop-guard</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><p>The value of the <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528def._%2528%2528submod._%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._expander%2529._prop%7E3atype-expander%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">prop:type-expander</a></span> property should either be a
transformer procedure of one or two arguments which will be called when
expanding the type, or the index of a field containing such a procedure.</p><p><div class="SIntrapara"><a name="(elem._(prefixable._chunk~3a~3cprop-guard~3e~3a1~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28prefixable._chunk~3a~3cprop-guard~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;prop-guard&#187;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._define%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">prop-guard</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="hspace">&nbsp;</span><span class="RktSym">struct-type-info-list</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=if.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fletstx-scheme..rkt%2529._cond%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">cond</a></span><span class="hspace">&nbsp;</span><a href="#%28elem._%28prefixable._chunk~3a~3cprop-guard-field-index~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;prop-guard-field-index&#187;</a></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28elem._%28prefixable._chunk~3a~3cprop-guard-procedure~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;prop-guard-procedure&#187;</a></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28elem._%28prefixable._chunk~3a~3cprop-guard-else-error~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;prop-guard-else-error&#187;</a><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><p>If the value is a field index, it should be within bounds. The
<span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=creatingmorestructs.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._make-struct-field-accessor%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">make-struct-field-accessor</a></span> function performs this check, and also returns
an accessor. The accessor expects an instance of the struct, and returns the
field&rsquo;s value.</p><p><div class="SIntrapara"><a name="(elem._(prefixable._chunk~3a~3cprop-guard-field-index~3e~3a1~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28prefixable._chunk~3a~3cprop-guard-field-index~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;prop-guard-field-index&#187;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=number-types.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._exact-nonnegative-integer%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">exact-nonnegative-integer?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._let%252A%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">let*</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">make-struct-accessor</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._cadddr%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">cadddr</a></span><span class="hspace">&nbsp;</span><span class="RktSym">struct-type-info-list</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">accessor</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=creatingmorestructs.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._make-struct-field-accessor%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">make-struct-field-accessor</a></span><span class="hspace">&nbsp;</span><span class="RktSym">make-struct-accessor</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._%7Ece%7Ebb%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">&#955;</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">instance</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._let%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">let</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">type-expander</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">accessor</span><span class="hspace">&nbsp;</span><span class="RktSym">instance</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28elem._%28prefixable._chunk~3a~3cprop-guard-field-value~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;prop-guard-field-value&#187;</a><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr></table></blockquote></div></p><p>The expander procedure will take one argument: the piece of syntax
corresponding to the use of the expander. If the property&rsquo;s value is a
procedure, we therefore check that its arity includes 1.</p><p><div class="SIntrapara"><a name="(elem._(prefixable._chunk~3a~3cprop-guard-field-value~3e~3a1~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28prefixable._chunk~3a~3cprop-guard-field-value~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;prop-guard-field-value&#187;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=if.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fletstx-scheme..rkt%2529._cond%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=if.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fletstx-scheme..rkt%2529._and%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">and</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=procedures.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._procedure%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">procedure?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">type-expander</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=procedures.html%23%2528def._%2528%2528lib._racket%252Ffunction..rkt%2529._arity-includes%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">arity-includes?</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=procedures.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._procedure-arity%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">procedure-arity</a></span><span class="hspace">&nbsp;</span><span class="RktSym">type-expander</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=procedures.html%23%2528def._%2528%2528lib._racket%252Ffunction..rkt%2529._curry%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">curry</a></span><span class="hspace">&nbsp;</span><span class="RktSym">type-expander</span><span class="hspace">&nbsp;</span><span class="RktSym">instance</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=if.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fletstx-scheme..rkt%2529._and%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">and</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=procedures.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._procedure%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">procedure?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">type-expander</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=procedures.html%23%2528def._%2528%2528lib._racket%252Ffunction..rkt%2529._arity-includes%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">arity-includes?</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=procedures.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._procedure-arity%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">procedure-arity</a></span><span class="hspace">&nbsp;</span><span class="RktSym">type-expander</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktSym">type-expander</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=if.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fletstx-scheme..rkt%2529._else%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">else</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=exns.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._raise-argument-error%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">raise-argument-error</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">prop:type-expander-guard</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528lib._racket%252Fformat..rkt%2529._%7E7ea%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">~a</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"the value of the "</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="hspace">&nbsp;</span><span class="RktVal">"-th field should"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">" be a procedure whose arity includes 1 or"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">" 2"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">type-expander</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><p>In the first case, when the property value is a field index, we return an
accessor function. The accessor function expects a struct instance, performs
some checks and returns the actual type expander procedure.</p><p>When the property&rsquo;s value is directly a type expander procedure, we follow the
same convention. We therefore return a function which, given a struct
instance, returns the type expander procedure (ignoring the <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529.__%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">_</a></span>
argument).</p><p><div class="SIntrapara"><a name="(elem._(prefixable._chunk~3a~3cprop-guard-procedure~3e~3a1~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28prefixable._chunk~3a~3cprop-guard-procedure~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;prop-guard-procedure&#187;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=procedures.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._procedure%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">procedure?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=if.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fletstx-scheme..rkt%2529._cond%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=procedures.html%23%2528def._%2528%2528lib._racket%252Ffunction..rkt%2529._arity-includes%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">arity-includes?</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=procedures.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._procedure-arity%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">procedure-arity</a></span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._%7Ece%7Ebb%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">&#955;</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">s</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=procedures.html%23%2528def._%2528%2528lib._racket%252Ffunction..rkt%2529._curry%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">curry</a></span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=procedures.html%23%2528def._%2528%2528lib._racket%252Ffunction..rkt%2529._arity-includes%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">arity-includes?</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=procedures.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._procedure-arity%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">procedure-arity</a></span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._%7Ece%7Ebb%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">&#955;</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529.__%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">_</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=if.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fletstx-scheme..rkt%2529._else%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">else</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=exns.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._raise-argument-error%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">raise-argument-error</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">prop:type-expander-guard</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">"a procedure whose arity includes 1 or 2"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">val</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr></table></blockquote></div></p><p>When the value of the <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528def._%2528%2528submod._%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._expander%2529._prop%7E3atype-expander%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">prop:type-expander</a></span> property is neither a
positive field index nor a procedure, an error is raised:</p><p><div class="SIntrapara"><a name="(elem._(prefixable._chunk~3a~3cprop-guard-else-error~3e~3a1~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28prefixable._chunk~3a~3cprop-guard-else-error~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;prop-guard-else-error&#187;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">[</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=if.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fletstx-scheme..rkt%2529._else%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">else</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=exns.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._raise-argument-error%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">raise-argument-error</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVal">'</span><span class="RktVal">prop:type-expander-guard</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528lib._racket%252Fformat..rkt%2529._%7E7ea%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">~a</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"a procedure whose arity includes 1 or 2, or an exact "</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">"non-negative integer designating a field index within "</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">"the structure that should contain a procedure whose "</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">"arity includes 1 or 2."</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">val</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr></table></blockquote></div></p><h5 x-source-module="(lib &quot;type-expander/scribblings/type-expander-implementation.scrbl&quot;)" x-source-pkg="type-expander" x-part-tag="&quot;The_type-expander_struct&quot;">1.3.1<tt>&nbsp;</tt><a name="(part._.The_type-expander_struct)"></a>The <span class="RktSym">type-expander</span> struct</h5><p>We make a simple struct that implements <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528def._%2528%2528submod._%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._expander%2529._prop%7E3atype-expander%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">prop:type-expander</a></span> and nothing
else. It has a single field, <span class="RktSym">expander-proc</span>, which contains the type
expander transformer procedure.</p><p><div class="SIntrapara"><a name="(elem._(prefixable._chunk~3a~3ctype-expander-struct~3e~3a1~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28prefixable._chunk~3a~3ctype-expander-struct~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;type-expander-struct&#187;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._struct%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">struct</a></span><span class="hspace">&nbsp;</span><span class="RktSym">type-expander</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">expander-proc</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">#:transparent</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">#:extra-constructor-name</span><span class="hspace">&nbsp;</span><span class="RktSym">make-type-expander</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">#:property</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528def._%2528%2528submod._%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._expander%2529._prop%7E3atype-expander%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">prop:type-expander</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=define-struct.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._struct-field-index%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">struct-field-index</a></span><span class="hspace">&nbsp;</span><span class="RktSym">expander-proc</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><h4 x-source-module="(lib &quot;type-expander/scribblings/type-expander-implementation.scrbl&quot;)" x-source-pkg="type-expander" x-part-tag="&quot;Associating_type_expanders_to_identifiers&quot;">1.4<tt>&nbsp;</tt><a name="(part._.Associating_type_expanders_to_identifiers)"></a>Associating type expanders to identifiers</h4><h5 x-source-module="(lib &quot;type-expander/scribblings/type-expander-implementation.scrbl&quot;)" x-source-pkg="type-expander" x-part-tag="&quot;The_type-expander_syntax_class&quot;">1.4.1<tt>&nbsp;</tt><a name="(part._.The_type-expander_syntax_class)"></a>The <span class="RktSym">type-expander</span> syntax class</h5><p><div class="SIntrapara">The <span class="RktSym">type-expander</span> syntax class recognises identifiers
which are bound to type expanders. These fall into three cases:
</div><div class="SIntrapara"><ul><li><p>The identifier&rsquo;s <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stxtrans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._syntax-local-value%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">syntax-local-value</a></span> is an instance of a struct
implementing <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528def._%2528%2528submod._%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._expander%2529._prop%7E3atype-expander%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">prop:type-expander</a></span></p></li><li><p>The identifier has been bound by a type-level local binding form like
<span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._.Let%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">Let</a></span> or <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=type-ref.html%23%2528form._%2528%2528lib._typed-racket%252Fbase-env%252Fbase-types-extra..rkt%2529._%7Ee2%7E88%7E80%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">&#8704;</a></span>, and therefore are registered in the
<span class="RktPn">(</span><span class="RktSym">tl-redirections</span><span class="RktPn">)</span> binding table.</p></li><li><p>The identifier has been patched via <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._patch-type-expander%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">patch-type-expander</a></span>, i.e.
a type expander has been globally attached to an existing identifier, in which
case the type expander is stored within the <span class="RktSym">patched</span> free identifier
table.</p></li></ul></div></p><p><div class="SIntrapara"><a name="(elem._(prefixable._chunk~3a~3cexpand-type-syntax-classes~3e~3a1~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28prefixable._chunk~3a~3cexpand-type-syntax-classes~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;expand-type-syntax-classes&#187;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-specifying.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._define-syntax-class%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define-syntax-class</a></span><span class="hspace">&nbsp;</span><span class="RktSym">type-expander</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-specifying.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._pattern%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">pattern</a></span><span class="hspace">&nbsp;</span><span class="RktSym">local-expander:id</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:when</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._let%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">let</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">b</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">binding-table-find-best</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">tl-redirections</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktRdr">#'</span><span class="RktSym">local-expander</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=if.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fletstx-scheme..rkt%2529._and%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">and</a></span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">has-prop:type-expander?</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:with</span><span class="hspace">&nbsp;</span><span class="RktSym">code</span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktSym">local-expander</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-specifying.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._pattern%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">pattern</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7evar%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~var</a></span><span class="hspace">&nbsp;</span><span class="RktSym">expander</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Library_Syntax_Classes_and_Literal_Sets.html%23%2528def._%2528%2528lib._syntax%252Fparse..rkt%2529._static%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">static</a></span><span class="hspace">&nbsp;</span><span class="RktSym">has-prop:type-expander?</span><span class="hspace">&nbsp;</span><span class="RktVal">"a type expander"</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:when</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=booleans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._not%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">not</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">binding-table-find-best</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">tl-redirections</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktRdr">#'</span><span class="RktSym">expander</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:with</span><span class="hspace">&nbsp;</span><span class="RktSym">code</span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktSym">expander</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-specifying.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._pattern%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">pattern</a></span><span class="hspace">&nbsp;</span><span class="RktSym">patched-expander:id</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:when</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._let%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">let</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">p</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=syntax-helpers.html%23%2528def._%2528%2528lib._syntax%252Fid-table..rkt%2529._free-id-table-ref%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">free-id-table-ref</a></span><span class="hspace">&nbsp;</span><span class="RktSym">patched</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktRdr">#'</span><span class="RktSym">patched-expander</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=if.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fletstx-scheme..rkt%2529._and%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">and</a></span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">has-prop:type-expander?</span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:when</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=booleans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._not%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">not</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">binding-table-find-best</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">tl-redirections</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktRdr">#'</span><span class="RktSym">expander</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:with</span><span class="hspace">&nbsp;</span><span class="RktSym">code</span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktSym">patched-expander</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><p>We also define a syntax class which matches types. Since types can bear many
complex cases, and can call type expanders which may accept arbitrary syntax,
we simply define the <span class="RktSym">type</span> syntax class as <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Library_Syntax_Classes_and_Literal_Sets.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._expr%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">expr</a></span>. Invalid syntax will
be eventually caught while expanding the type, and doing a thorough check
before any processing would only make the type expander slower, with little
actual benefits. The <span class="RktSym">type</span> syntax class is however used in syntax patterns
as a form of documentation, to clarify the distinction between types and
run-time or compile-time expressions.</p><p><div class="SIntrapara"><a name="(elem._(prefixable._chunk~3a~3ctype-syntax-class~3e~3a1~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28prefixable._chunk~3a~3ctype-syntax-class~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;type-syntax-class&#187;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-specifying.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._define-syntax-class%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define-syntax-class</a></span><span class="hspace">&nbsp;</span><span class="RktSym">type</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-specifying.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._pattern%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">pattern</a></span><span class="hspace">&nbsp;</span><span class="RktSym">:expr</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><p><div class="SIntrapara"><a name="(elem._(prefixable._chunk~3a~3ctype-contract~3e~3a1~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28prefixable._chunk~3a~3ctype-contract~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;type-contract&#187;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._define%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">stx-type/c</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stxops.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._syntax%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">syntax?</a></span><span class="RktPn">)</span></p></blockquote></div></p><p>Finally, we define a convenience syntax class which expands the matched type:</p><p><div class="SIntrapara"><a name="(elem._(prefixable._chunk~3a~3ctype-expand-syntax-class~3e~3a1~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28prefixable._chunk~3a~3ctype-expand-syntax-class~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;type-expand-syntax-class&#187;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-specifying.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._define-syntax-class%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define-syntax-class</a></span><span class="hspace">&nbsp;</span><span class="RktSym">type-expand!</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">#:attributes</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">expanded</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-specifying.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._pattern%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">pattern</a></span><span class="hspace">&nbsp;</span><span class="RktSym">t:expr</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:with</span><span class="hspace">&nbsp;</span><span class="RktSym">expanded</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528def._%2528%2528submod._%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._expander%2529._expand-type%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">expand-type</a></span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktSym">t</span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><h5 x-source-module="(lib &quot;type-expander/scribblings/type-expander-implementation.scrbl&quot;)" x-source-pkg="type-expander" x-part-tag="&quot;Calling_type_expanders&quot;">1.4.2<tt>&nbsp;</tt><a name="(part._.Calling_type_expanders)"></a>Calling type expanders</h5><p>The <span class="RktSym">apply-type-expander</span> function applies the syntax expander transformer
function associated to <span class="RktSym">type-expander-id</span>. It passes <span class="RktSym">stx</span> as the single
argument to the transformer function. Usually, <span class="RktSym">stx</span> will be the syntax
used to call the type expander, like <span class="RktRdr">#'</span><span class="RktPn">(</span><span class="RktSym">te</span><span class="stt"> </span><span class="RktSym">arg</span><span class="stt"> </span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktPn">)</span> or just <span class="RktRdr">#'</span><span class="RktSym">te</span> if
the type expander is not in the first position of a form.</p><p>The identifier <span class="RktSym">type-expander-id</span> should be bound to a type expander, in
one of the three possible ways described above.</p><p><div class="SIntrapara"><a name="(elem._(prefixable._chunk~3a~3capply-type-expander~3e~3a1~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28prefixable._chunk~3a~3capply-type-expander~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;apply-type-expander&#187;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=attaching-contracts-to-values.html%23%2528form._%2528%2528lib._racket%252Fcontract%252Fregion..rkt%2529._define%252Fcontract%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define/contract</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">apply-type-expander</span><span class="hspace">&nbsp;</span><span class="RktSym">type-expander-id</span><span class="hspace">&nbsp;</span><span class="RktSym">stx</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=type-ref.html%23%2528form._%2528%2528lib._typed-racket%252Fbase-env%252Fbase-types-extra..rkt%2529._-%7E3e%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stxops.html%23%2528def._%2528%2528lib._racket%252Fprivate%252Fstx..rkt%2529._identifier%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">identifier?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stxops.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._syntax%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">syntax?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stxops.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._syntax%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">syntax?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._let%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">let</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">val</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=if.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fletstx-scheme..rkt%2529._or%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">or</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">binding-table-find-best</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">tl-redirections</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">type-expander-id</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._let%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">let</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">slv</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stxtrans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._syntax-local-value%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">syntax-local-value</a></span><span class="hspace">&nbsp;</span><span class="RktSym">type-expander-id</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._%7Ece%7Ebb%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">&#955;</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=if.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fletstx-scheme..rkt%2529._and%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">and</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">has-prop:type-expander?</span><span class="hspace">&nbsp;</span><span class="RktSym">slv</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">slv</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=syntax-helpers.html%23%2528def._%2528%2528lib._syntax%252Fid-table..rkt%2529._free-id-table-ref%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">free-id-table-ref</a></span><span class="hspace">&nbsp;</span><span class="RktSym">patched</span><span class="hspace">&nbsp;</span><span class="RktSym">type-expander-id</span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">ctxx</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stxtrans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._make-syntax-introducer%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">make-syntax-introducer</a></span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28elem._%28prefixable._chunk~3a~3capply-type-expander-checks~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;apply-type-expander-checks&#187;</a></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ctxx</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">get-prop:type-expander-value</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">val</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ctxx</span><span class="hspace">&nbsp;</span><span class="RktSym">stx</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><p>The <span class="RktSym">apply-type-expander</span> function checks that its
<span class="RktSym">type-expander-id</span> argument is indeed a type expander before attempting
to apply it:</p><p><div class="SIntrapara"><a name="(elem._(prefixable._chunk~3a~3capply-type-expander-checks~3e~3a1~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28prefixable._chunk~3a~3capply-type-expander-checks~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;apply-type-expander-checks&#187;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=when_unless.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fletstx-scheme..rkt%2529._unless%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">unless</a></span><span class="hspace">&nbsp;</span><span class="RktSym">val</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=exns.html%23%2528def._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._raise-syntax-error%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">raise-syntax-error</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">apply-type-expander</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=Writing.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._format%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">format</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"Can't apply ~a, it is not a type expander"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">type-expander-id</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">stx</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">type-expander-id</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><h5 x-source-module="(lib &quot;type-expander/scribblings/type-expander-implementation.scrbl&quot;)" x-source-pkg="type-expander" x-part-tag="&quot;Associating_type_expanders_to_already_existing_identifiers&quot;">1.4.3<tt>&nbsp;</tt><a name="(part._.Associating_type_expanders_to_already_existing_identifiers)"></a>Associating type expanders to already existing identifiers</h5><p>As explained above, existing identifiers which are provided by other libraries
can be &ldquo;patched&rdquo; so that they behave like type expanders, using a global
table associating existing identifiers to the corresponding expander code:</p><p><div class="SIntrapara"><a name="(elem._(prefixable._chunk~3a~3cpatched~3e~3a1~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28prefixable._chunk~3a~3cpatched~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;patched&#187;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._define%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">patched</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=syntax-helpers.html%23%2528def._%2528%2528lib._syntax%252Fid-table..rkt%2529._make-free-id-table%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">make-free-id-table</a></span><span class="RktPn">)</span><span class="RktPn">)</span></p></blockquote></div></p><p><div class="SIntrapara"><a name="(elem._(prefixable._chunk~3a~3cpatch~3e~3a1~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28prefixable._chunk~3a~3cpatch~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;patch&#187;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define-syntax%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define-syntax</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._patch-type-expander%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">patch-type-expander</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Parsing_Syntax.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._syntax-parser%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">syntax-parser</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529.__%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">_</a></span><span class="hspace">&nbsp;</span><span class="RktSym">id:id</span><span class="hspace">&nbsp;</span><span class="RktSym">expander-expr:expr</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktRdr">#`</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=begin.html%23%2528form._%2528%2528quote._%7E23%7E25kernel%2529._begin%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">begin</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=begin.html%23%2528form._%2528%2528quote._%7E23%7E25kernel%2529._begin-for-syntax%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">begin-for-syntax</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=syntax-helpers.html%23%2528def._%2528%2528lib._syntax%252Fid-table..rkt%2529._free-id-table-set%2521%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">free-id-table-set!</a></span><span class="hspace">&nbsp;</span><span class="RktSym">patched</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktRdr">#'</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Library_Syntax_Classes_and_Literal_Sets.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._id%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">id</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">type-expander</span><span class="hspace">&nbsp;</span><span class="RktRdr">#,</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._syntax%252Floc%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">syntax/loc</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-specifying.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._this-syntax%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">this-syntax</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">expander-expr</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><h5 x-source-module="(lib &quot;type-expander/scribblings/type-expander-implementation.scrbl&quot;)" x-source-pkg="type-expander" x-part-tag="&quot;Defining_new_type_expanders&quot;">1.4.4<tt>&nbsp;</tt><a name="(part._.Defining_new_type_expanders)"></a>Defining new type expanders</h5><p>The <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._define-type-expander%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define-type-expander</a></span> macro binds <span class="RktVar">name</span> to a
type expander which uses <span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._%7Ece%7Ebb%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">&#955;</a></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktVar">arg</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktPn">. </span><span class="RktVar">body</span><span class="RktPn">)</span> as the
transformer procedure. To achieve this, we create a
transformer binding (with <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define-syntax%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define-syntax</a></span>), from
<span class="RktVar">name</span> to an instance of the <span class="RktSym">type-expander</span>
structure.</p><p><div class="SIntrapara"><a name="(elem._(prefixable._chunk~3a~3cdefine-type-expander~3e~3a1~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28prefixable._chunk~3a~3cdefine-type-expander~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;define-type-expander&#187;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define-syntax%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define-syntax</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._define-type-expander%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define-type-expander</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Parsing_Syntax.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._syntax-parser%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">syntax-parser</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529.__%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">_</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">name:id</span><span class="hspace">&nbsp;</span><span class="RktSym">arg:id</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">. </span><span class="RktSym">body</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktRdr">#`</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define-syntax%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define-syntax</a></span><span class="hspace">&nbsp;</span><span class="RktSym">name</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">type-expander</span><span class="hspace">&nbsp;</span><span class="RktRdr">#,</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._syntax%252Floc%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">syntax/loc</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-specifying.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._this-syntax%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">this-syntax</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._%7Ece%7Ebb%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">&#955;</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">arg</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">. </span><span class="RktSym">body</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529.__%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">_</a></span><span class="hspace">&nbsp;</span><span class="RktSym">name:id</span><span class="hspace">&nbsp;</span><span class="RktSym">fn:expr</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktRdr">#`</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define-syntax%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define-syntax</a></span><span class="hspace">&nbsp;</span><span class="RktSym">name</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">type-expander</span><span class="hspace">&nbsp;</span><span class="RktRdr">#,</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._syntax%252Floc%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">syntax/loc</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-specifying.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._this-syntax%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">this-syntax</a></span><span class="hspace">&nbsp;</span><span class="RktSym">fn</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><h5 x-source-module="(lib &quot;type-expander/scribblings/type-expander-implementation.scrbl&quot;)" x-source-pkg="type-expander" x-part-tag="&quot;shadow&quot;">1.4.5<tt>&nbsp;</tt><a name="(part._shadow)"></a>Locally binding type expanders</h5><p>Some features of the type expander need to locally bind new type expanders:</p><ul><li><p>The <span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._.Let%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">Let</a></span><span class="RktPn">. </span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktVar">id</span><span class="stt"> </span><span class="RktVar">expr</span><span class="RktPn">]</span><span class="stt"> </span><span class="RktSym">&#8230;</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktPn">. </span><span class="RktVar">body</span><span class="RktPn">)</span><span class="RktPn">)</span> special form binds the
identifiers <span class="RktVar">id</span><span class="stt"> </span><span class="RktSym">&#8230;</span> to the type expanders <span class="RktVar">expr</span><span class="stt"> </span><span class="RktSym">&#8230;</span> in its
<span class="RktVar">body</span>.</p></li><li><p>When expanding the body of a <span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=type-ref.html%23%2528form._%2528%2528lib._typed-racket%252Fbase-env%252Fbase-types-extra..rkt%2529._%7Ee2%7E88%7E80%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">&#8704;</a></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym">T&#7522;</span><span class="stt"> </span><span class="RktSym">&#8230;</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktSym">body</span><span class="RktPn">)</span> form, the
<span class="RktSym">T&#7522;</span> bound by the <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=type-ref.html%23%2528form._%2528%2528lib._typed-racket%252Fbase-env%252Fbase-types-extra..rkt%2529._%7Ee2%7E88%7E80%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">&#8704;</a></span> may shadow some type expanders with the
same name. If the <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=type-ref.html%23%2528form._%2528%2528lib._typed-racket%252Fbase-env%252Fbase-types-extra..rkt%2529._%7Ee2%7E88%7E80%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">&#8704;</a></span> form is directly applied to arguments, each
<span class="RktSym">T&#7522;</span> is instead bound to the corresponding argument.</p></li><li><p>When expanding the body of a <span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=type-ref.html%23%2528form._%2528%2528lib._typed-racket%252Fbase-env%252Fbase-types-extra..rkt%2529._.Rec%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">Rec</a></span><span class="stt"> </span><span class="RktSym">T</span><span class="stt"> </span><span class="RktSym">body</span><span class="RktPn">)</span> form, the <span class="RktSym">T</span>
bound by the <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=type-ref.html%23%2528form._%2528%2528lib._typed-racket%252Fbase-env%252Fbase-types-extra..rkt%2529._.Rec%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">Rec</a></span> may shadow a type expander with the same name.</p></li></ul><p>We use <span class="RktSym">with-bindings</span> (defined in another file) to achieve this. The
code</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">with-bindings</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktVar">bound-ids</span><span class="hspace">&nbsp;</span><span class="RktVar">transformer-values</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVar">rebind-stx</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">transformer-body</span><span class="RktPn">)</span></td></tr></table></blockquote><p>evaluates <span class="RktVar">transformer-body</span> in the transformer environment. It
creates a fresh scope, which it applies to the <span class="RktVar">bound-ids</span> and the
<span class="RktVar">rebind-stx</span>. It associates each modified <span class="RktVar">bound-id</span> with the
corresponding <span class="RktVar">transformer-value</span> in the <span class="RktPn">(</span><span class="RktSym">tl-redirections</span><span class="RktPn">)</span>
binding table. The <span class="RktSym">with-bindings</span> form does not mutate the syntax
objects, instead it shadows the syntax pattern variables mentioned in
<span class="RktVar">bound-ids</span> and <span class="RktVar">rebind-stx</span> with versions pointing to the
same syntax objects, but with the fresh scope flipped on them.</p><p>The code</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">with-rec-bindings</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktVar">bound-ids</span><span class="hspace">&nbsp;</span><span class="RktVar">generate-transformer-values</span><span class="hspace">&nbsp;</span><span class="RktVar">rhs</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVar">rebind-stx</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">transformer-body</span><span class="RktPn">)</span></td></tr></table></blockquote><p>works in the same way, but it also flips the fresh scope on each element of
<span class="RktVar">rhs</span>. The <span class="RktVar">generate-transformer-values</span> is expected to be a
transformer expression which, given an element of <span class="RktVar">rhs</span> with the
flipped scope, produces the transformer value to bind to the corresponding
<span class="RktVar">bound-id</span>.</p><p><div class="SIntrapara">The implementation of <span class="RktSym">with-bindings</span> unfortunately does not play well
with <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stxtrans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._syntax-local-value%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">syntax-local-value</a></span>, so the binding table has to be queried
directly instead of using <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stxtrans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._syntax-local-value%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">syntax-local-value</a></span>. To our knowledge, the
only ways to make new bindings recognised by <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stxtrans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._syntax-local-value%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">syntax-local-value</a></span> are:
</div><div class="SIntrapara"><ul><li><p>To expand to a <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define-syntax%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define-syntax</a></span> form, followed with a macro
performing the remaining work</p></li><li><p>Equivalently, to expand to a <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=let.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fletstx-scheme..rkt%2529._let-syntax%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">let-syntax</a></span> form, whose body is a
macro performing the remaining work</p></li><li><p>To call <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stxtrans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._local-expand%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">local-expand</a></span> with an internal definition context which
contains the desired bindings</p></li><li><p>To explicitly call <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stxtrans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._syntax-local-value%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">syntax-local-value</a></span> with an internal
definition context argument</p></li></ul></div></p><p>It is not practical in our case to use the first solution involving
<span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define-syntax%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define-syntax</a></span>, as the type expander may be called while expanding an
expression (e.g. <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._ann%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">ann</a></span>). The next two solutions assume that
<span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stxtrans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._syntax-local-value%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">syntax-local-value</a></span> will be called in a well-scoped fashion (in the
sense of the official expander): in the second solution,
<span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stxtrans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._syntax-local-value%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">syntax-local-value</a></span> must be called by expansion-time code located
within the scope of the <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=let.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fletstx-scheme..rkt%2529._let-syntax%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">let-syntax</a></span> form, and in the third solution,
<span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stxtrans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._syntax-local-value%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">syntax-local-value</a></span> must be called within the dynamic extent of
<span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stxtrans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._local-expand%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">local-expand</a></span>. The last solution works, but requires that the user
explicitly passes the appropriate internal definition context.</p><p>The second and third solutions cannot be applied in our case, because type
expanders can be expanded outside of the scope in which they were defined and
used, as explained the
<a href="#%28part._.Interactions_between_type_expanders_and_scopes%29" data-pltdoc="x">Interactions between type expanders and scopes</a> section.</p><p>The current version of the type expander does not support a reliable
alternative to <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stxtrans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._syntax-local-value%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">syntax-local-value</a></span> which takes into account local
binding forms for types (<span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._.Let%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">Let</a></span>, <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=type-ref.html%23%2528form._%2528%2528lib._typed-racket%252Fbase-env%252Fbase-types-extra..rkt%2529._%7Ee2%7E88%7E80%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">&#8704;</a></span> and <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=type-ref.html%23%2528form._%2528%2528lib._typed-racket%252Fbase-env%252Fbase-types-extra..rkt%2529._.Rec%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">Rec</a></span>), but one
could be implemented, either by using some tricks to make the first solution
work, or by providing an equivalent to <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stxtrans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._syntax-local-value%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">syntax-local-value</a></span> which
consults the <span class="RktPn">(</span><span class="RktSym">tl-redirections</span><span class="RktPn">)</span> binding table.</p><h4 x-source-module="(lib &quot;type-expander/scribblings/type-expander-implementation.scrbl&quot;)" x-source-pkg="type-expander" x-part-tag="&quot;Expanding_types&quot;">1.5<tt>&nbsp;</tt><a name="(part._.Expanding_types)"></a>Expanding types</h4><p>The <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528def._%2528%2528submod._%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._expander%2529._expand-type%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">expand-type</a></span> function fully expands the type
<span class="RktSym">stx</span>. As explained in
<a href="#%28part._shadow%29" data-pltdoc="x">Locally binding type expanders</a>, shadowing would be better handled using
scopes. The <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528def._%2528%2528submod._%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._expander%2529._expand-type%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">expand-type</a></span> function starts by defining
some syntax classes, then parses <span class="RktSym">stx</span>, which can fall in
many different cases.</p><p><div class="SIntrapara"><a name="(elem._(prefixable._chunk~3a~3cexpand-type~3e~3a1~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28prefixable._chunk~3a~3cexpand-type~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;expand-type&#187;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._define%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528def._%2528%2528submod._%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._expander%2529._expand-type%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">expand-type</a></span><span class="hspace">&nbsp;</span><span class="RktSym">stx</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">applicable?</span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">start-tl-redirections</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><a href="#%28elem._%28prefixable._chunk~3a~3cexpand-type-syntax-classes~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;expand-type-syntax-classes&#187;</a></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._define%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">expand-type-process</span><span class="hspace">&nbsp;</span><span class="RktSym">stx</span><span class="hspace">&nbsp;</span><span class="RktSym">first-pass?</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28elem._%28prefixable._chunk~3a~3cexpand-type-debug-before~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;expand-type-debug-before&#187;</a></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._%7Ece%7Ebb%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">&#955;</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">result</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><a href="#%28elem._%28prefixable._chunk~3a~3cexpand-type-debug-after~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;expand-type-debug-after&#187;</a><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=parameters.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fmore-scheme..rkt%2529._parameterize%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">parameterize</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><a href="#%28elem._%28prefixable._chunk~3a~3cexpand-type-debug-indent~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;expand-type-debug-indent&#187;</a><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28elem._%28prefixable._chunk~3a~3cexpand-type-debug-rules~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;expand-type-debug-rules&#187;</a></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Parsing_Syntax.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._syntax-parse%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">syntax-parse</a></span><span class="hspace">&nbsp;</span><span class="RktSym">stx</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28elem._%28prefixable._chunk~3a~3cexpand-type-case-~3a~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;expand-type-case-:&#187;</a></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28elem._%28prefixable._chunk~3a~3cexpand-type-case-expander~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;expand-type-case-expander&#187;</a></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28elem._%28prefixable._chunk~3a~3cexpand-type-case-~e2~88~80-later~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;expand-type-case-&#8704;-later&#187;</a></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28elem._%28prefixable._chunk~3a~3cexpand-type-case-~ce~9b-later~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;expand-type-case-&#923;-later&#187;</a></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28elem._%28prefixable._chunk~3a~3cexpand-type-case-app-expander~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;expand-type-case-app-expander&#187;</a></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28elem._%28prefixable._chunk~3a~3cexpand-type-case-~e2~88~80-through~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;expand-type-case-&#8704;-through&#187;</a></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28elem._%28prefixable._chunk~3a~3cexpand-type-case-.Rec~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;expand-type-case-Rec&#187;</a></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28elem._%28prefixable._chunk~3a~3cexpand-type-case-app-~ce~9b~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;expand-type-case-app-&#923;&#187;</a></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28elem._%28prefixable._chunk~3a~3cexpand-type-case-just-~ce~9b%2Fnot-applicable~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;expand-type-case-just-&#923;/not-applicable&#187;</a></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28elem._%28prefixable._chunk~3a~3cexpand-type-case-~e2~88~80-app~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;expand-type-case-&#8704;-app&#187;</a></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28elem._%28prefixable._chunk~3a~3cexpand-type-case-.Let~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;expand-type-case-Let&#187;</a></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28elem._%28prefixable._chunk~3a~3cexpand-type-case-.Letrec~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;expand-type-case-Letrec&#187;</a></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28elem._%28prefixable._chunk~3a~3cexpand-type-case-noexpand~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;expand-type-case-noexpand&#187;</a></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">Must be after other special application cases</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28elem._%28prefixable._chunk~3a~3cexpand-type-case-app-other~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;expand-type-case-app-other&#187;</a></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28elem._%28prefixable._chunk~3a~3cexpand-type-case-app-fallback~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;expand-type-case-app-fallback&#187;</a></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28elem._%28prefixable._chunk~3a~3cexpand-type-case-fallback-.T~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;expand-type-case-fallback-T&#187;</a><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">expand-type-process</span><span class="hspace">&nbsp;</span><span class="RktSym">stx</span><span class="hspace">&nbsp;</span><span class="RktVal">#t</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><h5 x-source-module="(lib &quot;type-expander/scribblings/type-expander-implementation.scrbl&quot;)" x-source-pkg="type-expander" x-part-tag="&quot;Cases_handled_by_expand-type&quot;">1.5.1<tt>&nbsp;</tt><a name="(part._.Cases_handled_by_expand-type)"></a>Cases handled by <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528def._%2528%2528submod._%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._expander%2529._expand-type%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">expand-type</a></span></h5><p>The cases described below which expand a use of a type expander re-expand the
result, by calling <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528def._%2528%2528submod._%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._expander%2529._expand-type%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">expand-type</a></span> once more. This process is repeated until
no more expansion can be performed. This allows type expanders to produce
calls to other type expanders, exactly like macros can produce calls to other
macros.</p><p>We distinguish the expansion of types which will appear as the first element
of their parent form from types which will appear in other places. When the
<span class="RktSym">applicable?</span> argument to <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528def._%2528%2528submod._%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._expander%2529._expand-type%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">expand-type</a></span> is <span class="RktVal">#true</span>, it
indicates that the current type, once expanded, will occur as the first
element of its enclosing form. If the expanded type is the name of a type
expander, or a <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=type-ref.html%23%2528form._%2528%2528lib._typed-racket%252Fbase-env%252Fbase-types-extra..rkt%2529._%7Ee2%7E88%7E80%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">&#8704;</a></span> or <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._%7Ece%7E9b%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">&#923;</a></span> form, it will be directly applied to
the given arguments by the type expander. When <span class="RktSym">applicable?</span> is
<span class="RktVal">#false</span>, it indicates that the current type, once expanded, will
<span class="emph">not</span> appear as the first element of its enclosing form (it will appear
in another position, or it is at the top of the syntax tree representing the
type).</p><p>When <span class="RktSym">applicable?</span> is <span class="RktVal">#true</span>, if the type is the name of a type
expander, or a <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=type-ref.html%23%2528form._%2528%2528lib._typed-racket%252Fbase-env%252Fbase-types-extra..rkt%2529._%7Ee2%7E88%7E80%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">&#8704;</a></span> or <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._%7Ece%7E9b%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">&#923;</a></span> form, it is not expanded immediately.
Instead, the outer form will expand it with the arguments. Otherwise, these
forms are expanded without arguments, like
<a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=guide&amp;rel=pattern-macros.html%23%2528tech._identifier._macro%2529&amp;version=8.6" class="techoutside Sq" data-pltdoc="x"><span class="techinside">identifier macros</span></a> would be.</p><h5 x-source-module="(lib &quot;type-expander/scribblings/type-expander-implementation.scrbl&quot;)" x-source-pkg="type-expander" x-part-tag="&quot;Applying_type_expanders&quot;">1.5.2<tt>&nbsp;</tt><a name="(part._.Applying_type_expanders)"></a>Applying type expanders</h5><p>When a type expander is found in a non-applicable position, it is called,
passing the identifier itself to the expander. An
<a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=guide&amp;rel=pattern-macros.html%23%2528tech._identifier._macro%2529&amp;version=8.6" class="techoutside Sq" data-pltdoc="x"><span class="techinside">identifier macro</span></a> would be
called in the same way.</p><p><div class="SIntrapara"><a name="(elem._(prefixable._chunk~3a~3cexpand-type-case-expander~3e~3a1~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28prefixable._chunk~3a~3cexpand-type-case-expander~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;expand-type-case-expander&#187;<span style="vertical-align: sub; font-size: 80%">1</span></a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">[</span><span class="RktSym">expander:type-expander</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">#:when</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=booleans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._not%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">not</a></span><span class="hspace">&nbsp;</span><span class="RktSym">applicable?</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">rule</span><span class="hspace">&nbsp;</span><span class="RktSym">id-expander/not-applicable</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._let%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">let</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">ctxx</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stxtrans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._make-syntax-introducer%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">make-syntax-introducer</a></span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528def._%2528%2528submod._%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._expander%2529._expand-type%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">expand-type</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ctxx</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">apply-type-expander</span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktSym">expander.code</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ctxx</span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktSym">expander</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">applicable?</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr></table></blockquote></div></p><p>When a type expander is found in an applicable position, it is returned
without modification, so that the containing application form may expand it
with arguments. When the expander <span class="RktSym">e</span> appears as <span class="RktPn">(</span><span class="RktSym">e</span><span class="stt"> </span><span class="RktPn">. </span><span class="RktSym">args</span><span class="RktPn">)</span>,
it is applicable. It is also applicable when it appears as
<span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._.Let%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">Let</a></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym">bindings&#8230;</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktSym">e</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktPn">. </span><span class="RktSym">args</span><span class="RktPn">)</span>, for example, because <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._.Let%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">Let</a></span>
propagates its <span class="RktSym">applicable?</span> status.</p><p><div class="SIntrapara"><a name="(elem._(prefixable._chunk~3a~3cexpand-type-case-expander~3e~3a2~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28prefixable._chunk~3a~3cexpand-type-case-expander~3e~3a2~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;expand-type-case-expander&#187;<span style="vertical-align: sub; font-size: 80%">2</span></a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">[</span><span class="RktSym">expander:type-expander</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">#:when</span><span class="hspace">&nbsp;</span><span class="RktSym">applicable?</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">rule</span><span class="hspace">&nbsp;</span><span class="RktSym">id-expander/applicable</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktRdr">#'</span><span class="RktSym">expander</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr></table></blockquote></div></p><p>When a form contains a type expander in its first element, the type expander
is called. The result is re-expanded, so that a type expander can expand to a
use of another type expander.</p><p><div class="SIntrapara"><a name="(elem._(prefixable._chunk~3a~3cexpand-type-case-app-expander~3e~3a1~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28prefixable._chunk~3a~3cexpand-type-case-app-expander~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;expand-type-case-app-expander&#187;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eand%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~and</a></span><span class="hspace">&nbsp;</span><span class="RktSym">expander-call-stx</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">expander:type-expander</span><span class="hspace">&nbsp;</span><span class="RktPn">. </span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529.__%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">_</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">rule</span><span class="hspace">&nbsp;</span><span class="RktSym">app-expander</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._let%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">let</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">ctxx</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stxtrans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._make-syntax-introducer%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">make-syntax-introducer</a></span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528def._%2528%2528submod._%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._expander%2529._expand-type%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">expand-type</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ctxx</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">apply-type-expander</span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktSym">expander.code</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ctxx</span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktSym">expander-call-stx</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">applicable?</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr></table></blockquote></div></p><p>When a form of the shape <span class="RktPn">(</span><span class="RktVar">f</span><span class="stt"> </span><span class="RktPn">. </span><span class="RktVar">args</span><span class="RktPn">)</span> is encountered, and the
<span class="RktVar">f</span> element is not a type expander, the <span class="RktVar">f</span> form is expanded,
and the whole form (with <span class="RktVar">f</span> replaced by its expansion) is expanded a
second time. The <span class="RktSym">applicable?</span> parameter is set to <span class="RktVal">#true</span> while
expanding <span class="RktVar">f</span>, so that if <span class="RktVar">f</span> produces a type expander (e.g.
<span class="RktVar">f</span> has the shape <span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._.Let%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">Let</a></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym">&#8230;</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktVar">some-type-expander</span><span class="RktPn">)</span>), the type
expander can be applied to the <span class="RktVar">args</span> arguments.</p><p><div class="SIntrapara"><a name="(elem._(prefixable._chunk~3a~3cexpand-type-case-app-other~3e~3a1~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28prefixable._chunk~3a~3cexpand-type-case-app-other~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;expand-type-case-app-other&#187;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eand%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~and</a></span><span class="hspace">&nbsp;</span><span class="RktSym">whole</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">f</span><span class="hspace">&nbsp;</span><span class="RktPn">. </span><span class="RktSym">args</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">#:when</span><span class="hspace">&nbsp;</span><span class="RktSym">first-pass?</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">rule</span><span class="hspace">&nbsp;</span><span class="RktSym">app-other</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">expand-type-process</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stxops.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._datum-%7E3esyntax%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">datum-&gt;syntax</a></span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktSym">whole</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._cons%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">cons</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528def._%2528%2528submod._%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._expander%2529._expand-type%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">expand-type</a></span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktSym">f</span><span class="hspace">&nbsp;</span><span class="RktVal">#true</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktSym">args</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktRdr">#'</span><span class="RktSym">whole</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktRdr">#'</span><span class="RktSym">whole</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr></table></blockquote></div></p><h5 x-source-module="(lib &quot;type-expander/scribblings/type-expander-implementation.scrbl&quot;)" x-source-pkg="type-expander" x-part-tag="&quot;Polymorphic_types_with_&quot;">1.5.2.1<tt>&nbsp;</tt><a name="(part._.Polymorphic_types_with_~e2~88~80)"></a>Polymorphic types with <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=type-ref.html%23%2528form._%2528%2528lib._typed-racket%252Fbase-env%252Fbase-types-extra..rkt%2529._%7Ee2%7E88%7E80%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">&#8704;</a></span></h5><p>When the <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=type-ref.html%23%2528form._%2528%2528lib._typed-racket%252Fbase-env%252Fbase-types-extra..rkt%2529._%7Ee2%7E88%7E80%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">&#8704;</a></span> or <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=type-ref.html%23%2528form._%2528%2528lib._typed-racket%252Fbase-env%252Fbase-types-extra..rkt%2529._.All%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">All</a></span> special forms from <a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=index.html&amp;version=8.6" class="RktModLink Sq" data-pltdoc="x"><span class="RktSym">typed/racket</span></a>
are used, the bound type variables may shadow some type expanders. The type
expanders used in the body <span class="RktSym">T</span> which have the same identifier as a bound
variable will be affected by this (they will not act as a type-expander
anymore). The body of the <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=type-ref.html%23%2528form._%2528%2528lib._typed-racket%252Fbase-env%252Fbase-types-extra..rkt%2529._%7Ee2%7E88%7E80%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">&#8704;</a></span> or <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=type-ref.html%23%2528form._%2528%2528lib._typed-racket%252Fbase-env%252Fbase-types-extra..rkt%2529._.All%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">All</a></span> form is expanded with the
modified environment. The result is wrapped again with
<span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=type-ref.html%23%2528form._%2528%2528lib._typed-racket%252Fbase-env%252Fbase-types-extra..rkt%2529._%7Ee2%7E88%7E80%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">&#8704;</a></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym">TVar</span><span class="stt"> </span><span class="RktSym">&#8230;</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktSym">expanded-T</span><span class="RktPn">)</span>, in order to conserve the behaviour from
<a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=index.html&amp;version=8.6" class="RktModLink Sq" data-pltdoc="x"><span class="RktSym">typed/racket</span></a>&rsquo;s <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=type-ref.html%23%2528form._%2528%2528lib._typed-racket%252Fbase-env%252Fbase-types-extra..rkt%2529._%7Ee2%7E88%7E80%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">&#8704;</a></span>.</p><p><div class="SIntrapara"><a name="(elem._(prefixable._chunk~3a~3cexpand-type-case-~e2~88~80-through~3e~3a1~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28prefixable._chunk~3a~3cexpand-type-case-~e2~88~80-through~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;expand-type-case-&#8704;-through&#187;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktPn">{</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eand%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~and</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=type-ref.html%23%2528form._%2528%2528lib._typed-racket%252Fbase-env%252Fbase-types-extra..rkt%2529._%7Ee2%7E88%7E80%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">&#8704;</a></span><span class="hspace">&nbsp;</span><span class="RktPn">{</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eliteral%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~literal</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=type-ref.html%23%2528form._%2528%2528lib._typed-racket%252Fbase-env%252Fbase-types-extra..rkt%2529._%7Ee2%7E88%7E80%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">&#8704;</a></span><span class="RktPn">}</span><span class="RktPn">}</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">tvar:id</span><span class="hspace">&nbsp;</span><span class="RktSym">&#8230;</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">T:type</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">#:when</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=booleans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._not%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">not</a></span><span class="hspace">&nbsp;</span><span class="RktSym">applicable?</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">rule</span><span class="hspace">&nbsp;</span><span class="RktSym">just-&#8704;/not-applicable</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._with-syntax%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">with-syntax</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym">tvar-vars-only</span><span class="hspace">&nbsp;</span><span class="RktSym">&#8230;</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">remove-ddd</span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktPn">(</span><span class="RktSym">tvar</span><span class="hspace">&nbsp;</span><span class="RktSym">&#8230;</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">with-bindings</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym">tvar-vars-only</span><span class="hspace">&nbsp;</span><span class="RktSym">&#8230;</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=syntax-helpers.html%23%2528def._%2528%2528lib._syntax%252Fstx..rkt%2529._stx-map%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">stx-map</a></span><span class="hspace">&nbsp;</span><a href="#%28elem._%28prefixable._chunk~3a~3cshadowed~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;shadowed&#187;</a></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktRdr">#'</span><span class="RktPn">(</span><span class="RktSym">tvar-vars-only</span><span class="hspace">&nbsp;</span><span class="RktSym">&#8230;</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">T</span><span class="hspace">&nbsp;</span><span class="RktSym">tvar</span><span class="hspace">&nbsp;</span><span class="RktSym">&#8230;</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktRdr">#`</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=type-ref.html%23%2528form._%2528%2528lib._typed-racket%252Fbase-env%252Fbase-types-extra..rkt%2529._%7Ee2%7E88%7E80%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">&#8704;</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">tvar</span><span class="hspace">&nbsp;</span><span class="RktSym">&#8230;</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktRdr">#,</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528def._%2528%2528submod._%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._expander%2529._expand-type%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">expand-type</a></span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktSym">T</span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr></table></blockquote></div></p><p>Where <a href="#%28elem._%28prefixable._chunk~3a~3cshadowed~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;shadowed&#187;</a> is used to bind the type variables <span class="RktSym">tvar&#7522;</span> to
<span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">No-Expand</span></span></span><span class="stt"> </span><span class="RktSym">tvar&#7522;</span><span class="RktPn">)</span>, so that their occurrences are left intact by the
type expander:</p><p><div class="SIntrapara"><a name="(elem._(prefixable._chunk~3a~3cshadowed~3e~3a1~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28prefixable._chunk~3a~3cshadowed~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;shadowed&#187;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._%7Ece%7Ebb%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">&#955;</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktVar">_&#964;</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-type-expander</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._%7Ece%7Ebb%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">&#955;</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">stx</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._syntax-case%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">syntax-case</a></span><span class="hspace">&nbsp;</span><span class="RktSym">stx</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">self</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stxops.html%23%2528def._%2528%2528lib._racket%252Fprivate%252Fstx..rkt%2529._identifier%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">identifier?</a></span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktSym">self</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">No-Expand</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym">self</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym">self</span><span class="hspace">&nbsp;</span><span class="RktPn">. </span><span class="RktSym">args</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">No-Expand</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym">self</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">. </span><span class="RktSym">args</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><p>When a <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=type-ref.html%23%2528form._%2528%2528lib._typed-racket%252Fbase-env%252Fbase-types-extra..rkt%2529._%7Ee2%7E88%7E80%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">&#8704;</a></span> polymorphic type is found in an applicable position, it is
returned without modification, so that the containing application form may
expand it, binding the type parameters to their effective arguments.</p><p><div class="SIntrapara"><a name="(elem._(prefixable._chunk~3a~3cexpand-type-case-~e2~88~80-later~3e~3a1~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28prefixable._chunk~3a~3cexpand-type-case-~e2~88~80-later~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;expand-type-case-&#8704;-later&#187;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eand%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~and</a></span><span class="hspace">&nbsp;</span><span class="RktSym">whole</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">{</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eliteral%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~literal</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=type-ref.html%23%2528form._%2528%2528lib._typed-racket%252Fbase-env%252Fbase-types-extra..rkt%2529._%7Ee2%7E88%7E80%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">&#8704;</a></span><span class="RktPn">}</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">tvar:id</span><span class="hspace">&nbsp;</span><span class="RktSym">&#8230;</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">T:type</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">#:when</span><span class="hspace">&nbsp;</span><span class="RktSym">applicable?</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">rule</span><span class="hspace">&nbsp;</span><span class="RktSym">just-&#8704;/applicable</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktRdr">#'</span><span class="RktSym">whole</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr></table></blockquote></div></p><p>When a <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=type-ref.html%23%2528form._%2528%2528lib._typed-racket%252Fbase-env%252Fbase-types-extra..rkt%2529._%7Ee2%7E88%7E80%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">&#8704;</a></span> polymorphic type is immediately applied to arguments, the
type expander attempts to bind the type parameters to the effective arguments.
It currently lacks any support for types under ellipses, and therefore that
case is currently handled by the <a href="#%28elem._%28prefixable._chunk~3a~3cexpand-type-case-app-fallback~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;expand-type-case-app-fallback&#187;</a> case
described later.</p><p><div class="SIntrapara"><a name="(elem._(prefixable._chunk~3a~3cexpand-type-case-~e2~88~80-app~3e~3a1~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28prefixable._chunk~3a~3cexpand-type-case-~e2~88~80-app~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;expand-type-case-&#8704;-app&#187;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktPn">{</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eliteral%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~literal</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=type-ref.html%23%2528form._%2528%2528lib._typed-racket%252Fbase-env%252Fbase-types-extra..rkt%2529._%7Ee2%7E88%7E80%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">&#8704;</a></span><span class="RktPn">}</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">{</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eand%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~and</a></span><span class="hspace">&nbsp;</span><span class="RktSym">tvar:id</span><span class="hspace">&nbsp;</span><span class="RktPn">{</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7enot%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~not</a></span><span class="hspace">&nbsp;</span><span class="RktPn">{</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eliteral%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~literal</a></span><span class="hspace">&nbsp;</span><span class="RktSym">&#8230;</span><span class="RktPn">}</span><span class="RktPn">}</span><span class="RktPn">}</span><span class="hspace">&nbsp;</span><span class="RktSym">&#8230;</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">&#964;</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">arg</span><span class="hspace">&nbsp;</span><span class="RktSym">&#8230;</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=when_unless.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fletstx-scheme..rkt%2529._unless%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">unless</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=generic-numbers.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._%7E3d%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">=</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._length%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">length</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stxops.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._syntax-%7E3elist%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">syntax-&gt;list</a></span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktPn">(</span><span class="RktSym">tvar</span><span class="hspace">&nbsp;</span><span class="RktSym">&#8230;</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._length%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">length</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stxops.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._syntax-%7E3elist%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">syntax-&gt;list</a></span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktPn">(</span><span class="RktSym">arg</span><span class="hspace">&nbsp;</span><span class="RktSym">&#8230;</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><a href="#%28elem._%28prefixable._chunk~3a~3capp-args-error~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;app-args-error&#187;</a><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">rule</span><span class="hspace">&nbsp;</span><span class="RktSym">app-&#8704;</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">with-bindings</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym">tvar</span><span class="hspace">&nbsp;</span><span class="RktSym">&#8230;</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=syntax-helpers.html%23%2528def._%2528%2528lib._syntax%252Fstx..rkt%2529._stx-map%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">stx-map</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._%7Ece%7Ebb%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">&#955;</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">a</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-type-expander</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._%7Ece%7Ebb%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">&#955;</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529.__%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">_</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktRdr">#'</span><span class="RktPn">(</span><span class="RktSym">arg</span><span class="hspace">&nbsp;</span><span class="RktSym">&#8230;</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">&#964;</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528def._%2528%2528submod._%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._expander%2529._expand-type%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">expand-type</a></span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktSym">&#964;</span><span class="hspace">&nbsp;</span><span class="RktSym">applicable?</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr></table></blockquote></div></p><p>If the given number of arguments does not match the expected number of
arguments, an error is raised immediately:</p><p><div class="SIntrapara"><a name="(elem._(prefixable._chunk~3a~3capp-args-error~3e~3a1~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28prefixable._chunk~3a~3capp-args-error~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;app-args-error&#187;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=exns.html%23%2528def._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._raise-syntax-error%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">raise-syntax-error</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">type-expander</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=Writing.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._format%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">format</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string-append%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">string-append</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"Wrong number of arguments to "</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">"polymorphic type: ~a\n"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">"</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktVal">expected: ~a\n"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">"</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktVal">given: ~a"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">"</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktVal">arguments were...:\n"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stxops.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._syntax-%7E3edatum%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">syntax-&gt;datum</a></span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktSym">f</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._length%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">length</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stxops.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._syntax-%7E3elist%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">syntax-&gt;list</a></span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktPn">(</span><span class="RktSym">tvar</span><span class="hspace">&nbsp;</span><span class="RktSym">&#8230;</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._length%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">length</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stxops.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._syntax-%7E3elist%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">syntax-&gt;list</a></span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktPn">(</span><span class="RktSym">arg</span><span class="hspace">&nbsp;</span><span class="RktSym">&#8230;</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528lib._racket%252Fstring..rkt%2529._string-join%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">string-join</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=syntax-helpers.html%23%2528def._%2528%2528lib._syntax%252Fstx..rkt%2529._stx-map%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">stx-map</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._%7Ece%7Ebb%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">&#955;</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">a</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=Writing.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._format%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">format</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"~a"</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stxops.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._syntax-%7E3edatum%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">syntax-&gt;datum</a></span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktRdr">#'</span><span class="RktPn">(</span><span class="RktSym">arg</span><span class="hspace">&nbsp;</span><span class="RktSym">&#8230;</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">"\n"</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktSym">whole</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=type-ref.html%23%2528form._%2528%2528lib._typed-racket%252Fbase-env%252Fbase-types-extra..rkt%2529._%7Ee2%7E88%7E80%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">&#8704;</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stxops.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._syntax-%7E3elist%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">syntax-&gt;list</a></span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktPn">(</span><span class="RktSym">arg</span><span class="hspace">&nbsp;</span><span class="RktSym">&#8230;</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><h5 x-source-module="(lib &quot;type-expander/scribblings/type-expander-implementation.scrbl&quot;)" x-source-pkg="type-expander" x-part-tag="&quot;Recursive_types_with_Rec&quot;">1.5.2.2<tt>&nbsp;</tt><a name="(part._.Recursive_types_with_.Rec)"></a>Recursive types with <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=type-ref.html%23%2528form._%2528%2528lib._typed-racket%252Fbase-env%252Fbase-types-extra..rkt%2529._.Rec%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">Rec</a></span></h5><p>Similarly, the <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=type-ref.html%23%2528form._%2528%2528lib._typed-racket%252Fbase-env%252Fbase-types-extra..rkt%2529._.Rec%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">Rec</a></span> special form will cause the bound
variable <span class="RktSym">R</span> to shadow type expanders with the same name,
within the extent of the body <span class="RktSym">T</span>. The result is wrapped
again with <span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=type-ref.html%23%2528form._%2528%2528lib._typed-racket%252Fbase-env%252Fbase-types-extra..rkt%2529._.Rec%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">Rec</a></span><span class="stt"> </span><span class="RktSym">R</span><span class="stt"> </span><span class="RktSym">expanded-T</span><span class="RktPn">)</span>, in order to conserve the
behaviour from <a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=index.html&amp;version=8.6" class="RktModLink Sq" data-pltdoc="x"><span class="RktSym">typed/racket</span></a>&rsquo;s <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=type-ref.html%23%2528form._%2528%2528lib._typed-racket%252Fbase-env%252Fbase-types-extra..rkt%2529._.Rec%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">Rec</a></span>.</p><p><div class="SIntrapara"><a name="(elem._(prefixable._chunk~3a~3cexpand-type-case-.Rec~3e~3a1~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28prefixable._chunk~3a~3cexpand-type-case-.Rec~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;expand-type-case-Rec&#187;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eliteral%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~literal</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=type-ref.html%23%2528form._%2528%2528lib._typed-racket%252Fbase-env%252Fbase-types-extra..rkt%2529._.Rec%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">Rec</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">R:id</span><span class="hspace">&nbsp;</span><span class="RktSym">T:type</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">rule</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=type-ref.html%23%2528form._%2528%2528lib._typed-racket%252Fbase-env%252Fbase-types-extra..rkt%2529._.Rec%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">Rec</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktRdr">#`</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=type-ref.html%23%2528form._%2528%2528lib._typed-racket%252Fbase-env%252Fbase-types-extra..rkt%2529._.Rec%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">Rec</a></span><span class="hspace">&nbsp;</span><span class="RktSym">R</span><span class="hspace">&nbsp;</span><span class="RktRdr">#,</span><span class="RktPn">(</span><span class="RktSym">with-bindings</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">R</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><a href="#%28elem._%28prefixable._chunk~3a~3cshadowed~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;shadowed&#187;</a><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktSym">R</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">T</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528def._%2528%2528submod._%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._expander%2529._expand-type%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">expand-type</a></span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktSym">T</span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr></table></blockquote></div></p><h5 x-source-module="(lib &quot;type-expander/scribblings/type-expander-implementation.scrbl&quot;)" x-source-pkg="type-expander" x-part-tag="&quot;Local_bindings_with_Let_and_Letrec&quot;">1.5.2.3<tt>&nbsp;</tt><a name="(part._.Local_bindings_with_.Let_and_.Letrec)"></a>Local bindings with <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._.Let%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">Let</a></span> and <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._.Letrec%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">Letrec</a></span></h5><p>The <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._.Let%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">Let</a></span> special form binds the given identifiers to the corresponding
type expanders. We use <span class="RktSym">with-bindings</span>, as explained above in
<font class="badlink">(part ("(lib type-expander/type-expander.hl.rkt)" "shadow"))</font>, to bind
the <span class="RktSym">V&#7522;</span><span class="stt"> </span><span class="RktSym">&#8230;</span> identifiers to their corresponding <span class="RktSym">E&#7522;</span> while
expanding <span class="RktSym">T</span>.</p><p><div class="SIntrapara"><a name="(elem._(prefixable._chunk~3a~3cexpand-type-case-.Let~3e~3a1~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28prefixable._chunk~3a~3cexpand-type-case-.Let~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;expand-type-case-Let&#187;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7ecommit%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~commit</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eliteral%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~literal</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._.Let%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">Let</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">V&#7522;:id</span><span class="hspace">&nbsp;</span><span class="RktSym">E&#7522;</span><span class="RktPn">]</span><span class="hspace">&nbsp;</span><span class="RktSym">&#8230;</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">T:type</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">rule</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._.Let%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">Let</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">with-bindings</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym">V&#7522;</span><span class="hspace">&nbsp;</span><span class="RktSym">&#8230;</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=syntax-helpers.html%23%2528def._%2528%2528lib._syntax%252Fstx..rkt%2529._stx-map%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">stx-map</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._%7Ece%7Ebb%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">&#955;</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">E&#7522;</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-type-expander</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._%7Ece%7Ebb%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">&#955;</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">stx</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._syntax-case%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">syntax-case</a></span><span class="hspace">&nbsp;</span><span class="RktSym">stx</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">self</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stxops.html%23%2528def._%2528%2528lib._racket%252Fprivate%252Fstx..rkt%2529._identifier%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">identifier?</a></span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktSym">self</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">E&#7522;</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym">self</span><span class="hspace">&nbsp;</span><span class="RktPn">. </span><span class="RktSym">argz</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktRdr">#`</span><span class="RktPn">(</span><span class="RktRdr">#,</span><span class="RktSym">E&#7522;</span><span class="hspace">&nbsp;</span><span class="RktPn">. </span><span class="RktSym">argz</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktRdr">#'</span><span class="RktPn">(</span><span class="RktSym">E&#7522;</span><span class="hspace">&nbsp;</span><span class="RktSym">&#8230;</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">T</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528def._%2528%2528submod._%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._expander%2529._expand-type%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">expand-type</a></span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktSym">T</span><span class="hspace">&nbsp;</span><span class="RktSym">applicable?</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr></table></blockquote></div></p><p>The <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._.Letrec%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">Letrec</a></span> special form behaves in a similar way, but uses
<span class="RktSym">with-rec-bindings</span>, so that the right-hand-side expressions
<span class="RktSym">E&#7522;</span> appear to be within the scope of all the <span class="RktSym">V&#7522;</span> bindings.</p><p><div class="SIntrapara"><a name="(elem._(prefixable._chunk~3a~3cexpand-type-case-.Letrec~3e~3a1~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28prefixable._chunk~3a~3cexpand-type-case-.Letrec~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;expand-type-case-Letrec&#187;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7ecommit%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~commit</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eliteral%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~literal</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._.Letrec%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">Letrec</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">V&#7522;:id</span><span class="hspace">&nbsp;</span><span class="RktSym">E&#7522;</span><span class="RktPn">]</span><span class="hspace">&nbsp;</span><span class="RktSym">&#8230;</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">T:type</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">rule</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._.Letrec%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">Letrec</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">with-rec-bindings</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym">V&#7522;</span><span class="hspace">&nbsp;</span><span class="RktSym">&#8230;</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._%7Ece%7Ebb%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">&#955;</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">E&#7522;</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-type-expander</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._%7Ece%7Ebb%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">&#955;</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">stx</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._syntax-case%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">syntax-case</a></span><span class="hspace">&nbsp;</span><span class="RktSym">stx</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">self</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stxops.html%23%2528def._%2528%2528lib._racket%252Fprivate%252Fstx..rkt%2529._identifier%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">identifier?</a></span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktSym">self</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">E&#7522;</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym">self</span><span class="hspace">&nbsp;</span><span class="RktPn">. </span><span class="RktSym">args444</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktRdr">#`</span><span class="RktPn">(</span><span class="RktRdr">#,</span><span class="RktSym">E&#7522;</span><span class="hspace">&nbsp;</span><span class="RktPn">. </span><span class="RktSym">args444</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">E&#7522;</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">T</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528def._%2528%2528submod._%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._expander%2529._expand-type%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">expand-type</a></span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktSym">T</span><span class="hspace">&nbsp;</span><span class="RktSym">applicable?</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr></table></blockquote></div></p><h5 x-source-module="(lib &quot;type-expander/scribblings/type-expander-implementation.scrbl&quot;)" x-source-pkg="type-expander" x-part-tag="&quot;Anonymous_types_with__&quot;">1.5.2.4<tt>&nbsp;</tt><a name="(part._.Anonymous_types_with__)"></a>Anonymous types with <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._%7Ece%7E9b%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">&#923;</a></span></h5><p>When an anonymous type expander appears as the first element of its enclosing
form, it is applied to the given arguments. We use the
<span class="RktSym">trampoline-eval</span> function defined in another file, which evaluates the
given quoted transformer expression, while limiting the issues related to
scopes. The &ldquo;official&rdquo; <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=eval.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._eval%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">eval</a></span> function from
<a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=index.html&amp;version=8.6" class="RktModLink Sq" data-pltdoc="x"><span class="RktSym">racket/base</span></a> removes one of the module scopes which are
normally present on the expression to evaluate. In our case, we are evaluating
an anonymous type expander, i.e. a transformer function. When using
<span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=eval.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._eval%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">eval</a></span>, identifiers generated by the transformer function may not have
the expected bindings. The alternative <span class="RktSym">trampoline-eval</span> seems to solve
this problem.</p><p>The <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=auto-syntax-e&amp;rel=index.html%23%2528form._%2528%2528lib._auto-syntax-e%252Fmain..rkt%2529._auto-syntax-case%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">auto-syntax-case</a></span> form is used, so that an anonymous type expander
<span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._%7Ece%7E9b%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">&#923;</a></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529.__%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">_</a></span><span class="stt"> </span><span class="RktSym">a</span><span class="stt"> </span><span class="RktSym">b</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktSym">&#8230;</span><span class="RktPn">)</span> can either use <span class="RktSym">a</span> and <span class="RktSym">b</span> as pattern
variables in quoted syntax objects, or as regular values (i.e
<span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stxops.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._syntax-%7E3edatum%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">syntax-&gt;datum</a></span> is automatically applied on the syntax pattern
variables when they are used outside of syntax templates, instead of throwing
an error).</p><p><div class="SIntrapara"><a name="(elem._(prefixable._chunk~3a~3ceval-anonymous-expander-code~3e~3a1~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28prefixable._chunk~3a~3ceval-anonymous-expander-code~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;eval-anonymous-expander-code&#187;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">trampoline-eval</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._%7Ece%7Ebb%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">&#955;</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">stx</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._define%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">ctxx</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stxtrans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._make-syntax-introducer%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">make-syntax-introducer</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ctxx</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=auto-syntax-e&amp;rel=index.html%23%2528form._%2528%2528lib._auto-syntax-e%252Fmain..rkt%2529._auto-syntax-case%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">auto-syntax-case</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ctxx</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=syntax-helpers.html%23%2528def._%2528%2528lib._syntax%252Fstx..rkt%2529._stx-cdr%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">stx-cdr</a></span><span class="hspace">&nbsp;</span><span class="RktSym">stx</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">formals</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._let%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">let</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">. </span><span class="RktSym">body</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><p>This case works by locally binding a fresh identifier <span class="RktSym">tmp</span> to a type
expander, and then applying that type expander. It would also be possible to
immediately invoke the type expander function.</p><p><div class="SIntrapara"><a name="(elem._(prefixable._chunk~3a~3cexpand-type-case-app-~ce~9b~3e~3a1~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28prefixable._chunk~3a~3cexpand-type-case-app-~ce~9b~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;expand-type-case-app-&#923;&#187;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">[</span><span class="RktPn">{</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eand%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~and</a></span><span class="hspace">&nbsp;</span><span class="RktSym">whole</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktPn">{</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eliteral%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~literal</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._%7Ece%7E9b%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">&#923;</a></span><span class="RktPn">}</span><span class="hspace">&nbsp;</span><span class="RktSym">formals</span><span class="hspace">&nbsp;</span><span class="RktPn">. </span><span class="RktSym">body</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">. </span><span class="RktVar">_args</span><span class="RktPn">)</span><span class="RktPn">}</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">; TODO: use the same code as for the not-applicable case, to avoid &#8800;</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">rule</span><span class="hspace">&nbsp;</span><span class="RktSym">app-&#923;</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=syntax-util.html%23%2528form._%2528%2528lib._racket%252Fsyntax..rkt%2529._with-syntax%252A%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">with-syntax*</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">tmp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=symbols.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._gensym%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">gensym</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">#%&#923;-app-</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">call-stx</span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktPn">(</span><span class="RktSym">tmp</span><span class="hspace">&nbsp;</span><span class="RktPn">. </span><span class="RktSym">whole</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">with-bindings</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">tmp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-type-expander</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28elem._%28prefixable._chunk~3a~3ceval-anonymous-expander-code~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;eval-anonymous-expander-code&#187;</a><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">call-stx</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528def._%2528%2528submod._%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._expander%2529._expand-type%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">expand-type</a></span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktSym">call-stx</span><span class="hspace">&nbsp;</span><span class="RktSym">applicable?</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr></table></blockquote></div></p><p>When a <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._%7Ece%7E9b%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">&#923;</a></span> anonymous type expander appears on its own, in a
non-applicable position, it is expanded like an
<a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=guide&amp;rel=pattern-macros.html%23%2528tech._identifier._macro%2529&amp;version=8.6" class="techoutside Sq" data-pltdoc="x"><span class="techinside">identifier macro</span></a> would
be.</p><p>This case is implemented like the <a href="#%28elem._%28prefixable._chunk~3a~3cexpand-type-case-app-~ce~9b~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;expand-type-case-app-&#923;&#187;</a> case, i.e.
by locally binding a fresh identifier <span class="RktSym">tmp</span> to a type expander, and
then applying that type expander. The difference is that in the
<a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=guide&amp;rel=pattern-macros.html%23%2528tech._identifier._macro%2529&amp;version=8.6" class="techoutside Sq" data-pltdoc="x"><span class="techinside">identifier macro</span></a> case,
the syntax object given as an argument to the type expander contains only the
generated <span class="RktSym">tmp</span> identifier. This allows the type expander to easily
recognise the <a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=guide&amp;rel=pattern-macros.html%23%2528tech._identifier._macro%2529&amp;version=8.6" class="techoutside Sq" data-pltdoc="x"><span class="techinside">identifier
macro</span></a> case, where the whole syntax form is an identifier, from regular
applications, where the whole syntax form is a syntax pair. The whole original
syntax is attached <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._cons%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">cons</a></span>ed onto a syntax property named
<span class="RktVal">'</span><span class="RktVal">original-&#923;-syntax</span>, in (unlikely) case the type expander needs to
access the original <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._%7Ece%7E9b%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">&#923;</a></span> syntax used to call it (this is an experimental
feature, and may change without notice in later versions).</p><p><div class="SIntrapara"><a name="(elem._(prefixable._chunk~3a~3cexpand-type-case-just-~ce~9b/not-applicable~3e~3a1~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28prefixable._chunk~3a~3cexpand-type-case-just-~ce~9b%2Fnot-applicable~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;expand-type-case-just-&#923;/not-applicable&#187;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">[</span><span class="RktPn">{</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eand%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~and</a></span><span class="hspace">&nbsp;</span><span class="RktSym">whole</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">{</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eliteral%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~literal</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._%7Ece%7E9b%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">&#923;</a></span><span class="RktPn">}</span><span class="hspace">&nbsp;</span><span class="RktSym">formals</span><span class="hspace">&nbsp;</span><span class="RktPn">. </span><span class="RktSym">body</span><span class="RktPn">)</span><span class="RktPn">}</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">#:when</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=booleans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._not%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">not</a></span><span class="hspace">&nbsp;</span><span class="RktSym">applicable?</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">rule</span><span class="hspace">&nbsp;</span><span class="RktSym">just-&#923;/not-applicable</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=syntax-util.html%23%2528form._%2528%2528lib._racket%252Fsyntax..rkt%2529._with-syntax%252A%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">with-syntax*</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">tmp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stxprops.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._syntax-property%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">syntax-property</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stxops.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._datum-%7E3esyntax%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">datum-&gt;syntax</a></span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktSym">whole</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=symbols.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._gensym%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">gensym</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">#%&#923;-id-macro-</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktRdr">#'</span><span class="RktSym">whole</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktRdr">#'</span><span class="RktSym">whole</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">'</span><span class="RktVal">original-&#923;-syntax</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._cons%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">cons</a></span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktSym">whole</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=if.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fletstx-scheme..rkt%2529._or%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">or</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stxprops.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._syntax-property%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">syntax-property</a></span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktSym">whole</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">'</span><span class="RktVal">original-&#923;-syntax</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._null%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">null</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">call-stx</span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktPn">(</span><span class="RktSym">tmp</span><span class="hspace">&nbsp;</span><span class="RktPn">. </span><span class="RktSym">tmp</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">with-bindings</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">tmp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-type-expander</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28elem._%28prefixable._chunk~3a~3ceval-anonymous-expander-code~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;eval-anonymous-expander-code&#187;</a><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">call-stx</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">; applicable? should be #f here, otherwise it would have been</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">; caught by other cases.</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528def._%2528%2528submod._%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._expander%2529._expand-type%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">expand-type</a></span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktSym">call-stx</span><span class="hspace">&nbsp;</span><span class="RktSym">applicable?</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr></table></blockquote></div></p><p>When a <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._%7Ece%7E9b%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">&#923;</a></span> anonymous type expander appears on its own, in an applicable
position, it is returned without modification, so that the containing
application form may expand it with arguments (instead of expanding it like an
<a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=guide&amp;rel=pattern-macros.html%23%2528tech._identifier._macro%2529&amp;version=8.6" class="techoutside Sq" data-pltdoc="x"><span class="techinside">identifier macro</span></a> would
be).</p><p><div class="SIntrapara"><a name="(elem._(prefixable._chunk~3a~3cexpand-type-case-~ce~9b-later~3e~3a1~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28prefixable._chunk~3a~3cexpand-type-case-~ce~9b-later~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;expand-type-case-&#923;-later&#187;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eand%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~and</a></span><span class="hspace">&nbsp;</span><span class="RktSym">whole</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">{</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eliteral%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~literal</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._%7Ece%7E9b%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">&#923;</a></span><span class="RktPn">}</span><span class="hspace">&nbsp;</span><span class="RktSym">formals</span><span class="hspace">&nbsp;</span><span class="RktPn">. </span><span class="RktSym">body</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">#:when</span><span class="hspace">&nbsp;</span><span class="RktSym">applicable?</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">rule</span><span class="hspace">&nbsp;</span><span class="RktSym">just-&#923;/applicable</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktRdr">#'</span><span class="RktSym">whole</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr></table></blockquote></div></p><h5 x-source-module="(lib &quot;type-expander/scribblings/type-expander-implementation.scrbl&quot;)" x-source-pkg="type-expander" x-part-tag="&quot;Preventing_the_expansion_of_types_with_No-Expand&quot;">1.5.2.5<tt>&nbsp;</tt><a name="(part._.Preventing_the_expansion_of_types_with_.No-.Expand)"></a>Preventing the expansion of types with <span class="RktSym"><span class="badlink"><span class="RktValLink">No-Expand</span></span></span></h5><p>The <span class="RktSym"><span class="badlink"><span class="RktValLink">No-Expand</span></span></span> special form prevents the type expander from
re-expanding the result. This is useful for example for the implementation of
the fancy <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=quote.html%23%2528form._%2528%2528quote._%7E23%7E25kernel%2529._quote%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">quote</a></span> expander, which relies on the built-in <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=quote.html%23%2528form._%2528%2528quote._%7E23%7E25kernel%2529._quote%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">quote</a></span>
expander. It is also used to implement shadowing: type variables bound by
<span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=type-ref.html%23%2528form._%2528%2528lib._typed-racket%252Fbase-env%252Fbase-types-extra..rkt%2529._%7Ee2%7E88%7E80%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">&#8704;</a></span> in non-applicable positions and type variables bound by
<span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=type-ref.html%23%2528form._%2528%2528lib._typed-racket%252Fbase-env%252Fbase-types-extra..rkt%2529._.Rec%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">Rec</a></span> are re-bound to type expanders returning
<span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">No-Expand</span></span></span><span class="stt"> </span><span class="RktSym">original-tvar</span><span class="RktPn">)</span>.</p><p><div class="SIntrapara"><a name="(elem._(prefixable._chunk~3a~3cexpand-type-case-noexpand~3e~3a1~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28prefixable._chunk~3a~3cexpand-type-case-noexpand~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;expand-type-case-noexpand&#187;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eliteral%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~literal</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">No-Expand</span></span></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">T</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">rule</span><span class="hspace">&nbsp;</span><span class="RktSym">just-No-Expand</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktRdr">#'</span><span class="RktSym">T</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eliteral%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~literal</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">No-Expand</span></span></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">T</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">arg</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">rule</span><span class="hspace">&nbsp;</span><span class="RktSym">app-No-Expand</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktRdr">#`</span><span class="RktPn">(</span><span class="RktSym">T</span><span class="hspace">&nbsp;</span><span class="RktRdr">#,@</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=syntax-helpers.html%23%2528def._%2528%2528lib._syntax%252Fstx..rkt%2529._stx-map%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">stx-map</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._%7Ece%7Ebb%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">&#955;</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">&#964;</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528def._%2528%2528submod._%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._expander%2529._expand-type%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">expand-type</a></span><span class="hspace">&nbsp;</span><span class="RktSym">&#964;</span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktPn">(</span><span class="RktSym">arg</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr></table></blockquote></div></p><h5 x-source-module="(lib &quot;type-expander/scribblings/type-expander-implementation.scrbl&quot;)" x-source-pkg="type-expander" x-part-tag="&quot;The_overloaded___identifier&quot;">1.5.2.6<tt>&nbsp;</tt><a name="(part._.The_overloaded___identifier)"></a>The overloaded <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._%7E3a%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">:</a></span> identifier</h5><p>This case handles the colon identifiers <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._%7E3a%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">:</a></span> (overloaded by this
library) and <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=special-forms.html%23%2528form._%2528%2528lib._typed-racket%252Fbase-env%252Fprims..rkt%2529._%7E3a%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">:</a></span> (provided by <a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=index.html&amp;version=8.6" class="RktModLink Sq" data-pltdoc="x"><span class="RktSym">typed/racket</span></a>). Wherever
the new overloaded <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._%7E3a%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">:</a></span> identifier appears in a type, we want to convert it
back to the original <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=special-forms.html%23%2528form._%2528%2528lib._typed-racket%252Fbase-env%252Fprims..rkt%2529._%7E3a%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">:</a></span> from <a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=index.html&amp;version=8.6" class="RktModLink Sq" data-pltdoc="x"><span class="RktSym">typed/racket</span></a>. The goal is
that a type of the form <span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=type-ref.html%23%2528form._%2528%2528lib._typed-racket%252Fbase-env%252Fbase-types-extra..rkt%2529._%7Ee2%7E86%7E92%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">&#8594;</a></span><span class="stt"> </span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=type-ref.html%23%2528form._%2528%2528lib._typed-racket%252Fbase-env%252Fbase-types..rkt%2529._.Any%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">Any</a></span><span class="stt"> </span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=type-ref.html%23%2528form._%2528%2528lib._typed-racket%252Fbase-env%252Fbase-types..rkt%2529._.Boolean%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">Boolean</a></span><span class="stt"> </span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._%7E3a%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">:</a></span><span class="stt"> </span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=type-ref.html%23%2528form._%2528%2528lib._typed-racket%252Fbase-env%252Fbase-types..rkt%2529._.Integer%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">Integer</a></span><span class="RktPn">)</span>, using the new
<span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._%7E3a%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">:</a></span>, will get translated to <span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=type-ref.html%23%2528form._%2528%2528lib._typed-racket%252Fbase-env%252Fbase-types-extra..rkt%2529._%7Ee2%7E86%7E92%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">&#8594;</a></span><span class="stt"> </span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=type-ref.html%23%2528form._%2528%2528lib._typed-racket%252Fbase-env%252Fbase-types..rkt%2529._.Any%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">Any</a></span><span class="stt"> </span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=type-ref.html%23%2528form._%2528%2528lib._typed-racket%252Fbase-env%252Fbase-types..rkt%2529._.Boolean%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">Boolean</a></span><span class="stt"> </span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=special-forms.html%23%2528form._%2528%2528lib._typed-racket%252Fbase-env%252Fprims..rkt%2529._%7E3a%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">:</a></span><span class="stt"> </span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=type-ref.html%23%2528form._%2528%2528lib._typed-racket%252Fbase-env%252Fbase-types..rkt%2529._.Integer%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">Integer</a></span><span class="RktPn">)</span>, using the old
<span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=special-forms.html%23%2528form._%2528%2528lib._typed-racket%252Fbase-env%252Fprims..rkt%2529._%7E3a%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">:</a></span> so that it gets properly interpreted by <a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=index.html&amp;version=8.6" class="RktModLink Sq" data-pltdoc="x"><span class="RktSym">typed/racket</span></a>&rsquo;s
parser.</p><p><div class="SIntrapara"><a name="(elem._(prefixable._chunk~3a~3cexpand-type-case-~3a~3e~3a1~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28prefixable._chunk~3a~3cexpand-type-case-~3a~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;expand-type-case-:&#187;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eand%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~and</a></span><span class="hspace">&nbsp;</span><span class="RktSym">c</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eliteral%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~literal</a></span><span class="hspace">&nbsp;</span><span class="RktSym">new-:</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">rule</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stxops.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._datum-%7E3esyntax%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">datum-&gt;syntax</a></span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktSym">here</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">:</span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktSym">c</span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktSym">c</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktVal">'</span><span class="RktVal">:</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr></table></blockquote></div></p><h5 x-source-module="(lib &quot;type-expander/scribblings/type-expander-implementation.scrbl&quot;)" x-source-pkg="type-expander" x-part-tag="&quot;Last_resort_cases__leaving_the_type_unchanged&quot;">1.5.2.7<tt>&nbsp;</tt><a name="(part._.Last_resort_cases__leaving_the_type_unchanged)"></a>Last resort cases: leaving the type unchanged</h5><p>If the type expression to expand was not matched by any of the above cases,
then it can still be an application of a polymorphic type <span class="RktSym">T</span>. The
arguments <span class="RktSym">TArg</span><span class="stt"> </span><span class="RktSym">&#8230;</span> can contain uses of type expanders. We therefore expand
each separately, and combine the results.</p><p><div class="SIntrapara"><a name="(elem._(prefixable._chunk~3a~3cexpand-type-case-app-fallback~3e~3a1~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28prefixable._chunk~3a~3cexpand-type-case-app-fallback~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;expand-type-case-app-fallback&#187;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">[</span><span class="RktPn">{</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eand%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~and</a></span><span class="hspace">&nbsp;</span><span class="RktSym">whole</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">T</span><span class="hspace">&nbsp;</span><span class="RktSym">TArg</span><span class="hspace">&nbsp;</span><span class="RktSym">&#8230;</span><span class="RktPn">)</span><span class="RktPn">}</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">rule</span><span class="hspace">&nbsp;</span><span class="RktSym">app-fallback</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fqqstx..rkt%2529._quasisyntax%252Floc%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">quasisyntax/loc</a></span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktSym">whole</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">T</span><span class="hspace">&nbsp;</span><span class="RktRdr">#,@</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=syntax-helpers.html%23%2528def._%2528%2528lib._syntax%252Fstx..rkt%2529._stx-map%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">stx-map</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._%7Ece%7Ebb%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">&#955;</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">a</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528def._%2528%2528submod._%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._expander%2529._expand-type%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">expand-type</a></span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktPn">(</span><span class="RktSym">TArg</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr></table></blockquote></div></p><p>As a last resort, we consider that the type <span class="RktSym">T</span> (which
would most likely be an identifier) is either a built-in
type provided by <span class="RktSym">typed/racket</span>, or a user-declared type
introduced by <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._define-type%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define-type</a></span>. In both cases, we just leave
the type as-is.</p><p><div class="SIntrapara"><a name="(elem._(prefixable._chunk~3a~3cexpand-type-case-fallback-.T~3e~3a1~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28prefixable._chunk~3a~3cexpand-type-case-fallback-.T~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;expand-type-case-fallback-T&#187;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">[</span><span class="RktSym">T</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">rule</span><span class="hspace">&nbsp;</span><span class="RktSym">just-fallback</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktRdr">#'</span><span class="RktSym">T</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr></table></blockquote></div></p><h5 x-source-module="(lib &quot;type-expander/scribblings/type-expander-implementation.scrbl&quot;)" x-source-pkg="type-expander" x-part-tag="&quot;Debugging_type_expanders&quot;">1.5.3<tt>&nbsp;</tt><a name="(part._.Debugging_type_expanders)"></a>Debugging type expanders</h5><p>In order to facilitate writing type expanders, it is possible to print the
inputs, steps and outputs of the expander using
<span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._debug-type-expander%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">debug-type-expander</a></span><span class="stt"> </span><span class="RktVal">#t</span><span class="RktPn">)</span>, which sets the value of
<span class="RktSym">debug-type-expander?</span>. This can then be undone using
<span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._debug-type-expander%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">debug-type-expander</a></span><span class="stt"> </span><span class="RktVal">#f</span><span class="RktPn">)</span>.</p><p><div class="SIntrapara"><a name="(elem._(prefixable._chunk~3a~3cexpand-type-debug-outer~3e~3a1~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28prefixable._chunk~3a~3cexpand-type-debug-outer~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;expand-type-debug-outer&#187;<span style="vertical-align: sub; font-size: 80%">1</span></a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._define%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">debug-type-expander?</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=boxes.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._box%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">box</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span><span class="RktPn">)</span></p></blockquote></div></p><p><div class="SIntrapara"><a name="(elem._(prefixable._chunk~3a~3cdebug-type-expander~3e~3a1~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28prefixable._chunk~3a~3cdebug-type-expander~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;debug-type-expander&#187;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define-syntax%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define-syntax</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._debug-type-expander%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">debug-type-expander</a></span><span class="hspace">&nbsp;</span><span class="RktSym">stx</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._syntax-case%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">syntax-case</a></span><span class="hspace">&nbsp;</span><span class="RktSym">stx</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529.__%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">_</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#t</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=boxes.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._set-box%2521%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">set-box!</a></span><span class="hspace">&nbsp;</span><span class="RktSym">debug-type-expander?</span><span class="hspace">&nbsp;</span><span class="RktVal">#t</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=void.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._void%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">void</a></span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529.__%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">_</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=boxes.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._set-box%2521%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">set-box!</a></span><span class="hspace">&nbsp;</span><span class="RktSym">debug-type-expander?</span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=void.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._void%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">void</a></span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><p>For better readability, each level of recursion indents the debugging
information:</p><p><div class="SIntrapara"><a name="(elem._(prefixable._chunk~3a~3cexpand-type-debug-outer~3e~3a2~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28prefixable._chunk~3a~3cexpand-type-debug-outer~3e~3a2~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;expand-type-debug-outer&#187;<span style="vertical-align: sub; font-size: 80%">2</span></a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._define%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">indent</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=parameters.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._make-parameter%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">make-parameter</a></span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="RktPn">)</span><span class="RktPn">)</span></p></blockquote></div></p><p><div class="SIntrapara"><a name="(elem._(prefixable._chunk~3a~3cexpand-type-debug-indent~3e~3a1~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28prefixable._chunk~3a~3cexpand-type-debug-indent~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;expand-type-debug-indent&#187;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><p><span class="RktPn">[</span><span class="RktSym">indent</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=generic-numbers.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._%252B%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">indent</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktPn">)</span><span class="RktPn">]</span></p></blockquote></div></p><p>Before expanding a term, it is printed:</p><p><div class="SIntrapara"><a name="(elem._(prefixable._chunk~3a~3cexpand-type-debug-before~3e~3a1~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28prefixable._chunk~3a~3cexpand-type-debug-before~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;expand-type-debug-before&#187;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=when_unless.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fletstx-scheme..rkt%2529._when%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">when</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=boxes.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._unbox%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">unbox</a></span><span class="hspace">&nbsp;</span><span class="RktSym">debug-type-expander?</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=Writing.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._printf%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">printf</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"~a~a ~a"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._make-string%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">make-string</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">indent</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">#\space</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">applicable?</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">+scopes</span><span class="hspace">&nbsp;</span><span class="RktSym">stx</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><p>Once the term has been expanded, the original term and the expanded term are
printed:</p><p><div class="SIntrapara"><a name="(elem._(prefixable._chunk~3a~3cexpand-type-debug-after~3e~3a1~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28prefixable._chunk~3a~3cexpand-type-debug-after~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;expand-type-debug-after&#187;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=when_unless.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fletstx-scheme..rkt%2529._when%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">when</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=boxes.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._unbox%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">unbox</a></span><span class="hspace">&nbsp;</span><span class="RktSym">debug-type-expander?</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=Writing.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._printf%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">printf</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"~a~a ~a\n~a=&gt; ~a (case: ~a)\n"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._make-string%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">make-string</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">indent</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">#\space</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">applicable?</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">+scopes</span><span class="hspace">&nbsp;</span><span class="RktSym">stx</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._make-string%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">make-string</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">indent</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">#\space</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">+scopes</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._car%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">car</a></span><span class="hspace">&nbsp;</span><span class="RktSym">result</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._cdr%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">cdr</a></span><span class="hspace">&nbsp;</span><span class="RktSym">result</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=when_unless.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fletstx-scheme..rkt%2529._when%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">when</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=generic-numbers.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._%7E3d%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">=</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">indent</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">print-full-scopes</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._car%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">car</a></span><span class="hspace">&nbsp;</span><span class="RktSym">result</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><p>Finally, each rule for the type expander is wrapped with the <span class="RktSym">rule</span>
macro, which prints the name of the rule, and returns a pair containing the
result and the rule&rsquo;s name, so that the debugging information indicates the
rule applied at each step.</p><p><div class="SIntrapara"><a name="(elem._(prefixable._chunk~3a~3cexpand-type-debug-rules~3e~3a1~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28prefixable._chunk~3a~3cexpand-type-debug-rules~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;expand-type-debug-rules&#187;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fmisc..rkt%2529._define-syntax-rule%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define-syntax-rule</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">rule</span><span class="hspace">&nbsp;</span><span class="RktSym">name</span><span class="hspace">&nbsp;</span><span class="RktSym">e</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=begin.html%23%2528form._%2528%2528quote._%7E23%7E25kernel%2529._begin%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">begin</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=when_unless.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fletstx-scheme..rkt%2529._when%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">when</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=boxes.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._unbox%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">unbox</a></span><span class="hspace">&nbsp;</span><span class="RktSym">debug-type-expander?</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=Writing.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._printf%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">printf</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"(case:~a)\n"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">'</span><span class="RktVal">name</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._cons%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">cons</a></span><span class="hspace">&nbsp;</span><span class="RktSym">e</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">name</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><h4 x-source-module="(lib &quot;type-expander/scribblings/type-expander-implementation.scrbl&quot;)" x-source-pkg="type-expander" x-part-tag="&quot;Overloading_typed_racket_forms&quot;">1.6<tt>&nbsp;</tt><a name="(part._.Overloading_typed_racket_forms)"></a>Overloading <span class="RktSym">typed/racket</span> forms</h4><p>Throughout this section, we provide alternative definitions of the
<span class="RktSym">typed/racket</span> forms <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._%7E3a%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">:</a></span>, <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._lambda%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">lambda</a></span>, <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._define%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define</a></span>, <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._struct%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">struct</a></span>, <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._ann%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">ann</a></span>,
<span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._inst%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">inst</a></span>&#8230; . We write these definitions with <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Parsing_Syntax.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._syntax-parse%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">syntax-parse</a></span>, using the syntax
classes defined in section <a href="#%28part._type-expander~7csyntax-classes%29" data-pltdoc="x">syntax classes</a>.</p><p>Most of the time, we will use the experimental <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Experimental.html%23%2528form._%2528%2528lib._syntax%252Fparse%252Fexperimental%252Ftemplate..rkt%2529._template%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">template</a></span> macro from
<span class="RktSym">syntax/parse/experimental/template</span> which allows more concise code than the
usual <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._syntax%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">#'</a></span><span class="RktPn">(</span><span class="RktPn">)</span><span class="RktMeta"></span> and <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fqqstx..rkt%2529._quasisyntax%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">#`</a></span><span class="RktPn">(</span><span class="RktPn">)</span><span class="RktMeta"></span>.</p><h5 x-source-module="(lib &quot;type-expander/scribblings/type-expander-implementation.scrbl&quot;)" x-source-pkg="type-expander" x-part-tag="&quot;type-expander|syntax-classes&quot;">1.6.1<tt>&nbsp;</tt><a name="(part._type-expander~7csyntax-classes)"></a>syntax classes</h5><p>The syntax classes from
<span class="RktSym">typed-racket/base-env/annotate-classes</span> match against
the <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=special-forms.html%23%2528form._%2528%2528lib._typed-racket%252Fbase-env%252Fprims..rkt%2529._%7E3a%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">:</a></span> literal. Since we provide a new definition for
it, these syntax classes do not match code using our
definition of <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._%7E3a%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">:</a></span>. We therefore cannot use the original
implementations of <span class="RktSym">curried-formals</span> and
<span class="RktSym">lambda-formals</span>, and instead have to roll out our own
versions.</p><p>We take that as an opportunity to expand the types directly from the syntax
classes using <span class="RktPn">#:with</span>, instead of doing that inside the macros that use
them.</p><p>The <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528submod._%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._main%2529._colon%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">colon</a></span> syntax class records the identifier it matches as a "disappeared
use", which means that DrRacket will draw an arrow from the library importing it
(either <a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=index.html&amp;version=8.6" class="RktModLink Sq" data-pltdoc="x"><span class="RktSym">typed/racket</span></a> or <a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html&amp;version=8.6" class="RktModLink Sq" data-pltdoc="x"><span class="RktSym">type-expander</span></a>) to the
identifier. Unfortunately, this effect is not (yet) undone by
<a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse.html&amp;version=8.6" class="RktModLink Sq" data-pltdoc="x"><span class="RktSym">syntax/parse</span></a>&rsquo;s backtracking. See
<a href="https://groups.google.com/forum/#!topic/racket-users/Nc1klmsj9ag"><span class="url">https://groups.google.com/forum/#!topic/racket-users/Nc1klmsj9ag</span></a> for more
details about this.</p><p><div class="SIntrapara"><a name="(elem._(prefixable._chunk~3a~3cremove-ddd~3e~3a1~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28prefixable._chunk~3a~3cremove-ddd~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;remove-ddd&#187;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._define%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">remove-ddd</span><span class="hspace">&nbsp;</span><span class="RktSym">stx</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528lib._racket%252Fprivate%252Flist..rkt%2529._remove%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">remove</a></span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stxops.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._syntax-%7E3elist%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">syntax-&gt;list</a></span><span class="hspace">&nbsp;</span><span class="RktSym">stx</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stxcmp.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._free-identifier%7E3d%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">free-identifier=?</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><p><div class="SIntrapara"><a name="(elem._(prefixable._chunk~3a~3csyntax-classes~3e~3a1~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28prefixable._chunk~3a~3csyntax-classes~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;syntax-classes&#187;<span style="vertical-align: sub; font-size: 80%">1</span></a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-specifying.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._define-syntax-class%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define-syntax-class</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528submod._%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._main%2529._colon%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">colon</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">#:attributes</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-specifying.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._pattern%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">pattern</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eand%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~and</a></span><span class="hspace">&nbsp;</span><span class="RktPn">{</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eor%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~or</a></span><span class="hspace">&nbsp;</span><span class="RktPn">{</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eliteral%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~literal</a></span><span class="hspace">&nbsp;</span><span class="RktSym">new-:</span><span class="RktPn">}</span><span class="hspace">&nbsp;</span><span class="RktPn">{</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eliteral%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~literal</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._%7E3a%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">:</a></span><span class="RktPn">}</span><span class="RktPn">}</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">C</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">{</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7edo%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~do</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=syntax-util.html%23%2528def._%2528%2528lib._racket%252Fsyntax..rkt%2529._record-disappeared-uses%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">record-disappeared-uses</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._list%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">list</a></span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktSym">C</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">}</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-specifying.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._define-splicing-syntax-class%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define-splicing-syntax-class</a></span><span class="hspace">&nbsp;</span><span class="RktSym">new-maybe-kw-type-vars</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">#:attributes</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">vars</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">]</span><span class="hspace">&nbsp;</span><span class="RktSym">maybe</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-specifying.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._pattern%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">pattern</a></span><span class="hspace">&nbsp;</span><span class="RktSym">kw+vars:lambda-type-vars</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:with</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">vars</span><span class="hspace">&nbsp;</span><span class="RktSym">&#8230;</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">remove-ddd</span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktSym">kw+vars.type-vars</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:with</span><span class="hspace">&nbsp;</span><span class="RktSym">maybe</span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktSym">kw+vars</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-specifying.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._pattern%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">pattern</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eseq%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~seq</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:with</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">vars</span><span class="hspace">&nbsp;</span><span class="RktSym">&#8230;</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktPn">(</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:attr</span><span class="hspace">&nbsp;</span><span class="RktSym">maybe</span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-specifying.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._define-splicing-syntax-class%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define-splicing-syntax-class</a></span><span class="hspace">&nbsp;</span><span class="RktSym">new-maybe-type-vars</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">#:attributes</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">vars</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">]</span><span class="hspace">&nbsp;</span><span class="RktSym">maybe</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-specifying.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._pattern%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">pattern</a></span><span class="hspace">&nbsp;</span><span class="RktSym">v:type-variables</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:with</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">vars</span><span class="hspace">&nbsp;</span><span class="RktSym">&#8230;</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">remove-ddd</span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktSym">v</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:with</span><span class="hspace">&nbsp;</span><span class="RktSym">maybe</span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktSym">v</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-specifying.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._pattern%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">pattern</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eseq%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~seq</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:with</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">vars</span><span class="hspace">&nbsp;</span><span class="RktSym">&#8230;</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktPn">(</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:attr</span><span class="hspace">&nbsp;</span><span class="RktSym">maybe</span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-specifying.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._define-splicing-syntax-class%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define-splicing-syntax-class</a></span><span class="hspace">&nbsp;</span><span class="RktSym">new-kw-formal</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">#:attributes</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">expanded</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-specifying.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._pattern%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">pattern</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eseq%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~seq</a></span><span class="hspace">&nbsp;</span><span class="RktSym">kw:keyword</span><span class="hspace">&nbsp;</span><span class="RktSym">id:id</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:with</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">expanded</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktPn">(</span><span class="RktSym">kw</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Library_Syntax_Classes_and_Literal_Sets.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._id%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">id</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-specifying.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._pattern%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">pattern</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eseq%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~seq</a></span><span class="hspace">&nbsp;</span><span class="RktSym">kw:keyword</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">id:id</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eoptional%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~optional</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eseq%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~seq</a></span><span class="hspace">&nbsp;</span><span class="RktSym">:colon</span><span class="hspace">&nbsp;</span><span class="RktSym">type:type-expand!</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eoptional%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~optional</a></span><span class="hspace">&nbsp;</span><span class="RktSym">default:expr</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:with</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">expanded</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Experimental.html%23%2528form._%2528%2528lib._syntax%252Fparse%252Fexperimental%252Ftemplate..rkt%2529._template%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">template</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">kw</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Library_Syntax_Classes_and_Literal_Sets.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._id%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">id</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Experimental.html%23%2528form._%2528%2528lib._syntax%252Fparse%252Fexperimental%252Ftemplate..rkt%2529._%7E3f%7E40%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">?@</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._%7E3a%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">:</a></span><span class="hspace">&nbsp;</span><span class="RktSym">type.expanded</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Experimental.html%23%2528form._%2528%2528lib._syntax%252Fparse%252Fexperimental%252Ftemplate..rkt%2529._%7E3f%7E3f%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">??</a></span><span class="hspace">&nbsp;</span><span class="RktSym">default</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-specifying.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._define-splicing-syntax-class%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define-splicing-syntax-class</a></span><span class="hspace">&nbsp;</span><span class="RktSym">new-mand-formal</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">#:attributes</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">expanded</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-specifying.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._pattern%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">pattern</a></span><span class="hspace">&nbsp;</span><span class="RktSym">id:id</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:with</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">expanded</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Library_Syntax_Classes_and_Literal_Sets.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._id%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">id</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-specifying.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._pattern%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">pattern</a></span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">id:id</span><span class="hspace">&nbsp;</span><span class="RktSym">:colon</span><span class="hspace">&nbsp;</span><span class="RktSym">type:type-expand!</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:with</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">expanded</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Experimental.html%23%2528form._%2528%2528lib._syntax%252Fparse%252Fexperimental%252Ftemplate..rkt%2529._template%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">template</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Library_Syntax_Classes_and_Literal_Sets.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._id%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">id</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._%7E3a%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">:</a></span><span class="hspace">&nbsp;</span><span class="RktSym">type.expanded</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-specifying.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._pattern%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">pattern</a></span><span class="hspace">&nbsp;</span><span class="RktSym">kw:new-kw-formal</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:with</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">expanded</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktPn">(</span><span class="RktSym">kw.expanded</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-specifying.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._define-splicing-syntax-class%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define-splicing-syntax-class</a></span><span class="hspace">&nbsp;</span><span class="RktSym">new-opt-formal</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">#:attributes</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">expanded</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-specifying.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._pattern%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">pattern</a></span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">id:id</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eoptional%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~optional</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eseq%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~seq</a></span><span class="hspace">&nbsp;</span><span class="RktSym">:colon</span><span class="hspace">&nbsp;</span><span class="RktSym">type:type-expand!</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">default:expr</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:with</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">expanded</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Experimental.html%23%2528form._%2528%2528lib._syntax%252Fparse%252Fexperimental%252Ftemplate..rkt%2529._template%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">template</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Library_Syntax_Classes_and_Literal_Sets.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._id%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">id</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Experimental.html%23%2528form._%2528%2528lib._syntax%252Fparse%252Fexperimental%252Ftemplate..rkt%2529._%7E3f%7E3f%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">??</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Experimental.html%23%2528form._%2528%2528lib._syntax%252Fparse%252Fexperimental%252Ftemplate..rkt%2529._%7E3f%7E40%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">?@</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._%7E3a%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">:</a></span><span class="hspace">&nbsp;</span><span class="RktSym">type.expanded</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">default</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-specifying.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._pattern%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">pattern</a></span><span class="hspace">&nbsp;</span><span class="RktSym">kw:new-kw-formal</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:with</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">expanded</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktPn">(</span><span class="RktSym">kw.expanded</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-specifying.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._define-syntax-class%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define-syntax-class</a></span><span class="hspace">&nbsp;</span><span class="RktSym">new-rest-arg</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">#:attributes</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">expanded</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-specifying.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._pattern%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">pattern</a></span><span class="hspace">&nbsp;</span><span class="RktSym">rest:id</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:with</span><span class="hspace">&nbsp;</span><span class="RktSym">expanded</span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528lib._racket%252Flist..rkt%2529._rest%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">rest</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-specifying.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._pattern%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">pattern</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">rest:id</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">:colon</span><span class="hspace">&nbsp;</span><span class="RktSym">type:type-expand!</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eor%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~or</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eand%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~and</a></span><span class="hspace">&nbsp;</span><span class="RktSym">x*</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7edescribe%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~describe</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"*"</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eor%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~or</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eliteral%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~literal</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=generic-numbers.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._%252A%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">*</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eliteral%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~literal</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._......%252A%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...*</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eseq%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~seq</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eliteral%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~literal</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">bound:type-expand!</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:with</span><span class="hspace">&nbsp;</span><span class="RktSym">expanded</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Experimental.html%23%2528form._%2528%2528lib._syntax%252Fparse%252Fexperimental%252Ftemplate..rkt%2529._template%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">template</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528lib._racket%252Flist..rkt%2529._rest%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">rest</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._%7E3a%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">:</a></span><span class="hspace">&nbsp;</span><span class="RktSym">type.expanded</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Experimental.html%23%2528form._%2528%2528lib._syntax%252Fparse%252Fexperimental%252Ftemplate..rkt%2529._%7E3f%7E3f%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">??</a></span><span class="hspace">&nbsp;</span><span class="RktSym">x*</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Experimental.html%23%2528form._%2528%2528lib._syntax%252Fparse%252Fexperimental%252Ftemplate..rkt%2529._%7E3f%7E40%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">?@</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">bound.expanded</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-specifying.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._define-syntax-class%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define-syntax-class</a></span><span class="hspace">&nbsp;</span><span class="RktSym">new-lambda-formals</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-specifying.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._pattern%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">pattern</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eor%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~or</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">mand:new-mand-formal</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">opt:new-opt-formal</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">. </span><span class="RktSym">rest:new-rest-arg</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">mand:new-mand-formal</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">opt:new-opt-formal</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">; TODO: once template supports ?? in tail position, use it.</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:with</span><span class="hspace">&nbsp;</span><span class="RktSym">expanded</span><span class="hspace">&nbsp;</span><span class="RktRdr">#`</span><span class="RktPn">(</span><span class="RktSym">mand.expanded</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">opt.expanded</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">. </span><span class="RktRdr">#,</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=if.html%23%2528form._%2528%2528quote._%7E23%7E25kernel%2529._if%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">if</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-specifying.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._attribute%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">attribute</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528lib._racket%252Flist..rkt%2529._rest%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">rest</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktRdr">#'</span><span class="RktSym">rest.expanded</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktRdr">#'</span><span class="RktPn">(</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-specifying.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._define-syntax-class%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define-syntax-class</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">new-curried-formals</span><span class="hspace">&nbsp;</span><span class="RktSym">def-id</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-specifying.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._pattern%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">pattern</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">f:id</span><span class="hspace">&nbsp;</span><span class="RktPn">. </span><span class="RktSym">args:new-lambda-formals</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:with</span><span class="hspace">&nbsp;</span><span class="RktSym">expanded</span><span class="hspace">&nbsp;</span><span class="RktRdr">#`</span><span class="RktPn">(</span><span class="RktRdr">#,</span><span class="RktSym">def-id</span><span class="hspace">&nbsp;</span><span class="RktPn">. </span><span class="RktSym">args.expanded</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-specifying.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._pattern%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">pattern</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7evar%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~var</a></span><span class="hspace">&nbsp;</span><span class="RktSym">lhs</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">new-curried-formals</span><span class="hspace">&nbsp;</span><span class="RktSym">def-id</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">. </span><span class="RktSym">args:new-lambda-formals</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:with</span><span class="hspace">&nbsp;</span><span class="RktSym">expanded</span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktPn">(</span><span class="RktSym">lhs.expanded</span><span class="hspace">&nbsp;</span><span class="RktPn">. </span><span class="RktSym">args.expanded</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-specifying.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._define-syntax-class%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define-syntax-class</a></span><span class="hspace">&nbsp;</span><span class="RktSym">new-curried-formals-id</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-specifying.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._pattern%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">pattern</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">id:id</span><span class="hspace">&nbsp;</span><span class="RktPn">. </span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529.__%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">_</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-specifying.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._pattern%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">pattern</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lhs:new-curried-formals-id</span><span class="hspace">&nbsp;</span><span class="RktPn">. </span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529.__%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">_</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:with</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Library_Syntax_Classes_and_Literal_Sets.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._id%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">id</a></span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktSym">lhs.id</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-specifying.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._define-splicing-syntax-class%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define-splicing-syntax-class</a></span><span class="hspace">&nbsp;</span><span class="RktSym">new-optionally-annotated-name</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-specifying.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._pattern%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">pattern</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eseq%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~seq</a></span><span class="hspace">&nbsp;</span><span class="RktSym">name:id</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eoptional%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~optional</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eseq%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~seq</a></span><span class="hspace">&nbsp;</span><span class="RktSym">:colon</span><span class="hspace">&nbsp;</span><span class="RktSym">type:type-expand!</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:with</span><span class="hspace">&nbsp;</span><span class="RktSym">expanded</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Experimental.html%23%2528form._%2528%2528lib._syntax%252Fparse%252Fexperimental%252Ftemplate..rkt%2529._template%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">template</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">name</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Experimental.html%23%2528form._%2528%2528lib._syntax%252Fparse%252Fexperimental%252Ftemplate..rkt%2529._%7E3f%7E3f%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">??</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Experimental.html%23%2528form._%2528%2528lib._syntax%252Fparse%252Fexperimental%252Ftemplate..rkt%2529._%7E3f%7E40%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">?@</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._%7E3a%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">:</a></span><span class="hspace">&nbsp;</span><span class="RktSym">type.expanded</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-specifying.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._define-syntax-class%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define-syntax-class</a></span><span class="hspace">&nbsp;</span><span class="RktSym">new-name-or-parenthesised-annotated-name</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-specifying.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._pattern%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">pattern</a></span><span class="hspace">&nbsp;</span><span class="RktSym">name:id</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:with</span><span class="hspace">&nbsp;</span><span class="RktSym">expanded</span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktSym">name</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-specifying.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._pattern%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">pattern</a></span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">id:id</span><span class="hspace">&nbsp;</span><span class="RktSym">:colon</span><span class="hspace">&nbsp;</span><span class="RktSym">type:type-expand!</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:with</span><span class="hspace">&nbsp;</span><span class="RktSym">expanded</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Experimental.html%23%2528form._%2528%2528lib._syntax%252Fparse%252Fexperimental%252Ftemplate..rkt%2529._template%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">template</a></span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Library_Syntax_Classes_and_Literal_Sets.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._id%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">id</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._%7E3a%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">:</a></span><span class="hspace">&nbsp;</span><span class="RktSym">type.expanded</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><h5 x-source-module="(lib &quot;type-expander/scribblings/type-expander-implementation.scrbl&quot;)" x-source-pkg="type-expander" x-part-tag="&quot;Overview_of_the_overloaded_primitives&quot;">1.6.2<tt>&nbsp;</tt><a name="(part._.Overview_of_the_overloaded_primitives)"></a>Overview of the overloaded primitives</h5><p>The following sections merely define overloads for the
<a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=index.html&amp;version=8.6" class="RktModLink Sq" data-pltdoc="x"><span class="RktSym">typed/racket</span></a> primitives. The process is
similar each time: a new primitive is defined, e.g.
<span class="RktSym">new-:</span> for <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=special-forms.html%23%2528form._%2528%2528lib._typed-racket%252Fbase-env%252Fprims..rkt%2529._%7E3a%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">:</a></span>. The new primitive calls the old one,
after having expanded (using <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528def._%2528%2528submod._%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._expander%2529._expand-type%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">expand-type</a></span>) all parts of
the syntax which contain types. Aside from heavy usage of
<span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Parsing_Syntax.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._syntax-parse%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">syntax-parse</a></span>, there is not much to say concerning these
definitions.</p><h5 x-source-module="(lib &quot;type-expander/scribblings/type-expander-implementation.scrbl&quot;)" x-source-pkg="type-expander" x-part-tag="&quot;_&quot;">1.6.3<tt>&nbsp;</tt><a name="(part.__)"></a><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._%7E3a%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">:</a></span></h5><p><div class="SIntrapara"><a name="(elem._(prefixable._chunk~3a~3c~3a~3e~3a1~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28prefixable._chunk~3a~3c~3a~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;:&#187;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">set-:-impl!</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Parsing_Syntax.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._syntax-parser%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">syntax-parser</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529.__%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">_</a></span><span class="hspace">&nbsp;</span><span class="RktSym">x:id</span><span class="hspace">&nbsp;</span><span class="RktSym">t:expr</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktRdr">#`</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._%7E3a%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">:</a></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktRdr">#,</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528def._%2528%2528submod._%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._expander%2529._expand-type%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">expand-type</a></span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktSym">t</span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><h5 x-source-module="(lib &quot;type-expander/scribblings/type-expander-implementation.scrbl&quot;)" x-source-pkg="type-expander" x-part-tag="&quot;define-type&quot;">1.6.4<tt>&nbsp;</tt><a name="(part._define-type)"></a><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._define-type%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define-type</a></span></h5><p><div class="SIntrapara"><a name="(elem._(prefixable._chunk~3a~3cdefine-type~3e~3a1~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28prefixable._chunk~3a~3cdefine-type~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;define-type&#187;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define-syntax%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define-syntax</a></span><span class="hspace">&nbsp;</span><span class="RktSym">new-define-type</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Parsing_Syntax.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._syntax-parser%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">syntax-parser</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529.__%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">_</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eor%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~or</a></span><span class="hspace">&nbsp;</span><span class="RktSym">name:id</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">name:id</span><span class="hspace">&nbsp;</span><span class="RktSym">maybe-tvar:id</span><span class="hspace">&nbsp;</span><span class="RktSym">&#8230;</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">. </span><span class="RktSym">whole-rest</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:with</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">tvar</span><span class="hspace">&nbsp;</span><span class="RktSym">&#8230;</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=if.html%23%2528form._%2528%2528quote._%7E23%7E25kernel%2529._if%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">if</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-specifying.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._attribute%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">attribute</a></span><span class="hspace">&nbsp;</span><span class="RktSym">maybe-tvar</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktPn">(</span><span class="RktSym">maybe-tvar</span><span class="hspace">&nbsp;</span><span class="RktSym">&#8230;</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktPn">(</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:with</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">tvar-not-ooo</span><span class="hspace">&nbsp;</span><span class="RktSym">&#8230;</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528lib._racket%252Fprivate%252Flist..rkt%2529._filter%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">filter</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._%7Ece%7Ebb%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">&#955;</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">tv</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=booleans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._not%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">not</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stxcmp.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._free-identifier%7E3d%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">free-identifier=?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">tv</span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktPn">(</span><span class="RktSym">&#8230;</span><span class="hspace">&nbsp;</span><span class="RktSym">&#8230;</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stxops.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._syntax-%7E3elist%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">syntax-&gt;list</a></span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktPn">(</span><span class="RktSym">tvar</span><span class="hspace">&nbsp;</span><span class="RktSym">&#8230;</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">start-tl-redirections</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">with-bindings</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym">tvar-not-ooo</span><span class="hspace">&nbsp;</span><span class="RktSym">&#8230;</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=syntax-helpers.html%23%2528def._%2528%2528lib._syntax%252Fstx..rkt%2529._stx-map%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">stx-map</a></span><span class="hspace">&nbsp;</span><a href="#%28elem._%28prefixable._chunk~3a~3cshadowed~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;shadowed&#187;</a></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktRdr">#'</span><span class="RktPn">(</span><span class="RktSym">tvar-not-ooo</span><span class="hspace">&nbsp;</span><span class="RktSym">&#8230;</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">whole-rest</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Parsing_Syntax.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._syntax-parse%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">syntax-parse</a></span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktSym">whole-rest</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym">type:type-expand!</span><span class="hspace">&nbsp;</span><span class="RktPn">. </span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528lib._racket%252Flist..rkt%2529._rest%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">rest</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Experimental.html%23%2528form._%2528%2528lib._syntax%252Fparse%252Fexperimental%252Ftemplate..rkt%2529._template%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">template</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._define-type%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define-type</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Experimental.html%23%2528form._%2528%2528lib._syntax%252Fparse%252Fexperimental%252Ftemplate..rkt%2529._%7E3f%7E3f%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">??</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">name</span><span class="hspace">&nbsp;</span><span class="RktSym">tvar</span><span class="hspace">&nbsp;</span><span class="RktSym">&#8230;</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">name</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">type.expanded</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">. </span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528lib._racket%252Flist..rkt%2529._rest%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">rest</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><h5 x-source-module="(lib &quot;type-expander/scribblings/type-expander-implementation.scrbl&quot;)" x-source-pkg="type-expander" x-part-tag="&quot;define&quot;">1.6.5<tt>&nbsp;</tt><a name="(part._define)"></a><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._define%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define</a></span></h5><p><div class="SIntrapara"><a name="(elem._(prefixable._chunk~3a~3cdefine~3e~3a1~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28prefixable._chunk~3a~3cdefine~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;define&#187;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define-syntax%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define-syntax</a></span><span class="hspace">&nbsp;</span><span class="RktSym">new-define</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">f-start-tl-redirections</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Parsing_Syntax.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._syntax-parser%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">syntax-parser</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529.__%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">_</a></span><span class="hspace">&nbsp;</span><span class="RktPn">{</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eand%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~and</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eseq%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~seq</a></span><span class="hspace">&nbsp;</span><span class="RktVar">:new-maybe-kw-type-vars</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eor%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~or</a></span><span class="hspace">&nbsp;</span><span class="RktSym">v:id</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">formals-id:new-curried-formals-id</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529.__%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">_</a></span><span class="hspace">&nbsp;</span><span class="RktSym">&#8230;</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">~with-tvars</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">tvars</span><span class="hspace">&nbsp;</span><span class="RktSym">new-maybe-kw-type-vars</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eor%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~or</a></span><span class="hspace">&nbsp;</span><span class="RktVar">:id</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7evar%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~var</a></span><span class="hspace">&nbsp;</span><span class="RktSym">formals</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">new-curried-formals</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktRdr">#'</span><span class="RktSym">formals-id.id</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eoptional%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~optional</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eseq%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~seq</a></span><span class="hspace">&nbsp;</span><span class="RktSym">:colon</span><span class="hspace">&nbsp;</span><span class="RktSym">type:type-expand!</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">e</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">}</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Experimental.html%23%2528form._%2528%2528lib._syntax%252Fparse%252Fexperimental%252Ftemplate..rkt%2529._template%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">template</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._define%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Experimental.html%23%2528form._%2528%2528lib._syntax%252Fparse%252Fexperimental%252Ftemplate..rkt%2529._%7E3f%7E3f%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">??</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Experimental.html%23%2528form._%2528%2528lib._syntax%252Fparse%252Fexperimental%252Ftemplate..rkt%2529._%7E3f%7E40%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">?@</a></span><span class="hspace">&nbsp;</span><span class="RktPn">. </span><span class="RktSym">tvars.maybe</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Experimental.html%23%2528form._%2528%2528lib._syntax%252Fparse%252Fexperimental%252Ftemplate..rkt%2529._%7E3f%7E3f%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">??</a></span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="hspace">&nbsp;</span><span class="RktSym">formals.expanded</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Experimental.html%23%2528form._%2528%2528lib._syntax%252Fparse%252Fexperimental%252Ftemplate..rkt%2529._%7E3f%7E3f%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">??</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Experimental.html%23%2528form._%2528%2528lib._syntax%252Fparse%252Fexperimental%252Ftemplate..rkt%2529._%7E3f%7E40%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">?@</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._%7E3a%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">:</a></span><span class="hspace">&nbsp;</span><span class="RktSym">type.expanded</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">e</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><h5 x-source-module="(lib &quot;type-expander/scribblings/type-expander-implementation.scrbl&quot;)" x-source-pkg="type-expander" x-part-tag="&quot;lambda&quot;">1.6.6<tt>&nbsp;</tt><a name="(part._lambda)"></a><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._lambda%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">lambda</a></span></h5><p><div class="SIntrapara"><a name="(elem._(prefixable._chunk~3a~3clambda~3e~3a1~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28prefixable._chunk~3a~3clambda~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;lambda&#187;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define-syntax%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define-syntax</a></span><span class="hspace">&nbsp;</span><span class="RktSym">new-lambda</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">f-start-tl-redirections</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Parsing_Syntax.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._syntax-parser%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">syntax-parser</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529.__%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">_</a></span><span class="hspace">&nbsp;</span><span class="RktPn">{</span><span class="RktSym">~with-tvars</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">tvars</span><span class="hspace">&nbsp;</span><span class="RktSym">new-maybe-kw-type-vars</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">args:new-lambda-formals</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eoptional%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~optional</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eseq%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~seq</a></span><span class="hspace">&nbsp;</span><span class="RktSym">:colon</span><span class="hspace">&nbsp;</span><span class="RktSym">ret-type:type-expand!</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">e</span><span class="hspace">&nbsp;</span><span class="RktSym">&#8230;</span><span class="RktPn">}</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Experimental.html%23%2528form._%2528%2528lib._syntax%252Fparse%252Fexperimental%252Ftemplate..rkt%2529._template%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">template</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._lambda%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">lambda</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Experimental.html%23%2528form._%2528%2528lib._syntax%252Fparse%252Fexperimental%252Ftemplate..rkt%2529._%7E3f%7E3f%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">??</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Experimental.html%23%2528form._%2528%2528lib._syntax%252Fparse%252Fexperimental%252Ftemplate..rkt%2529._%7E3f%7E40%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">?@</a></span><span class="hspace">&nbsp;</span><span class="RktPn">. </span><span class="RktSym">tvars.maybe</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">args.expanded</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Experimental.html%23%2528form._%2528%2528lib._syntax%252Fparse%252Fexperimental%252Ftemplate..rkt%2529._%7E3f%7E3f%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">??</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Experimental.html%23%2528form._%2528%2528lib._syntax%252Fparse%252Fexperimental%252Ftemplate..rkt%2529._%7E3f%7E40%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">?@</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._%7E3a%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">:</a></span><span class="hspace">&nbsp;</span><span class="RktSym">ret-type.expanded</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">e</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><h5 x-source-module="(lib &quot;type-expander/scribblings/type-expander-implementation.scrbl&quot;)" x-source-pkg="type-expander" x-part-tag="&quot;case-lambda&quot;">1.6.7<tt>&nbsp;</tt><a name="(part._case-lambda)"></a><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._case-lambda%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">case-lambda</a></span></h5><p><div class="SIntrapara"><a name="(elem._(prefixable._chunk~3a~3ccase-lambda~3e~3a1~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28prefixable._chunk~3a~3ccase-lambda~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;case-lambda&#187;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define-syntax%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define-syntax</a></span><span class="hspace">&nbsp;</span><span class="RktSym">new-case-lambda</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">f-start-tl-redirections</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Parsing_Syntax.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._syntax-parser%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">syntax-parser</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529.__%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">_</a></span><span class="hspace">&nbsp;</span><span class="RktPn">{</span><span class="RktSym">~with-tvars</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">tvars</span><span class="hspace">&nbsp;</span><span class="RktSym">new-maybe-kw-type-vars</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">args:new-lambda-formals</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eoptional%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~optional</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eseq%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~seq</a></span><span class="hspace">&nbsp;</span><span class="RktSym">:colon</span><span class="hspace">&nbsp;</span><span class="RktSym">ret-type:type-expand!</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">e</span><span class="hspace">&nbsp;</span><span class="RktSym">&#8230;</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">&#8230;</span><span class="RktPn">}</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Experimental.html%23%2528form._%2528%2528lib._syntax%252Fparse%252Fexperimental%252Ftemplate..rkt%2529._template%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">template</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._case-lambda%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">case-lambda</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Experimental.html%23%2528form._%2528%2528lib._syntax%252Fparse%252Fexperimental%252Ftemplate..rkt%2529._%7E3f%7E3f%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">??</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Experimental.html%23%2528form._%2528%2528lib._syntax%252Fparse%252Fexperimental%252Ftemplate..rkt%2529._%7E3f%7E40%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">?@</a></span><span class="hspace">&nbsp;</span><span class="RktPn">#:&#8704;</span><span class="hspace">&nbsp;</span><span class="RktSym">tvars.maybe</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">args.expanded</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Experimental.html%23%2528form._%2528%2528lib._syntax%252Fparse%252Fexperimental%252Ftemplate..rkt%2529._%7E3f%7E3f%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">??</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._ann%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">ann</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._let%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">let</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">e</span><span class="hspace">&nbsp;</span><span class="RktSym">&#8230;</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">ret-type.expanded</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Experimental.html%23%2528form._%2528%2528lib._syntax%252Fparse%252Fexperimental%252Ftemplate..rkt%2529._%7E3f%7E40%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">?@</a></span><span class="hspace">&nbsp;</span><span class="RktSym">e</span><span class="hspace">&nbsp;</span><span class="RktSym">&#8230;</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">&#8230;</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><h5 x-source-module="(lib &quot;type-expander/scribblings/type-expander-implementation.scrbl&quot;)" x-source-pkg="type-expander" x-part-tag="&quot;struct&quot;">1.6.8<tt>&nbsp;</tt><a name="(part._struct)"></a><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._struct%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">struct</a></span></h5><p>The name must be captured outside of the <span class="RktSym">~with-tvars</span>, as
<span class="RktSym">~with-tvars</span> introduces everything in a new lexical context.</p><p><div class="SIntrapara"><a name="(elem._(prefixable._chunk~3a~3cstruct~3e~3a1~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28prefixable._chunk~3a~3cstruct~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;struct&#187;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define-syntax%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define-syntax</a></span><span class="hspace">&nbsp;</span><span class="RktSym">new-struct</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">f-start-tl-redirections</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Parsing_Syntax.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._syntax-parser%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">syntax-parser</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529.__%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">_</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eand%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~and</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eseq%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~seq</a></span><span class="hspace">&nbsp;</span><span class="RktVar">:new-maybe-type-vars</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eand%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~and</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eseq%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~seq</a></span><span class="hspace">&nbsp;</span><span class="RktSym">name+parent</span><span class="hspace">&nbsp;</span><span class="RktSym">&#8230;</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eor%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~or</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eseq%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~seq</a></span><span class="hspace">&nbsp;</span><span class="RktSym">name:id</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eseq%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~seq</a></span><span class="hspace">&nbsp;</span><span class="RktSym">name:id</span><span class="hspace">&nbsp;</span><span class="RktSym">parent:id</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529.__%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">_</a></span><span class="hspace">&nbsp;</span><span class="RktSym">&#8230;</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">{</span><span class="RktSym">~with-tvars</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">tvars</span><span class="hspace">&nbsp;</span><span class="RktSym">new-maybe-type-vars</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eor%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~or</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eseq%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~seq</a></span><span class="hspace">&nbsp;</span><span class="RktVar">:id</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eseq%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~seq</a></span><span class="hspace">&nbsp;</span><span class="RktVar">:id</span><span class="hspace">&nbsp;</span><span class="RktVar">:id</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">field:id</span><span class="hspace">&nbsp;</span><span class="RktSym">:colon</span><span class="hspace">&nbsp;</span><span class="RktSym">type:type-expand!</span><span class="RktPn">]</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528lib._racket%252Flist..rkt%2529._rest%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">rest</a></span><span class="hspace">&nbsp;</span><span class="RktSym">&#8230;</span><span class="RktPn">}</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Experimental.html%23%2528form._%2528%2528lib._syntax%252Fparse%252Fexperimental%252Ftemplate..rkt%2529._template%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">template</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._struct%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">struct</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Experimental.html%23%2528form._%2528%2528lib._syntax%252Fparse%252Fexperimental%252Ftemplate..rkt%2529._%7E3f%7E3f%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">??</a></span><span class="hspace">&nbsp;</span><span class="RktSym">tvars.maybe</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">name</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Experimental.html%23%2528form._%2528%2528lib._syntax%252Fparse%252Fexperimental%252Ftemplate..rkt%2529._%7E3f%7E3f%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">??</a></span><span class="hspace">&nbsp;</span><span class="RktSym">parent</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=createclass.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fclass-internal..rkt%2529._field%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">field</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._%7E3a%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">:</a></span><span class="hspace">&nbsp;</span><span class="RktSym">type.expanded</span><span class="RktPn">]</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528lib._racket%252Flist..rkt%2529._rest%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">rest</a></span><span class="hspace">&nbsp;</span><span class="RktSym">&#8230;</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><h5 x-source-module="(lib &quot;type-expander/scribblings/type-expander-implementation.scrbl&quot;)" x-source-pkg="type-expander" x-part-tag="&quot;define-struct_exec&quot;">1.6.9<tt>&nbsp;</tt><a name="(part._define-struct_exec)"></a><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._define-struct%252Fexec%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define-struct/exec</a></span></h5><p><div class="SIntrapara"><a name="(elem._(prefixable._chunk~3a~3cdefine-struct/exec~3e~3a1~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28prefixable._chunk~3a~3cdefine-struct%2Fexec~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;define-struct/exec&#187;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define-syntax%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define-syntax</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">new-define-struct/exec</span><span class="hspace">&nbsp;</span><span class="RktSym">stx</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Parsing_Syntax.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._syntax-parse%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">syntax-parse</a></span><span class="hspace">&nbsp;</span><span class="RktSym">stx</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529.__%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">_</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eand%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~and</a></span><span class="hspace">&nbsp;</span><span class="RktSym">name+parent</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eor%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~or</a></span><span class="hspace">&nbsp;</span><span class="RktSym">name:id</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">name:id</span><span class="hspace">&nbsp;</span><span class="RktSym">parent:id</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">field:id</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eoptional%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~optional</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eseq%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~seq</a></span><span class="hspace">&nbsp;</span><span class="RktSym">:colon</span><span class="hspace">&nbsp;</span><span class="RktSym">type:type-expand!</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">proc</span><span class="hspace">&nbsp;</span><span class="RktSym">:colon</span><span class="hspace">&nbsp;</span><span class="RktSym">proc-type:type-expand!</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Experimental.html%23%2528form._%2528%2528lib._syntax%252Fparse%252Fexperimental%252Ftemplate..rkt%2529._template%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">template</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._define-struct%252Fexec%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define-struct/exec</a></span><span class="hspace">&nbsp;</span><span class="RktSym">name+parent</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=createclass.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fclass-internal..rkt%2529._field%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">field</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Experimental.html%23%2528form._%2528%2528lib._syntax%252Fparse%252Fexperimental%252Ftemplate..rkt%2529._%7E3f%7E3f%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">??</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Experimental.html%23%2528form._%2528%2528lib._syntax%252Fparse%252Fexperimental%252Ftemplate..rkt%2529._%7E3f%7E40%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">?@</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._%7E3a%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">:</a></span><span class="hspace">&nbsp;</span><span class="RktSym">type.expanded</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">proc</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._%7E3a%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">:</a></span><span class="hspace">&nbsp;</span><span class="RktSym">proc-type.expanded</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><h5 x-source-module="(lib &quot;type-expander/scribblings/type-expander-implementation.scrbl&quot;)" x-source-pkg="type-expander" x-part-tag="&quot;ann&quot;">1.6.10<tt>&nbsp;</tt><a name="(part._ann)"></a><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._ann%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">ann</a></span></h5><p><div class="SIntrapara"><a name="(elem._(prefixable._chunk~3a~3cann~3e~3a1~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28prefixable._chunk~3a~3cann~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;ann&#187;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define-syntax/parse</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">new-ann</span><span class="hspace">&nbsp;</span><span class="RktSym">value:expr</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eoptional%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~optional</a></span><span class="hspace">&nbsp;</span><span class="RktSym">:colon</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">type:type-expand!</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Experimental.html%23%2528form._%2528%2528lib._syntax%252Fparse%252Fexperimental%252Ftemplate..rkt%2529._template%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">template</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._ann%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">ann</a></span><span class="hspace">&nbsp;</span><span class="RktSym">value</span><span class="hspace">&nbsp;</span><span class="RktSym">type.expanded</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><h5 x-source-module="(lib &quot;type-expander/scribblings/type-expander-implementation.scrbl&quot;)" x-source-pkg="type-expander" x-part-tag="&quot;cast&quot;">1.6.11<tt>&nbsp;</tt><a name="(part._cast)"></a><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._cast%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">cast</a></span></h5><p><div class="SIntrapara"><a name="(elem._(prefixable._chunk~3a~3ccast~3e~3a1~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28prefixable._chunk~3a~3ccast~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;cast&#187;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define-syntax/parse</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">new-cast</span><span class="hspace">&nbsp;</span><span class="RktSym">value:expr</span><span class="hspace">&nbsp;</span><span class="RktSym">type:type-expand!</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Experimental.html%23%2528form._%2528%2528lib._syntax%252Fparse%252Fexperimental%252Ftemplate..rkt%2529._template%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">template</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._cast%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">cast</a></span><span class="hspace">&nbsp;</span><span class="RktSym">value</span><span class="hspace">&nbsp;</span><span class="RktSym">type.expanded</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><h5 x-source-module="(lib &quot;type-expander/scribblings/type-expander-implementation.scrbl&quot;)" x-source-pkg="type-expander" x-part-tag="&quot;unsafe-cast&quot;">1.6.12<tt>&nbsp;</tt><a name="(part._unsafe-cast)"></a><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._unsafe-cast%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">unsafe-cast</a></span></h5><p>We additionally define an <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._unsafe-cast%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">unsafe-cast</a></span> macro, which Typed/Racket does
not provide yet, but can easily be defined using <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=Unsafe_Typed_Racket_operations.html%23%2528form._%2528%2528lib._typed%252Fracket%252Funsafe..rkt%2529._unsafe-require%252Ftyped%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">unsafe-require/typed</a></span>
and a polymorphic function.</p><p><div class="SIntrapara"><a name="(elem._(prefixable._chunk~3a~3cunsafe-cast~3e~3a1~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28prefixable._chunk~3a~3cunsafe-cast~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;unsafe-cast&#187;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=module.html%23%2528form._%2528%2528quote._%7E23%7E25kernel%2529._module%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">module</a></span><span class="hspace">&nbsp;</span><span class="RktSym">m-unsafe-cast</span><span class="hspace">&nbsp;</span><span class="RktSym">typed/racket</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._provide%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">provide</a></span><span class="hspace">&nbsp;</span><span class="RktSym">unsafe-cast-function</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._define%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">unsafe-cast-function</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">v</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._%7E3a%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">:</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=type-ref.html%23%2528form._%2528%2528lib._typed-racket%252Fbase-env%252Fbase-types..rkt%2529._.Any%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">Any</a></span><span class="RktPn">]</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._require%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">require</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._only-in%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">only-in</a></span><span class="hspace">&nbsp;</span><span class="RktSym">typed/racket/unsafe</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=Unsafe_Typed_Racket_operations.html%23%2528form._%2528%2528lib._typed%252Fracket%252Funsafe..rkt%2529._unsafe-require%252Ftyped%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">unsafe-require/typed</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=Unsafe_Typed_Racket_operations.html%23%2528form._%2528%2528lib._typed%252Fracket%252Funsafe..rkt%2529._unsafe-require%252Ftyped%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">unsafe-require/typed</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">m-unsafe-cast</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">unsafe-cast-function</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=type-ref.html%23%2528form._%2528%2528lib._typed-racket%252Fbase-env%252Fbase-types-extra..rkt%2529._%7Ee2%7E88%7E80%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">&#8704;</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">A</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=type-ref.html%23%2528form._%2528%2528lib._typed-racket%252Fbase-env%252Fbase-types-extra..rkt%2529._%7Ee2%7E86%7E92%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">&#8594;</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=type-ref.html%23%2528form._%2528%2528lib._typed-racket%252Fbase-env%252Fbase-types..rkt%2529._.Any%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">Any</a></span><span class="hspace">&nbsp;</span><span class="RktSym">A</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fmisc..rkt%2529._define-syntax-rule%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define-syntax-rule</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._unsafe-cast%252Fno-expand%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">unsafe-cast/no-expand</a></span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="hspace">&nbsp;</span><span class="RktSym">t</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._inst%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">inst</a></span><span class="hspace">&nbsp;</span><span class="RktSym">unsafe-cast-function</span><span class="hspace">&nbsp;</span><span class="RktSym">t</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define-syntax/parse</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._unsafe-cast%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">unsafe-cast</a></span><span class="hspace">&nbsp;</span><span class="RktSym">value:expr</span><span class="hspace">&nbsp;</span><span class="RktSym">type:type-expand!</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Experimental.html%23%2528form._%2528%2528lib._syntax%252Fparse%252Fexperimental%252Ftemplate..rkt%2529._template%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">template</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._unsafe-cast%252Fno-expand%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">unsafe-cast/no-expand</a></span><span class="hspace">&nbsp;</span><span class="RktSym">value</span><span class="hspace">&nbsp;</span><span class="RktSym">type.expanded</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><h5 x-source-module="(lib &quot;type-expander/scribblings/type-expander-implementation.scrbl&quot;)" x-source-pkg="type-expander" x-part-tag="&quot;inst&quot;">1.6.13<tt>&nbsp;</tt><a name="(part._inst)"></a><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._inst%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">inst</a></span></h5><p><div class="SIntrapara"><a name="(elem._(prefixable._chunk~3a~3cinst~3e~3a1~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28prefixable._chunk~3a~3cinst~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;inst&#187;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define-syntax%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define-syntax</a></span><span class="hspace">&nbsp;</span><span class="RktSym">new-inst</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Parsing_Syntax.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._syntax-parser%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">syntax-parser</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529.__%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">_</a></span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eoptional%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~optional</a></span><span class="hspace">&nbsp;</span><span class="RktSym">:colon</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">t:type-expand!</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">last:type-expand!</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eliteral%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~literal</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">b:id</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Experimental.html%23%2528form._%2528%2528lib._syntax%252Fparse%252Fexperimental%252Ftemplate..rkt%2529._template%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">template</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._inst%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">inst</a></span><span class="hspace">&nbsp;</span><span class="RktSym">v</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">t.expanded</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">last.expanded</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529.__%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">_</a></span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eoptional%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~optional</a></span><span class="hspace">&nbsp;</span><span class="RktSym">:colon</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">t:type-expand!</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Experimental.html%23%2528form._%2528%2528lib._syntax%252Fparse%252Fexperimental%252Ftemplate..rkt%2529._template%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">template</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._inst%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">inst</a></span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="hspace">&nbsp;</span><span class="RktSym">t.expanded</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><h5 x-source-module="(lib &quot;type-expander/scribblings/type-expander-implementation.scrbl&quot;)" x-source-pkg="type-expander" x-part-tag="&quot;row-inst&quot;">1.6.14<tt>&nbsp;</tt><a name="(part._row-inst)"></a><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=special-forms.html%23%2528form._%2528%2528lib._typed-racket%252Fbase-env%252Fprims..rkt%2529._row-inst%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">row-inst</a></span></h5><p><div class="SIntrapara"><a name="(elem._(prefixable._chunk~3a~3crow-inst~3e~3a1~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28prefixable._chunk~3a~3crow-inst~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;row-inst&#187;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define-syntax/parse</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">new-inst</span><span class="hspace">&nbsp;</span><span class="RktSym">e</span><span class="hspace">&nbsp;</span><span class="RktSym">row:type-expand!</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Experimental.html%23%2528form._%2528%2528lib._syntax%252Fparse%252Fexperimental%252Ftemplate..rkt%2529._template%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">template</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=special-forms.html%23%2528form._%2528%2528lib._typed-racket%252Fbase-env%252Fprims..rkt%2529._row-inst%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">row-inst</a></span><span class="hspace">&nbsp;</span><span class="RktSym">e</span><span class="hspace">&nbsp;</span><span class="RktSym">row.expanded</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><h5 x-source-module="(lib &quot;type-expander/scribblings/type-expander-implementation.scrbl&quot;)" x-source-pkg="type-expander" x-part-tag="&quot;let&quot;">1.6.15<tt>&nbsp;</tt><a name="(part._let)"></a><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._let%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">let</a></span></h5><p><div class="SIntrapara"><a name="(elem._(prefixable._chunk~3a~3clet~3e~3a1~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28prefixable._chunk~3a~3clet~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;let&#187;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define-syntax%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define-syntax</a></span><span class="hspace">&nbsp;</span><span class="RktSym">new-let</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">f-start-tl-redirections</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Parsing_Syntax.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._syntax-parser%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">syntax-parser</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529.__%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">_</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eoptional%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~optional</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eseq%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~seq</a></span><span class="hspace">&nbsp;</span><span class="RktSym">loop:id</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eoptional%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~optional</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eseq%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~seq</a></span><span class="hspace">&nbsp;</span><span class="RktSym">:colon</span><span class="hspace">&nbsp;</span><span class="RktSym">return-type:type-expand!</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">~with-tvars</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">tvars</span><span class="hspace">&nbsp;</span><span class="RktSym">new-maybe-kw-type-vars</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">name:new-optionally-annotated-name</span><span class="hspace">&nbsp;</span><span class="RktSym">e:expr</span><span class="RktPn">]</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528lib._racket%252Flist..rkt%2529._rest%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">rest</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Experimental.html%23%2528form._%2528%2528lib._syntax%252Fparse%252Fexperimental%252Ftemplate..rkt%2529._template%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">template</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._let%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">let</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Experimental.html%23%2528form._%2528%2528lib._syntax%252Fparse%252Fexperimental%252Ftemplate..rkt%2529._%7E3f%7E3f%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">??</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Experimental.html%23%2528form._%2528%2528lib._syntax%252Fparse%252Fexperimental%252Ftemplate..rkt%2529._%7E3f%7E40%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">?@</a></span><span class="hspace">&nbsp;</span><span class="RktSym">loop</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Experimental.html%23%2528form._%2528%2528lib._syntax%252Fparse%252Fexperimental%252Ftemplate..rkt%2529._%7E3f%7E3f%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">??</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Experimental.html%23%2528form._%2528%2528lib._syntax%252Fparse%252Fexperimental%252Ftemplate..rkt%2529._%7E3f%7E40%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">?@</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._%7E3a%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">:</a></span><span class="hspace">&nbsp;</span><span class="RktSym">return-type.expanded</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Experimental.html%23%2528form._%2528%2528lib._syntax%252Fparse%252Fexperimental%252Ftemplate..rkt%2529._%7E3f%7E40%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">?@</a></span><span class="hspace">&nbsp;</span><span class="RktPn">. </span><span class="RktSym">tvars</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Experimental.html%23%2528form._%2528%2528lib._syntax%252Fparse%252Fexperimental%252Ftemplate..rkt%2529._%7E3f%7E40%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">?@</a></span><span class="hspace">&nbsp;</span><span class="RktPn">. </span><span class="RktSym">name.expanded</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">e</span><span class="RktPn">]</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528lib._racket%252Flist..rkt%2529._rest%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">rest</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><h5 x-source-module="(lib &quot;type-expander/scribblings/type-expander-implementation.scrbl&quot;)" x-source-pkg="type-expander" x-part-tag="&quot;let_&quot;">1.6.16<tt>&nbsp;</tt><a name="(part._let_)"></a><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._let%252A%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">let*</a></span></h5><p><div class="SIntrapara"><a name="(elem._(prefixable._chunk~3a~3clet*~3e~3a1~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28prefixable._chunk~3a~3clet%2A~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;let*&#187;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define-syntax/parse</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">new-let*</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">name:new-optionally-annotated-name</span><span class="hspace">&nbsp;</span><span class="RktSym">e:expr</span><span class="RktPn">]</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">. </span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528lib._racket%252Flist..rkt%2529._rest%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">rest</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Experimental.html%23%2528form._%2528%2528lib._syntax%252Fparse%252Fexperimental%252Ftemplate..rkt%2529._template%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">template</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._let%252A%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">let*</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Experimental.html%23%2528form._%2528%2528lib._syntax%252Fparse%252Fexperimental%252Ftemplate..rkt%2529._%7E3f%7E40%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">?@</a></span><span class="hspace">&nbsp;</span><span class="RktPn">. </span><span class="RktSym">name.expanded</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">e</span><span class="RktPn">]</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">. </span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528lib._racket%252Flist..rkt%2529._rest%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">rest</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><h5 x-source-module="(lib &quot;type-expander/scribblings/type-expander-implementation.scrbl&quot;)" x-source-pkg="type-expander" x-part-tag="&quot;let-values&quot;">1.6.17<tt>&nbsp;</tt><a name="(part._let-values)"></a><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._let-values%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">let-values</a></span></h5><p><div class="SIntrapara"><a name="(elem._(prefixable._chunk~3a~3clet-values~3e~3a1~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28prefixable._chunk~3a~3clet-values~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;let-values&#187;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define-syntax/parse</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">new-let-values</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym">name:new-name-or-parenthesised-annotated-name</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">e:expr</span><span class="RktPn">]</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">. </span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528lib._racket%252Flist..rkt%2529._rest%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">rest</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Experimental.html%23%2528form._%2528%2528lib._syntax%252Fparse%252Fexperimental%252Ftemplate..rkt%2529._template%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">template</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._let-values%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">let-values</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym">name.expanded</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">e</span><span class="RktPn">]</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">. </span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528lib._racket%252Flist..rkt%2529._rest%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">rest</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><h5 x-source-module="(lib &quot;type-expander/scribblings/type-expander-implementation.scrbl&quot;)" x-source-pkg="type-expander" x-part-tag="&quot;make-predicate&quot;">1.6.18<tt>&nbsp;</tt><a name="(part._make-predicate)"></a><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._make-predicate%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">make-predicate</a></span></h5><p><div class="SIntrapara"><a name="(elem._(prefixable._chunk~3a~3cmake-predicate~3e~3a1~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28prefixable._chunk~3a~3cmake-predicate~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;make-predicate&#187;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define-simple-macro</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">new-make-predicate</span><span class="hspace">&nbsp;</span><span class="RktSym">type:type-expand!</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._make-predicate%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">make-predicate</a></span><span class="hspace">&nbsp;</span><span class="RktSym">type.expanded</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><h5 x-source-module="(lib &quot;type-expander/scribblings/type-expander-implementation.scrbl&quot;)" x-source-pkg="type-expander" x-part-tag="&quot;_type___print-type___query-type_args___query-type_result&quot;">1.6.19<tt>&nbsp;</tt><a name="(part.__type___print-type___query-type_args___query-type_result)"></a><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._%7E3atype%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">:type</a></span>, <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._%7E3aprint-type%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">:print-type</a></span>, <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._%7E3aquery-type%252Fargs%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">:query-type/args</a></span>,
<span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._%7E3aquery-type%252Fresult%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">:query-type/result</a></span></h5><p><div class="SIntrapara"><a name="(elem._(prefixable._chunk~3a~3c~3atype~3e~3a1~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28prefixable._chunk~3a~3c~3atype~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;:type&#187;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define-syntax/parse</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">new-:type</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eoptional%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~optional</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eand%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~and</a></span><span class="hspace">&nbsp;</span><span class="RktSym">verbose</span><span class="hspace">&nbsp;</span><span class="RktPn">#:verbose</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">type:type-expand!</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Experimental.html%23%2528form._%2528%2528lib._syntax%252Fparse%252Fexperimental%252Ftemplate..rkt%2529._template%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">template</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=eval.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._eval%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">eval</a></span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=special-forms.html%23%2528form._%2528%2528lib._typed-racket%252Ftyped-racket..rkt%2529._%7E23%7E25top-interaction%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">#%top-interaction</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">. </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._%7E3atype%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">:type</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Experimental.html%23%2528form._%2528%2528lib._syntax%252Fparse%252Fexperimental%252Ftemplate..rkt%2529._%7E3f%7E3f%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">??</a></span><span class="hspace">&nbsp;</span><span class="RktSym">verbose</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">type.expanded</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><p><div class="SIntrapara"><a name="(elem._(prefixable._chunk~3a~3c~3aprint-type~3e~3a1~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28prefixable._chunk~3a~3c~3aprint-type~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;:print-type&#187;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define-syntax/parse</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">new-:print-type</span><span class="hspace">&nbsp;</span><span class="RktSym">e:expr</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktRdr">#'</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._%7E3aprint-type%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">:print-type</a></span><span class="hspace">&nbsp;</span><span class="RktSym">e</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktRdr">#'</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=eval.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._eval%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">eval</a></span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=special-forms.html%23%2528form._%2528%2528lib._typed-racket%252Ftyped-racket..rkt%2529._%7E23%7E25top-interaction%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">#%top-interaction</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">. </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._%7E3aprint-type%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">:print-type</a></span><span class="hspace">&nbsp;</span><span class="RktSym">e</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><p><div class="SIntrapara"><a name="(elem._(prefixable._chunk~3a~3c~3aquery-type/args~3e~3a1~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28prefixable._chunk~3a~3c~3aquery-type%2Fargs~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;:query-type/args&#187;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define-syntax/parse</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">new-:query-type/args</span><span class="hspace">&nbsp;</span><span class="RktSym">f</span><span class="hspace">&nbsp;</span><span class="RktSym">type:type-expand!</span><span class="hspace">&nbsp;</span><span class="RktSym">&#8230;</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktRdr">#'</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=eval.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._eval%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">eval</a></span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=special-forms.html%23%2528form._%2528%2528lib._typed-racket%252Ftyped-racket..rkt%2529._%7E23%7E25top-interaction%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">#%top-interaction</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">. </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._%7E3aquery-type%252Fargs%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">:query-type/args</a></span><span class="hspace">&nbsp;</span><span class="RktSym">f</span><span class="hspace">&nbsp;</span><span class="RktSym">type.expanded</span><span class="hspace">&nbsp;</span><span class="RktSym">&#8230;</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><p><div class="SIntrapara"><a name="(elem._(prefixable._chunk~3a~3c~3aquery-type/result~3e~3a1~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28prefixable._chunk~3a~3c~3aquery-type%2Fresult~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;:query-type/result&#187;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define-syntax/parse</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">new-:query-type/result</span><span class="hspace">&nbsp;</span><span class="RktSym">f</span><span class="hspace">&nbsp;</span><span class="RktSym">type:type-expand!</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktRdr">#'</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=eval.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._eval%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">eval</a></span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=special-forms.html%23%2528form._%2528%2528lib._typed-racket%252Ftyped-racket..rkt%2529._%7E23%7E25top-interaction%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">#%top-interaction</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">. </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._%7E3aquery-type%252Fresult%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">:query-type/result</a></span><span class="hspace">&nbsp;</span><span class="RktSym">f</span><span class="hspace">&nbsp;</span><span class="RktSym">type.expanded</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><h5 x-source-module="(lib &quot;type-expander/scribblings/type-expander-implementation.scrbl&quot;)" x-source-pkg="type-expander" x-part-tag="&quot;Type_expanders_for_the_typed_classes&quot;">1.6.20<tt>&nbsp;</tt><a name="(part._.Type_expanders_for_the_typed_classes)"></a>Type expanders for the typed classes</h5><p>Not all forms are supported for now.</p><p><div class="SIntrapara"><a name="(elem._(prefixable._chunk~3a~3csyntax-classes~3e~3a2~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28prefixable._chunk~3a~3csyntax-classes~3e~3a2~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;syntax-classes&#187;<span style="vertical-align: sub; font-size: 80%">2</span></a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-specifying.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._define-syntax-class%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define-syntax-class</a></span><span class="hspace">&nbsp;</span><span class="RktSym">field-decl</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-specifying.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._pattern%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">pattern</a></span><span class="hspace">&nbsp;</span><span class="RktSym">id:id</span><span class="hspace">&nbsp;</span><span class="RktPn">#:with</span><span class="hspace">&nbsp;</span><span class="RktSym">expanded</span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=createclass.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fclass-internal..rkt%2529._field%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">field</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Library_Syntax_Classes_and_Literal_Sets.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._id%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">id</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-specifying.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._pattern%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">pattern</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">maybe-renamed</span><span class="hspace">&nbsp;</span><span class="RktPn">{</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eoptional%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~optional</a></span><span class="hspace">&nbsp;</span><span class="RktPn">{</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eseq%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~seq</a></span><span class="hspace">&nbsp;</span><span class="RktSym">:colon</span><span class="hspace">&nbsp;</span><span class="RktSym">type:type-expand!</span><span class="RktPn">}</span><span class="RktPn">}</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">{</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eoptional%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~optional</a></span><span class="hspace">&nbsp;</span><span class="RktSym">default-value-expr</span><span class="RktPn">}</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:with</span><span class="hspace">&nbsp;</span><span class="RktSym">expanded</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Experimental.html%23%2528form._%2528%2528lib._syntax%252Fparse%252Fexperimental%252Ftemplate..rkt%2529._template%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">template</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">maybe-renamed</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Experimental.html%23%2528form._%2528%2528lib._syntax%252Fparse%252Fexperimental%252Ftemplate..rkt%2529._%7E3f%7E3f%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">??</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Experimental.html%23%2528form._%2528%2528lib._syntax%252Fparse%252Fexperimental%252Ftemplate..rkt%2529._%7E3f%7E40%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">?@</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._%7E3a%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">:</a></span><span class="hspace">&nbsp;</span><span class="RktSym">type.expanded</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Experimental.html%23%2528form._%2528%2528lib._syntax%252Fparse%252Fexperimental%252Ftemplate..rkt%2529._%7E3f%7E3f%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">??</a></span><span class="hspace">&nbsp;</span><span class="RktSym">default-value-expr</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><p><div class="SIntrapara"><a name="(elem._(prefixable._chunk~3a~3csyntax-classes~3e~3a3~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28prefixable._chunk~3a~3csyntax-classes~3e~3a3~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;syntax-classes&#187;<span style="vertical-align: sub; font-size: 80%">3</span></a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-specifying.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._define-syntax-class%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define-syntax-class</a></span><span class="hspace">&nbsp;</span><span class="RktSym">field-clause</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">#:literals</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=createclass.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fclass-internal..rkt%2529._field%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">field</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-specifying.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._pattern%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">pattern</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=createclass.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fclass-internal..rkt%2529._field%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">field</a></span><span class="hspace">&nbsp;</span><span class="RktSym">field-decl:field-decl</span><span class="hspace">&nbsp;</span><span class="RktSym">&#8230;</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:with</span><span class="hspace">&nbsp;</span><span class="RktSym">expanded</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Experimental.html%23%2528form._%2528%2528lib._syntax%252Fparse%252Fexperimental%252Ftemplate..rkt%2529._template%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">template</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=createclass.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fclass-internal..rkt%2529._field%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">field</a></span><span class="hspace">&nbsp;</span><span class="RktSym">field-decl.expanded</span><span class="hspace">&nbsp;</span><span class="RktSym">&#8230;</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><p><div class="SIntrapara"><a name="(elem._(prefixable._chunk~3a~3csyntax-classes~3e~3a4~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28prefixable._chunk~3a~3csyntax-classes~3e~3a4~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;syntax-classes&#187;<span style="vertical-align: sub; font-size: 80%">4</span></a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-specifying.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._define-syntax-class%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define-syntax-class</a></span><span class="hspace">&nbsp;</span><span class="RktSym">super-new-clause</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">#:literals</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=objcreation.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fclass-internal..rkt%2529._super-new%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">super-new</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-specifying.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._pattern%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">pattern</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=objcreation.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fclass-internal..rkt%2529._super-new%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">super-new</a></span><span class="hspace">&nbsp;</span><span class="RktPn">. </span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528lib._racket%252Flist..rkt%2529._rest%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">rest</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:with</span><span class="hspace">&nbsp;</span><span class="RktSym">expanded</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Experimental.html%23%2528form._%2528%2528lib._syntax%252Fparse%252Fexperimental%252Ftemplate..rkt%2529._template%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">template</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=objcreation.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fclass-internal..rkt%2529._super-new%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">super-new</a></span><span class="hspace">&nbsp;</span><span class="RktPn">. </span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528lib._racket%252Flist..rkt%2529._rest%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">rest</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><p><div class="SIntrapara"><a name="(elem._(prefixable._chunk~3a~3csyntax-classes~3e~3a5~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28prefixable._chunk~3a~3csyntax-classes~3e~3a5~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;syntax-classes&#187;<span style="vertical-align: sub; font-size: 80%">5</span></a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-specifying.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._define-syntax-class%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define-syntax-class</a></span><span class="hspace">&nbsp;</span><span class="RktSym">class-clause</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">#:attributes</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">expanded</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-specifying.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._pattern%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">pattern</a></span><span class="hspace">&nbsp;</span><span class="RktSym">:field-clause</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-specifying.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._pattern%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">pattern</a></span><span class="hspace">&nbsp;</span><span class="RktSym">:super-new-clause</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><p><div class="SIntrapara"><a name="(elem._(prefixable._chunk~3a~3cclass~3e~3a1~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28prefixable._chunk~3a~3cclass~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;class&#187;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define-syntax%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define-syntax</a></span><span class="hspace">&nbsp;</span><span class="RktSym">new-class</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">f-start-tl-redirections</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Parsing_Syntax.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._syntax-parser%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">syntax-parser</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529.__%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">_</a></span><span class="hspace">&nbsp;</span><span class="RktSym">superclass-expr</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">{</span><span class="RktSym">~with-tvars</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">tvars</span><span class="hspace">&nbsp;</span><span class="RktSym">new-maybe-kw-type-vars</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">clause:class-clause</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktPn">}</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Experimental.html%23%2528form._%2528%2528lib._syntax%252Fparse%252Fexperimental%252Ftemplate..rkt%2529._template%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">template</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._class%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">class</a></span><span class="hspace">&nbsp;</span><span class="RktSym">superclass-expr</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Experimental.html%23%2528form._%2528%2528lib._syntax%252Fparse%252Fexperimental%252Ftemplate..rkt%2529._%7E3f%7E3f%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">??</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Experimental.html%23%2528form._%2528%2528lib._syntax%252Fparse%252Fexperimental%252Ftemplate..rkt%2529._%7E3f%7E40%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">?@</a></span><span class="hspace">&nbsp;</span><span class="RktPn">. </span><span class="RktSym">tvars.maybe</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">clause.expanded</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><h5 x-source-module="(lib &quot;type-expander/scribblings/type-expander-implementation.scrbl&quot;)" x-source-pkg="type-expander" x-part-tag="&quot;type-expander|other-forms&quot;">1.6.21<tt>&nbsp;</tt><a name="(part._type-expander~7cother-forms)"></a>Other <span class="RktSym">typed/racket</span>
forms</h5><p>The other <span class="RktSym">typed/racket</span> forms below do not have an alternative definition
yet.</p><p><div class="SIntrapara"><a name="(elem._(prefixable._chunk~3a~3cother-forms~3e~3a1~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28prefixable._chunk~3a~3cother-forms~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;other-forms&#187;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define-syntax%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define-syntax</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">missing-forms</span><span class="hspace">&nbsp;</span><span class="RktSym">stx</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Parsing_Syntax.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._syntax-parse%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">syntax-parse</a></span><span class="hspace">&nbsp;</span><span class="RktSym">stx</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529.__%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">_</a></span><span class="hspace">&nbsp;</span><span class="RktSym">name</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=syntax-util.html%23%2528form._%2528%2528lib._racket%252Fsyntax..rkt%2529._define%252Fwith-syntax%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define/with-syntax</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">tmp</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stxops.html%23%2528def._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._generate-temporaries%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">generate-temporaries</a></span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktPn">(</span><span class="RktSym">name</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktRdr">#'</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=begin.html%23%2528form._%2528%2528quote._%7E23%7E25kernel%2529._begin%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">begin</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=begin.html%23%2528form._%2528%2528quote._%7E23%7E25kernel%2529._begin%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">begin</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define-syntax%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define-syntax</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">tmp</span><span class="hspace">&nbsp;</span><span class="RktSym">stx</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=exns.html%23%2528def._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._raise-syntax-error%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">raise-syntax-error</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">'</span><span class="RktVal">name</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=Writing.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._format%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">format</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"~a not implemented yet for type-expander"</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">name</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">stx</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._provide%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">provide</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._rename-out%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">rename-out</a></span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">tmp</span><span class="hspace">&nbsp;</span><span class="RktSym">name</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">missing-forms</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">;TODO: add all-defined-out in prims.rkt</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">; top-interaction.rkt</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">:type</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">:print-type</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">:query-type/args</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">:query-type/result</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">; case-lambda.rkt</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">case-lambda</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">case-lambda:</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._pcase-lambda%7E3a%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">pcase-lambda:</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">; (submod "prims-contract.rkt" forms)</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._require%252Fopaque-type%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">require/opaque-type</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">require-typed-struct-legacy</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._require-typed-struct%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">require-typed-struct</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">require/typed-legacy</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._require%252Ftyped%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">require/typed</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._require%252Ftyped%252Fprovide%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">require/typed/provide</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._require-typed-struct%252Fprovide%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">require-typed-struct/provide</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">cast</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">make-predicate</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._define-predicate%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define-predicate</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">; prims.rkt</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._define-type-alias%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define-type-alias</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._define-new-subtype%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define-new-subtype</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._define-typed-struct%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define-typed-struct</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._define-typed-struct%252Fexec%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define-typed-struct/exec</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">ann</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">inst</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">:</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._define-struct%7E3a%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define-struct:</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._define-struct%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define-struct</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">struct</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._struct%7E3a%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">struct:</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._%7Ece%7Ebb%7E3a%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">&#955;:</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._lambda%7E3a%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">lambda:</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">lambda</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&#955;</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">define</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">let</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">let*</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._letrec%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">letrec</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">let-values</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._letrec-values%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">letrec-values</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._let%252Fcc%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">let/cc</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._let%252Fec%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">let/ec</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._let%7E3a%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">let:</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._let%252A%7E3a%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">let*:</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._letrec%7E3a%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">letrec:</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._let-values%7E3a%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">let-values:</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._letrec-values%7E3a%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">letrec-values:</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._let%252Fcc%7E3a%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">let/cc:</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._let%252Fec%7E3a%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">let/ec:</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._for%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">for</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._for%252Flist%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">for/list</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._for%252Fvector%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">for/vector</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._for%252Fhash%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">for/hash</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._for%252Fhasheq%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">for/hasheq</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._for%252Fhasheqv%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">for/hasheqv</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._for%252Fand%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">for/and</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._for%252For%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">for/or</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._for%252Fsum%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">for/sum</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._for%252Fproduct%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">for/product</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._for%252Flists%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">for/lists</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._for%252Ffirst%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">for/first</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._for%252Flast%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">for/last</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._for%252Ffold%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">for/fold</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._for%252A%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">for*</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._for%252A%252Flist%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">for*/list</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._for%252A%252Flists%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">for*/lists</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._for%252A%252Fvector%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">for*/vector</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._for%252A%252Fhash%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">for*/hash</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._for%252A%252Fhasheq%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">for*/hasheq</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._for%252A%252Fhasheqv%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">for*/hasheqv</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._for%252A%252Fand%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">for*/and</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._for%252A%252For%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">for*/or</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._for%252A%252Fsum%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">for*/sum</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._for%252A%252Fproduct%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">for*/product</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._for%252A%252Ffirst%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">for*/first</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._for%252A%252Flast%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">for*/last</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._for%252A%252Ffold%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">for*/fold</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._for%252Fset%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">for/set</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._for%252A%252Fset%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">for*/set</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._do%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">do</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._do%7E3a%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">do:</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._with-handlers%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">with-handlers</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._define-struct%252Fexec%7E3a%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define-struct/exec:</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">define-struct/exec</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><h4 x-source-module="(lib &quot;type-expander/scribblings/type-expander-implementation.scrbl&quot;)" x-source-pkg="type-expander" x-part-tag="&quot;Future_work&quot;">1.7<tt>&nbsp;</tt><a name="(part._.Future_work)"></a>Future work</h4><p>We have not implemented alternative type-expanding definitions for all the
<span class="RktSym">typed/racket</span> forms, as noted in <a href="#%28part._type-expander~7cother-forms%29" data-pltdoc="x">Other <span class="RktSym">typed/racket</span>
forms</a>.</p><p>Integrating the type expander directly into typed/racket
would avoid the need to provide such definitions, and allow
using type expanders in vanilla <span class="RktSym">typed/racket</span>, instead
of having to <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._require%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">require</a></span> this library. However, the
code wrapping the <span class="RktSym">typed/racket</span> forms could be re-used
by other libraries that alter the way <span class="RktSym">typed/racket</span>
works, so implementing the remaining forms could still be
useful.</p><p>Also, we would need to provide a <span class="RktSym">syntax-local-type-introduce</span> function,
similar to the <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=match.html%23%2528def._%2528%2528lib._racket%252Fmatch..rkt%2529._syntax-local-match-introduce%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">syntax-local-match-introduce</a></span> function provided by <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=match.html%23%2528form._%2528%2528lib._racket%252Fmatch..rkt%2529._match%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">match</a></span>
for example.</p><h4 x-source-module="(lib &quot;type-expander/scribblings/type-expander-implementation.scrbl&quot;)" x-source-pkg="type-expander" x-part-tag="&quot;Conclusion&quot;">1.8<tt>&nbsp;</tt><a name="(part._.Conclusion)"></a>Conclusion</h4><p>When an identifier is <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._require%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">require</a></span>d from another module,
it is not the same as the one visible within the defining
module. This is a problem for <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._%7E3a%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">:</a></span>, because we match
against it in our syntax classes, using <span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eliteral%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~literal</a></span><span class="stt"> </span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._%7E3a%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">:</a></span><span class="RktPn">)</span>,
but when it is written in another module, for example
<span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._define%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="stt"> </span><span class="RktSym">foo</span><span class="stt"> </span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._%7E3a%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">:</a></span><span class="stt"> </span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=type-ref.html%23%2528form._%2528%2528lib._typed-racket%252Fbase-env%252Fbase-types..rkt%2529._.Number%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">Number</a></span><span class="stt"> </span><span class="RktVal">42</span><span class="RktPn">)</span>, it is not the same identifier
as the one used by original definition of <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._%7E3a%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">:</a></span>, and
therefore the <span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eliteral%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~literal</a></span><span class="stt"> </span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._%7E3a%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">:</a></span><span class="RktPn">)</span> won&rsquo;t match. I suspect that
issue to be due to contract wrappers added by
<span class="RktSym">typed/racket</span>.</p><p>To get around that problem, we define <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._%7E3a%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">:</a></span> in a separate module, and
<span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._require%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">require</a></span> it in the module containing the syntax classes:</p><p>Since our <span class="RktSym">new-:</span> macro needs to call the
<span class="RktSym">type-expander</span>, and the other forms too, we cannot
define <span class="RktSym">type-expander</span> in the same module as these forms,
it needs to be either in the same module as <span class="RktSym">new-:</span>, or
in a separate module. Additionally, <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528def._%2528%2528submod._%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._expander%2529._expand-type%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">expand-type</a></span> needs
to be required <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._for-syntax%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">for-syntax</a></span> by the forms, but needs to be
<span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._provide%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">provide</a></span>d too, so it is much easier if it is defined in
a separate module (that will be used only by macros, so it
will be written in <span class="RktSym">racket</span>, not <span class="RktSym">typed/racket</span>).</p><p><div class="SIntrapara"><a name="(elem._(prefixable._chunk~3a~3cmodule-expander~3e~3a1~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28prefixable._chunk~3a~3cmodule-expander~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;module-expander&#187;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=module.html%23%2528form._%2528%2528quote._%7E23%7E25kernel%2529._module%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">module</a></span><span class="hspace">&nbsp;</span><span class="RktSym">expander</span><span class="hspace">&nbsp;</span><span class="RktSym">racket</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._require%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">require</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._for-template%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">for-template</a></span><span class="hspace">&nbsp;</span><span class="RktSym">typed/racket</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">"identifiers.rkt"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">racket</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._only-in%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">only-in</a></span><span class="hspace">&nbsp;</span><span class="RktSym">racket/base</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktSym">&#8230;</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">syntax/parse</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">racket/format</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">racket/syntax</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">syntax/id-table</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">syntax/stx</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">auto-syntax-e</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">"parameterize-lexical-context.rkt"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">debug-scopes</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">racket/contract/base</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">; TODO: move this in a separate chunk and explain it</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._provide%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">provide</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528def._%2528%2528submod._%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._expander%2529._prop%7E3atype-expander%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">prop:type-expander</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=attaching-contracts-to-values.html%23%2528form._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._contract-out%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">contract-out</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=creatingunits.html%23%2528form._%2528%2528lib._racket%252Funit..rkt%2529._rename%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">rename</a></span><span class="hspace">&nbsp;</span><span class="RktSym">has-prop:type-expander?</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528def._%2528%2528submod._%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._expander%2529._prop%7E3atype-expander%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">prop:type-expander?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=type-ref.html%23%2528form._%2528%2528lib._typed-racket%252Fbase-env%252Fbase-types-extra..rkt%2529._-%7E3e%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">any/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=booleans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._boolean%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">boolean?</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=creatingunits.html%23%2528form._%2528%2528lib._racket%252Funit..rkt%2529._rename%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">rename</a></span><span class="hspace">&nbsp;</span><span class="RktSym">get-prop:type-expander-value</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528def._%2528%2528submod._%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._expander%2529._prop%7E3atype-expander-ref%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">prop:type-expander-ref</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=ts-reference&amp;rel=type-ref.html%23%2528form._%2528%2528lib._typed-racket%252Fbase-env%252Fbase-types-extra..rkt%2529._-%7E3e%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="hspace">&nbsp;</span><span class="RktSym">has-prop:type-expander?</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">any/c</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">type-expander</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">apply-type-expander</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">bind-type-vars</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528def._%2528%2528submod._%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._expander%2529._expand-type%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">expand-type</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">type</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">stx-type/c</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">type-expand!</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">debug-type-expander?</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">patched</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">make-type-expander</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><a href="#%28elem._%28prefixable._chunk~3a~3cremove-ddd~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;remove-ddd&#187;</a></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><a href="#%28elem._%28prefixable._chunk~3a~3cprop-guard~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;prop-guard&#187;</a></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><a href="#%28elem._%28prefixable._chunk~3a~3cprop~3atype-expander~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;prop:type-expander&#187;</a></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><a href="#%28elem._%28prefixable._chunk~3a~3ctype-expander-struct~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;type-expander-struct&#187;</a></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><a href="#%28elem._%28prefixable._chunk~3a~3cpatched~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;patched&#187;</a></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><a href="#%28elem._%28prefixable._chunk~3a~3capply-type-expander~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;apply-type-expander&#187;</a></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&lt;expand-quasiquote&gt;</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><a href="#%28elem._%28prefixable._chunk~3a~3ctype-syntax-class~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;type-syntax-class&#187;</a></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><a href="#%28elem._%28prefixable._chunk~3a~3ctype-contract~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;type-contract&#187;</a></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><a href="#%28elem._%28prefixable._chunk~3a~3cexpand-type-debug-outer~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;expand-type-debug-outer&#187;</a></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><a href="#%28elem._%28prefixable._chunk~3a~3cexpand-type~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;expand-type&#187;</a></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><a href="#%28elem._%28prefixable._chunk~3a~3ctype-expand-syntax-class~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;type-expand-syntax-class&#187;</a><span class="RktPn">)</span></td></tr></table></blockquote></div></p><p>We can finally define the overloaded forms, as well as the
<span class="RktSym">&lt;define-type-expander&gt;</span> form.</p><p><div class="SIntrapara"><a name="(elem._(prefixable._chunk~3a~3cmodule-main~3e~3a1~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28prefixable._chunk~3a~3cmodule-main~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;module-main&#187;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=module.html%23%2528form._%2528%2528quote._%7E23%7E25kernel%2529._module%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">module</a></span><span class="hspace">&nbsp;</span><span class="RktSym">main</span><span class="hspace">&nbsp;</span><span class="RktSym">typed/racket</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._require%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">require</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._only-in%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">only-in</a></span><span class="hspace">&nbsp;</span><span class="RktSym">typed/racket/base</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktSym">&#8230;</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">typed/racket/class</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._for-syntax%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">for-syntax</a></span><span class="hspace">&nbsp;</span><span class="RktSym">racket</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._only-in%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">only-in</a></span><span class="hspace">&nbsp;</span><span class="RktSym">racket/base</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktSym">&#8230;</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">racket/syntax</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">syntax/parse</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">syntax/parse/experimental/template</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">syntax/id-table</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">"parameterize-lexical-context.rkt"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">syntax/stx</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._for-meta%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">for-meta</a></span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="hspace">&nbsp;</span><span class="RktSym">racket/base</span><span class="hspace">&nbsp;</span><span class="RktSym">syntax/parse</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">"utils.rkt"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">syntax/parse/define</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">"identifiers.rkt"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._require%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">require</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._submod%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">submod</a></span><span class="hspace">&nbsp;</span><span class="RktVal">".."</span><span class="hspace">&nbsp;</span><span class="RktSym">expander</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._require%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">require</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._for-syntax%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">for-syntax</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._submod%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">submod</a></span><span class="hspace">&nbsp;</span><span class="RktVal">".."</span><span class="hspace">&nbsp;</span><span class="RktSym">expander</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._require%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">require</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._for-syntax%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">for-syntax</a></span><span class="hspace">&nbsp;</span><span class="RktSym">typed-racket/base-env/annotate-classes</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._provide%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">provide</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528def._%2528%2528submod._%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._expander%2529._prop%7E3atype-expander%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">prop:type-expander</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528def._%2528%2528submod._%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._expander%2529._prop%7E3atype-expander%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">prop:type-expander?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528def._%2528%2528submod._%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._expander%2529._prop%7E3atype-expander-ref%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">prop:type-expander-ref</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528def._%2528%2528submod._%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._expander%2529._expand-type%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">expand-type</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._define-type-expander%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define-type-expander</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._patch-type-expander%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">patch-type-expander</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._.Let%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">Let</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._.Letrec%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">Letrec</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._%7Ece%7E9b%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">&#923;</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._......%252A%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...*</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">No-Expand</span></span></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._unsafe-cast%252Fno-expand%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">unsafe-cast/no-expand</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._unsafe-cast%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">unsafe-cast</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._debug-type-expander%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">debug-type-expander</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._rename-out%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">rename-out</a></span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">new-:</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._%7E3a%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">:</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">new-define-type</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._define-type%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define-type</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">new-define</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._define%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">new-lambda</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._lambda%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">lambda</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">new-lambda</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._%7Ece%7Ebb%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">&#955;</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">new-case-lambda</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._case-lambda%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">case-lambda</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">new-case-lambda</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._case-lambda%7E3a%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">case-lambda:</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">new-struct</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._struct%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">struct</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">new-define-struct/exec</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._define-struct%252Fexec%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define-struct/exec</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">new-ann</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._ann%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">ann</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">new-cast</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._cast%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">cast</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">new-inst</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._inst%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">inst</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">new-let</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._let%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">let</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">new-let*</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._let%252A%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">let*</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">new-let-values</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._let-values%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">let-values</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">new-make-predicate</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._make-predicate%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">make-predicate</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">new-:type</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._%7E3atype%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">:type</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">new-:print-type</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._%7E3aprint-type%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">:print-type</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">new-:query-type/args</span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._%7E3aquery-type%252Fargs%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">:query-type/args</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">new-:query-type/result</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._%7E3aquery-type%252Fresult%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">:query-type/result</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">[new-field</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">field]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">[new-super-new</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">super-new]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">new-class</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._class%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">class</a></span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=begin.html%23%2528form._%2528%2528quote._%7E23%7E25kernel%2529._begin-for-syntax%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">begin-for-syntax</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define-syntax%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define-syntax</a></span><span class="hspace">&nbsp;</span><span class="RktSym">~with-tvars</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528def._%2528%2528lib._syntax%252Fparse..rkt%2529._pattern-expander%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">pattern-expander</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=Parsing_Syntax.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._syntax-parser%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">syntax-parser</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529.__%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">_</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">tv</span><span class="hspace">&nbsp;</span><span class="RktSym">tv-stxclass</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">pat</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktRdr">#'</span><span class="RktPn">{</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eseq%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~seq</a></span><span class="hspace">&nbsp;</span><span class="RktPn">{</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7evar%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~var</a></span><span class="hspace">&nbsp;</span><span class="RktSym">tmp-tv</span><span class="hspace">&nbsp;</span><span class="RktSym">tv-stxclass</span><span class="RktPn">}</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">{</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eseq%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~seq</a></span><span class="hspace">&nbsp;</span><span class="RktSym">whole-rest</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">}</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">{</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eparse%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~parse</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktPn">{</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7evar%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">~var</a></span><span class="hspace">&nbsp;</span><span class="RktSym">tv</span><span class="hspace">&nbsp;</span><span class="RktSym">tv-stxclass</span><span class="RktPn">}</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">pat</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">; rebind tvars:</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">with-bindings</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym">tmp-tv.vars</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=syntax&amp;rel=syntax-helpers.html%23%2528def._%2528%2528lib._syntax%252Fstx..rkt%2529._stx-map%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">stx-map</a></span><span class="hspace">&nbsp;</span><a href="#%28elem._%28prefixable._chunk~3a~3cshadowed~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;shadowed&#187;</a></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktRdr">#'</span><span class="RktPn">(</span><span class="RktSym">tmp-tv.vars</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">; rebind occurrences of the tvars within:</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">tmp-tv</span><span class="hspace">&nbsp;</span><span class="RktSym">whole-rest</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">; to (re-)parse:</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktRdr">#'</span><span class="RktPn">(</span><span class="RktSym">tmp-tv</span><span class="hspace">&nbsp;</span><span class="RktSym">whole-rest</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">}</span><span class="RktPn">}</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><a href="#%28elem._%28prefixable._chunk~3a~3cdebug-type-expander~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;debug-type-expander&#187;</a></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><a href="#%28elem._%28prefixable._chunk~3a~3c~3a~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;:&#187;</a></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><a href="#%28elem._%28prefixable._chunk~3a~3cdefine-type-expander~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;define-type-expander&#187;</a></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><a href="#%28elem._%28prefixable._chunk~3a~3cpatch~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;patch&#187;</a></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=begin.html%23%2528form._%2528%2528quote._%7E23%7E25kernel%2529._begin-for-syntax%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">begin-for-syntax</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28elem._%28prefixable._chunk~3a~3cremove-ddd~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;remove-ddd&#187;</a></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28elem._%28prefixable._chunk~3a~3csyntax-classes~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;syntax-classes&#187;</a></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._provide%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">provide</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528submod._%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._main%2529._colon%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">colon</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><a href="#%28elem._%28prefixable._chunk~3a~3cdefine-type~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;define-type&#187;</a></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><a href="#%28elem._%28prefixable._chunk~3a~3cdefine~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;define&#187;</a></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><a href="#%28elem._%28prefixable._chunk~3a~3clambda~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;lambda&#187;</a></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><a href="#%28elem._%28prefixable._chunk~3a~3ccase-lambda~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;case-lambda&#187;</a></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><a href="#%28elem._%28prefixable._chunk~3a~3cstruct~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;struct&#187;</a></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><a href="#%28elem._%28prefixable._chunk~3a~3cdefine-struct%2Fexec~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;define-struct/exec&#187;</a></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><a href="#%28elem._%28prefixable._chunk~3a~3cann~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;ann&#187;</a></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><a href="#%28elem._%28prefixable._chunk~3a~3ccast~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;cast&#187;</a></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><a href="#%28elem._%28prefixable._chunk~3a~3cunsafe-cast~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;unsafe-cast&#187;</a></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><a href="#%28elem._%28prefixable._chunk~3a~3cinst~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;inst&#187;</a></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><a href="#%28elem._%28prefixable._chunk~3a~3clet~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;let&#187;</a></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><a href="#%28elem._%28prefixable._chunk~3a~3clet%2A~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;let*&#187;</a></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><a href="#%28elem._%28prefixable._chunk~3a~3clet-values~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;let-values&#187;</a></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><a href="#%28elem._%28prefixable._chunk~3a~3cmake-predicate~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;make-predicate&#187;</a></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><a href="#%28elem._%28prefixable._chunk~3a~3c~3atype~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;:type&#187;</a></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><a href="#%28elem._%28prefixable._chunk~3a~3c~3aprint-type~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;:print-type&#187;</a></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><a href="#%28elem._%28prefixable._chunk~3a~3c~3aquery-type%2Fargs~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;:query-type/args&#187;</a></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><a href="#%28elem._%28prefixable._chunk~3a~3c~3aquery-type%2Fresult~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;:query-type/result&#187;</a></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&lt;field&gt;</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><a href="#%28elem._%28prefixable._chunk~3a~3cclass~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;class&#187;</a></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&lt;super-new&gt;</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><a href="#%28elem._%28prefixable._chunk~3a~3cother-forms~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;other-forms&#187;</a><span class="RktPn">)</span></td></tr></table></blockquote></div></p><p>We can now assemble the modules in this order:</p><p><div class="SIntrapara"><a name="(elem._(prefixable._chunk~3a~3c*~3e~3a1~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28prefixable._chunk~3a~3c%2A~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;*&#187;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><a href="#%28elem._%28prefixable._chunk~3a~3cmodule-expander~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;module-expander&#187;</a></td></tr><tr><td><a href="#%28elem._%28prefixable._chunk~3a~3cmodule-main~3e~3a1~3a1%29%29" class="plainlink" data-pltdoc="x">&#171;module-main&#187;</a></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._require%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">require</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">main</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._provide%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">provide</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._except-out%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">except-out</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._all-from-out%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">all-from-out</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">main</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._for-syntax%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">for-syntax</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=type-expander&amp;rel=index.html%23%2528form._%2528%2528submod._%2528lib._type-expander%252Ftype-expander..hl..rkt%2529._main%2529._colon%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">colon</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><div class="navsetbottom"><span class="navleft"><form class="searchform"><input class="searchbox" id="searchbox" type="text" tabindex="1" placeholder="...search manuals..." title="Enter a search string to search the manuals" onkeypress="return DoSearchKey(event, this, &quot;8.6&quot;, &quot;../&quot;);"/></form>&nbsp;&nbsp;<a href="../index-2.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;8.6&quot;);">top</a><span class="tocsettoggle">&nbsp;&nbsp;<a href="javascript:void(0);" title="show/hide table of contents" onclick="TocsetToggle();">contents</a></span></span><span class="navright">&nbsp;&nbsp;<a href="index.html" title="backward to &quot;Type expander: Implementation&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="index.html" title="up to &quot;Type expander: Implementation&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="type-expander_ty-xp-morety-xp-more.html" title="forward to &quot;2 Some example type expanders&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body>
<!-- Mirrored from docs.racket-lang.org/type-expander-implementation/type-expander_ty-xp-implty-xp-impl.html by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 07 Sep 2022 03:25:47 GMT -->
</html>