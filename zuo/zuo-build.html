<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- Mirrored from docs.racket-lang.org/zuo/zuo-build.html by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 07 Sep 2022 03:14:18 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><meta name="viewport" content="width=device-width, initial-scale=0.8"/><title>3&nbsp;Zuo as a make Replacement</title><link rel="stylesheet" type="text/css" href="../scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="../racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-style.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../doc-site.css" title="default"/><script type="text/javascript" src="../scribble-common.js"></script><script type="text/javascript" src="../manual-racket.js"></script><script type="text/javascript" src="../manual-racket.js"></script><script type="text/javascript" src="../doc-site.js"></script><script type="text/javascript" src="../local-redirect/local-redirect.js"></script><script type="text/javascript" src="../local-redirect/local-user-redirect.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="doc-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9660;</a></td><td></td><td><a href="index.html" class="tocviewlink" data-pltdoc="x">Zuo:<span class="mywbr"> &nbsp;</span> A Tiny Racket for Scripting</a></td></tr></table></div><div class="tocviewsublisttop" style="display: block;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="Zuo_Overview.html" class="tocviewlink" data-pltdoc="x">Zuo Overview</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="zuo-base.html" class="tocviewlink" data-pltdoc="x">Zuo Base Language</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="#" class="tocviewselflink" data-pltdoc="x">Zuo as a <span class="stt">make</span> Replacement</a></td></tr><tr><td align="right">4&nbsp;</td><td><a href="zuo-lib.html" class="tocviewlink" data-pltdoc="x">Zuo Libraries</a></td></tr><tr><td align="right">5&nbsp;</td><td><a href="zuo-hygienic.html" class="tocviewlink" data-pltdoc="x">Zuo with Hygienic Macros</a></td></tr><tr><td align="right">6&nbsp;</td><td><a href="Zuo_Data_as_Module.html" class="tocviewlink" data-pltdoc="x">Zuo Data as Module</a></td></tr><tr><td align="right">7&nbsp;</td><td><a href="zuo-kernel.html" class="tocviewlink" data-pltdoc="x">Zuo Kernel Language</a></td></tr></table></div></div><div class="tocviewlist"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_1&quot;);">&#9658;</a></td><td>3&nbsp;</td><td><a href="#" class="tocviewselflink" data-pltdoc="x">Zuo as a <span class="stt">make</span> Replacement</a></td></tr></table><div class="tocviewsublistbottom" style="display: none;" id="tocview_1"><table cellspacing="0" cellpadding="0"><tr><td align="right">3.1&nbsp;</td><td><a href="#%28part._make-target%29" class="tocviewlink" data-pltdoc="x">Creating Targets</a></td></tr><tr><td align="right">3.2&nbsp;</td><td><a href="#%28part._build-targets%29" class="tocviewlink" data-pltdoc="x">Building Targets</a></td></tr><tr><td align="right">3.3&nbsp;</td><td><a href="#%28part._.Recording_.Results%29" class="tocviewlink" data-pltdoc="x">Recording Results</a></td></tr><tr><td align="right">3.4&nbsp;</td><td><a href="#%28part._.Parallelism%29" class="tocviewlink" data-pltdoc="x">Parallelism</a></td></tr><tr><td align="right">3.5&nbsp;</td><td><a href="#%28part._.Build_.A.P.I%29" class="tocviewlink" data-pltdoc="x">Build API</a></td></tr></table></div></div></div><div class="tocsub"><div class="tocsubtitle">On this page:</div><table class="tocsublist" cellspacing="0"><tr><td><span class="tocsublinknumber">3.1<tt>&nbsp;</tt></span><a href="#%28part._make-target%29" class="tocsubseclink" data-pltdoc="x">Creating Targets</a></td></tr><tr><td><span class="tocsublinknumber">3.2<tt>&nbsp;</tt></span><a href="#%28part._build-targets%29" class="tocsubseclink" data-pltdoc="x">Building Targets</a></td></tr><tr><td><span class="tocsublinknumber">3.3<tt>&nbsp;</tt></span><a href="#%28part._.Recording_.Results%29" class="tocsubseclink" data-pltdoc="x">Recording Results</a></td></tr><tr><td><span class="tocsublinknumber">3.4<tt>&nbsp;</tt></span><a href="#%28part._.Parallelism%29" class="tocsubseclink" data-pltdoc="x">Parallelism</a></td></tr><tr><td><span class="tocsublinknumber">3.5<tt>&nbsp;</tt></span><a href="#%28part._.Build_.A.P.I%29" class="tocsubseclink" data-pltdoc="x">Build API</a></td></tr><tr><td><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._target~3f%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">target?</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._target-name%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">target-<wbr></wbr>name</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._target-path%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">target-<wbr></wbr>path</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._target-shell%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">target-<wbr></wbr>shell</span></a></td></tr><tr><td><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._input-file-target%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">input-<wbr></wbr>file-<wbr></wbr>target</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._input-data-target%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">input-<wbr></wbr>data-<wbr></wbr>target</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._target%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">target</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._rule%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">rule</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._rule~3f%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">rule?</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._phony-rule%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">phony-<wbr></wbr>rule</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._phony-rule~3f%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">phony-<wbr></wbr>rule?</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._token~3f%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">token?</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._build%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">build</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._build%2Fdep%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">build/<span class="mywbr"> &nbsp;</span>dep</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._build%2Fno-dep%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">build/<span class="mywbr"> &nbsp;</span>no-<wbr></wbr>dep</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._build%2Fcommand-line%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">build/<span class="mywbr"> &nbsp;</span>command-<wbr></wbr>line</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._build%2Fcommand-line%2A%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">build/<span class="mywbr"> &nbsp;</span>command-<wbr></wbr>line*</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._find-target%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">find-<wbr></wbr>target</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._make-at-dir%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">make-<wbr></wbr>at-<wbr></wbr>dir</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._command-target~3f%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">command-<wbr></wbr>target?</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._command-target-~3etarget%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">command-<wbr></wbr>target-<wbr></wbr>&gt;target</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._file-sha256%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">file-<wbr></wbr>sha256</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._sha256~3f%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">sha256?</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._sha256-length%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">sha256-<wbr></wbr>length</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._no-sha256%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">no-<wbr></wbr>sha256</span></span></a></td></tr><tr><td><a href="#%28form._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._provide-targets%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">provide-<wbr></wbr>targets</span></span></a></td></tr><tr><td><a href="#%28form._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._bounce-to-targets%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">bounce-<wbr></wbr>to-<wbr></wbr>targets</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._make-targets%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">make-<wbr></wbr>targets</span></span></a></td></tr></table></div></div><div class="maincolumn"><div class="main"><div class="versionbox"><span class="version">8.6</span></div><div class="navsettop"><span class="navleft"><form class="searchform"><input class="searchbox" id="searchbox" type="text" tabindex="1" placeholder="...search manuals..." title="Enter a search string to search the manuals" onkeypress="return DoSearchKey(event, this, &quot;8.6&quot;, &quot;../&quot;);"/></form>&nbsp;&nbsp;<a href="../index-2.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;8.6&quot;);">top</a><span class="tocsettoggle">&nbsp;&nbsp;<a href="javascript:void(0);" title="show/hide table of contents" onclick="TocsetToggle();">contents</a></span></span><span class="navright">&nbsp;&nbsp;<a href="zuo-base.html" title="backward to &quot;2 Zuo Base Language&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="index.html" title="up to &quot;Zuo: A Tiny Racket for Scripting&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="zuo-lib.html" title="forward to &quot;4 Zuo Libraries&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div><h3 x-source-module="(lib &quot;zuo-doc/zuo.scrbl&quot;)" x-source-pkg="zuo-doc" x-part-tag="&quot;zuo-build&quot;">3<tt>&nbsp;</tt><a name="(part._zuo-build)"></a><a name="(mod-path._zuo/build)"></a>Zuo as a <span class="stt">make</span> Replacement</h3><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="defmodule"><tr><td align="left" colspan="2"><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._require%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">require</a></span><span class="stt"> </span><a href="#" class="RktModLink" data-pltdoc="x"><span class="RktSym">zuo/build</span></a><span class="RktPn">)</span></td></tr></table></div><div class="SIntrapara">The <a href="#" class="RktModLink" data-pltdoc="x"><span class="RktSym">zuo/build</span></a> module is reprovided by <a href="zuo-base.html" class="RktModLink" data-pltdoc="x"><span class="RktSym">zuo</span></a>.</div></p><p>The <a href="#" class="RktModLink" data-pltdoc="x"><span class="RktSym">zuo/build</span></a> library is modeled on <span class="stt">make</span> and
<a href="https://shakebuild.com/">Shake</a> for tracking dependencies
and build steps. The library has two layers:</p><ul><li><p>The core <a href="#%28tech._target%29" class="techoutside" data-pltdoc="x"><span class="techinside">target</span></a> datatype and build engine, as reflected
by functions like <span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._target%29%29" class="RktValLink" data-pltdoc="x">target</a></span> and <span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._build%29%29" class="RktValLink" data-pltdoc="x">build</a></span>.</p></li><li><p>A makefile-like, declarative form for dependencies as
implemented by the <span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._make-targets%29%29" class="RktValLink" data-pltdoc="x">make-targets</a></span> function.</p></li></ul><p>A <a href="#%28tech._target%29" class="techoutside" data-pltdoc="x"><span class="techinside">target</span></a> represents either an input to a build (such as a
source file) or a generated output, and a target can depend on any
number of other targets. A target&rsquo;s output is represented by a
string that is normally an SHA-256 hash: more precisely, it is
represented by a value satisfying the predicate <span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._sha256~3f%29%29" class="RktValLink" data-pltdoc="x">sha256?</a></span>.
The <span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._build%29%29" class="RktValLink" data-pltdoc="x">build</a></span> procedure
records hashes and dependencies in a database located alongside
non-input targets, so it can avoid rebuilding targets when nothing has
changed since the last build. Unlike <span class="stt">make</span>, timestamps are used
only as a shortcut to avoiding computing the SHA-256 of a file (i.e., if
the timestamp has not changed, the SHA-256 result is assumed to be
unchanged).</p><p>&ldquo;Recursive make&rdquo; is encouraged in the sense that a target&rsquo;s build
rule can call <span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._build%29%29" class="RktValLink" data-pltdoc="x">build</a></span> to start a nested build, or it can call
<span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._build%2Fdep%29%29" class="RktValLink" data-pltdoc="x">build/dep</a></span> to build or register a dependency that is
discovered in the process of building.</p><h4 x-source-module="(lib &quot;zuo-doc/zuo.scrbl&quot;)" x-source-pkg="zuo-doc" x-part-tag="&quot;make-target&quot;">3.1<tt>&nbsp;</tt><a name="(part._make-target)"></a>Creating Targets</h4><p>Construct a <a name="(tech._target)"></a><span style="font-style: italic">target</span> with either <span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._input-file-target%29%29" class="RktValLink" data-pltdoc="x">input-file-target</a></span>
(given a file name), <span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._input-data-target%29%29" class="RktValLink" data-pltdoc="x">input-data-target</a></span> (given a value whose
<span class="RktSym"><a href="zuo-base.html#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._~7es%29%29" class="RktValLink" data-pltdoc="x">~s</a></span> form is hashed), or <span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._target%29%29" class="RktValLink" data-pltdoc="x">target</a></span> (given a filename for a
real target or a symbol for a <a href="#%28tech._phony%29" class="techoutside" data-pltdoc="x"><span class="techinside">phony</span></a> target).</p><p>Only a target created with <span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._target%29%29" class="RktValLink" data-pltdoc="x">target</a></span> can have dependencies, but
they are not specified when <span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._target%29%29" class="RktValLink" data-pltdoc="x">target</a></span> is called, because
computing dependencies for a target may involve work that can be
skipped if the target isn&rsquo;t needed. Instead, <span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._target%29%29" class="RktValLink" data-pltdoc="x">target</a></span> takes a
<span class="RktVar">get-rule</span> procedure that will be called if the dependencies
are needed. The <span class="RktVar">get-rule</span> procedure returns up to three
results in a <span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._rule%29%29" class="RktValLink" data-pltdoc="x">rule</a></span> record: a list of dependencies; the hash of
an already-built version of the target, if one exists, where
<span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._file-sha256%29%29" class="RktValLink" data-pltdoc="x">file-sha256</a></span> is used by default; and a <span class="RktVar">rebuild</span>
procedure that is called if the returned hash, the hash of
dependencies (rebuilt if needed), and recorded results from a previous
build together determine that a rebuild is needed.</p><p>When a target&rsquo;s <span class="RktVar">rebuild</span> function is called, it optionally
returns a hash for the result of the build if the target&rsquo;s
<span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._rule%29%29" class="RktValLink" data-pltdoc="x">rule</a></span> had one, otherwise <span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._file-sha256%29%29" class="RktValLink" data-pltdoc="x">file-sha256</a></span> is used to get a
result hash. Either way, it&rsquo;s possible that the result hash is the
same the one returned by <span class="RktVar">get-rule</span>; that is, maybe a
dependency of the target changed, but the change turned out not to
affect the built result. In that case, rebuilding for other targets
that depend on this one can be short-circuited.</p><p>Finally, in the process of building a target, a <span class="RktVar">rebuild</span>
procedure may discover additional dependencies. A discovered
dependency sent to <span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._build%2Fdep%29%29" class="RktValLink" data-pltdoc="x">build/dep</a></span> is recorded as a dependency of
the target in addition to the ones that were reported by
<span class="RktVar">get-deps</span>. Any changes in these additional targets trigger a
rebuild of the target in the future. Meanwhile, the build system
assumes that if none of the dependencies change, then the set of
additional dependencies discovered by <span class="RktVar">rebuild</span> would be the
same; that assumption allows the build system to skip
<span class="RktVar">rebuild</span> and its discoveries if none of the dependencies have
changed.</p><p>A <a name="(tech._phony)"></a><span style="font-style: italic">phony</span> target is like a regular target, but one that always
needs to be rebuilt. A typical use of a phony target is to give a name
to a set of &ldquo;top-level&rdquo; targets or to implement an action along the
lines of <span class="stt">make install</span>. Create a phony target with
<span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._target%29%29" class="RktValLink" data-pltdoc="x">target</a></span> and a symbol name.</p><p>A target can declare multiple outputs by specifying additional outputs
in a <span class="RktVal">'</span><span class="RktVal">co-outputs</span> option. The target&rsquo;s <span class="RktVar">rebuild</span>
procedure will be called if any of the additional outputs are missing
or not consistent with the result of an earlier build.</p><p>In many cases, a plain path string can be used as a target as a
shorthand for applying <span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._input-file-target%29%29" class="RktValLink" data-pltdoc="x">input-file-target</a></span> to the path string.</p><h4 x-source-module="(lib &quot;zuo-doc/zuo.scrbl&quot;)" x-source-pkg="zuo-doc" x-part-tag="&quot;build-targets&quot;">3.2<tt>&nbsp;</tt><a name="(part._build-targets)"></a>Building Targets</h4><p>There is no global list of targets that <span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._build%29%29" class="RktValLink" data-pltdoc="x">build</a></span> draws from.
Instead, <span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._build%29%29" class="RktValLink" data-pltdoc="x">build</a></span> starts with a given target, and it learns
about other targets a <span class="RktVar">get-dep</span> procedures return them and as
<span class="RktVar">rebuild</span> procedures expose them via <span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._build%2Fdep%29%29" class="RktValLink" data-pltdoc="x">build/dep</a></span>. If
<span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._build%29%29" class="RktValLink" data-pltdoc="x">build</a></span> discovers multiple non-input targets with the same
filename, then it reports an error.</p><p>The <span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._build%2Fcommand-line%29%29" class="RktValLink" data-pltdoc="x">build/command-line</a></span> function is a convenience to implement
get <span class="stt">make</span>-like command-line handling for building targets. The
<span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._build%2Fcommand-line%29%29" class="RktValLink" data-pltdoc="x">build/command-line</a></span> procedure takes a list of targets, and it
calls <span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._build%29%29" class="RktValLink" data-pltdoc="x">build</a></span> on one or more of them based on command-line
arguments (with help from <span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._find-target%29%29" class="RktValLink" data-pltdoc="x">find-target</a></span>).</p><p>All relative paths are considered relative to the start-time current
directory. This convention works well for running a Zuo script that&rsquo;s
in a source directory while the current directory is the build
directory, as long as the script references source files with
<span class="RktSym"><a href="zuo-base.html#%28form._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._at-source%29%29" class="RktStxLink" data-pltdoc="x">at-source</a></span> to make them relative to the script. For
multi-directory builds, a good convention is for each directory to
have a script that exports a <span class="RktSym">targets-at</span> procedure,
where <span class="RktSym">targets-at</span> takes an <span class="RktVar">at-dir</span> procedure
(supplied as just <span class="RktSym"><a href="zuo-base.html#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._build-path%29%29" class="RktValLink" data-pltdoc="x">build-path</a></span> by default) to apply to each
target path when building a list of targets, and a hash table of
variables (analogous to variables that a makefile might provide to
another makefile via <span class="stt">make</span> arguments).</p><p>As a further convenience following the <span class="RktSym">targets-at</span>
model, the <span class="RktSym"><a href="#%28form._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._provide-targets%29%29" class="RktStxLink" data-pltdoc="x">provide-targets</a></span> form takes an identifier for such a
<span class="RktSym">targets-at</span> procedure, and it both exports
<span class="RktSym">targets-at</span> and creates a <span class="RktSym">main</span> <a href="zuo-base.html#%28tech._submodule%29" class="techoutside" data-pltdoc="x"><span class="techinside">submodule</span></a>
that calls <span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._build%2Fcommand-line%2A%29%29" class="RktValLink" data-pltdoc="x">build/command-line*</a></span> on with the
<span class="RktSym">targets-at</span> procedure.</p><p>As a naming convention, consider using <span class="stt">"main.zuo"</span> in a
directory where build results are intended to be written, but use
<span class="stt">"build.zuo"</span> in a source directory that is intended to be
(potentially) separate from the build directory. In other words, use
<span class="stt">"main.zuo"</span> as a replacement for <span class="stt">"Makefile"</span> and
<span class="stt">"build.zuo"</span> as a replacement for <span class="stt">"Makefile.in"</span> in a
<span class="stt">configure</span>-style build. You may even have a <span class="stt">configure</span>
script that generates a <span class="stt">"main.zuo"</span> script in a build
directory so that <span class="stt">zuo .</span> is a replacement for <span class="stt">make</span>.
The generated <span class="stt">"main.zuo"</span> could import the source directory&rsquo;s
<span class="stt">"build.zuo"</span> and calls <span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._build%2Fcommand-line%2A%29%29" class="RktValLink" data-pltdoc="x">build/command-line*</a></span> on with
the imported <span class="RktSym">targets-at</span> procedure plus
<span class="RktSym"><a href="zuo-base.html#%28form._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._at-source%29%29" class="RktStxLink" data-pltdoc="x">at-source</a></span>:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=guide&amp;rel=Module_Syntax.html%23%2528part._hash-lang%2529&amp;version=8.6" class="RktModLink Sq" data-pltdoc="x"><span class="RktMod">#lang</span></a><span class="hspace">&nbsp;</span><a href="zuo-base.html" class="RktModLink" data-pltdoc="x"><span class="RktSym">zuo</span></a></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="zuo-base.html#%28form._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._require%29%29" class="RktStxLink" data-pltdoc="x">require</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"</span><span class="sroman">&#8249;<span style="font-style: italic">srcdir</span>&#8250;</span><span class="RktVal">/build.zuo"</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._build%2Fcommand-line%2A%29%29" class="RktValLink" data-pltdoc="x">build/command-line*</a></span><span class="hspace">&nbsp;</span><span class="RktSym">targets-at</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="zuo-base.html#%28form._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._at-source%29%29" class="RktStxLink" data-pltdoc="x">at-source</a></span><span class="RktPn">)</span></td></tr></table></blockquote><p>However, correctly encoding <span class="sroman">&#8249;<span style="font-style: italic">srcdir</span>&#8250;</span> can be tricky when
working from something like a shell configure script or batch file to
generate <span class="stt">"main.zuo"</span>. You may find it easier to write the path
to a separate file using a shell-variable assignment syntax, and then
have the generated <span class="stt">"main.zuo"</span> read from that file. The
<span class="RktSym"><a href="#%28form._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._bounce-to-targets%29%29" class="RktStxLink" data-pltdoc="x">bounce-to-targets</a></span> form implements that pattern. For example,
if <span class="stt">"Mf-config"</span> is written in the same directory with a
<span class="RktInBG"><span class="hspace"></span><span class="RktIn">srcdir=</span><span class="hspace"></span></span> line to specify the source directory (where no
escapes are needed for the path after <span class="RktInBG"><span class="hspace"></span><span class="RktIn">=</span><span class="hspace"></span></span>), then a
<span class="stt">"mzin.zuo"</span> of them form</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=guide&amp;rel=Module_Syntax.html%23%2528part._hash-lang%2529&amp;version=8.6" class="RktModLink Sq" data-pltdoc="x"><span class="RktMod">#lang</span></a><span class="hspace">&nbsp;</span><a href="zuo-base.html" class="RktModLink" data-pltdoc="x"><span class="RktSym">zuo</span></a></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._bounce-to-targets%29%29" class="RktStxLink" data-pltdoc="x">bounce-to-targets</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"Mf-config"</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">srcdir</span><span class="hspace">&nbsp;</span><span class="RktVal">"build.zuo"</span><span class="RktPn">)</span></td></tr></table></blockquote><p>reads <span class="stt">"Mf-config"</span> to find and dispatch to
<span class="stt">"build.zuo"</span> in the same way as the earlier example module.</p><h4 x-source-module="(lib &quot;zuo-doc/zuo.scrbl&quot;)" x-source-pkg="zuo-doc" x-part-tag="&quot;Recording_Results&quot;">3.3<tt>&nbsp;</tt><a name="(part._.Recording_.Results)"></a>Recording Results</h4><p>Build results are stored in a <span class="stt">"_zuo.db"</span> file in the same
directory as a target (by default). Cached SHA-256 results with associated
file timestamps are stored in a <span class="stt">"_zuo_tc.db"</span> in the same
directory (i.e., the cached value for dependency is kept with the
target, which is in a writable build space, while an input-file target
might be in a read-only source space). A target&rsquo;s options can specify
an alternative directory to use for <span class="stt">"_zuo.db"</span> and
<span class="stt">"_zuo_tc.db"</span>. Timestamp recording in <span class="stt">"_zuo_tc.db"</span>
is disabled if the <span class="stt">SOURCE_DATE_EPOCH</span> environment variable is set.</p><p>In the unfortunate case that a <span class="stt">"_zuo.db"</span> or
<span class="stt">"_zuo_tc.db"</span> file gets mangled, then it may trigger an error
that halts the build system, but the <span class="stt">"_zuo.db"</span> or
<span class="stt">"_zuo_tc.db"</span> file will be deleted in reaction to the error.
Another attempt at the build should recover, while perhaps rebuilding
more than it would have otherwise, since the result of previous builds
might have been lost.</p><p>Specify a location for the <span class="stt">"_zuo.db"</span> and
<span class="stt">"_zuo_tc.db"</span> files associated with a target via the
<span class="RktVal">'</span><span class="RktVal">db-dir</span> target option. The <span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._make-targets%29%29" class="RktValLink" data-pltdoc="x">make-targets</a></span> function
recognizes as <span class="RktSym">:db-dir</span> clause to set the option for all of the
targets that it creates.</p><h4 x-source-module="(lib &quot;zuo-doc/zuo.scrbl&quot;)" x-source-pkg="zuo-doc" x-part-tag="&quot;Parallelism&quot;">3.4<tt>&nbsp;</tt><a name="(part._.Parallelism)"></a>Parallelism</h4><p>A build runs in a <a href="zuo-thread.html#%28tech._threading._context%29" class="techoutside" data-pltdoc="x"><span class="techinside">threading context</span></a>, so a target&rsquo;s
<span class="RktVar">get-deps</span> or <span class="RktVar">rebuild</span> procedure can use
<span class="RktSym"><a href="zuo-thread.html#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._thread-process-wait%29%29" class="RktValLink" data-pltdoc="x">thread-process-wait</a></span> can be used to wait on a process. Doing
so can enable parallelism among targets, depending on the
<span class="RktVal">'</span><span class="RktVal">jobs</span> option provided to <span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._build%29%29" class="RktValLink" data-pltdoc="x">build</a></span> or
<span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._build%2Fcommand-line%29%29" class="RktValLink" data-pltdoc="x">build/command-line</a></span>, a <span class="nobreak"><span class="stt">--jobs</span></span> command-line argument
parsed by <span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._build%2Fcommand-line%29%29" class="RktValLink" data-pltdoc="x">build/command-line</a></span>, or the <span class="stt">ZUO_JOBS</span>
environment variable.</p><p>When calling <span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._build%29%29" class="RktValLink" data-pltdoc="x">build</a></span> for a nested build from a target&rsquo;s
<span class="RktVar">get-deps</span> or <span class="RktVar">rebuild</span> procedures, supply the
<a href="#%28tech._build._token%29" class="techoutside" data-pltdoc="x"><span class="techinside">build token</span></a> that is passed to <span class="RktVar">get-deps</span> to the
<span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._build%29%29" class="RktValLink" data-pltdoc="x">build</a></span> call. That way, parallelism configured for the
enclosing build will be extended to the nested build.</p><h4 x-source-module="(lib &quot;zuo-doc/zuo.scrbl&quot;)" x-source-pkg="zuo-doc" x-part-tag="&quot;Build_API&quot;">3.5<tt>&nbsp;</tt><a name="(part._.Build_.A.P.I)"></a>Build API</h4><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._zuo-doc/fake-zuo..rkt)._target~3f))"></a><span title="Provided from: zuo, zuo/build"><span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._target~3f%29%29" class="RktValDef RktValLink" data-pltdoc="x">target?</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">v</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="zuo-base.html#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._boolean~3f%29%29" class="RktValLink" data-pltdoc="x">boolean?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">v</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">any/c</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Returns <span class="RktVal">#t</span> if <span class="RktVar">v</span> is <a href="#%28tech._target%29" class="techoutside" data-pltdoc="x"><span class="techinside">target</span></a>, <span class="RktVal">#f</span>
otherwise.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._zuo-doc/fake-zuo..rkt)._target-name))"></a><span title="Provided from: zuo, zuo/build"><span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._target-name%29%29" class="RktValDef RktValLink" data-pltdoc="x">target-name</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">t</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="zuo-base.html#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._symbol~3f%29%29" class="RktValLink" data-pltdoc="x">symbol?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="zuo-base.html#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._path-string~3f%29%29" class="RktValLink" data-pltdoc="x">path-string?</a></span><span class="RktPn">)</span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">t</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._target~3f%29%29" class="RktValLink" data-pltdoc="x">target?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Returns the name of a target, which is a path for most targets, but a
symbol for an input-data target or a <a href="#%28tech._phony%29" class="techoutside" data-pltdoc="x"><span class="techinside">phony</span></a> target.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._zuo-doc/fake-zuo..rkt)._target-path))"></a><span title="Provided from: zuo, zuo/build"><span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._target-path%29%29" class="RktValDef RktValLink" data-pltdoc="x">target-path</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">t</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="zuo-base.html#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._path-string~3f%29%29" class="RktValLink" data-pltdoc="x">path-string?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">t</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._target~3f%29%29" class="RktValLink" data-pltdoc="x">target?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">The same as <span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._target-name%29%29" class="RktValLink" data-pltdoc="x">target-name</a></span> for a target whose name is a path,
and an error for other targets.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._zuo-doc/fake-zuo..rkt)._target-shell))"></a><span title="Provided from: zuo, zuo/build"><span class="RktSym"><span class="RktSymDef RktSym">target-shell</span></span></span><span class="hspace">&nbsp;</span><span class="RktVar">t</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="zuo-base.html#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._string~3f%29%29" class="RktValLink" data-pltdoc="x">string?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">t</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._target~3f%29%29" class="RktValLink" data-pltdoc="x">target?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Composes <span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._target-path%29%29" class="RktValLink" data-pltdoc="x">target-path</a></span> with <span class="RktSym"><a href="zuo-base.html#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._string-~3eshell%29%29" class="RktValLink" data-pltdoc="x">string-&gt;shell</a></span>. Use this
when getting a target name to include in a shell command.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._zuo-doc/fake-zuo..rkt)._input-file-target))"></a><span title="Provided from: zuo, zuo/build"><span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._input-file-target%29%29" class="RktValDef RktValLink" data-pltdoc="x">input-file-target</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">path</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._target~3f%29%29" class="RktValLink" data-pltdoc="x">target?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">path</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="zuo-base.html#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._path-string~3f%29%29" class="RktValLink" data-pltdoc="x">path-string?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Creates a <a href="#%28tech._target%29" class="techoutside" data-pltdoc="x"><span class="techinside">target</span></a> that represents an input file. An input-file
target has no build procedure, and it&rsquo;s state is summarized as a hash
via <span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._file-sha256%29%29" class="RktValLink" data-pltdoc="x">file-sha256</a></span>.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._zuo-doc/fake-zuo..rkt)._input-data-target))"></a><span title="Provided from: zuo, zuo/build"><span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._input-data-target%29%29" class="RktValDef RktValLink" data-pltdoc="x">input-data-target</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">name</span><span class="hspace">&nbsp;</span><span class="RktVar">content</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._target~3f%29%29" class="RktValLink" data-pltdoc="x">target?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">name</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="zuo-base.html#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._symbol~3f%29%29" class="RktValLink" data-pltdoc="x">symbol?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">content</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">any/c</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Similar to <span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._input-file-target%29%29" class="RktValLink" data-pltdoc="x">input-file-target</a></span> for a would-be file that
contains <span class="RktPn">(</span><span class="RktSym"><a href="zuo-base.html#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._~7es%29%29" class="RktValLink" data-pltdoc="x">~s</a></span><span class="stt"> </span><span class="RktVar">content</span><span class="RktPn">)</span>.</div></p><p>The result of <span class="RktPn">(</span><span class="RktSym"><a href="zuo-base.html#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._symbol-~3estring%29%29" class="RktValLink" data-pltdoc="x">symbol-&gt;string</a></span><span class="stt"> </span><span class="RktVar">name</span><span class="RktPn">)</span> must be distinct among
all the input-data dependencies of a particular target, but it does
not need to be globally unique.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._zuo-doc/fake-zuo..rkt)._target))"></a><span title="Provided from: zuo, zuo/build"><span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._target%29%29" class="RktValDef RktValLink" data-pltdoc="x">target</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">name</span><span class="hspace">&nbsp;</span><span class="RktVar">get-deps</span><span class="hspace">&nbsp;</span><span class="RktOpt">[</span><span class="RktVar">options</span><span class="RktOpt">]</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._target~3f%29%29" class="RktValLink" data-pltdoc="x">target?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">name</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="zuo-base.html#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._path-string~3f%29%29" class="RktValLink" data-pltdoc="x">path-string?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">get-deps</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="zuo-base.html#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._path-string~3f%29%29" class="RktValLink" data-pltdoc="x">path-string?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._token~3f%29%29" class="RktValLink" data-pltdoc="x">token?</a></span><span class="hspace">&nbsp;</span><span class="RktPn">. </span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=function-contracts.html%23%2528form._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._-%7E3e%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="RktPn"> .</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._rule~3f%29%29" class="RktValLink" data-pltdoc="x">rule?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">options</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="zuo-base.html#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._hash~3f%29%29" class="RktValLink" data-pltdoc="x">hash?</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="zuo-base.html#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._hash%29%29" class="RktValLink" data-pltdoc="x">hash</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span title="Provided from: zuo, zuo/build"><span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._target%29%29" class="RktValDef RktValLink" data-pltdoc="x">target</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">name</span><span class="hspace">&nbsp;</span><span class="RktVar">get-deps</span><span class="hspace">&nbsp;</span><span class="RktOpt">[</span><span class="RktVar">options</span><span class="RktOpt">]</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._target~3f%29%29" class="RktValLink" data-pltdoc="x">target?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">name</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="zuo-base.html#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._symbol~3f%29%29" class="RktValLink" data-pltdoc="x">symbol?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">get-deps</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._token~3f%29%29" class="RktValLink" data-pltdoc="x">token?</a></span><span class="hspace">&nbsp;</span><span class="RktPn">. </span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=function-contracts.html%23%2528form._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._-%7E3e%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="RktPn"> .</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._phony-rule~3f%29%29" class="RktValLink" data-pltdoc="x">phony-rule?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">options</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="zuo-base.html#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._hash~3f%29%29" class="RktValLink" data-pltdoc="x">hash?</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="zuo-base.html#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._hash%29%29" class="RktValLink" data-pltdoc="x">hash</a></span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Creates a <a href="#%28tech._target%29" class="techoutside" data-pltdoc="x"><span class="techinside">target</span></a> that can have dependencies. If <span class="RktVar">name</span>
is a path string, then it represents a file build target whose results
are recorded to avoid rebuilding. If <span class="RktVar">name</span> is a symbol, then
it represents a <a href="#%28tech._phony%29" class="techoutside" data-pltdoc="x"><span class="techinside">phony</span></a> target that is always rebuilt.</div></p><p>In the case of a file target, <span class="RktVar">get-deps</span> receives <span class="RktVar">name</span>
back, because that&rsquo;s often more convenient for constructing a target
when applying an <span class="RktVar">at-dir</span> function to create <span class="RktVar">name</span>.</p><p>The <a name="(tech._build._token)"></a><span style="font-style: italic">build token</span> argument to <span class="RktVar">get-deps</span> represents the
target build in progress. It&rsquo;s useful with <span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._file-sha256%29%29" class="RktValLink" data-pltdoc="x">file-sha256</a></span> to take
advantage of caching, with <span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._build%2Fdep%29%29" class="RktValLink" data-pltdoc="x">build/dep</a></span> to report
discovered targets, and with <span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._build%2Fno-dep%29%29" class="RktValLink" data-pltdoc="x">build/no-dep</a></span> or <span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._build%29%29" class="RktValLink" data-pltdoc="x">build</a></span>.</p><p>The following keys are recognized in <span class="RktVar">options</span>:</p><ul><li><p><span class="RktVal">'</span><span class="RktVal">co-outputs</span> mapped to a list of path strings: paths
that are also generated by the target in addition to
<span class="RktVar">name</span> when <span class="RktVar">name</span> is a path string; the target&rsquo;s
build function will be called if the combination of
<span class="RktVar">name</span> and these files is out-of-date.</p></li><li><p><span class="RktVal">'</span><span class="RktVal">precious?</span> mapped to any value: if non-<span class="RktVal">#f</span> for
a non-phony target, <span class="RktVar">name</span> is not deleted if the
<span class="RktVar">get-deps</span> function or its result&rsquo;s <span class="RktVar">rebuild</span>
function fails.</p></li><li><p><span class="RktVal">'</span><span class="RktVal">command?</span> mapped to any value: if non-<span class="RktVal">#f</span>, when
<span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._build%2Fcommand-line%29%29" class="RktValLink" data-pltdoc="x">build/command-line</a></span> runs the target as the first one
named on the command line, all arguments from the command line
after the target name are provided <span class="RktVar">get-deps</span> as
additional arguments. When building a target directly instead
of through <span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._build%2Fcommand-line%29%29" class="RktValLink" data-pltdoc="x">build/command-line</a></span>, use
<span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._command-target-~3etarget%29%29" class="RktValLink" data-pltdoc="x">command-target-&gt;target</a></span> to supply arguments.</p></li><li><p><span class="RktVal">'</span><span class="RktVal">noisy?</span> mapped to any value: if non-<span class="RktVal">#f</span>, then a
message prints via <span class="RktSym"><a href="zuo-base.html#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._alert%29%29" class="RktValLink" data-pltdoc="x">alert</a></span> whenever when the target is
found to be already up to date.</p></li><li><p><span class="RktVal">'</span><span class="RktVal">quiet?</span> mapped to any value: if non-<span class="RktVal">#f</span>, then
even when <span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._build%29%29" class="RktValLink" data-pltdoc="x">build</a></span> runs the target directly or as the
dependency of a <a href="#%28tech._phony%29" class="techoutside" data-pltdoc="x"><span class="techinside">phony</span></a> target, it does not print a message
via <span class="RktSym"><a href="zuo-base.html#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._alert%29%29" class="RktValLink" data-pltdoc="x">alert</a></span> when the target is up to date, unless the
target is also noisy. When a phony target is quiet, it builds
its dependencies as quiet.</p></li><li><p><span class="RktVal">'</span><span class="RktVal">eager?</span> mapped to any value: if non-<span class="RktVal">#f</span>, then
the target&rsquo;s build step is not run in a separate thread, which
has the effect of ordering the build step before others that do
run in a separate thread.</p></li><li><p><span class="RktVal">'</span><span class="RktVal">db-dir</span> mapped to a path or <span class="RktVal">#f</span>: if
non-<span class="RktVal">#f</span>, build information for the target is stored in
<span class="stt">"_zuo.db"</span> and <span class="stt">"_zuo_tc.db"</span> files in the
specified directory, instead of the directory of <span class="RktSym">path</span>.</p></li></ul><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><table cellspacing="0" cellpadding="0" class="together"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._zuo-doc/fake-zuo..rkt)._rule))"></a><span title="Provided from: zuo, zuo/build"><span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._rule%29%29" class="RktValDef RktValLink" data-pltdoc="x">rule</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">dependencies</span><span class="hspace">&nbsp;</span><span class="RktOpt">[</span><span class="RktVar">rebuild</span><span class="hspace">&nbsp;</span><span class="RktVar">sha256</span><span class="RktOpt">]</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._rule~3f%29%29" class="RktValLink" data-pltdoc="x">rule?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">dependencies</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._listof%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">listof</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._target~3f%29%29" class="RktValLink" data-pltdoc="x">target?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="zuo-base.html#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._path-string~3f%29%29" class="RktValLink" data-pltdoc="x">path-string?</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">rebuild</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=function-contracts.html%23%2528form._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._-%7E3e%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._sha256~3f%29%29" class="RktValLink" data-pltdoc="x">sha256?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">any/c</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#f</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">sha256</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._sha256~3f%29%29" class="RktValLink" data-pltdoc="x">sha256?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#f</span></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="together"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._zuo-doc/fake-zuo..rkt)._rule~3f))"></a><span title="Provided from: zuo, zuo/build"><span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._rule~3f%29%29" class="RktValDef RktValLink" data-pltdoc="x">rule?</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">v</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="zuo-base.html#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._boolean~3f%29%29" class="RktValLink" data-pltdoc="x">boolean?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">v</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">any/c</a></span></td></tr></table></td></tr></table></blockquote></div><div class="SIntrapara">The <span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._rule%29%29" class="RktValLink" data-pltdoc="x">rule</a></span> procedure combines the three results expected from a
procedure passed to <span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._target%29%29" class="RktValLink" data-pltdoc="x">target</a></span>. See <a href="#%28part._make-target%29" data-pltdoc="x">Creating Targets</a>.</div></p><p>A path string can be reported as a dependency in
<span class="RktVar">dependencies</span>, in which case it is coerced to a target using
<span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._input-file-target%29%29" class="RktValLink" data-pltdoc="x">input-file-target</a></span>. If <span class="RktVar">sha256</span> is <span class="RktVal">#f</span>,
<span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._file-sha256%29%29" class="RktValLink" data-pltdoc="x">file-sha256</a></span> is used to compute the target&rsquo;s current hash, and
<span class="RktVar">rebuild</span> is not expected to return a hash. If <span class="RktVar">sha256</span> is
not <span class="RktVal">#f</span>, then if <span class="RktVar">rebuild</span> is called, it must return a
new hash.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><table cellspacing="0" cellpadding="0" class="together"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._zuo-doc/fake-zuo..rkt)._phony-rule))"></a><span title="Provided from: zuo, zuo/build"><span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._phony-rule%29%29" class="RktValDef RktValLink" data-pltdoc="x">phony-rule</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">dependencies</span><span class="hspace">&nbsp;</span><span class="RktVar">rebuild</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._phony-rule~3f%29%29" class="RktValLink" data-pltdoc="x">phony-rule?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">dependencies</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._listof%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">listof</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._target~3f%29%29" class="RktValLink" data-pltdoc="x">target?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="zuo-base.html#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._path-string~3f%29%29" class="RktValLink" data-pltdoc="x">path-string?</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">rebuild</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=function-contracts.html%23%2528form._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._-%7E3e%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">any/c</a></span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="together"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._zuo-doc/fake-zuo..rkt)._phony-rule~3f))"></a><span title="Provided from: zuo, zuo/build"><span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._phony-rule~3f%29%29" class="RktValDef RktValLink" data-pltdoc="x">phony-rule?</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">v</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="zuo-base.html#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._boolean~3f%29%29" class="RktValLink" data-pltdoc="x">boolean?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">v</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">any/c</a></span></td></tr></table></td></tr></table></blockquote></div><div class="SIntrapara">The <span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._phony-rule%29%29" class="RktValLink" data-pltdoc="x">phony-rule</a></span> procedure combines the two results expected
from a procedure passed to <span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._target%29%29" class="RktValLink" data-pltdoc="x">target</a></span> to create a <a href="#%28tech._phony%29" class="techoutside" data-pltdoc="x"><span class="techinside">phony</span></a>
target. Compared to the non-phony protocol, the result SHA-256 is
omitted.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._zuo-doc/fake-zuo..rkt)._token~3f))"></a><span title="Provided from: zuo, zuo/build"><span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._token~3f%29%29" class="RktValDef RktValLink" data-pltdoc="x">token?</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">v</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="zuo-base.html#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._boolean~3f%29%29" class="RktValLink" data-pltdoc="x">boolean?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">v</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">any/c</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Returns <span class="RktVal">#t</span> if <span class="RktVar">v</span> is a token representing a target
build, <span class="RktVal">#f</span> otherwise.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._zuo-doc/fake-zuo..rkt)._build))"></a><span title="Provided from: zuo, zuo/build"><span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._build%29%29" class="RktValDef RktValLink" data-pltdoc="x">build</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">target</span><span class="hspace">&nbsp;</span><span class="RktOpt">[</span><span class="RktVar">token</span><span class="hspace">&nbsp;</span><span class="RktVar">options</span><span class="RktOpt">]</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="zuo-base.html#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._void~3f%29%29" class="RktValLink" data-pltdoc="x">void?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">target</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._target~3f%29%29" class="RktValLink" data-pltdoc="x">target?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="zuo-base.html#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._path-string~3f%29%29" class="RktValLink" data-pltdoc="x">path-string?</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._listof%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">listof</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._target~3f%29%29" class="RktValLink" data-pltdoc="x">target?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="zuo-base.html#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._path-string~3f%29%29" class="RktValLink" data-pltdoc="x">path-string?</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">token</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._token~3f%29%29" class="RktValLink" data-pltdoc="x">token?</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#f</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">options</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="zuo-base.html#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._hash~3f%29%29" class="RktValLink" data-pltdoc="x">hash?</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="zuo-base.html#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._hash%29%29" class="RktValLink" data-pltdoc="x">hash</a></span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Builds <span class="RktVar">target</span> as a fresh build process, independent of any
that might already be running (in the sense described below). A list
of targets as <span class="RktVar">target</span> is coerced to a phony target that
depends on the given list.</div></p><p>If <span class="RktVar">target</span> is a path, then it is coerced to target via
<span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._input-file-target%29%29" class="RktValLink" data-pltdoc="x">input-file-target</a></span>, but the only effect will be to compute the
file&rsquo;s SHA-256 or error if the file does not exist.</p><p>The <span class="RktVar">options</span> argument supplies build options, and the
following keys are recognized:</p><ul><li><p><span class="RktVal">'</span><span class="RktVal">jobs</span> mapped to a positive integer: controls the
maximum build steps that are allowed to proceed concurrently,
and this concurrency turns into parallelism when a task uses a
process and <span class="RktSym"><a href="zuo-thread.html#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._thread-process-wait%29%29" class="RktValLink" data-pltdoc="x">thread-process-wait</a></span>; the <span class="stt">ZUO_JOBS</span>
environment variable determines the default if it is set,
otherwise the default is 1</p></li><li><p><span class="RktVal">'</span><span class="RktVal">log?</span> mapped to any value: enables logging of rebuild
reasons via <span class="RktSym"><a href="zuo-base.html#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._alert%29%29" class="RktValLink" data-pltdoc="x">alert</a></span> when the value is not <span class="RktVal">#f</span>;
logging also can be enabled by setting the
<span class="stt">ZUO_BUILD_LOG</span> environment variable</p></li></ul><p>If <span class="RktVar">token</span> is not <span class="RktVal">#f</span>, it must be a <a href="#%28tech._build._token%29" class="techoutside" data-pltdoc="x"><span class="techinside">build token</span></a>
that was passed to a target&rsquo;s <span class="RktVar">get-deps</span> to represent a build
in progress (but paused to run this one). The new build process uses
parallelism available within the in-progress build for the new build
process.</p><p>Whether or not <span class="RktVar">token</span> is <span class="RktVal">#f</span>, the new build is
independent of other builds in the sense that target results for
others build are not reused for this one. That is, other builds and
this one might check the states of some of the same files, but any
triggered actions are separate, and <a href="#%28tech._phony%29" class="techoutside" data-pltdoc="x"><span class="techinside">phony</span></a> targets are similarly
triggered independently. Use <span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._build%2Fdep%29%29" class="RktValLink" data-pltdoc="x">build/dep</a></span> or
<span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._build%2Fno-dep%29%29" class="RktValLink" data-pltdoc="x">build/no-dep</a></span>, instead, to recursively trigger targets within
the same build.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._zuo-doc/fake-zuo..rkt)._build/dep))"></a><span title="Provided from: zuo, zuo/build"><span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._build%2Fdep%29%29" class="RktValDef RktValLink" data-pltdoc="x">build/dep</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">target</span><span class="hspace">&nbsp;</span><span class="RktVar">token</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="zuo-base.html#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._void~3f%29%29" class="RktValLink" data-pltdoc="x">void?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">target</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="zuo-base.html#%28form._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._or%29%29" class="RktStxLink" data-pltdoc="x">or</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._target~3f%29%29" class="RktValLink" data-pltdoc="x">target?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="zuo-base.html#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._path-string~3f%29%29" class="RktValLink" data-pltdoc="x">path-string?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">token</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._token~3f%29%29" class="RktValLink" data-pltdoc="x">token?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Like <span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._build%29%29" class="RktValLink" data-pltdoc="x">build</a></span>, but continues a build in progress as represented
by a <span class="RktVar">token</span> that was passed to a target&rsquo;s <span class="RktVar">get-deps</span>
or <span class="RktVar">rebuild</span> procedure. Targets reachable through
<span class="RktVar">target</span> may have been built or have be in progress already,
for example. After <span class="RktVar">target</span> is built, it is registered as a
dependency of the target that received <span class="RktVar">token</span> (if the target
is not <a href="#%28tech._phony%29" class="techoutside" data-pltdoc="x"><span class="techinside">phony</span></a>).</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._zuo-doc/fake-zuo..rkt)._build/no-dep))"></a><span title="Provided from: zuo, zuo/build"><span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._build%2Fno-dep%29%29" class="RktValDef RktValLink" data-pltdoc="x">build/no-dep</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">target</span><span class="hspace">&nbsp;</span><span class="RktVar">token</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="zuo-base.html#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._void~3f%29%29" class="RktValLink" data-pltdoc="x">void?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">target</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="zuo-base.html#%28form._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._or%29%29" class="RktStxLink" data-pltdoc="x">or</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._target~3f%29%29" class="RktValLink" data-pltdoc="x">target?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="zuo-base.html#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._path-string~3f%29%29" class="RktValLink" data-pltdoc="x">path-string?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">token</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._token~3f%29%29" class="RktValLink" data-pltdoc="x">token?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Like <span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._build%2Fdep%29%29" class="RktValLink" data-pltdoc="x">build/dep</a></span> to continue a build in progress, but does not
register a dependency. Using <span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._build%2Fno-dep%29%29" class="RktValLink" data-pltdoc="x">build/no-dep</a></span> has an effect
similar to <a href="https://shakebuild.com/">Shake</a>&rsquo;s &ldquo;order only&rdquo; dependencies.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._zuo-doc/fake-zuo..rkt)._build/command-line))"></a><span title="Provided from: zuo, zuo/build"><span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._build%2Fcommand-line%29%29" class="RktValDef RktValLink" data-pltdoc="x">build/command-line</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">targets</span><span class="hspace">&nbsp;</span><span class="RktOpt">[</span><span class="RktVar">options</span><span class="RktOpt">]</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="zuo-base.html#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._void~3f%29%29" class="RktValLink" data-pltdoc="x">void?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">targets</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._listof%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">listof</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._target~3f%29%29" class="RktValLink" data-pltdoc="x">target?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">options</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="zuo-base.html#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._hash~3f%29%29" class="RktValLink" data-pltdoc="x">hash?</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="zuo-base.html#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._hash%29%29" class="RktValLink" data-pltdoc="x">hash</a></span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Parses command-line arguments to build one or more targets in
<span class="RktVar">targets</span>, where the first one is built by default. The
<span class="RktVar">options</span> argument is passed along to <span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._build%29%29" class="RktValLink" data-pltdoc="x">build</a></span>, but may
be adjusted via command-line flags such as <span class="nobreak"><span class="stt">--jobs</span></span>.</div></p><p>If <span class="RktVar">options</span> has a mapping for <span class="RktVal">'</span><span class="RktVal">args</span>, the value is
used as the command-line arguments to parse instead of
<span class="RktPn">(</span><span class="RktSym"><a href="zuo-base.html#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._hash-ref%29%29" class="RktValLink" data-pltdoc="x">hash-ref</a></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym">system-env</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktVal">'</span><span class="RktVal">args</span><span class="RktPn">)</span>. If <span class="RktVar">options</span> has a
mapping for <span class="RktVal">'</span><span class="RktVal">usage</span>, the value is used as the usage options
string.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><table cellspacing="0" cellpadding="0" class="prototype RForeground"><tr><td valign="top"><span class="RktPn">(</span><a name="(def._((lib._zuo-doc/fake-zuo..rkt)._build/command-line*))"></a><span title="Provided from: zuo, zuo/build"><span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._build%2Fcommand-line%2A%29%29" class="RktValDef RktValLink" data-pltdoc="x">build/command-line*</a></span></span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">targets-at</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span><span class="RktOpt">[</span></td><td valign="top"><span class="RktVar">at-dir</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">options</span><span class="RktOpt">]</span><span class="RktPn">)</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">&rarr;</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktSym"><a href="zuo-base.html#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._void~3f%29%29" class="RktValLink" data-pltdoc="x">void?</a></span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">targets-at</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="zuo-base.html#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._procedure~3f%29%29" class="RktValLink" data-pltdoc="x">procedure?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="zuo-base.html#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._hash~3f%29%29" class="RktValLink" data-pltdoc="x">hash?</a></span><span class="hspace">&nbsp;</span><span class="RktPn">. </span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=function-contracts.html%23%2528form._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._-%7E3e%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="RktPn"> .</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._listof%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">listof</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._target~3f%29%29" class="RktValLink" data-pltdoc="x">target?</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">at-dir</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="zuo-base.html#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._path-string~3f%29%29" class="RktValLink" data-pltdoc="x">path-string?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">...</span><span class="hspace">&nbsp;</span><span class="RktPn">. </span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=function-contracts.html%23%2528form._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._-%7E3e%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="RktPn"> .</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="zuo-base.html#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._path-string~3f%29%29" class="RktValLink" data-pltdoc="x">path-string?</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktSym"><a href="zuo-base.html#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._build-path%29%29" class="RktValLink" data-pltdoc="x">build-path</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">options</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="zuo-base.html#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._hash~3f%29%29" class="RktValLink" data-pltdoc="x">hash?</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="zuo-base.html#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._hash%29%29" class="RktValLink" data-pltdoc="x">hash</a></span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Adds a layer of target-variable parsing to
<span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._build%2Fcommand-line%29%29" class="RktValLink" data-pltdoc="x">build/command-line</a></span>. Command-line arguments of the form
<span class="sroman">&#8249;<span style="font-style: italic">name</span>&#8250;</span><span class="RktInBG"><span class="hspace"></span><span class="RktIn">=</span><span class="hspace"></span></span><span class="sroman">&#8249;<span style="font-style: italic">value</span>&#8250;</span> are parsed as variable
assignments, where <span class="sroman">&#8249;<span style="font-style: italic">name</span>&#8250;</span> is formed by <span class="RktInBG"><span class="hspace"></span><span class="RktIn">a</span><span class="hspace"></span></span>-<span class="RktInBG"><span class="hspace"></span><span class="RktIn">z</span><span class="hspace"></span></span>,
<span class="RktInBG"><span class="hspace"></span><span class="RktIn">A</span><span class="hspace"></span></span>-<span class="RktInBG"><span class="hspace"></span><span class="RktIn">Z</span><span class="hspace"></span></span>, <span class="RktInBG"><span class="hspace"></span><span class="RktIn">_</span><span class="hspace"></span></span>, and <span class="RktInBG"><span class="hspace"></span><span class="RktIn">0</span><span class="hspace"></span></span>-<span class="RktInBG"><span class="hspace"></span><span class="RktIn">9</span><span class="hspace"></span></span>, but
not starting <span class="RktInBG"><span class="hspace"></span><span class="RktIn">0</span><span class="hspace"></span></span>-<span class="RktInBG"><span class="hspace"></span><span class="RktIn">9</span><span class="hspace"></span></span>. These variables can appear
anywhere in the command line and are removed from the argument list
sent on to <span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._build%2Fcommand-line%29%29" class="RktValLink" data-pltdoc="x">build/command-line</a></span>, but no argument after a
<span class="RktVal">"--"</span> argument is parsed as a variable assignment.</div></p><p>The <span class="RktVar">targets-at</span> procedure is applied to <span class="RktVar">at-dir</span> and a
hash table of variables, where each variable name is converted to a
symbol and the value is left exact as after <span class="RktInBG"><span class="hspace"></span><span class="RktIn">=</span><span class="hspace"></span></span>.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._zuo-doc/fake-zuo..rkt)._find-target))"></a><span title="Provided from: zuo, zuo/build"><span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._find-target%29%29" class="RktValDef RktValLink" data-pltdoc="x">find-target</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">name</span><span class="hspace">&nbsp;</span><span class="RktVar">targets</span><span class="hspace">&nbsp;</span><span class="RktOpt">[</span><span class="RktVar">fail-k</span><span class="RktOpt">]</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._target~3f%29%29" class="RktValLink" data-pltdoc="x">target?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">name</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="zuo-base.html#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._string~3f%29%29" class="RktValLink" data-pltdoc="x">string?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">targets</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._listof%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">listof</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._target~3f%29%29" class="RktValLink" data-pltdoc="x">target?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">fail-k</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="zuo-base.html#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._procedure~3f%29%29" class="RktValLink" data-pltdoc="x">procedure?</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="zuo-base.html#%28form._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._lambda%29%29" class="RktStxLink" data-pltdoc="x">lambda</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="zuo-base.html#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._error%29%29" class="RktValLink" data-pltdoc="x">error</a></span><span class="hspace">&nbsp;</span><span class="RktSym">....</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Finds the first target in <span class="RktVar">targets</span> that is a match for
<span class="RktVar">name</span>, returning <span class="RktVal">#f</span> is not match is found. A
<span class="RktVar">name</span> matches when it is the same as n entire symbol or path
target name or when it matches a suffix that is preceded by
<span class="RktInBG"><span class="hspace"></span><span class="RktIn">/</span><span class="hspace"></span></span> or <span class="RktInBG"><span class="hspace"></span><span class="RktIn">\\</span><span class="hspace"></span></span>. If no match is found, <span class="RktVar">fail-k</span>
is called in tail position.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._zuo-doc/fake-zuo..rkt)._make-at-dir))"></a><span title="Provided from: zuo, zuo/build"><span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._make-at-dir%29%29" class="RktValDef RktValLink" data-pltdoc="x">make-at-dir</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">path</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="zuo-base.html#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._path-string~3f%29%29" class="RktValLink" data-pltdoc="x">path-string?</a></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">...</span><span class="hspace">&nbsp;</span><span class="RktPn">. </span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=function-contracts.html%23%2528form._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._-%7E3e%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="RktPn"> .</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="zuo-base.html#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._path-string~3f%29%29" class="RktValLink" data-pltdoc="x">path-string?</a></span><span class="RktPn">)</span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">path</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="zuo-base.html#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._path-string~3f%29%29" class="RktValLink" data-pltdoc="x">path-string?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Creates a function that is similar to on created by <span class="RktSym"><a href="zuo-base.html#%28form._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._at-source%29%29" class="RktStxLink" data-pltdoc="x">at-source</a></span>,
but relative to <span class="RktVar">path</span>.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><table cellspacing="0" cellpadding="0" class="together"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._zuo-doc/fake-zuo..rkt)._command-target~3f))"></a><span title="Provided from: zuo, zuo/build"><span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._command-target~3f%29%29" class="RktValDef RktValLink" data-pltdoc="x">command-target?</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">v</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="zuo-base.html#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._boolean~3f%29%29" class="RktValLink" data-pltdoc="x">boolean?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">v</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">any/c</a></span></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="together"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._zuo-doc/fake-zuo..rkt)._command-target-~3etarget))"></a><span title="Provided from: zuo, zuo/build"><span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._command-target-~3etarget%29%29" class="RktValDef RktValLink" data-pltdoc="x">command-target-&gt;target</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">target</span><span class="hspace">&nbsp;</span><span class="RktVar">args</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._target~3f%29%29" class="RktValLink" data-pltdoc="x">target?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">target</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._command-target~3f%29%29" class="RktValLink" data-pltdoc="x">command-target?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">args</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="zuo-base.html#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._list~3f%29%29" class="RktValLink" data-pltdoc="x">list?</a></span></td></tr></table></td></tr></table></blockquote></div><div class="SIntrapara">The <span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._command-target~3f%29%29" class="RktValLink" data-pltdoc="x">command-target?</a></span> predicate recognizes a target with the
<span class="RktVal">'</span><span class="RktVal">target?</span> option, and <span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._command-target-~3etarget%29%29" class="RktValLink" data-pltdoc="x">command-target-&gt;target</a></span> converts
such a target to one where <span class="RktVar">args</span> are the argument when the
target is built.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><table cellspacing="0" cellpadding="0" class="together"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._zuo-doc/fake-zuo..rkt)._file-sha256))"></a><span title="Provided from: zuo, zuo/build"><span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._file-sha256%29%29" class="RktValDef RktValLink" data-pltdoc="x">file-sha256</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">file</span><span class="hspace">&nbsp;</span><span class="RktVar">token</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._sha256~3f%29%29" class="RktValLink" data-pltdoc="x">sha256?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">file</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="zuo-base.html#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._path-string~3f%29%29" class="RktValLink" data-pltdoc="x">path-string?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">token</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._token~3f%29%29" class="RktValLink" data-pltdoc="x">token?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="together"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._zuo-doc/fake-zuo..rkt)._sha256~3f))"></a><span title="Provided from: zuo, zuo/build"><span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._sha256~3f%29%29" class="RktValDef RktValLink" data-pltdoc="x">sha256?</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">v</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym">booelan?</span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">v</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">any/c</a></span></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="together"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>value</p></div></div><p class="RForeground"><a name="(def._((lib._zuo-doc/fake-zuo..rkt)._sha256-length))"></a><span title="Provided from: zuo, zuo/build"><span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._sha256-length%29%29" class="RktValDef RktValLink" data-pltdoc="x">sha256-length</a></span></span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="zuo-base.html#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._integer~3f%29%29" class="RktValLink" data-pltdoc="x">integer?</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">64</span></p></blockquote></td></tr></table></td></tr></table></blockquote></div><div class="SIntrapara">The <span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._file-sha256%29%29" class="RktValLink" data-pltdoc="x">file-sha256</a></span> procedure returns the SHA-256 hash of the
content of <span class="RktVar">file</span> as a 64-character hexadecimal string (thus,
<span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._sha256-length%29%29" class="RktValLink" data-pltdoc="x">sha256-length</a></span>), or it returns <span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._no-sha256%29%29" class="RktValLink" data-pltdoc="x">no-sha256</a></span> if
<span class="RktVar">file</span> does not exist.</div></p><p>The <span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._sha256~3f%29%29" class="RktValLink" data-pltdoc="x">sha256?</a></span> predicate recognizes <span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._no-sha256%29%29" class="RktValLink" data-pltdoc="x">no-sha256</a></span> and
strings for which <span class="RktSym"><a href="zuo-base.html#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._string-length%29%29" class="RktValLink" data-pltdoc="x">string-length</a></span> returns either
<span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._sha256-length%29%29" class="RktValLink" data-pltdoc="x">sha256-length</a></span> or a multiple of <span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._sha256-length%29%29" class="RktValLink" data-pltdoc="x">sha256-length</a></span>. The
later case is used for multi-file targets, which concatenate the
constituent SHA-256 strings.</p><p>See also <span class="RktSym"><a href="zuo-base.html#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._string-sha256%29%29" class="RktValLink" data-pltdoc="x">string-sha256</a></span>.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>value</p></div></div><p class="RForeground"><a name="(def._((lib._zuo-doc/fake-zuo..rkt)._no-sha256))"></a><span title="Provided from: zuo, zuo/build"><span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._no-sha256%29%29" class="RktValDef RktValLink" data-pltdoc="x">no-sha256</a></span></span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._sha256~3f%29%29" class="RktValLink" data-pltdoc="x">sha256?</a></span></p></blockquote></td></tr></table></blockquote></div><div class="SIntrapara">The empty string represents a non-existent target or one that needs to
be rebuilt.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>syntax</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(form._((lib._zuo-doc/fake-zuo..rkt)._provide-targets))"></a><span title="Provided from: zuo, zuo/build"><span class="RktSym"><a href="#%28form._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._provide-targets%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">provide-targets</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">targets-at-id</span><span class="RktPn">)</span></p></blockquote></td></tr></table></blockquote></div><div class="SIntrapara">Provides <span class="RktVar">targets-at-id</span> as <span class="RktSym">targets-at</span>, and
creates a <span class="RktSym">main</span> submodule that runs
<span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._build%2Fcommand-line%2A%29%29" class="RktValLink" data-pltdoc="x">build/command-line*</a></span><span class="stt"> </span><span class="RktVar">targets-at-id</span><span class="stt"> </span><span class="RktSym"><a href="zuo-base.html#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._build-path%29%29" class="RktValLink" data-pltdoc="x">build-path</a></span><span class="RktPn">)</span>. A script
using <span class="RktSym"><a href="#%28form._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._provide-targets%29%29" class="RktStxLink" data-pltdoc="x">provide-targets</a></span> thus works as a makefile-like script or
as an input to a larger build.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>syntax</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(form._((lib._zuo-doc/fake-zuo..rkt)._bounce-to-targets))"></a><span title="Provided from: zuo, zuo/build"><span class="RktSym"><a href="#%28form._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._bounce-to-targets%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">bounce-to-targets</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">config-file-expr</span><span class="hspace">&nbsp;</span><span class="RktVar">key-symbol-expr</span><span class="hspace">&nbsp;</span><span class="RktVar">script-file-expr</span><span class="RktPn">)</span></p></blockquote></td></tr></table></blockquote></div><div class="SIntrapara">Chains to targets from (the path produced by)
<span class="RktVar">script-file-expr</span> relative to the directory recorded in (the
file whose path is produced by) <span class="RktVar">config-file-expr</span> using the
key (produced by) <span class="RktVar">key-symbol-expr</span>, supplying the enclosing
script&rsquo;s directory as the target directory.</div></p><p>The path produced by <span class="RktVar">config-file-expr</span> is interpreted relative
to the enclosing module. If the path in that file for
<span class="RktVar">key-symbol-expr</span> is relative, it is treated relative to the
<span class="RktVar">config-file-expr</span> path.</p><p>See <a href="#%28part._build-targets%29" data-pltdoc="x">Building Targets</a> for an explanation of how
<span class="RktSym"><a href="#%28form._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._bounce-to-targets%29%29" class="RktStxLink" data-pltdoc="x">bounce-to-targets</a></span> is useful. The expansion of
<span class="RktSym"><a href="#%28form._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._bounce-to-targets%29%29" class="RktStxLink" data-pltdoc="x">bounce-to-targets</a></span> is roughly as follows:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="zuo-base.html#%28form._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">config</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="zuo-config.html#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._config-file-~3ehash%29%29" class="RktValLink" data-pltdoc="x">config-file-&gt;hash</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="zuo-base.html#%28form._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._at-source%29%29" class="RktStxLink" data-pltdoc="x">at-source</a></span><span class="hspace">&nbsp;</span><span class="RktVar">config-file-expr</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="zuo-base.html#%28form._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">at-config-dir</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._make-at-dir%29%29" class="RktValLink" data-pltdoc="x">make-at-dir</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="zuo-base.html#%28form._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._or%29%29" class="RktStxLink" data-pltdoc="x">or</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="zuo-base.html#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._car%29%29" class="RktValLink" data-pltdoc="x">car</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="zuo-base.html#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._split-path%29%29" class="RktValLink" data-pltdoc="x">split-path</a></span><span class="hspace">&nbsp;</span><span class="RktSym">config-file</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">"."</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="zuo-base.html#%28form._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">script-file</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">at-config-dir</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="zuo-base.html#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._hash-ref%29%29" class="RktValLink" data-pltdoc="x">hash-ref</a></span><span class="hspace">&nbsp;</span><span class="RktSym">config</span><span class="hspace">&nbsp;</span><span class="RktVar">key-symbol-expr</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVar">script-file-expr</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._build%2Fcommand-line%2A%29%29" class="RktValLink" data-pltdoc="x">build/command-line*</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">dynamic-require</span><span class="hspace">&nbsp;</span><span class="RktSym">script-file</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">targets-at</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="zuo-base.html#%28form._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._at-source%29%29" class="RktStxLink" data-pltdoc="x">at-source</a></span><span class="RktPn">)</span></td></tr></table></blockquote><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._zuo-doc/fake-zuo..rkt)._make-targets))"></a><span title="Provided from: zuo, zuo/build"><span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._make-targets%29%29" class="RktValDef RktValLink" data-pltdoc="x">make-targets</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">specs</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="zuo-base.html#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._list~3f%29%29" class="RktValLink" data-pltdoc="x">list?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">specs</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="zuo-base.html#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._list~3f%29%29" class="RktValLink" data-pltdoc="x">list?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Converts a <span class="stt">make</span>-like specification into a list of targets for use
with <span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._build%29%29" class="RktValLink" data-pltdoc="x">build</a></span>. In this <span class="stt">make</span>-like specification, extra
dependencies can be listed separately from a build rule, and
dependencies can be written in terms of paths instead of <a href="#%28tech._target%29" class="techoutside" data-pltdoc="x"><span class="techinside">target</span></a>
objects.</div></p><p>Although it might seem natural for this <span class="stt">make</span>-like specification
to be provided as a syntactic form, typical makefiles use patterns and
variables to generate sets of rules. In Zuo, <span class="RktSym"><a href="zuo-base.html#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._map%29%29" class="RktValLink" data-pltdoc="x">map</a></span> and similar
are available for generating sets of rules. So, <span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._make-targets%29%29" class="RktValLink" data-pltdoc="x">make-targets</a></span>
takes an S-expression representation of the declaration as
<span class="RktVar">specs</span>, and plain old quasiquote and splicing can be used to
construct <span class="RktVar">specs</span>.</p><p>The <span class="RktVar">specs</span> argument is a list of <span style="font-style: italic">lines</span>, where each
line has one of the following shapes:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktVal">`</span><span class="RktVal">[</span><span class="RktVal">:target</span><span class="hspace">&nbsp;</span><span class="RktRdr">,</span><span class="RktVar">path</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktRdr">,</span><span class="RktVar">dep-path-or-target</span><span class="hspace">&nbsp;</span><span class="RktVal">...</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktRdr">,</span><span class="RktVar">build-proc</span><span class="hspace">&nbsp;</span><span class="RktRdr">,</span><span class="RktVar">option</span><span class="hspace">&nbsp;</span><span class="RktVal">...</span><span class="RktVal">]</span></td></tr><tr><td><span class="RktVal">`</span><span class="RktVal">[</span><span class="RktVal">:depend</span><span class="hspace">&nbsp;</span><span class="RktRdr">,</span><span class="RktVar">path</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktRdr">,</span><span class="RktVar">dep-path-or-target</span><span class="hspace">&nbsp;</span><span class="RktVal">...</span><span class="RktVal">)</span><span class="RktVal">]</span></td></tr><tr><td><span class="RktVal">`</span><span class="RktVal">[</span><span class="RktVal">:target</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktRdr">,</span><span class="RktVar">path</span><span class="hspace">&nbsp;</span><span class="RktVal">...</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktRdr">,</span><span class="RktVar">dep-path-or-target</span><span class="hspace">&nbsp;</span><span class="RktVal">...</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktRdr">,</span><span class="RktVar">build-proc</span><span class="hspace">&nbsp;</span><span class="RktRdr">,</span><span class="RktVar">option</span><span class="hspace">&nbsp;</span><span class="RktVal">...</span><span class="RktVal">]</span></td></tr><tr><td><span class="RktVal">`</span><span class="RktVal">[</span><span class="RktVal">:depend</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktRdr">,</span><span class="RktVar">path</span><span class="hspace">&nbsp;</span><span class="RktVal">...</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktRdr">,</span><span class="RktVar">dep-path-or-target</span><span class="hspace">&nbsp;</span><span class="RktVal">...</span><span class="RktVal">)</span><span class="RktVal">]</span></td></tr><tr><td><span class="RktVal">`</span><span class="RktVal">[</span><span class="RktVal">:db-dir</span><span class="hspace">&nbsp;</span><span class="RktRdr">,</span><span class="RktVar">path</span><span class="RktVal">]</span></td></tr></table></blockquote><p>A <span class="RktVal">'</span><span class="RktVal">:target</span> line defines a build rule that is implemented by
<span class="RktVar">build-proc</span>, while a <span class="RktVal">'</span><span class="RktVal">:depend</span> line adds extra
dependencies for a <span class="RktVar">path</span> that also has a <span class="RktVal">'</span><span class="RktVal">:target</span>
line. A <span class="RktVal">'</span><span class="RktVal">:depend</span> line with multiple <span class="RktVar">path</span>s is the
same as a sequence of <span class="RktVal">'</span><span class="RktVal">:depend</span> lines with the same
<span class="RktVar">dep-path-or-target</span> list, but a <span class="RktVal">'</span><span class="RktVal">:target</span> line with multiple
<span class="RktVar">path</span>s creates a single target that builds all of the
<span class="RktVar">path</span>s.</p><p>In <span class="RktVal">'</span><span class="RktVal">:target</span> and <span class="RktVal">'</span><span class="RktVal">:depend</span> lines, a <span class="RktVar">path</span> is
normally a path string, but it can be a symbol for a <a href="#%28tech._phony%29" class="techoutside" data-pltdoc="x"><span class="techinside">phony</span></a>
target. When a <span class="RktVal">'</span><span class="RktVal">:target</span> has multiple <span class="RktVar">path</span>s, they
must all be path strings.</p><p>A <span class="RktVar">build-proc</span> accepts a path (if not phony) and a <a href="#%28tech._build._token%29" class="techoutside" data-pltdoc="x"><span class="techinside">build
token</span></a>, just like a <span class="RktVar">get-deps</span> procedure for <span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._target%29%29" class="RktValLink" data-pltdoc="x">target</a></span>,
but <span class="RktVar">build-proc</span> should build the target like the
<span class="RktVar">rebuild</span> procedure for <span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._rule%29%29" class="RktValLink" data-pltdoc="x">rule</a></span> (or <span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._phony-rule%29%29" class="RktValLink" data-pltdoc="x">phony-rule</a></span>).
When a <span class="RktVal">'</span><span class="RktVal">:target</span> line has multiple <span class="RktVar">path</span>s, only the
first one is passed to the <span class="RktVar">build-proc</span>.</p><p>A <span class="RktVar">dep-path-or-target</span> is normally a path string. If it is the
same path as the <span class="RktVar">path</span> of a <span class="RktVal">'</span><span class="RktVal">:target</span> line, then a
dependency is established on that target. If
<span class="RktVar">dep-path-or-target</span> is any other path string, it is coerced
to an input-file target. A <span class="RktVar">dep-path-or-target</span> can also be a
target that is created outside the <span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._make-targets%29%29" class="RktValLink" data-pltdoc="x">make-targets</a></span> call.</p><p>An <span class="RktVar">option</span> can be <span class="RktVal">'</span><span class="RktVal">:precious</span>, <span class="RktVal">'</span><span class="RktVal">:command</span>,
<span class="RktVal">'</span><span class="RktVal">:noisy</span>, <span class="RktVal">'</span><span class="RktVal">:quiet</span>, or <span class="RktVal">'</span><span class="RktVal">:eager</span> to set the
corresponding option (see <span class="RktSym"><a href="#%28def._%28%28lib._zuo-doc%2Ffake-zuo..rkt%29._target%29%29" class="RktValLink" data-pltdoc="x">target</a></span>) in a target.</p><p>A <span class="RktVal">'</span><span class="RktVal">:db-dir</span> line (appearing at most once) specifies where
build information should be recorded for all targets. Otherwise, the
build result for each target is stored in the target&rsquo;s directory.</p><div class="navsetbottom"><span class="navleft"><form class="searchform"><input class="searchbox" id="searchbox" type="text" tabindex="1" placeholder="...search manuals..." title="Enter a search string to search the manuals" onkeypress="return DoSearchKey(event, this, &quot;8.6&quot;, &quot;../&quot;);"/></form>&nbsp;&nbsp;<a href="../index-2.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;8.6&quot;);">top</a><span class="tocsettoggle">&nbsp;&nbsp;<a href="javascript:void(0);" title="show/hide table of contents" onclick="TocsetToggle();">contents</a></span></span><span class="navright">&nbsp;&nbsp;<a href="zuo-base.html" title="backward to &quot;2 Zuo Base Language&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="index.html" title="up to &quot;Zuo: A Tiny Racket for Scripting&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="zuo-lib.html" title="forward to &quot;4 Zuo Libraries&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body>
<!-- Mirrored from docs.racket-lang.org/zuo/zuo-build.html by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 07 Sep 2022 03:14:18 GMT -->
</html>