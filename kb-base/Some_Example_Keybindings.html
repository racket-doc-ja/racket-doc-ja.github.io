<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- Mirrored from docs.racket-lang.org/kb-base/Some_Example_Keybindings.html by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 07 Sep 2022 03:27:19 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><meta name="viewport" content="width=device-width, initial-scale=0.8"/><title>2&nbsp;Some Example Keybindings</title><link rel="stylesheet" type="text/css" href="../scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="../racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-style.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../doc-site.css" title="default"/><script type="text/javascript" src="../scribble-common.js"></script><script type="text/javascript" src="../manual-racket.js"></script><script type="text/javascript" src="../manual-racket.js"></script><script type="text/javascript" src="../doc-site.js"></script><script type="text/javascript" src="../local-redirect/local-redirect.js"></script><script type="text/javascript" src="../local-redirect/local-user-redirect.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="doc-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9660;</a></td><td></td><td><a href="index.html" class="tocviewlink" data-pltdoc="x">Keybinding Base Language</a></td></tr></table></div><div class="tocviewsublisttop" style="display: block;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="Getting_Started_with_Keybindings.html" class="tocviewlink" data-pltdoc="x">Getting Started with Keybindings</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="#" class="tocviewselflink" data-pltdoc="x">Some Example Keybindings</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="Keybinding_Language_Reference.html" class="tocviewlink" data-pltdoc="x">Keybinding Language Reference</a></td></tr></table></div></div><div class="tocviewlist"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_1&quot;);">&#9658;</a></td><td>2&nbsp;</td><td><a href="#" class="tocviewselflink" data-pltdoc="x">Some Example Keybindings</a></td></tr></table><div class="tocviewsublistbottom" style="display: none;" id="tocview_1"><table cellspacing="0" cellpadding="0"><tr><td align="right">2.1&nbsp;</td><td><a href="#%28part._.Example_1__.Swapping_cond_.Branches%29" class="tocviewlink" data-pltdoc="x">Example 1:<span class="mywbr"> &nbsp;</span> Swapping <span class="RktSym"><span class="RktStxLink">cond</span></span> Branches</a></td></tr><tr><td align="right">2.2&nbsp;</td><td><a href="#%28part._.Example_2__.Converting_.Between_.Contract_.Forms%29" class="tocviewlink" data-pltdoc="x">Example 2:<span class="mywbr"> &nbsp;</span> Converting Between Contract Forms</a></td></tr><tr><td align="right">2.3&nbsp;</td><td><a href="#%28part._.Example_3__.Pattern_.Matching_.Code_.Generation%29" class="tocviewlink" data-pltdoc="x">Example 3:<span class="mywbr"> &nbsp;</span> Pattern Matching Code Generation</a></td></tr></table></div></div></div><div class="tocsub"><div class="tocsubtitle">On this page:</div><table class="tocsublist" cellspacing="0"><tr><td><span class="tocsublinknumber">2.1<tt>&nbsp;</tt></span><a href="#%28part._.Example_1__.Swapping_cond_.Branches%29" class="tocsubseclink" data-pltdoc="x">Example 1:<span class="mywbr"> &nbsp;</span> Swapping <span class="RktSym"><span class="RktStxLink">cond</span></span> Branches</a></td></tr><tr><td><span class="tocsublinknumber">2.2<tt>&nbsp;</tt></span><a href="#%28part._.Example_2__.Converting_.Between_.Contract_.Forms%29" class="tocsubseclink" data-pltdoc="x">Example 2:<span class="mywbr"> &nbsp;</span> Converting Between Contract Forms</a></td></tr><tr><td><span class="tocsublinknumber">2.3<tt>&nbsp;</tt></span><a href="#%28part._.Example_3__.Pattern_.Matching_.Code_.Generation%29" class="tocsubseclink" data-pltdoc="x">Example 3:<span class="mywbr"> &nbsp;</span> Pattern Matching Code Generation</a></td></tr></table></div></div><div class="maincolumn"><div class="main"><div class="navsettop"><span class="navleft"><form class="searchform"><input class="searchbox" id="searchbox" type="text" tabindex="1" placeholder="...search manuals..." title="Enter a search string to search the manuals" onkeypress="return DoSearchKey(event, this, &quot;8.6&quot;, &quot;../&quot;);"/></form>&nbsp;&nbsp;<a href="../index-2.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;8.6&quot;);">top</a><span class="tocsettoggle">&nbsp;&nbsp;<a href="javascript:void(0);" title="show/hide table of contents" onclick="TocsetToggle();">contents</a></span></span><span class="navright">&nbsp;&nbsp;<a href="Getting_Started_with_Keybindings.html" title="backward to &quot;1 Getting Started with Keybindings&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="index.html" title="up to &quot;Keybinding Base Language&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="Keybinding_Language_Reference.html" title="forward to &quot;3 Keybinding Language Reference&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div><h3 x-source-module="(lib &quot;kb-base/scribblings/kb-base.scrbl&quot;)" x-source-pkg="drracket-custom-keybindings" x-part-tag="&quot;Some_Example_Keybindings&quot;">2<tt>&nbsp;</tt><a name="(part._.Some_.Example_.Keybindings)"></a>Some Example Keybindings</h3><p>Often it is easier to get an understanding of how something works by looking at examples, so in this section we will
look at a few example keybindings made for existing forms in Racket.</p><h4 x-source-module="(lib &quot;kb-base/scribblings/kb-base.scrbl&quot;)" x-source-pkg="drracket-custom-keybindings" x-part-tag="&quot;Example_1__Swapping_cond_Branches&quot;">2.1<tt>&nbsp;</tt><a name="(part._.Example_1__.Swapping_cond_.Branches)"></a>Example 1: Swapping <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=if.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fletstx-scheme..rkt%2529._cond%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">cond</a></span> Branches</h4><p>First lets look at an example my-cond macro which we&rsquo;ll pretend behaves like <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=if.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fletstx-scheme..rkt%2529._cond%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">cond</a></span>. Notice how
we can attach a keybinding using the <a href="Getting_Started_with_Keybindings.html#%28tech._%27keybinding._info%29" class="techoutside" data-pltdoc="x"><span class="techinside">&rsquo;keybinding-info</span></a> property. The program <span class="RktSym">swap-cond-branches</span>
will be defined later.</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define-syntax%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define-syntax</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">my-cond</span><span class="hspace">&nbsp;</span><span class="RktSym">stx</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stxprops.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._syntax-property%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">syntax-property</a></span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=if.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fletstx-scheme..rkt%2529._cond%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">cond</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">'</span><span class="RktVal">keybinding-info</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._make-kb%29%29" class="RktValLink" data-pltdoc="x">make-kb</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"c:space"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">swap-cond-branches</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">"swap-cond-branches"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">'</span><span class="RktVal">local</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">stx</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p>This simple keybinding takes into account the cursor position inside a cond, and swaps the first branch
following the cursor with the one following it. For example, if we have this before the the keybinding:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">my-cond</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym">some-predicate?</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">#t</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym">some-other-predicate?</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr></table></blockquote><p>with the current cursor position preceding the first branch, then after the keybinding we&rsquo;d have:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">my-cond</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym">some-other-predicate?</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym">some-predicate?</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">#t</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr></table></blockquote><p>Let&rsquo;s look at the full code for this keybinding program:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">swap-cond-branches</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._seq%29%29" class="RktValLink" data-pltdoc="x">seq</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._down-sexp%29%29" class="RktValLink" data-pltdoc="x">down-sexp</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28form._%28%28lib._kb-base%2Fmain..rkt%29._kb-let%29%29" class="RktStxLink" data-pltdoc="x">kb-let</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktVal">'</span><span class="RktVal">first-sexp-start</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._get-position%29%29" class="RktValLink" data-pltdoc="x">get-position</a></span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktVal">'</span><span class="RktVal">first-sexp-end</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._seq%29%29" class="RktValLink" data-pltdoc="x">seq</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._up-sexp%29%29" class="RktValLink" data-pltdoc="x">up-sexp</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._forward-sexp%29%29" class="RktValLink" data-pltdoc="x">forward-sexp</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._sub%29%29" class="RktValLink" data-pltdoc="x">sub</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._get-position%29%29" class="RktValLink" data-pltdoc="x">get-position</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktVal">'</span><span class="RktVal">second-sexp-start</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._seq%29%29" class="RktValLink" data-pltdoc="x">seq</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._down-sexp%29%29" class="RktValLink" data-pltdoc="x">down-sexp</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._get-position%29%29" class="RktValLink" data-pltdoc="x">get-position</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktVal">'</span><span class="RktVal">second-sexp-end</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._seq%29%29" class="RktValLink" data-pltdoc="x">seq</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._up-sexp%29%29" class="RktValLink" data-pltdoc="x">up-sexp</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._forward-sexp%29%29" class="RktValLink" data-pltdoc="x">forward-sexp</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._sub%29%29" class="RktValLink" data-pltdoc="x">sub</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._get-position%29%29" class="RktValLink" data-pltdoc="x">get-position</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktVal">'</span><span class="RktVal">first-sexp-content</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._get-text%29%29" class="RktValLink" data-pltdoc="x">get-text</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">first-sexp-start</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">first-sexp-end</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktVal">'</span><span class="RktVal">second-sexp-content</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._get-text%29%29" class="RktValLink" data-pltdoc="x">get-text</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">second-sexp-start</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">second-sexp-end</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._set-position%29%29" class="RktValLink" data-pltdoc="x">set-position</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">second-sexp-start</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._delete%29%29" class="RktValLink" data-pltdoc="x">delete</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">second-sexp-start</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">second-sexp-end</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._insert%29%29" class="RktValLink" data-pltdoc="x">insert</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">first-sexp-content</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._set-position%29%29" class="RktValLink" data-pltdoc="x">set-position</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">first-sexp-start</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._delete%29%29" class="RktValLink" data-pltdoc="x">delete</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">first-sexp-start</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">first-sexp-end</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._insert%29%29" class="RktValLink" data-pltdoc="x">insert</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">second-sexp-content</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._set-position%29%29" class="RktValLink" data-pltdoc="x">set-position</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">first-sexp-start</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._up-sexp%29%29" class="RktValLink" data-pltdoc="x">up-sexp</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p>The high level idea of this keybinding program is to start right before the opening parenthesis of the first branch you want to move,
then from there we copy the content from that branch and the one following it, then we just insert the content of the second branch
over the first and the content of the first over the second, effectively swapping the two branches.</p><p>The various bindings inside the <span class="RktSym"><a href="Keybinding_Language_Reference.html#%28form._%28%28lib._kb-base%2Fmain..rkt%29._kb-let%29%29" class="RktStxLink" data-pltdoc="x">kb-let</a></span> expression take care of getting the content, which gets bound to <span class="RktVal">'</span><span class="RktVal">first-sexp-content</span>
and <span class="RktVal">'</span><span class="RktVal">second-sexp-content</span>. Once we have these, the body of the let just takes care of moving to the correct positions, deleting the original
content and replacing it with the content we&rsquo;re swapping in.</p><p>More generally, you can read a keybinding program as sort of a sequence of steps you might take when making this code transformation manually, or put
another way you can walk through each instruction and how it will affect the buffer as you read the program. As you can see everything is quite low-level,
so the level of reasoning is in terms of very discrete small operations on the buffer like "insert" and "delete".</p><h4 x-source-module="(lib &quot;kb-base/scribblings/kb-base.scrbl&quot;)" x-source-pkg="drracket-custom-keybindings" x-part-tag="&quot;Example_2__Converting_Between_Contract_Forms&quot;">2.2<tt>&nbsp;</tt><a name="(part._.Example_2__.Converting_.Between_.Contract_.Forms)"></a>Example 2: Converting Between Contract Forms</h4><p>Once again we&rsquo;ll look at the macro definition for our own version of <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=function-contracts.html%23%2528form._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._-%7E3e%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x"><span class="nobreak">-&gt;</span></a></span> called <span class="RktSym">my-&gt;</span> with a keybinding attached.
The actual keybinding program is explained later in this example.</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define-syntax%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define-syntax</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">my-&gt;</span><span class="hspace">&nbsp;</span><span class="RktSym">stx</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stxprops.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._syntax-property%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">syntax-property</a></span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=function-contracts.html%23%2528form._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._-%7E3e%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">'</span><span class="RktVal">keybinding-info</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._make-kb%29%29" class="RktValLink" data-pltdoc="x">make-kb</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"c:space"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">arrow-to-arrow-star</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">"arrow-to-arrow-star-kb"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">'</span><span class="RktVal">local</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">stx</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p>Another code transformation one might like to make is updating the contract on a function they&rsquo;ve written. Maybe initially
the function took no optional arguments and now it needs a different contract form to represent the optional argument&rsquo;s contract.
Remembering the syntax for the various contract combinators provided by Racket can be difficult, so the keybindings we see in this section
take one contract combinator and convert it to the other form automatically. Imagine, for example, you have the following
function:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=attaching-contracts-to-values.html%23%2528form._%2528%2528lib._racket%252Fcontract%252Fregion..rkt%2529._define%252Fcontract%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define/contract</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">my-func</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">my-&gt;</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=number-types.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._number%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">number?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">string?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=booleans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._boolean%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">boolean?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktPn">)</span></td></tr></table></blockquote><p>Converting this to the <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=function-contracts.html%23%2528form._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._-%7E3e%252A%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x"><span class="nobreak">-&gt;</span>*</a></span> syntax can be done easily with a keybinding, resulting in:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=attaching-contracts-to-values.html%23%2528form._%2528%2528lib._racket%252Fcontract%252Fregion..rkt%2529._define%252Fcontract%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define/contract</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">my-func</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=function-contracts.html%23%2528form._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._-%7E3e%252A%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x"><span class="nobreak">-&gt;</span>*</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=number-types.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._number%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">number?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">string?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=booleans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._boolean%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">boolean?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktPn">)</span></td></tr></table></blockquote><p>Let&rsquo;s look at the full code for this keybinding program:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">arrow-to-arrow-star</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._seq%29%29" class="RktValLink" data-pltdoc="x">seq</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._delete%29%29" class="RktValLink" data-pltdoc="x">delete</a></span><span class="hspace">&nbsp;</span><span class="RktVal">4</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._insert%29%29" class="RktValLink" data-pltdoc="x">insert</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"-&gt;* "</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28form._%28%28lib._kb-base%2Fmain..rkt%29._kb-let%29%29" class="RktStxLink" data-pltdoc="x">kb-let</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktVal">'</span><span class="RktVal">num-of-args</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._sub%29%29" class="RktValLink" data-pltdoc="x">sub</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._count-iters%29%29" class="RktValLink" data-pltdoc="x">count-iters</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._forward-sexp-exists~3f%29%29" class="RktValLink" data-pltdoc="x">forward-sexp-exists?</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">sexp</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._insert%29%29" class="RktValLink" data-pltdoc="x">insert</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"("</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._delete%29%29" class="RktValLink" data-pltdoc="x">delete</a></span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._do-times%29%29" class="RktValLink" data-pltdoc="x">do-times</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">num-of-args</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._move-position%29%29" class="RktValLink" data-pltdoc="x">move-position</a></span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">sexp</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._insert%29%29" class="RktValLink" data-pltdoc="x">insert</a></span><span class="hspace">&nbsp;</span><span class="RktVal">")"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._insert-return%29%29" class="RktValLink" data-pltdoc="x">insert-return</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._insert%29%29" class="RktValLink" data-pltdoc="x">insert</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"()"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._insert-return%29%29" class="RktValLink" data-pltdoc="x">insert-return</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p>This keybinding should be invoked with the current position immediately preceding <span class="RktSym">my-&gt;</span>.
Using that position, we simply delete the name and insert the new one with a star. This is the call to
<span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._delete%29%29" class="RktValLink" data-pltdoc="x">delete</a></span><span class="stt"> </span><span class="RktVal">4</span><span class="RktPn">)</span>.</p><p>The next task is to use <span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._count-iters%29%29" class="RktValLink" data-pltdoc="x">count-iters</a></span> to compute how many arguments the function takes, which we can do by iterating
one s-expression at a time and subtracting the total by 1 (the return value contract). Once we have this we use a <span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._do-times%29%29" class="RktValLink" data-pltdoc="x">do-times</a></span> to
wrap the arguments in one s-expression, insert an empty () for the optional paramters we&rsquo;ll expect the user to add, and end up with
these pieces of the <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=function-contracts.html%23%2528form._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._-%7E3e%252A%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x"><span class="nobreak">-&gt;</span>*</a></span> contract on their own line, where the last thing is the return type. We could easily decide to
insert less newlines or customize exactly how we want the <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=function-contracts.html%23%2528form._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._-%7E3e%252A%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x"><span class="nobreak">-&gt;</span>*</a></span> expression to look once it has been transformed.</p><h4 x-source-module="(lib &quot;kb-base/scribblings/kb-base.scrbl&quot;)" x-source-pkg="drracket-custom-keybindings" x-part-tag="&quot;Example_3__Pattern_Matching_Code_Generation&quot;">2.3<tt>&nbsp;</tt><a name="(part._.Example_3__.Pattern_.Matching_.Code_.Generation)"></a>Example 3: Pattern Matching Code Generation</h4><p>This last example is for a macro like <span class="RktSym">|#lang|</span><span class="stt"> </span><span class="RktSym">plai</span>&rsquo;s <span class="RktSym">define-type</span>, here is the macro with a keybinding
attached:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define-syntax%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define-syntax</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">my-define-type</span><span class="hspace">&nbsp;</span><span class="RktSym">stx</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">syntax-parse</span><span class="hspace">&nbsp;</span><span class="RktSym">stx</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529.__%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">_</a></span><span class="hspace">&nbsp;</span><span class="RktSym">type-name</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">var-name</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">field-name</span><span class="hspace">&nbsp;</span><span class="RktSym">field-c</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">field-clause</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">first-var-pos</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=generic-numbers.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._-%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x"><span class="nobreak">-</span></a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stxops.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._syntax-position%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">syntax-position</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528lib._racket%252Flist..rkt%2529._third%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">third</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stxops.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._syntax-%7E3elist%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">syntax-&gt;list</a></span><span class="hspace">&nbsp;</span><span class="RktSym">stx</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stxprops.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._syntax-property%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">syntax-property</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktRdr">#'</span><span class="RktPn">(</span><span class="RktSym">define-type</span><span class="hspace">&nbsp;</span><span class="RktSym">type-name</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">var-name</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">field-name</span><span class="hspace">&nbsp;</span><span class="RktSym">field-c</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">field-clause</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktPn">]</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">'</span><span class="RktVal">keybinding-info</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._make-kb%29%29" class="RktValLink" data-pltdoc="x">make-kb</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"c:space"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">gen-type-case</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=symbols.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._symbol-%7E3estring%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">symbol-&gt;string</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stxops.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._syntax-e%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">syntax-e</a></span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktSym">type-name</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">first-var-pos</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">"generate-type-case"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">'</span><span class="RktVal">global</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">stx</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p>This macro&rsquo;s definition warrants a little more explanation. We&rsquo;ll see a bit later on, but we need to pass to this keybinding
program two things: the position of the first variant&rsquo;s s-expression, and the type name for the <span class="RktSym">define-type</span>. We can
get this information from the macro usage and it&rsquo;s passed to the call to <span class="RktSym">gen-type-case</span>.</p><p>Now lets look at what this keybinding should do. Given the following defined in our buffer:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define-type</span><span class="hspace">&nbsp;</span><span class="RktSym">Animal</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">dog</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">bark-volume</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=number-types.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._number%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">number?</a></span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">cat</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">favorite-treat</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">string?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">coat-length</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">string?</a></span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">lizard</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">eats-bugs</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=booleans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._boolean%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">boolean?</a></span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr></table></blockquote><p>We want to generate a <span class="RktSym">type-case</span> that looks like this:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">type-case</span><span class="hspace">&nbsp;</span><span class="RktSym">Animal</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">dog</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">bark-volume</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">cat</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">favorite-treat</span><span class="hspace">&nbsp;</span><span class="RktSym">coat-length</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">lizard</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">eats-bugs</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr></table></blockquote><p>The idea of this keybinding is that it will use some information from the <span class="RktSym">define-type</span> macro to get the
name of the type and the position where the first variant&rsquo;s sexpr starts. It will then use this information to construct
a type case from the definition. The full code is as follows, and we can walk through it in detail:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">gen-type-case</span><span class="hspace">&nbsp;</span><span class="RktSym">type-name</span><span class="hspace">&nbsp;</span><span class="RktSym">var-pos</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._seq%29%29" class="RktValLink" data-pltdoc="x">seq</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._set-position%29%29" class="RktValLink" data-pltdoc="x">set-position</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._last-position%29%29" class="RktValLink" data-pltdoc="x">last-position</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._insert-return%29%29" class="RktValLink" data-pltdoc="x">insert-return</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._insert-return%29%29" class="RktValLink" data-pltdoc="x">insert-return</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._insert%29%29" class="RktValLink" data-pltdoc="x">insert</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"(type-case "</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._insert%29%29" class="RktValLink" data-pltdoc="x">insert</a></span><span class="hspace">&nbsp;</span><span class="RktSym">type-name</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._insert%29%29" class="RktValLink" data-pltdoc="x">insert</a></span><span class="hspace">&nbsp;</span><span class="RktVal">" ..."</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._insert-return%29%29" class="RktValLink" data-pltdoc="x">insert-return</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28form._%28%28lib._kb-base%2Fmain..rkt%29._kb-let%29%29" class="RktStxLink" data-pltdoc="x">kb-let</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktVal">'</span><span class="RktVal">insert-posn</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._get-position%29%29" class="RktValLink" data-pltdoc="x">get-position</a></span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._set-position%29%29" class="RktValLink" data-pltdoc="x">set-position</a></span><span class="hspace">&nbsp;</span><span class="RktSym">var-pos</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._do-times%29%29" class="RktValLink" data-pltdoc="x">do-times</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._count-iters%29%29" class="RktValLink" data-pltdoc="x">count-iters</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._forward-sexp-exists~3f%29%29" class="RktValLink" data-pltdoc="x">forward-sexp-exists?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">1</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">'</span><span class="RktVal">sexp</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._down-sexp%29%29" class="RktValLink" data-pltdoc="x">down-sexp</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28form._%28%28lib._kb-base%2Fmain..rkt%29._kb-let%29%29" class="RktStxLink" data-pltdoc="x">kb-let</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktVal">'</span><span class="RktVal">current-variant-name-posn</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._get-position%29%29" class="RktValLink" data-pltdoc="x">get-position</a></span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._set-position%29%29" class="RktValLink" data-pltdoc="x">set-position</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">insert-posn</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._insert%29%29" class="RktValLink" data-pltdoc="x">insert</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"["</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._insert%29%29" class="RktValLink" data-pltdoc="x">insert</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._get-forward-word%29%29" class="RktValLink" data-pltdoc="x">get-forward-word</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">current-variant-name-posn</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._insert%29%29" class="RktValLink" data-pltdoc="x">insert</a></span><span class="hspace">&nbsp;</span><span class="RktVal">" ("</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._kb-set%21%29%29" class="RktValLink" data-pltdoc="x">kb-set!</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">insert-posn</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._get-position%29%29" class="RktValLink" data-pltdoc="x">get-position</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._set-position%29%29" class="RktValLink" data-pltdoc="x">set-position</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">current-variant-name-posn</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._forward-sexp%29%29" class="RktValLink" data-pltdoc="x">forward-sexp</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._do-times%29%29" class="RktValLink" data-pltdoc="x">do-times</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._count-iters%29%29" class="RktValLink" data-pltdoc="x">count-iters</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._forward-sexp-exists~3f%29%29" class="RktValLink" data-pltdoc="x">forward-sexp-exists?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">1</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">'</span><span class="RktVal">sexp</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._down-sexp%29%29" class="RktValLink" data-pltdoc="x">down-sexp</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28form._%28%28lib._kb-base%2Fmain..rkt%29._kb-let%29%29" class="RktStxLink" data-pltdoc="x">kb-let</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktVal">'</span><span class="RktVal">current-field-name-posn</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._get-position%29%29" class="RktValLink" data-pltdoc="x">get-position</a></span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._set-position%29%29" class="RktValLink" data-pltdoc="x">set-position</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">insert-posn</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._insert%29%29" class="RktValLink" data-pltdoc="x">insert</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._get-forward-word%29%29" class="RktValLink" data-pltdoc="x">get-forward-word</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">current-field-name-posn</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._insert%29%29" class="RktValLink" data-pltdoc="x">insert</a></span><span class="hspace">&nbsp;</span><span class="RktVal">" "</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._kb-set%21%29%29" class="RktValLink" data-pltdoc="x">kb-set!</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">insert-posn</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._get-position%29%29" class="RktValLink" data-pltdoc="x">get-position</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._set-position%29%29" class="RktValLink" data-pltdoc="x">set-position</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">current-field-name-posn</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._up-sexp%29%29" class="RktValLink" data-pltdoc="x">up-sexp</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._forward-sexp%29%29" class="RktValLink" data-pltdoc="x">forward-sexp</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._set-position%29%29" class="RktValLink" data-pltdoc="x">set-position</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">insert-posn</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._delete%29%29" class="RktValLink" data-pltdoc="x">delete</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._sub%29%29" class="RktValLink" data-pltdoc="x">sub</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._get-position%29%29" class="RktValLink" data-pltdoc="x">get-position</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._get-position%29%29" class="RktValLink" data-pltdoc="x">get-position</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._insert%29%29" class="RktValLink" data-pltdoc="x">insert</a></span><span class="hspace">&nbsp;</span><span class="RktVal">") ...]"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._insert-return%29%29" class="RktValLink" data-pltdoc="x">insert-return</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._kb-set%21%29%29" class="RktValLink" data-pltdoc="x">kb-set!</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">insert-posn</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._get-position%29%29" class="RktValLink" data-pltdoc="x">get-position</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._set-position%29%29" class="RktValLink" data-pltdoc="x">set-position</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">current-variant-name-posn</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._up-sexp%29%29" class="RktValLink" data-pltdoc="x">up-sexp</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._forward-sexp%29%29" class="RktValLink" data-pltdoc="x">forward-sexp</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._set-position%29%29" class="RktValLink" data-pltdoc="x">set-position</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">insert-posn</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._seek-while%29%29" class="RktValLink" data-pltdoc="x">seek-while</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._kb-not%29%29" class="RktValLink" data-pltdoc="x">kb-not</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._kb-equal~3f%29%29" class="RktValLink" data-pltdoc="x">kb-equal?</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._get-character%29%29" class="RktValLink" data-pltdoc="x">get-character</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">#\]</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal"><span class="nobreak">-1</span></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">simple</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._move-position%29%29" class="RktValLink" data-pltdoc="x">move-position</a></span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">simple</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Keybinding_Language_Reference.html#%28def._%28%28lib._kb-base%2Fmain..rkt%29._insert%29%29" class="RktValLink" data-pltdoc="x">insert</a></span><span class="hspace">&nbsp;</span><span class="RktVal">")"</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p>This is definitely the most complex keybinding program we&rsquo;ve looked at, and rather than walking through it line by line we can
see it as a few high level tasks. The first thing to notice is we take in <span class="RktSym">type-name</span> and <span class="RktSym">var-pos</span>, which represent
the name of the type we&rsquo;d like to generate the <span class="RktSym">type-case</span> for and the starting position of the s-expression containing
the first variant in the type&rsquo;s definition. This is all information we can get from the macro we&rsquo;re attaching this keybinding program to.</p><p>The first part of the program sets up the start of the call to <span class="RktSym">type-case</span>, by inserting "(type-case &lt;type-name&gt; ..." where the "..."
is left for the user to fill in with an expression producing the correct type. The program then sets up a variable <span class="RktVal">'</span><span class="RktVal">insert-posn</span>, which
will be sort of a running track of where to insert text throughout the course of the program (in this case we start generating the <span class="RktSym">type-case</span>
at the end of the buffer and we just update it each time we do an insert).</p><div class="navsetbottom"><span class="navleft"><form class="searchform"><input class="searchbox" id="searchbox" type="text" tabindex="1" placeholder="...search manuals..." title="Enter a search string to search the manuals" onkeypress="return DoSearchKey(event, this, &quot;8.6&quot;, &quot;../&quot;);"/></form>&nbsp;&nbsp;<a href="../index-2.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;8.6&quot;);">top</a><span class="tocsettoggle">&nbsp;&nbsp;<a href="javascript:void(0);" title="show/hide table of contents" onclick="TocsetToggle();">contents</a></span></span><span class="navright">&nbsp;&nbsp;<a href="Getting_Started_with_Keybindings.html" title="backward to &quot;1 Getting Started with Keybindings&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="index.html" title="up to &quot;Keybinding Base Language&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="Keybinding_Language_Reference.html" title="forward to &quot;3 Keybinding Language Reference&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body>
<!-- Mirrored from docs.racket-lang.org/kb-base/Some_Example_Keybindings.html by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 07 Sep 2022 03:27:20 GMT -->
</html>