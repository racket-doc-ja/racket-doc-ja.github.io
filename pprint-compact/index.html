<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- Mirrored from docs.racket-lang.org/pprint-compact/index.html by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 07 Sep 2022 03:04:43 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><meta name="viewport" content="width=device-width, initial-scale=0.8"/><title>pprint-compact: a non-greedy pretty printer</title><link rel="stylesheet" type="text/css" href="../scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="../racket.css" title="default"/><link rel="stylesheet" type="text/css" href="autobib.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-style.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../doc-site.css" title="default"/><script type="text/javascript" src="../scribble-common.js"></script><script type="text/javascript" src="../manual-racket.js"></script><script type="text/javascript" src="../manual-racket.js"></script><script type="text/javascript" src="../doc-site.js"></script><script type="text/javascript" src="../local-redirect/local-redirect.js"></script><script type="text/javascript" src="../local-redirect/local-user-redirect.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="doc-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9658;</a></td><td></td><td><a href="#" class="tocviewselflink" data-pltdoc="x">pprint-<wbr></wbr>compact:<span class="mywbr"> &nbsp;</span> a non-<wbr></wbr>greedy pretty printer</a></td></tr></table></div><div class="tocviewsublistonly" style="display: none;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="#%28part._.Getting_.Started%29" class="tocviewlink" data-pltdoc="x">Getting Started</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="#%28part._.Documents%29" class="tocviewlink" data-pltdoc="x">Documents</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="#%28part._.Best_.Practice_for_.Document_.Construction%29" class="tocviewlink" data-pltdoc="x">Best Practice for Document Construction</a></td></tr><tr><td align="right">4&nbsp;</td><td><a href="#%28part._.Library_.Documentation%29" class="tocviewlink" data-pltdoc="x">Library Documentation</a></td></tr><tr><td align="right">5&nbsp;</td><td><a href="#%28part._.Annotation%29" class="tocviewlink" data-pltdoc="x">Annotation</a></td></tr><tr><td align="right">6&nbsp;</td><td><a href="#%28part._.Processing_.Documents%29" class="tocviewlink" data-pltdoc="x">Processing Documents</a></td></tr><tr><td align="right">7&nbsp;</td><td><a href="#%28part._.Debug%29" class="tocviewlink" data-pltdoc="x">Debug</a></td></tr><tr><td align="right">8&nbsp;</td><td><a href="#%28part._.Design_.Notes%29" class="tocviewlink" data-pltdoc="x">Design Notes</a></td></tr><tr><td align="right">9&nbsp;</td><td><a href="#%28part._.Acknowledgment%29" class="tocviewlink" data-pltdoc="x">Acknowledgment</a></td></tr><tr><td align="right"></td><td><a href="#%28part._doc-bibliography%29" class="tocviewlink" data-pltdoc="x">Bibliography</a></td></tr></table></div></div></div><div class="tocsub"><table class="tocsublist" cellspacing="0"><tr><td><span class="tocsublinknumber"></span><a href="#%28part._top%29" class="tocsubseclink" data-pltdoc="x">pprint-<wbr></wbr>compact:<span class="mywbr"> &nbsp;</span> a non-<wbr></wbr>greedy pretty printer</a></td></tr><tr><td><span class="tocsublinknumber">1<tt>&nbsp;</tt></span><a href="#%28part._.Getting_.Started%29" class="tocsubseclink" data-pltdoc="x">Getting Started</a></td></tr><tr><td><span class="tocsublinknumber">2<tt>&nbsp;</tt></span><a href="#%28part._.Documents%29" class="tocsubseclink" data-pltdoc="x">Documents</a></td></tr><tr><td><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._doc~3f%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">doc?</span></span></a></td></tr><tr><td><span class="tocsublinknumber">3<tt>&nbsp;</tt></span><a href="#%28part._.Best_.Practice_for_.Document_.Construction%29" class="tocsubseclink" data-pltdoc="x">Best Practice for Document Construction</a></td></tr><tr><td><span class="tocsublinknumber">4<tt>&nbsp;</tt></span><a href="#%28part._.Library_.Documentation%29" class="tocsubseclink" data-pltdoc="x">Library Documentation</a></td></tr><tr><td><span class="tocsublinknumber">4.1<tt>&nbsp;</tt></span><a href="#%28part._.Rendering_.Documents%29" class="tocsubseclink" data-pltdoc="x">Rendering Documents</a></td></tr><tr><td><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._pretty-print%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">pretty-<wbr></wbr>print</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._pretty-format%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">pretty-<wbr></wbr>format</span></span></a></td></tr><tr><td><span class="tocsublinknumber">4.2<tt>&nbsp;</tt></span><a href="#%28part._.Constructing_.Documents%29" class="tocsubseclink" data-pltdoc="x">Constructing Documents</a></td></tr><tr><td><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._text%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">text</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._flush%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">flush</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._alt%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">alt</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._h-append%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">h-<wbr></wbr>append</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._h-concat%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">h-<wbr></wbr>concat</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._v-append%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">v-<wbr></wbr>append</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._v-concat%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">v-<wbr></wbr>concat</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._hs-append%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">hs-<wbr></wbr>append</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._hs-concat%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">hs-<wbr></wbr>concat</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._sep%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">sep</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._fail%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">fail</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._annotate%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">annotate</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._flat%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">flat</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._flush-if%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">flush-<wbr></wbr>if</span></span></a></td></tr><tr><td><span class="tocsublinknumber">4.3<tt>&nbsp;</tt></span><a href="#%28part._.Useful_.Constants%29" class="tocsubseclink" data-pltdoc="x">Useful Constants</a></td></tr><tr><td><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._empty-doc%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">empty-<wbr></wbr>doc</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._lparen%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">lparen</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._rparen%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">rparen</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._space%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">space</span></span></a></td></tr><tr><td><span class="tocsublinknumber">4.4<tt>&nbsp;</tt></span><a href="#%28part._.Parameters%29" class="tocsubseclink" data-pltdoc="x">Parameters</a></td></tr><tr><td><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._current-page-width%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">current-<wbr></wbr>page-<wbr></wbr>width</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._current-page-indent%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">current-<wbr></wbr>page-<wbr></wbr>indent</span></span></a></td></tr><tr><td><span class="tocsublinknumber">4.5<tt>&nbsp;</tt></span><a href="#%28part._.Match_.Expanders%29" class="tocsubseclink" data-pltdoc="x">Match Expanders</a></td></tr><tr><td><a href="#%28form._%28%28lib._pprint-compact%2Fmain..rkt%29._~3atext%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">:<span class="mywbr"> &nbsp;</span>text</span></span></a></td></tr><tr><td><a href="#%28form._%28%28lib._pprint-compact%2Fmain..rkt%29._~3aflush%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">:<span class="mywbr"> &nbsp;</span>flush</span></span></a></td></tr><tr><td><a href="#%28form._%28%28lib._pprint-compact%2Fmain..rkt%29._~3aconcat%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">:<span class="mywbr"> &nbsp;</span>concat</span></span></a></td></tr><tr><td><a href="#%28form._%28%28lib._pprint-compact%2Fmain..rkt%29._~3aalternatives%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">:<span class="mywbr"> &nbsp;</span>alternatives</span></span></a></td></tr><tr><td><a href="#%28form._%28%28lib._pprint-compact%2Fmain..rkt%29._~3aannotate%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">:<span class="mywbr"> &nbsp;</span>annotate</span></span></a></td></tr><tr><td><a href="#%28form._%28%28lib._pprint-compact%2Fmain..rkt%29._~3afail%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">:<span class="mywbr"> &nbsp;</span>fail</span></span></a></td></tr><tr><td><span class="tocsublinknumber">5<tt>&nbsp;</tt></span><a href="#%28part._.Annotation%29" class="tocsubseclink" data-pltdoc="x">Annotation</a></td></tr><tr><td><span class="tocsublinknumber">6<tt>&nbsp;</tt></span><a href="#%28part._.Processing_.Documents%29" class="tocsubseclink" data-pltdoc="x">Processing Documents</a></td></tr><tr><td><span class="tocsublinknumber">6.1<tt>&nbsp;</tt></span><a href="#%28part._.Memoization_.Library%29" class="tocsubseclink" data-pltdoc="x">Memoization Library</a></td></tr><tr><td><a href="#%28def._%28%28lib._pprint-compact%2Fmemoize..rkt%29._memoize%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">memoize</span></span></a></td></tr><tr><td><span class="tocsublinknumber">6.2<tt>&nbsp;</tt></span><a href="#%28part._.Document_.Processing_.Library%29" class="tocsubseclink" data-pltdoc="x">Document Processing Library</a></td></tr><tr><td><a href="#%28def._%28%28lib._pprint-compact%2Fprocess..rkt%29._doc-process%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">doc-<wbr></wbr>process</span></span></a></td></tr><tr><td><span class="tocsublinknumber">6.3<tt>&nbsp;</tt></span><a href="#%28part._.Tutorial__.Implementing_flat%29" class="tocsubseclink" data-pltdoc="x">Tutorial:<span class="mywbr"> &nbsp;</span> Implementing flat</a></td></tr><tr><td><span class="tocsublinknumber">7<tt>&nbsp;</tt></span><a href="#%28part._.Debug%29" class="tocsubseclink" data-pltdoc="x">Debug</a></td></tr><tr><td><a href="#%28def._%28%28lib._pprint-compact%2Fdebug..rkt%29._dag-size%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">dag-<wbr></wbr>size</span></a></td></tr><tr><td><a href="#%28def._%28%28lib._pprint-compact%2Fdebug..rkt%29._tree-size%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">tree-<wbr></wbr>size</span></a></td></tr><tr><td><span class="tocsublinknumber">8<tt>&nbsp;</tt></span><a href="#%28part._.Design_.Notes%29" class="tocsubseclink" data-pltdoc="x">Design Notes</a></td></tr><tr><td><span class="tocsublinknumber">9<tt>&nbsp;</tt></span><a href="#%28part._.Acknowledgment%29" class="tocsubseclink" data-pltdoc="x">Acknowledgment</a></td></tr><tr><td><span class="tocsublinknumber"></span><a href="#%28part._doc-bibliography%29" class="tocsubseclink" data-pltdoc="x">Bibliography</a></td></tr></table></div></div><div class="maincolumn"><div class="main"><div class="versionbox"><span class="version">8.6</span></div><div class="navsettop"><span class="navleft"><form class="searchform"><input class="searchbox" id="searchbox" type="text" tabindex="1" placeholder="...search manuals..." title="Enter a search string to search the manuals" onkeypress="return DoSearchKey(event, this, &quot;8.6&quot;, &quot;../&quot;);"/></form>&nbsp;&nbsp;<a href="../index-2.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;8.6&quot;);">top</a><span class="tocsettoggle">&nbsp;&nbsp;<a href="javascript:void(0);" title="show/hide table of contents" onclick="TocsetToggle();">contents</a></span></span><span class="navright">&nbsp;&nbsp;<span class="nonavigation">&larr; prev</span>&nbsp;&nbsp;<a href="../index-2.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;8.6&quot;);">up</a>&nbsp;&nbsp;<span class="nonavigation">next &rarr;</span></span>&nbsp;</div><h2 x-source-module="(lib &quot;pprint-compact/scribblings/pprint-compact.scrbl&quot;)" x-source-pkg="pprint-compact" x-part-tag="&quot;top&quot;"><a name="(part._top)"></a><a name="(part._pprint-compact__a_non-greedy_pretty_printer)"></a><a name="(mod-path._pprint-compact)"></a>pprint-compact: a non-greedy pretty printer</h2><div class="SAuthorListBox"><span class="SAuthorList"><p class="author">Sorawee Porncharoenwase &lt;<a href="mailto:sorawee.pwase@gmail.com">sorawee.pwase@gmail.com</a>&gt;</p></span></div><p><table cellspacing="0" cellpadding="0" class="defmodule"><tr><td align="left"><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._require%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">require</a></span><span class="stt"> </span><a href="#" class="RktModLink" data-pltdoc="x"><span class="RktSym">pprint-compact</span></a><span class="RktPn">)</span></td><td align="right"><span class="RpackageSpec"><span class="Smaller">&nbsp;package:</span> <a href="https://pkgs.racket-lang.org/package/pprint-compact" title="Install this package using `raco pkg install pprint-compact`"><span class="stt">pprint-compact</span></a></span></td></tr></table></p><p>This library implements an optimal pretty printer inspired by <span class="Autobibref"><a href="#%28autobib._.Jean-.Philippe._.Bernardy.A._.Pretty._.But._.Not._.Greedy._.Printer2017https~3a%2F%2Fjyp..github..io%2Fpdf%2F.Prettiest..pdf%29" class="AutobibLink" data-pltdoc="x">Bernardy</a>&nbsp;(<a href="#%28autobib._.Jean-.Philippe._.Bernardy.A._.Pretty._.But._.Not._.Greedy._.Printer2017https~3a%2F%2Fjyp..github..io%2Fpdf%2F.Prettiest..pdf%29" class="AutobibLink" data-pltdoc="x">2017</a>)</span> and <span class="Autobibref"><a href="#%28autobib._.Anton._.Podkopaev._and._.Dmitri._.Boulytchev.Polynomial-.Time._.Optimal._.Pretty-.Printing._.Combinators._with._.Choice2014https~3a%2F%2Foops..math..spbu..ru%2Fpapers%2Fprinter-combinators..pdf%29" class="AutobibLink" data-pltdoc="x">Podkopaev and Boulytchev</a>&nbsp;(<a href="#%28autobib._.Anton._.Podkopaev._and._.Dmitri._.Boulytchev.Polynomial-.Time._.Optimal._.Pretty-.Printing._.Combinators._with._.Choice2014https~3a%2F%2Foops..math..spbu..ru%2Fpapers%2Fprinter-combinators..pdf%29" class="AutobibLink" data-pltdoc="x">2014</a>)</span>.
The pretty printer generates the most optimal textual document from a tree structure.</p><p>The library is similar to another pretty printer library <a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?tag=%28mod-path._.%27pprint.%27%29&amp;version=8.6" class="RktModLink Sq" data-pltdoc="x"><span class="RktSym">pprint</span></a>,
but <a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?tag=%28mod-path._.%27pprint.%27%29&amp;version=8.6" class="RktModLink Sq" data-pltdoc="x"><span class="RktSym">pprint</span></a> implements a greedy printer and doesn&rsquo;t support the choice operator (<span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._alt%29%29" class="RktValLink" data-pltdoc="x">alt</a></span>). In practice, this means <a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?tag=%28mod-path._.%27pprint.%27%29&amp;version=8.6" class="RktModLink Sq" data-pltdoc="x"><span class="RktSym">pprint</span></a> will be more efficient, but it lacks expressivity that this library provides, and could produce a non-optimal layout.</p><p>Unlike <a href="https://github.com/jyp/prettiest/">the canonical Haskell implementation</a> which removes the choice operator to improve performance, we implement all constructs described in <span class="Autobibref"><a href="#%28autobib._.Jean-.Philippe._.Bernardy.A._.Pretty._.But._.Not._.Greedy._.Printer2017https~3a%2F%2Fjyp..github..io%2Fpdf%2F.Prettiest..pdf%29" class="AutobibLink" data-pltdoc="x">Bernardy</a>&nbsp;(<a href="#%28autobib._.Jean-.Philippe._.Bernardy.A._.Pretty._.But._.Not._.Greedy._.Printer2017https~3a%2F%2Fjyp..github..io%2Fpdf%2F.Prettiest..pdf%29" class="AutobibLink" data-pltdoc="x">2017</a>)</span>, with additional optimizations, constructs for practical printers, and a much better handling of overflow.</p><p>A part of this documentation and its structure are shamelessly copied/adapted from the PPrint library.</p><table cellspacing="0" cellpadding="0"><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._.Getting_.Started%29" class="toptoclink" data-pltdoc="x">1<span class="hspace">&nbsp;</span>Getting Started</a></p></td></tr><tr><td><p><span class="hspace"></span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._.Documents%29" class="toptoclink" data-pltdoc="x">2<span class="hspace">&nbsp;</span>Documents</a></p></td></tr><tr><td><p><span class="hspace"></span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._.Best_.Practice_for_.Document_.Construction%29" class="toptoclink" data-pltdoc="x">3<span class="hspace">&nbsp;</span>Best Practice for Document Construction</a></p></td></tr><tr><td><p><span class="hspace"></span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._.Library_.Documentation%29" class="toptoclink" data-pltdoc="x">4<span class="hspace">&nbsp;</span>Library Documentation</a></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._.Rendering_.Documents%29" class="toclink" data-pltdoc="x">4.1<span class="hspace">&nbsp;</span>Rendering Documents</a></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._.Constructing_.Documents%29" class="toclink" data-pltdoc="x">4.2<span class="hspace">&nbsp;</span>Constructing Documents</a></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._.Useful_.Constants%29" class="toclink" data-pltdoc="x">4.3<span class="hspace">&nbsp;</span>Useful Constants</a></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._.Parameters%29" class="toclink" data-pltdoc="x">4.4<span class="hspace">&nbsp;</span>Parameters</a></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._.Match_.Expanders%29" class="toclink" data-pltdoc="x">4.5<span class="hspace">&nbsp;</span>Match Expanders</a></p></td></tr><tr><td><p><span class="hspace"></span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._.Annotation%29" class="toptoclink" data-pltdoc="x">5<span class="hspace">&nbsp;</span>Annotation</a></p></td></tr><tr><td><p><span class="hspace"></span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._.Processing_.Documents%29" class="toptoclink" data-pltdoc="x">6<span class="hspace">&nbsp;</span>Processing Documents</a></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._.Memoization_.Library%29" class="toclink" data-pltdoc="x">6.1<span class="hspace">&nbsp;</span>Memoization Library</a></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._.Document_.Processing_.Library%29" class="toclink" data-pltdoc="x">6.2<span class="hspace">&nbsp;</span>Document Processing Library</a></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._.Tutorial__.Implementing_flat%29" class="toclink" data-pltdoc="x">6.3<span class="hspace">&nbsp;</span>Tutorial: Implementing flat</a></p></td></tr><tr><td><p><span class="hspace"></span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._.Debug%29" class="toptoclink" data-pltdoc="x">7<span class="hspace">&nbsp;</span>Debug</a></p></td></tr><tr><td><p><span class="hspace"></span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._.Design_.Notes%29" class="toptoclink" data-pltdoc="x">8<span class="hspace">&nbsp;</span>Design Notes</a></p></td></tr><tr><td><p><span class="hspace"></span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._.Acknowledgment%29" class="toptoclink" data-pltdoc="x">9<span class="hspace">&nbsp;</span>Acknowledgment</a></p></td></tr><tr><td><p><span class="hspace"></span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._doc-bibliography%29" class="toptoclink" data-pltdoc="x">Bibliography</a></p></td></tr></table><h3 x-source-module="(lib &quot;pprint-compact/scribblings/pprint-compact.scrbl&quot;)" x-source-pkg="pprint-compact" x-part-tag="&quot;Getting_Started&quot;">1<tt>&nbsp;</tt><a name="(part._.Getting_.Started)"></a>Getting Started</h3><p>Here&rsquo;s a simple example of pretty-printing a fragment of code.</p><p><div class="SIntrapara">Examples:</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">doc</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._v-append%29%29" class="RktValLink" data-pltdoc="x">v-append</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._text%29%29" class="RktValLink" data-pltdoc="x">text</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"while (true) {"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._h-append%29%29" class="RktValLink" data-pltdoc="x">h-append</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._text%29%29" class="RktValLink" data-pltdoc="x">text</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._v-append%29%29" class="RktValLink" data-pltdoc="x">v-append</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._text%29%29" class="RktValLink" data-pltdoc="x">text</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"f();"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._alt%29%29" class="RktValLink" data-pltdoc="x">alt</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._hs-append%29%29" class="RktValLink" data-pltdoc="x">hs-append</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._text%29%29" class="RktValLink" data-pltdoc="x">text</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"if (done())"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._text%29%29" class="RktValLink" data-pltdoc="x">text</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"exit();"</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._v-append%29%29" class="RktValLink" data-pltdoc="x">v-append</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._text%29%29" class="RktValLink" data-pltdoc="x">text</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"if (done())"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._h-append%29%29" class="RktValLink" data-pltdoc="x">h-append</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._text%29%29" class="RktValLink" data-pltdoc="x">text</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._text%29%29" class="RktValLink" data-pltdoc="x">text</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"exit();"</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._text%29%29" class="RktValLink" data-pltdoc="x">text</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"}"</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._pretty-print%29%29" class="RktValLink" data-pltdoc="x">pretty-print</a></span><span class="hspace">&nbsp;</span><span class="RktSym">doc</span><span class="RktPn">)</span></td></tr><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="RktOut">while (true) {</span></p></td></tr><tr><td><p><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">f();</span></p></td></tr><tr><td><p><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">if (done()) exit();</span></p></td></tr><tr><td><p><span class="RktOut">}</span></p></td></tr></table></td></tr></table></blockquote></div></p><p>With a different page width limit, the document could be printed differently:</p><p><div class="SIntrapara">Example:</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._pretty-print%29%29" class="RktValLink" data-pltdoc="x">pretty-print</a></span><span class="hspace">&nbsp;</span><span class="RktSym">doc</span><span class="hspace">&nbsp;</span><span class="RktPn">#:width</span><span class="hspace">&nbsp;</span><span class="RktVal">20</span><span class="RktPn">)</span></td></tr><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="RktOut">while (true) {</span></p></td></tr><tr><td><p><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">f();</span></p></td></tr><tr><td><p><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">if (done())</span></p></td></tr><tr><td><p><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">exit();</span></p></td></tr><tr><td><p><span class="RktOut">}</span></p></td></tr></table></td></tr></table></blockquote></div></p><h3 x-source-module="(lib &quot;pprint-compact/scribblings/pprint-compact.scrbl&quot;)" x-source-pkg="pprint-compact" x-part-tag="&quot;Documents&quot;">2<tt>&nbsp;</tt><a name="(part._.Documents)"></a>Documents</h3><p>Formatting text involves creating an &ldquo;abstract document&rdquo; or <a name="(tech._doc)"></a><span style="font-style: italic">doc</span>,
which encapsulates formatting information for the pretty printer.
The library functions (see <a href="#%28part._.Constructing_.Documents%29" data-pltdoc="x">Constructing Documents</a>)
build and combine docs, which can then be rendered for pretty printing
(see <a href="#%28part._.Rendering_.Documents%29" data-pltdoc="x">Rendering Documents</a>).</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._pprint-compact/main..rkt)._doc~3f))"></a><span title="Provided from: pprint-compact | Package: pprint-compact"><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._doc~3f%29%29" class="RktValDef RktValLink" data-pltdoc="x">doc?</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">x</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=booleans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._boolean%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">boolean?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">x</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">any/c</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Determines whether <span class="RktVar">x</span> is a member of the <a href="#%28tech._doc%29" class="techoutside" data-pltdoc="x"><span class="techinside">doc</span></a> datatype.</div></p><h3 x-source-module="(lib &quot;pprint-compact/scribblings/pprint-compact.scrbl&quot;)" x-source-pkg="pprint-compact" x-part-tag="&quot;Best_Practice_for_Document_Construction&quot;">3<tt>&nbsp;</tt><a name="(part._.Best_.Practice_for_.Document_.Construction)"></a>Best Practice for Document Construction</h3><p>The arguments to <span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._alt%29%29" class="RktValLink" data-pltdoc="x">alt</a></span> should roughly have the same content, albeit with different formats.
This means that the <a name="(tech._tree._size)"></a><span style="font-style: italic">tree size</span> of a <a href="#%28tech._doc%29" class="techoutside" data-pltdoc="x"><span class="techinside">doc</span></a> containing <span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._alt%29%29" class="RktValLink" data-pltdoc="x">alt</a></span> tends to blow up exponentially.
The time complexity of the algorithm used by this library however depends on the <a name="(tech._dag._size)"></a><span style="font-style: italic">DAG size</span> of the <a href="#%28tech._doc%29" class="techoutside" data-pltdoc="x"><span class="techinside">doc</span></a>,
so provided that sub-documents are sufficiently <span class="emph">shared</span>, the <a href="#%28tech._dag._size%29" class="techoutside" data-pltdoc="x"><span class="techinside">DAG size</span></a> should be small enough to allow efficient pretty printing.</p><p>As an example, say we want to pretty print an S-expression with two possible layouts for each &ldquo;list&rdquo;: horizontal and vertical. That is,</p><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktPn">)</span></p></blockquote><p>could be rendered as itself or</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktVal">1</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktVal">2</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktPn">)</span></td></tr></table></blockquote><p>We can construct a function to convert an S-expression to a <a href="#%28tech._doc%29" class="techoutside" data-pltdoc="x"><span class="techinside">doc</span></a>:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">pretty</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=match.html%23%2528form._%2528%2528lib._racket%252Fmatch..rkt%2529._match%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">match</a></span><span class="hspace">&nbsp;</span><span class="RktSym">s</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._list%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">list</a></span><span class="hspace">&nbsp;</span><span class="RktSym">xs</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">Calculate all subdocuments first to <span class="emph">share</span> their references</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">xs*</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528lib._racket%252Fprivate%252Fmap..rkt%2529._map%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">map</a></span><span class="hspace">&nbsp;</span><span class="RktSym">pretty</span><span class="hspace">&nbsp;</span><span class="RktSym">xs</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._alt%29%29" class="RktValLink" data-pltdoc="x">alt</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._h-append%29%29" class="RktValLink" data-pltdoc="x">h-append</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._lparen%29%29" class="RktValLink" data-pltdoc="x">lparen</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._hs-concat%29%29" class="RktValLink" data-pltdoc="x">hs-concat</a></span><span class="hspace">&nbsp;</span><span class="RktSym">xs*</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._rparen%29%29" class="RktValLink" data-pltdoc="x">rparen</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._h-append%29%29" class="RktValLink" data-pltdoc="x">h-append</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._lparen%29%29" class="RktValLink" data-pltdoc="x">lparen</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._v-concat%29%29" class="RktValLink" data-pltdoc="x">v-concat</a></span><span class="hspace">&nbsp;</span><span class="RktSym">xs*</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._rparen%29%29" class="RktValLink" data-pltdoc="x">rparen</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529.__%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">_</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._text%29%29" class="RktValLink" data-pltdoc="x">text</a></span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr></table></blockquote><p>And then pretty print it:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">doc</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">pretty</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">"1"</span><span class="hspace">&nbsp;</span><span class="RktVal">"2"</span><span class="hspace">&nbsp;</span><span class="RktVal">"3"</span><span class="RktVal">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._pretty-print%29%29" class="RktValLink" data-pltdoc="x">pretty-print</a></span><span class="hspace">&nbsp;</span><span class="RktSym">doc</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktOut">(1 2 3)</span></p></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._pretty-print%29%29" class="RktValLink" data-pltdoc="x">pretty-print</a></span><span class="hspace">&nbsp;</span><span class="RktSym">doc</span><span class="hspace">&nbsp;</span><span class="RktPn">#:width</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktPn">)</span></td></tr><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="RktOut">(1</span></p></td></tr><tr><td><p><span class="RktOut"></span><span class="hspace">&nbsp;</span><span class="RktOut">2</span></p></td></tr><tr><td><p><span class="RktOut"></span><span class="hspace">&nbsp;</span><span class="RktOut">3)</span></p></td></tr></table></td></tr></table></blockquote><p>The important point is that we <span class="emph">reuse</span> <span class="RktSym">xs*</span> across branches of <span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._alt%29%29" class="RktValLink" data-pltdoc="x">alt</a></span>.
Had we call <span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528lib._racket%252Fprivate%252Fmap..rkt%2529._map%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">map</a></span><span class="stt"> </span><span class="RktSym">pretty</span><span class="stt"> </span><span class="RktSym">xs</span><span class="RktPn">)</span> twice in branches of <span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._alt%29%29" class="RktValLink" data-pltdoc="x">alt</a></span>,
both <a href="#%28tech._doc%29" class="techoutside" data-pltdoc="x"><span class="techinside">doc</span></a> construction and <span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._pretty-print%29%29" class="RktValLink" data-pltdoc="x">pretty-print</a></span> would be inefficient.</p><h3 x-source-module="(lib &quot;pprint-compact/scribblings/pprint-compact.scrbl&quot;)" x-source-pkg="pprint-compact" x-part-tag="&quot;Library_Documentation&quot;">4<tt>&nbsp;</tt><a name="(part._.Library_.Documentation)"></a>Library Documentation</h3><h4 x-source-module="(lib &quot;pprint-compact/scribblings/pprint-compact.scrbl&quot;)" x-source-pkg="pprint-compact" x-part-tag="&quot;Rendering_Documents&quot;">4.1<tt>&nbsp;</tt><a name="(part._.Rendering_.Documents)"></a>Rendering Documents</h4><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><table cellspacing="0" cellpadding="0" class="prototype RForeground"><tr><td valign="top"><span class="RktPn">(</span><a name="(def._((lib._pprint-compact/main..rkt)._pretty-print))"></a><span title="Provided from: pprint-compact | Package: pprint-compact"><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._pretty-print%29%29" class="RktValDef RktValLink" data-pltdoc="x">pretty-print</a></span></span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">d</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span><span class="RktOpt">[</span></td><td valign="top"><span class="RktPn">#:out</span><span class="hspace">&nbsp;</span><span class="RktVar">out</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:width</span><span class="hspace">&nbsp;</span><span class="RktVar">width</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:indent</span><span class="hspace">&nbsp;</span><span class="RktVar">indent</span><span class="RktOpt">]</span><span class="RktPn">)</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">&rarr;</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=void.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._void%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">void?</a></span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">d</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._doc~3f%29%29" class="RktValLink" data-pltdoc="x">doc?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">out</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=port-ops.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._output-port%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">output-port?</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=port-ops.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._current-output-port%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">current-output-port</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">width</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktVal">+inf.0</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._natural-number%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">natural-number/c</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._current-page-width%29%29" class="RktValLink" data-pltdoc="x">current-page-width</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">indent</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._natural-number%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">natural-number/c</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._current-page-indent%29%29" class="RktValLink" data-pltdoc="x">current-page-indent</a></span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Pretty prints the <a href="#%28tech._doc%29" class="techoutside" data-pltdoc="x"><span class="techinside">doc</span></a> <span class="RktVar">d</span> to the output port <span class="RktVar">out</span> with a maximum page width of <span class="RktVar">width</span> and an initial indentation level for subsequent lines of <span class="RktVar">indent</span>.</div></p><p><div class="SIntrapara">Examples:</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">prefix-s</span><span class="hspace">&nbsp;</span><span class="RktVal">"value is: "</span><span class="RktPn">)</span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=begin.html%23%2528form._%2528%2528quote._%7E23%7E25kernel%2529._begin%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">begin</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=Writing.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._display%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">display</a></span><span class="hspace">&nbsp;</span><span class="RktSym">prefix-s</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._pretty-print%29%29" class="RktValLink" data-pltdoc="x">pretty-print</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._v-append%29%29" class="RktValLink" data-pltdoc="x">v-append</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._text%29%29" class="RktValLink" data-pltdoc="x">text</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"a"</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._text%29%29" class="RktValLink" data-pltdoc="x">text</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"b"</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._text%29%29" class="RktValLink" data-pltdoc="x">text</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"c"</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:indent</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string-length%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">string-length</a></span><span class="hspace">&nbsp;</span><span class="RktSym">prefix-s</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="RktOut">value is: a</span></p></td></tr><tr><td><p><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">b</span></p></td></tr><tr><td><p><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">c</span></p></td></tr></table></td></tr></table></blockquote></div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><table cellspacing="0" cellpadding="0" class="prototype RForeground"><tr><td valign="top"><span class="RktPn">(</span><a name="(def._((lib._pprint-compact/main..rkt)._pretty-format))"></a><span title="Provided from: pprint-compact | Package: pprint-compact"><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._pretty-format%29%29" class="RktValDef RktValLink" data-pltdoc="x">pretty-format</a></span></span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">d</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span><span class="RktOpt">[</span></td><td valign="top"><span class="RktPn">#:width</span><span class="hspace">&nbsp;</span><span class="RktVar">width</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:indent</span><span class="hspace">&nbsp;</span><span class="RktVar">indent</span><span class="RktOpt">]</span><span class="RktPn">)</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">&rarr;</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">string?</a></span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">d</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._doc~3f%29%29" class="RktValLink" data-pltdoc="x">doc?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">width</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktVal">+inf.0</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._natural-number%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">natural-number/c</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._current-page-width%29%29" class="RktValLink" data-pltdoc="x">current-page-width</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">indent</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._natural-number%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">natural-number/c</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._current-page-indent%29%29" class="RktValLink" data-pltdoc="x">current-page-indent</a></span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Pretty prints the <a href="#%28tech._doc%29" class="techoutside" data-pltdoc="x"><span class="techinside">doc</span></a> <span class="RktVar">d</span> as a string with a maximum page width of <span class="RktVar">width</span>.</div></p><h4 x-source-module="(lib &quot;pprint-compact/scribblings/pprint-compact.scrbl&quot;)" x-source-pkg="pprint-compact" x-part-tag="&quot;Constructing_Documents&quot;">4.2<tt>&nbsp;</tt><a name="(part._.Constructing_.Documents)"></a>Constructing Documents</h4><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._pprint-compact/main..rkt)._text))"></a><span title="Provided from: pprint-compact | Package: pprint-compact"><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._text%29%29" class="RktValDef RktValLink" data-pltdoc="x">text</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">s</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._doc~3f%29%29" class="RktValLink" data-pltdoc="x">doc?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">s</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">string?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Constructs a <a href="#%28tech._doc%29" class="techoutside" data-pltdoc="x"><span class="techinside">doc</span></a> containing the fixed string <span class="RktVar">s</span>.
<span class="RktVar">s</span> must <span style="font-weight: bold">not</span> contain a newline character.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._pprint-compact/main..rkt)._flush))"></a><span title="Provided from: pprint-compact | Package: pprint-compact"><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._flush%29%29" class="RktValDef RktValLink" data-pltdoc="x">flush</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">d</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._doc~3f%29%29" class="RktValLink" data-pltdoc="x">doc?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">d</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._doc~3f%29%29" class="RktValLink" data-pltdoc="x">doc?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Constructs a <a href="#%28tech._doc%29" class="techoutside" data-pltdoc="x"><span class="techinside">doc</span></a> which is like <span class="RktVar">d</span> but with a newline at the end.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._pprint-compact/main..rkt)._alt))"></a><span title="Provided from: pprint-compact | Package: pprint-compact"><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._alt%29%29" class="RktValDef RktValLink" data-pltdoc="x">alt</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">x</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._doc~3f%29%29" class="RktValLink" data-pltdoc="x">doc?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">x</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._doc~3f%29%29" class="RktValLink" data-pltdoc="x">doc?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Constructs a <a href="#%28tech._doc%29" class="techoutside" data-pltdoc="x"><span class="techinside">doc</span></a> which is rendered to one of <span class="RktVar">x</span>s, whichever resulting in the prettiest layout for the whole document. If given no arguments, the resulting doc is <span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._fail%29%29" class="RktValLink" data-pltdoc="x">fail</a></span>.</div></p><p>See <a href="#%28part._.Best_.Practice_for_.Document_.Construction%29" data-pltdoc="x">Best Practice for Document Construction</a>
for caveats of this construct.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._pprint-compact/main..rkt)._h-append))"></a><span title="Provided from: pprint-compact | Package: pprint-compact"><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._h-append%29%29" class="RktValDef RktValLink" data-pltdoc="x">h-append</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">x</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._doc~3f%29%29" class="RktValLink" data-pltdoc="x">doc?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">x</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._doc~3f%29%29" class="RktValLink" data-pltdoc="x">doc?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Concatenates <a href="#%28tech._doc%29" class="techoutside" data-pltdoc="x"><span class="techinside">doc</span></a> <span class="RktVar">x</span>s horizontally.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._pprint-compact/main..rkt)._h-concat))"></a><span title="Provided from: pprint-compact | Package: pprint-compact"><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._h-concat%29%29" class="RktValDef RktValLink" data-pltdoc="x">h-concat</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">xs</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._doc~3f%29%29" class="RktValLink" data-pltdoc="x">doc?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">xs</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._listof%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">listof</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._doc~3f%29%29" class="RktValLink" data-pltdoc="x">doc?</a></span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Concatenates <a href="#%28tech._doc%29" class="techoutside" data-pltdoc="x"><span class="techinside">doc</span></a>s in <span class="RktVar">xs</span> horizontally.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._pprint-compact/main..rkt)._v-append))"></a><span title="Provided from: pprint-compact | Package: pprint-compact"><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._v-append%29%29" class="RktValDef RktValLink" data-pltdoc="x">v-append</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">x</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._doc~3f%29%29" class="RktValLink" data-pltdoc="x">doc?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">x</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._doc~3f%29%29" class="RktValLink" data-pltdoc="x">doc?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Concatenates <a href="#%28tech._doc%29" class="techoutside" data-pltdoc="x"><span class="techinside">doc</span></a> <span class="RktVar">x</span>s vertically.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._pprint-compact/main..rkt)._v-concat))"></a><span title="Provided from: pprint-compact | Package: pprint-compact"><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._v-concat%29%29" class="RktValDef RktValLink" data-pltdoc="x">v-concat</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">xs</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._doc~3f%29%29" class="RktValLink" data-pltdoc="x">doc?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">xs</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._listof%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">listof</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._doc~3f%29%29" class="RktValLink" data-pltdoc="x">doc?</a></span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Concatenates <a href="#%28tech._doc%29" class="techoutside" data-pltdoc="x"><span class="techinside">doc</span></a>s in <span class="RktVar">xs</span> vertically.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._pprint-compact/main..rkt)._hs-append))"></a><span title="Provided from: pprint-compact | Package: pprint-compact"><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._hs-append%29%29" class="RktValDef RktValLink" data-pltdoc="x">hs-append</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">x</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._doc~3f%29%29" class="RktValLink" data-pltdoc="x">doc?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">x</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._doc~3f%29%29" class="RktValLink" data-pltdoc="x">doc?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Concatenates <a href="#%28tech._doc%29" class="techoutside" data-pltdoc="x"><span class="techinside">doc</span></a> <span class="RktVar">x</span>s horizontally with successive pairs separated by <span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._space%29%29" class="RktValLink" data-pltdoc="x">space</a></span>.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._pprint-compact/main..rkt)._hs-concat))"></a><span title="Provided from: pprint-compact | Package: pprint-compact"><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._hs-concat%29%29" class="RktValDef RktValLink" data-pltdoc="x">hs-concat</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">x</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._doc~3f%29%29" class="RktValLink" data-pltdoc="x">doc?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">x</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._doc~3f%29%29" class="RktValLink" data-pltdoc="x">doc?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Concatenates <a href="#%28tech._doc%29" class="techoutside" data-pltdoc="x"><span class="techinside">doc</span></a>s in <span class="RktSym">xs</span> horizontally with successive pairs separated by <span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._space%29%29" class="RktValLink" data-pltdoc="x">space</a></span>.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._pprint-compact/main..rkt)._sep))"></a><span title="Provided from: pprint-compact | Package: pprint-compact"><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._sep%29%29" class="RktValDef RktValLink" data-pltdoc="x">sep</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">xs</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._doc~3f%29%29" class="RktValLink" data-pltdoc="x">doc?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">xs</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._doc~3f%29%29" class="RktValLink" data-pltdoc="x">doc?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Concatenates <a href="#%28tech._doc%29" class="techoutside" data-pltdoc="x"><span class="techinside">doc</span></a>s in <span class="RktVar">xs</span> either (1) vertically or (2)
horizontally with successive pairs separated by <span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._space%29%29" class="RktValLink" data-pltdoc="x">space</a></span>.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>value</p></div></div><p class="RForeground"><a name="(def._((lib._pprint-compact/main..rkt)._fail))"></a><span title="Provided from: pprint-compact | Package: pprint-compact"><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._fail%29%29" class="RktValDef RktValLink" data-pltdoc="x">fail</a></span></span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._doc~3f%29%29" class="RktValLink" data-pltdoc="x">doc?</a></span></p></blockquote></td></tr></table></blockquote></div><div class="SIntrapara">Constructs a <a href="#%28tech._doc%29" class="techoutside" data-pltdoc="x"><span class="techinside">doc</span></a> that fails to render.
This doc interacts with <span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._alt%29%29" class="RktValLink" data-pltdoc="x">alt</a></span>: only non-failing branches are considered for rendering.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._pprint-compact/main..rkt)._annotate))"></a><span title="Provided from: pprint-compact | Package: pprint-compact"><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._annotate%29%29" class="RktValDef RktValLink" data-pltdoc="x">annotate</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">d</span><span class="hspace">&nbsp;</span><span class="RktVar">a</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._doc~3f%29%29" class="RktValLink" data-pltdoc="x">doc?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">d</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._doc~3f%29%29" class="RktValLink" data-pltdoc="x">doc?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">a</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">any/c</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Constructs a <a href="#%28tech._doc%29" class="techoutside" data-pltdoc="x"><span class="techinside">doc</span></a> which is like <span class="RktVar">d</span> but with an <a href="#%28tech._annotation%29" class="techoutside" data-pltdoc="x"><span class="techinside">annotation</span></a> <span class="RktVar">a</span>.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._pprint-compact/main..rkt)._flat))"></a><span title="Provided from: pprint-compact | Package: pprint-compact"><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._flat%29%29" class="RktValDef RktValLink" data-pltdoc="x">flat</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">x</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._doc~3f%29%29" class="RktValLink" data-pltdoc="x">doc?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">x</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._doc~3f%29%29" class="RktValLink" data-pltdoc="x">doc?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Constrains <a href="#%28tech._doc%29" class="techoutside" data-pltdoc="x"><span class="techinside">doc</span></a> <span class="RktVar">x</span> to fit in one line.
If <span class="RktVar">x</span> can&rsquo;t fit in one line, it fails to render.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._pprint-compact/main..rkt)._flush-if))"></a><span title="Provided from: pprint-compact | Package: pprint-compact"><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._flush-if%29%29" class="RktValDef RktValLink" data-pltdoc="x">flush-if</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">b</span><span class="hspace">&nbsp;</span><span class="RktVar">d</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._doc~3f%29%29" class="RktValLink" data-pltdoc="x">doc?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">b</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">any/c</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">d</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._doc~3f%29%29" class="RktValLink" data-pltdoc="x">doc?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Performs <span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._flush%29%29" class="RktValLink" data-pltdoc="x">flush</a></span> on <span class="RktVar">d</span> if <span class="RktVar">b</span> is true.
Otherwise, simply returns <span class="RktVar">d</span>.</div></p><h4 x-source-module="(lib &quot;pprint-compact/scribblings/pprint-compact.scrbl&quot;)" x-source-pkg="pprint-compact" x-part-tag="&quot;Useful_Constants&quot;">4.3<tt>&nbsp;</tt><a name="(part._.Useful_.Constants)"></a>Useful Constants</h4><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>value</p></div></div><p class="RForeground"><a name="(def._((lib._pprint-compact/main..rkt)._empty-doc))"></a><span title="Provided from: pprint-compact | Package: pprint-compact"><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._empty-doc%29%29" class="RktValDef RktValLink" data-pltdoc="x">empty-doc</a></span></span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._doc~3f%29%29" class="RktValLink" data-pltdoc="x">doc?</a></span></p></blockquote></td></tr></table></blockquote></div><div class="SIntrapara">Same as <span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._text%29%29" class="RktValLink" data-pltdoc="x">text</a></span><span class="stt"> </span><span class="RktVal">""</span><span class="RktPn">)</span></div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>value</p></div></div><p class="RForeground"><a name="(def._((lib._pprint-compact/main..rkt)._lparen))"></a><span title="Provided from: pprint-compact | Package: pprint-compact"><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._lparen%29%29" class="RktValDef RktValLink" data-pltdoc="x">lparen</a></span></span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._doc~3f%29%29" class="RktValLink" data-pltdoc="x">doc?</a></span></p></blockquote></td></tr></table></blockquote></div><div class="SIntrapara">Same as <span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._text%29%29" class="RktValLink" data-pltdoc="x">text</a></span><span class="stt"> </span><span class="RktVal">"("</span><span class="RktPn">)</span></div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>value</p></div></div><p class="RForeground"><a name="(def._((lib._pprint-compact/main..rkt)._rparen))"></a><span title="Provided from: pprint-compact | Package: pprint-compact"><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._rparen%29%29" class="RktValDef RktValLink" data-pltdoc="x">rparen</a></span></span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._doc~3f%29%29" class="RktValLink" data-pltdoc="x">doc?</a></span></p></blockquote></td></tr></table></blockquote></div><div class="SIntrapara">Same as <span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._text%29%29" class="RktValLink" data-pltdoc="x">text</a></span><span class="stt"> </span><span class="RktVal">")"</span><span class="RktPn">)</span></div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>value</p></div></div><p class="RForeground"><a name="(def._((lib._pprint-compact/main..rkt)._space))"></a><span title="Provided from: pprint-compact | Package: pprint-compact"><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._space%29%29" class="RktValDef RktValLink" data-pltdoc="x">space</a></span></span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._doc~3f%29%29" class="RktValLink" data-pltdoc="x">doc?</a></span></p></blockquote></td></tr></table></blockquote></div><div class="SIntrapara">Same as <span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._text%29%29" class="RktValLink" data-pltdoc="x">text</a></span><span class="stt"> </span><span class="RktVal">" "</span><span class="RktPn">)</span></div></p><h4 x-source-module="(lib &quot;pprint-compact/scribblings/pprint-compact.scrbl&quot;)" x-source-pkg="pprint-compact" x-part-tag="&quot;Parameters&quot;">4.4<tt>&nbsp;</tt><a name="(part._.Parameters)"></a>Parameters</h4><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>parameter</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._pprint-compact/main..rkt)._current-page-width))"></a><span title="Provided from: pprint-compact | Package: pprint-compact"><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._current-page-width%29%29" class="RktValDef RktValLink" data-pltdoc="x">current-page-width</a></span></span><span class="RktPn"></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._natural-number%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">natural-number/c</a></span><span class="hspace">&nbsp;</span><span class="RktVal">+inf.0</span><span class="RktPn">)</span></p></blockquote></td></tr><tr><td><span class="RktPn">(</span><span title="Provided from: pprint-compact | Package: pprint-compact"><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._current-page-width%29%29" class="RktValDef RktValLink" data-pltdoc="x">current-page-width</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">page-width</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=void.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._void%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">void?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">page-width</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._natural-number%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">natural-number/c</a></span><span class="hspace">&nbsp;</span><span class="RktVal">+inf.0</span><span class="RktPn">)</span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="argcontract"><tr><td valign="top"><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVal">80</span></td></tr></table></td></tr></table></blockquote></div><div class="SIntrapara">A parameter that determines the page width for pretty printing.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>parameter</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._pprint-compact/main..rkt)._current-page-indent))"></a><span title="Provided from: pprint-compact | Package: pprint-compact"><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._current-page-indent%29%29" class="RktValDef RktValLink" data-pltdoc="x">current-page-indent</a></span></span><span class="RktPn"></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._natural-number%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">natural-number/c</a></span></p></blockquote></td></tr><tr><td><span class="RktPn">(</span><span title="Provided from: pprint-compact | Package: pprint-compact"><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._current-page-indent%29%29" class="RktValDef RktValLink" data-pltdoc="x">current-page-indent</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">indent</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=void.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._void%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">void?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">indent</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._natural-number%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">natural-number/c</a></span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="argcontract"><tr><td valign="top"><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVal">0</span></td></tr></table></td></tr></table></blockquote></div><div class="SIntrapara">A parameter that determines the initial indentation level for subsequent lines.</div></p><h4 x-source-module="(lib &quot;pprint-compact/scribblings/pprint-compact.scrbl&quot;)" x-source-pkg="pprint-compact" x-part-tag="&quot;Match_Expanders&quot;">4.5<tt>&nbsp;</tt><a name="(part._.Match_.Expanders)"></a>Match Expanders</h4><p>Internally, a <a href="#%28tech._doc%29" class="techoutside" data-pltdoc="x"><span class="techinside">doc</span></a> is either a <span class="RktSym"><a href="#%28form._%28%28lib._pprint-compact%2Fmain..rkt%29._~3atext%29%29" class="RktStxLink" data-pltdoc="x">:text</a></span>, <span class="RktSym"><a href="#%28form._%28%28lib._pprint-compact%2Fmain..rkt%29._~3aflush%29%29" class="RktStxLink" data-pltdoc="x">:flush</a></span>, <span class="RktSym"><a href="#%28form._%28%28lib._pprint-compact%2Fmain..rkt%29._~3aconcat%29%29" class="RktStxLink" data-pltdoc="x">:concat</a></span>, <span class="RktSym"><a href="#%28form._%28%28lib._pprint-compact%2Fmain..rkt%29._~3aalternatives%29%29" class="RktStxLink" data-pltdoc="x">:alternatives</a></span>, <span class="RktSym"><a href="#%28form._%28%28lib._pprint-compact%2Fmain..rkt%29._~3aannotate%29%29" class="RktStxLink" data-pltdoc="x">:annotate</a></span>, or <span class="RktSym"><a href="#%28form._%28%28lib._pprint-compact%2Fmain..rkt%29._~3afail%29%29" class="RktStxLink" data-pltdoc="x">:fail</a></span>.
We provide these <a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=match.html%23%2528part._.Extending_match%2529&amp;version=8.6" class="Sq" data-pltdoc="x">match expander</a>s to allow <a href="#%28tech._doc%29" class="techoutside" data-pltdoc="x"><span class="techinside">doc</span></a> processing (see <a href="#%28part._.Processing_.Documents%29" data-pltdoc="x">Processing Documents</a>.
The match expanders are illegal outside of the pattern position of the <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=match.html%23%2528form._%2528%2528lib._racket%252Fmatch..rkt%2529._match%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">match</a></span> form.
Keep in mind that this list is unstable and could change across versions of the library.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>syntax</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(form._((lib._pprint-compact/main..rkt)._~3atext))"></a><span title="Provided from: pprint-compact | Package: pprint-compact"><span class="RktSym"><a href="#%28form._%28%28lib._pprint-compact%2Fmain..rkt%29._~3atext%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">:text</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">s</span><span class="RktPn">)</span></p></blockquote></td></tr></table></blockquote></div><div class="SIntrapara">A match expander that recognizes text <span class="RktVar">s</span> of type <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">string?</a></span>.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>syntax</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(form._((lib._pprint-compact/main..rkt)._~3aflush))"></a><span title="Provided from: pprint-compact | Package: pprint-compact"><span class="RktSym"><a href="#%28form._%28%28lib._pprint-compact%2Fmain..rkt%29._~3aflush%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">:flush</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">d</span><span class="RktPn">)</span></p></blockquote></td></tr></table></blockquote></div><div class="SIntrapara">A match expander that recognizes a <a href="#%28tech._doc%29" class="techoutside" data-pltdoc="x"><span class="techinside">doc</span></a> <span class="RktVar">d</span> with a newline at the end.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>syntax</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(form._((lib._pprint-compact/main..rkt)._~3aconcat))"></a><span title="Provided from: pprint-compact | Package: pprint-compact"><span class="RktSym"><a href="#%28form._%28%28lib._pprint-compact%2Fmain..rkt%29._~3aconcat%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">:concat</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">da</span><span class="hspace">&nbsp;</span><span class="RktVar">db</span><span class="RktPn">)</span></p></blockquote></td></tr></table></blockquote></div><div class="SIntrapara">A match expander that recognizes a horizontal concatenation of <a href="#%28tech._doc%29" class="techoutside" data-pltdoc="x"><span class="techinside">doc</span></a>s <span class="RktVar">da</span> and <span class="RktVar">db</span>.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>syntax</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(form._((lib._pprint-compact/main..rkt)._~3aalternatives))"></a><span title="Provided from: pprint-compact | Package: pprint-compact"><span class="RktSym"><a href="#%28form._%28%28lib._pprint-compact%2Fmain..rkt%29._~3aalternatives%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">:alternatives</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">da</span><span class="hspace">&nbsp;</span><span class="RktVar">db</span><span class="RktPn">)</span></p></blockquote></td></tr></table></blockquote></div><div class="SIntrapara">A match expander that recognizes two choices: <a href="#%28tech._doc%29" class="techoutside" data-pltdoc="x"><span class="techinside">doc</span></a>s <span class="RktVar">da</span> and <span class="RktVar">db</span>.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>syntax</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(form._((lib._pprint-compact/main..rkt)._~3aannotate))"></a><span title="Provided from: pprint-compact | Package: pprint-compact"><span class="RktSym"><a href="#%28form._%28%28lib._pprint-compact%2Fmain..rkt%29._~3aannotate%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">:annotate</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">d</span><span class="hspace">&nbsp;</span><span class="RktVar">a</span><span class="RktPn">)</span></p></blockquote></td></tr></table></blockquote></div><div class="SIntrapara">A match expander that recognizes a <a href="#%28tech._doc%29" class="techoutside" data-pltdoc="x"><span class="techinside">doc</span></a> <span class="RktVar">d</span> with an annotation value <span class="RktVar">a</span>.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>syntax</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(form._((lib._pprint-compact/main..rkt)._~3afail))"></a><span title="Provided from: pprint-compact | Package: pprint-compact"><span class="RktSym"><a href="#%28form._%28%28lib._pprint-compact%2Fmain..rkt%29._~3afail%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">:fail</a></span></span><span class="RktPn">)</span></p></blockquote></td></tr></table></blockquote></div><div class="SIntrapara">A match expander that recognizes a failing <a href="#%28tech._doc%29" class="techoutside" data-pltdoc="x"><span class="techinside">doc</span></a>.</div></p><h3 x-source-module="(lib &quot;pprint-compact/scribblings/pprint-compact.scrbl&quot;)" x-source-pkg="pprint-compact" x-part-tag="&quot;Annotation&quot;">5<tt>&nbsp;</tt><a name="(part._.Annotation)"></a>Annotation</h3><p>An <a name="(tech._annotation)"></a><span style="font-style: italic">annotation</span> can be attached to a <a href="#%28tech._doc%29" class="techoutside" data-pltdoc="x"><span class="techinside">doc</span></a> via <span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._annotate%29%29" class="RktValLink" data-pltdoc="x">annotate</a></span>.
An annotated doc is rendered like the corresponding unannotated doc,
but various constructs can inspect an annotation for optimization or
to change the rendering semantics.
Unless you wish to write a function to process a <a href="#%28tech._doc%29" class="techoutside" data-pltdoc="x"><span class="techinside">doc</span></a> (see <a href="#%28part._.Processing_.Documents%29" data-pltdoc="x">Processing Documents</a>),
you can pretend that this feature doesn&rsquo;t exist.</p><h3 x-source-module="(lib &quot;pprint-compact/scribblings/pprint-compact.scrbl&quot;)" x-source-pkg="pprint-compact" x-part-tag="&quot;Processing_Documents&quot;">6<tt>&nbsp;</tt><a name="(part._.Processing_.Documents)"></a>Processing Documents</h3><p>If you wish to process a <a href="#%28tech._doc%29" class="techoutside" data-pltdoc="x"><span class="techinside">doc</span></a>, it is highly recommended that your function that recurs over the <a href="#%28tech._doc%29" class="techoutside" data-pltdoc="x"><span class="techinside">doc</span></a> structure is <span class="emph">memoizing</span>. This can be done by using <span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmemoize..rkt%29._memoize%29%29" class="RktValLink" data-pltdoc="x">memoize</a></span> function in <a href="#%28mod-path._pprint-compact%2Fmemoize%29" class="RktModLink" data-pltdoc="x"><span class="RktSym">pprint-compact/memoize</span></a>.</p><h4 x-source-module="(lib &quot;pprint-compact/scribblings/pprint-compact.scrbl&quot;)" x-source-pkg="pprint-compact" x-part-tag="&quot;Memoization_Library&quot;">6.1<tt>&nbsp;</tt><a name="(part._.Memoization_.Library)"></a><a name="(mod-path._pprint-compact/memoize)"></a>Memoization Library</h4><p><table cellspacing="0" cellpadding="0" class="defmodule"><tr><td align="left" colspan="2"><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._require%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">require</a></span><span class="stt"> </span><a href="#%28mod-path._pprint-compact%2Fmemoize%29" class="RktModLink" data-pltdoc="x"><span class="RktSym">pprint-compact/memoize</span></a><span class="RktPn">)</span></td></tr><tr><td align="left">&nbsp;</td><td align="right"><span class="RpackageSpec"><span class="Smaller">&nbsp;package:</span> <a href="https://pkgs.racket-lang.org/package/pprint-compact" title="Install this package using `raco pkg install pprint-compact`"><span class="stt">pprint-compact</span></a></span></td></tr></table></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._pprint-compact/memoize..rkt)._memoize))"></a><span title="Provided from: pprint-compact/memoize | Package: pprint-compact"><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmemoize..rkt%29._memoize%29%29" class="RktValDef RktValLink" data-pltdoc="x">memoize</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">f</span><span class="hspace">&nbsp;</span><span class="RktOpt">[</span><span class="RktPn">#:backend</span><span class="hspace">&nbsp;</span><span class="RktVar">backend</span><span class="RktOpt">]</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=procedures.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._procedure%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">procedure?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">f</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=function-contracts.html%23%2528form._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._-%7E3e%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">any/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">any/c</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">backend</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=procedures.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._procedure%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">procedure?</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=hashtables.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._hasheq%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">hasheq</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Memoizes the function <span class="RktVar">f</span> based on the <span class="RktVar">backend</span> data structure.</div></p><h4 x-source-module="(lib &quot;pprint-compact/scribblings/pprint-compact.scrbl&quot;)" x-source-pkg="pprint-compact" x-part-tag="&quot;Document_Processing_Library&quot;">6.2<tt>&nbsp;</tt><a name="(part._.Document_.Processing_.Library)"></a><a name="(mod-path._pprint-compact/process)"></a>Document Processing Library</h4><p><table cellspacing="0" cellpadding="0" class="defmodule"><tr><td align="left" colspan="2"><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._require%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">require</a></span><span class="stt"> </span><a href="#%28mod-path._pprint-compact%2Fprocess%29" class="RktModLink" data-pltdoc="x"><span class="RktSym">pprint-compact/process</span></a><span class="RktPn">)</span></td></tr><tr><td align="left">&nbsp;</td><td align="right"><span class="RpackageSpec"><span class="Smaller">&nbsp;package:</span> <a href="https://pkgs.racket-lang.org/package/pprint-compact" title="Install this package using `raco pkg install pprint-compact`"><span class="stt">pprint-compact</span></a></span></td></tr></table></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._pprint-compact/process..rkt)._doc-process))"></a><span title="Provided from: pprint-compact/process | Package: pprint-compact"><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fprocess..rkt%29._doc-process%29%29" class="RktValDef RktValLink" data-pltdoc="x">doc-process</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">f</span><span class="hspace">&nbsp;</span><span class="RktVar">d</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._doc~3f%29%29" class="RktValLink" data-pltdoc="x">doc?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">f</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=procedures.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._procedure%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">procedure?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">d</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._doc~3f%29%29" class="RktValLink" data-pltdoc="x">doc?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Calls <span class="RktVar">f</span> on the immediate subdocuments of <span class="RktVar">d</span> and reassembles the results back.
The function attempts to avoid creating new objects as best as it can. Note that <span class="RktVar">f</span> should be memoized.</div></p><p>Prefer this function over manual <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=match.html%23%2528form._%2528%2528lib._racket%252Fmatch..rkt%2529._match%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">match</a></span>ing against all match expanders, since the list of match expanders could change across versions of this library, making the code brittle to changes. Using this function on the other hand makes doc processing stable across versions.</p><h4 x-source-module="(lib &quot;pprint-compact/scribblings/pprint-compact.scrbl&quot;)" x-source-pkg="pprint-compact" x-part-tag="&quot;Tutorial__Implementing_flat&quot;">6.3<tt>&nbsp;</tt><a name="(part._.Tutorial__.Implementing_flat)"></a>Tutorial: Implementing flat</h4><p>This section will demonstrate how to perform document processing by implementing <span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._flat%29%29" class="RktValLink" data-pltdoc="x">flat</a></span>.</p><p>The goal of <span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._flat%29%29" class="RktValLink" data-pltdoc="x">flat</a></span> is to constrain a document to have only one line.
This can be done by replacing every <span class="RktSym"><a href="#%28form._%28%28lib._pprint-compact%2Fmain..rkt%29._~3aflush%29%29" class="RktStxLink" data-pltdoc="x">:flush</a></span> with <span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._fail%29%29" class="RktValLink" data-pltdoc="x">fail</a></span>.</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">my-flat</span><span class="hspace">&nbsp;</span><span class="RktSym">d</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=match.html%23%2528form._%2528%2528lib._racket%252Fmatch..rkt%2529._match%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">match</a></span><span class="hspace">&nbsp;</span><span class="RktSym">d</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._pprint-compact%2Fmain..rkt%29._~3aflush%29%29" class="RktStxLink" data-pltdoc="x">:flush</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._fail%29%29" class="RktValLink" data-pltdoc="x">fail</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._pprint-compact%2Fmain..rkt%29._~3atext%29%29" class="RktStxLink" data-pltdoc="x">:text</a></span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">d</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._pprint-compact%2Fmain..rkt%29._~3afail%29%29" class="RktStxLink" data-pltdoc="x">:fail</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">d</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._pprint-compact%2Fmain..rkt%29._~3aconcat%29%29" class="RktStxLink" data-pltdoc="x">:concat</a></span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._h-append%29%29" class="RktValLink" data-pltdoc="x">h-append</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">my-flat</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">my-flat</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._pprint-compact%2Fmain..rkt%29._~3aalternatives%29%29" class="RktStxLink" data-pltdoc="x">:alternatives</a></span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._alt%29%29" class="RktValLink" data-pltdoc="x">alt</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">my-flat</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">my-flat</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._pprint-compact%2Fmain..rkt%29._~3aannotate%29%29" class="RktStxLink" data-pltdoc="x">:annotate</a></span><span class="hspace">&nbsp;</span><span class="RktSym">d</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._annotate%29%29" class="RktValLink" data-pltdoc="x">annotate</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">my-flat</span><span class="hspace">&nbsp;</span><span class="RktSym">d</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p>While this code is functional, it is inefficient: the time complexity is linear to the <a href="#%28tech._tree._size%29" class="techoutside" data-pltdoc="x"><span class="techinside">tree size</span></a> of the document, even though the <a href="#%28tech._dag._size%29" class="techoutside" data-pltdoc="x"><span class="techinside">DAG size</span></a> could be much smaller.</p><p>We can improve the function by using memoization:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">my-flat</span><span class="hspace">&nbsp;</span><span class="RktSym">d</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">loop</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmemoize..rkt%29._memoize%29%29" class="RktValLink" data-pltdoc="x">memoize</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=lambda.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._%7Ece%7Ebb%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">&#955;</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">d</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=match.html%23%2528form._%2528%2528lib._racket%252Fmatch..rkt%2529._match%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">match</a></span><span class="hspace">&nbsp;</span><span class="RktSym">d</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._pprint-compact%2Fmain..rkt%29._~3aflush%29%29" class="RktStxLink" data-pltdoc="x">:flush</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._fail%29%29" class="RktValLink" data-pltdoc="x">fail</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._pprint-compact%2Fmain..rkt%29._~3atext%29%29" class="RktStxLink" data-pltdoc="x">:text</a></span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">d</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._pprint-compact%2Fmain..rkt%29._~3afail%29%29" class="RktStxLink" data-pltdoc="x">:fail</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">d</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._pprint-compact%2Fmain..rkt%29._~3aconcat%29%29" class="RktStxLink" data-pltdoc="x">:concat</a></span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._h-append%29%29" class="RktValLink" data-pltdoc="x">h-append</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">loop</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">loop</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._pprint-compact%2Fmain..rkt%29._~3aalternatives%29%29" class="RktStxLink" data-pltdoc="x">:alternatives</a></span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._alt%29%29" class="RktValLink" data-pltdoc="x">alt</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">loop</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">loop</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._pprint-compact%2Fmain..rkt%29._~3aannotate%29%29" class="RktStxLink" data-pltdoc="x">:annotate</a></span><span class="hspace">&nbsp;</span><span class="RktSym">d</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._annotate%29%29" class="RktValLink" data-pltdoc="x">annotate</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">loop</span><span class="hspace">&nbsp;</span><span class="RktSym">d</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">loop</span><span class="hspace">&nbsp;</span><span class="RktSym">d</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p>However, this function is still subtly inefficient because when it recurs, it unconditionally constructs new objects even though there is no change. Moreover, the code is brittle as the list of match expanders could change across versions of this library.</p><p>We can solve both problems at once by using <span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fprocess..rkt%29._doc-process%29%29" class="RktValLink" data-pltdoc="x">doc-process</a></span>.</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">my-flat</span><span class="hspace">&nbsp;</span><span class="RktSym">d</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">loop</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmemoize..rkt%29._memoize%29%29" class="RktValLink" data-pltdoc="x">memoize</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=lambda.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._%7Ece%7Ebb%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">&#955;</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">d</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=match.html%23%2528form._%2528%2528lib._racket%252Fmatch..rkt%2529._match%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">match</a></span><span class="hspace">&nbsp;</span><span class="RktSym">d</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._pprint-compact%2Fmain..rkt%29._~3aflush%29%29" class="RktStxLink" data-pltdoc="x">:flush</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._fail%29%29" class="RktValLink" data-pltdoc="x">fail</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529.__%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">_</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fprocess..rkt%29._doc-process%29%29" class="RktValLink" data-pltdoc="x">doc-process</a></span><span class="hspace">&nbsp;</span><span class="RktSym">loop</span><span class="hspace">&nbsp;</span><span class="RktSym">d</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">loop</span><span class="hspace">&nbsp;</span><span class="RktSym">d</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p>We can further optimize the function by noticing that if a doc fragment is already flat, then there is no need to recur further. Therefore, we add an <a href="#%28tech._annotation%29" class="techoutside" data-pltdoc="x"><span class="techinside">annotation</span></a> that the output doc is flat and avoid computation if the doc is already flat:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">my-flat</span><span class="hspace">&nbsp;</span><span class="RktSym">d</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">loop</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmemoize..rkt%29._memoize%29%29" class="RktValLink" data-pltdoc="x">memoize</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=lambda.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._%7Ece%7Ebb%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">&#955;</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">d</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=match.html%23%2528form._%2528%2528lib._racket%252Fmatch..rkt%2529._match%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">match</a></span><span class="hspace">&nbsp;</span><span class="RktSym">d</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._pprint-compact%2Fmain..rkt%29._~3aflush%29%29" class="RktStxLink" data-pltdoc="x">:flush</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._fail%29%29" class="RktValLink" data-pltdoc="x">fail</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._pprint-compact%2Fmain..rkt%29._~3aannotate%29%29" class="RktStxLink" data-pltdoc="x">:annotate</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529.__%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">_</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">flat</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">d</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529.__%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">_</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fprocess..rkt%29._doc-process%29%29" class="RktValLink" data-pltdoc="x">doc-process</a></span><span class="hspace">&nbsp;</span><span class="RktSym">loop</span><span class="hspace">&nbsp;</span><span class="RktSym">d</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._annotate%29%29" class="RktValLink" data-pltdoc="x">annotate</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">loop</span><span class="hspace">&nbsp;</span><span class="RktSym">d</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">flat</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><h3 x-source-module="(lib &quot;pprint-compact/scribblings/pprint-compact.scrbl&quot;)" x-source-pkg="pprint-compact" x-part-tag="&quot;Debug&quot;">7<tt>&nbsp;</tt><a name="(part._.Debug)"></a><a name="(mod-path._pprint-compact/debug)"></a>Debug</h3><p><table cellspacing="0" cellpadding="0" class="defmodule"><tr><td align="left"><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._require%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">require</a></span><span class="stt"> </span><a href="#%28mod-path._pprint-compact%2Fdebug%29" class="RktModLink" data-pltdoc="x"><span class="RktSym">pprint-compact/debug</span></a><span class="RktPn">)</span></td><td align="right"><span class="RpackageSpec"><span class="Smaller">&nbsp;package:</span> <a href="https://pkgs.racket-lang.org/package/pprint-compact" title="Install this package using `raco pkg install pprint-compact`"><span class="stt">pprint-compact</span></a></span></td></tr></table></p><p>The following functions can be used to measure document size.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._pprint-compact/debug..rkt)._dag-size))"></a><span title="Provided from: pprint-compact/debug | Package: pprint-compact"><span class="RktSym"><span class="RktSymDef RktSym">dag-size</span></span></span><span class="hspace">&nbsp;</span><span class="RktVar">d</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._natural-number%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">natural-number/c</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">d</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._doc~3f%29%29" class="RktValLink" data-pltdoc="x">doc?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Returns the <a href="#%28tech._dag._size%29" class="techoutside" data-pltdoc="x"><span class="techinside">DAG size</span></a> of <a href="#%28tech._doc%29" class="techoutside" data-pltdoc="x"><span class="techinside">doc</span></a> <span class="RktVar">d</span>.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._pprint-compact/debug..rkt)._tree-size))"></a><span title="Provided from: pprint-compact/debug | Package: pprint-compact"><span class="RktSym"><span class="RktSymDef RktSym">tree-size</span></span></span><span class="hspace">&nbsp;</span><span class="RktVar">d</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._natural-number%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">natural-number/c</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">d</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._doc~3f%29%29" class="RktValLink" data-pltdoc="x">doc?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Returns the <a href="#%28tech._tree._size%29" class="techoutside" data-pltdoc="x"><span class="techinside">tree size</span></a> of <a href="#%28tech._doc%29" class="techoutside" data-pltdoc="x"><span class="techinside">doc</span></a> <span class="RktVar">d</span>.</div></p><h3 x-source-module="(lib &quot;pprint-compact/scribblings/pprint-compact.scrbl&quot;)" x-source-pkg="pprint-compact" x-part-tag="&quot;Design_Notes&quot;">8<tt>&nbsp;</tt><a name="(part._.Design_.Notes)"></a>Design Notes</h3><p>For the history of pretty printer in general, see <a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?tag=%28part._%28.%27%28lib._pprint%2Fpprint..scrbl%29.%27._.%27history.%27%29%29&amp;version=8.6" class="Sq" data-pltdoc="x">History</a> in the <a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?tag=%28mod-path._.%27pprint.%27%29&amp;version=8.6" class="RktModLink Sq" data-pltdoc="x"><span class="RktSym">pprint</span></a> library.</p><p>Two recent algorithms are proposed in <span class="Autobibref"><a href="#%28autobib._.Jean-.Philippe._.Bernardy.A._.Pretty._.But._.Not._.Greedy._.Printer2017https~3a%2F%2Fjyp..github..io%2Fpdf%2F.Prettiest..pdf%29" class="AutobibLink" data-pltdoc="x">Bernardy</a>&nbsp;(<a href="#%28autobib._.Jean-.Philippe._.Bernardy.A._.Pretty._.But._.Not._.Greedy._.Printer2017https~3a%2F%2Fjyp..github..io%2Fpdf%2F.Prettiest..pdf%29" class="AutobibLink" data-pltdoc="x">2017</a>)</span> and <span class="Autobibref"><a href="#%28autobib._.Anton._.Podkopaev._and._.Dmitri._.Boulytchev.Polynomial-.Time._.Optimal._.Pretty-.Printing._.Combinators._with._.Choice2014https~3a%2F%2Foops..math..spbu..ru%2Fpapers%2Fprinter-combinators..pdf%29" class="AutobibLink" data-pltdoc="x">Podkopaev and Boulytchev</a>&nbsp;(<a href="#%28autobib._.Anton._.Podkopaev._and._.Dmitri._.Boulytchev.Polynomial-.Time._.Optimal._.Pretty-.Printing._.Combinators._with._.Choice2014https~3a%2F%2Foops..math..spbu..ru%2Fpapers%2Fprinter-combinators..pdf%29" class="AutobibLink" data-pltdoc="x">2014</a>)</span>, which are more expressive and optimal at the cost of being less efficient, compared to other greedy pretty printers.
The time complexity of the algorithm in <span class="Autobibref"><a href="#%28autobib._.Jean-.Philippe._.Bernardy.A._.Pretty._.But._.Not._.Greedy._.Printer2017https~3a%2F%2Fjyp..github..io%2Fpdf%2F.Prettiest..pdf%29" class="AutobibLink" data-pltdoc="x">Bernardy</a>&nbsp;(<a href="#%28autobib._.Jean-.Philippe._.Bernardy.A._.Pretty._.But._.Not._.Greedy._.Printer2017https~3a%2F%2Fjyp..github..io%2Fpdf%2F.Prettiest..pdf%29" class="AutobibLink" data-pltdoc="x">2017</a>)</span> is <span style="font-style: italic">O</span>(<span style="font-style: italic">n W</span><span style="vertical-align: super; font-size: 80%"><span style="font-style: italic"></span>4<span style="font-style: italic"></span></span><span style="font-style: italic"> log W</span>)<span style="font-style: italic"></span>, where <span style="font-style: italic">n</span> is the <a href="#%28tech._tree._size%29" class="techoutside" data-pltdoc="x"><span class="techinside">tree size</span></a> and <span style="font-style: italic">W</span> is the page width (when using an efficient Pareto frontier computation), though in practice it is fairly fast.
Similarly, the time complexity of the algorithm in <span class="Autobibref"><a href="#%28autobib._.Anton._.Podkopaev._and._.Dmitri._.Boulytchev.Polynomial-.Time._.Optimal._.Pretty-.Printing._.Combinators._with._.Choice2014https~3a%2F%2Foops..math..spbu..ru%2Fpapers%2Fprinter-combinators..pdf%29" class="AutobibLink" data-pltdoc="x">Podkopaev and Boulytchev</a>&nbsp;(<a href="#%28autobib._.Anton._.Podkopaev._and._.Dmitri._.Boulytchev.Polynomial-.Time._.Optimal._.Pretty-.Printing._.Combinators._with._.Choice2014https~3a%2F%2Foops..math..spbu..ru%2Fpapers%2Fprinter-combinators..pdf%29" class="AutobibLink" data-pltdoc="x">2014</a>)</span> is <span style="font-style: italic">O</span>(<span style="font-style: italic">n W</span><span style="vertical-align: super; font-size: 80%"><span style="font-style: italic"></span>4<span style="font-style: italic"></span></span><span style="font-style: italic"></span>)<span style="font-style: italic"></span>, where <span style="font-style: italic">n</span> is the <a href="#%28tech._tree._size%29" class="techoutside" data-pltdoc="x"><span class="techinside">tree size</span></a> and <span style="font-style: italic">W</span> is the page width, though in practice it is fairly slow.</p><p>This library implements a novel algorithm inspired by <span class="Autobibref"><a href="#%28autobib._.Jean-.Philippe._.Bernardy.A._.Pretty._.But._.Not._.Greedy._.Printer2017https~3a%2F%2Fjyp..github..io%2Fpdf%2F.Prettiest..pdf%29" class="AutobibLink" data-pltdoc="x">Bernardy</a>&nbsp;(<a href="#%28autobib._.Jean-.Philippe._.Bernardy.A._.Pretty._.But._.Not._.Greedy._.Printer2017https~3a%2F%2Fjyp..github..io%2Fpdf%2F.Prettiest..pdf%29" class="AutobibLink" data-pltdoc="x">2017</a>)</span> and <span class="Autobibref"><a href="#%28autobib._.Anton._.Podkopaev._and._.Dmitri._.Boulytchev.Polynomial-.Time._.Optimal._.Pretty-.Printing._.Combinators._with._.Choice2014https~3a%2F%2Foops..math..spbu..ru%2Fpapers%2Fprinter-combinators..pdf%29" class="AutobibLink" data-pltdoc="x">Podkopaev and Boulytchev</a>&nbsp;(<a href="#%28autobib._.Anton._.Podkopaev._and._.Dmitri._.Boulytchev.Polynomial-.Time._.Optimal._.Pretty-.Printing._.Combinators._with._.Choice2014https~3a%2F%2Foops..math..spbu..ru%2Fpapers%2Fprinter-combinators..pdf%29" class="AutobibLink" data-pltdoc="x">2014</a>)</span>. It uses various techniques to improve the time complexity to <span style="font-style: italic">O</span>(<span style="font-style: italic">n W</span><span style="vertical-align: super; font-size: 80%"><span style="font-style: italic"></span>3<span style="font-style: italic"></span></span><span style="font-style: italic"> log W</span>)<span style="font-style: italic"></span> where <span style="font-style: italic">n</span> is the <a href="#%28tech._dag._size%29" class="techoutside" data-pltdoc="x"><span class="techinside">DAG size</span></a>, while making it fast in practice.
It also adds features like <span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._fail%29%29" class="RktValLink" data-pltdoc="x">fail</a></span> and <span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._annotate%29%29" class="RktValLink" data-pltdoc="x">annotate</a></span>, which are basis to implement constructs like <span class="RktSym"><a href="#%28def._%28%28lib._pprint-compact%2Fmain..rkt%29._flat%29%29" class="RktValLink" data-pltdoc="x">flat</a></span> efficiently.</p><h3 x-source-module="(lib &quot;pprint-compact/scribblings/pprint-compact.scrbl&quot;)" x-source-pkg="pprint-compact" x-part-tag="&quot;Acknowledgment&quot;">9<tt>&nbsp;</tt><a name="(part._.Acknowledgment)"></a>Acknowledgment</h3><p>I would like to give special thanks to <a href="https://justinpombrio.net/">Justin Pombrio</a> for pointing me to <span class="Autobibref"><a href="#%28autobib._.Jean-.Philippe._.Bernardy.A._.Pretty._.But._.Not._.Greedy._.Printer2017https~3a%2F%2Fjyp..github..io%2Fpdf%2F.Prettiest..pdf%29" class="AutobibLink" data-pltdoc="x">Bernardy</a>&nbsp;(<a href="#%28autobib._.Jean-.Philippe._.Bernardy.A._.Pretty._.But._.Not._.Greedy._.Printer2017https~3a%2F%2Fjyp..github..io%2Fpdf%2F.Prettiest..pdf%29" class="AutobibLink" data-pltdoc="x">2017</a>)</span> and countless advice.</p><h3 x-source-module="(lib &quot;pprint-compact/scribblings/pprint-compact.scrbl&quot;)" x-source-pkg="pprint-compact" x-part-tag="&quot;doc-bibliography&quot;"><a name="(part._doc-bibliography)"></a>Bibliography</h3><p><table cellspacing="0" cellpadding="0" class="AutoBibliography"><tr><td><p><a name="(autobib._.Jean-.Philippe._.Bernardy.A._.Pretty._.But._.Not._.Greedy._.Printer2017https~3a//jyp..github..io/pdf/.Prettiest..pdf)"></a><span class="Autobibentry">Jean-Philippe Bernardy. A Pretty But Not Greedy Printer. 2017. <a href="https://jyp.github.io/pdf/Prettiest.pdf"><span class="url">https://jyp.github.io/pdf/Prettiest.pdf</span></a></span></p></td></tr><tr><td><p><a name="(autobib._.Anton._.Podkopaev._and._.Dmitri._.Boulytchev.Polynomial-.Time._.Optimal._.Pretty-.Printing._.Combinators._with._.Choice2014https~3a//oops..math..spbu..ru/papers/printer-combinators..pdf)"></a><span class="Autobibentry">Anton Podkopaev and Dmitri Boulytchev. Polynomial-Time Optimal Pretty-Printing Combinators with Choice. 2014. <a href="https://oops.math.spbu.ru/papers/printer-combinators.pdf"><span class="url">https://oops.math.spbu.ru/papers/printer-combinators.pdf</span></a></span></p></td></tr></table></p><div class="navsetbottom"><span class="navleft"><form class="searchform"><input class="searchbox" id="searchbox" type="text" tabindex="1" placeholder="...search manuals..." title="Enter a search string to search the manuals" onkeypress="return DoSearchKey(event, this, &quot;8.6&quot;, &quot;../&quot;);"/></form>&nbsp;&nbsp;<a href="../index-2.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;8.6&quot;);">top</a><span class="tocsettoggle">&nbsp;&nbsp;<a href="javascript:void(0);" title="show/hide table of contents" onclick="TocsetToggle();">contents</a></span></span><span class="navright">&nbsp;&nbsp;<span class="nonavigation">&larr; prev</span>&nbsp;&nbsp;<a href="../index-2.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;8.6&quot;);">up</a>&nbsp;&nbsp;<span class="nonavigation">next &rarr;</span></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body>
<!-- Mirrored from docs.racket-lang.org/pprint-compact/index.html by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 07 Sep 2022 03:04:43 GMT -->
</html>