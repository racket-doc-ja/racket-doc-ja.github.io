<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- Mirrored from docs.racket-lang.org/pkg-build/Package-Building_API.html by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 07 Sep 2022 03:29:42 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><meta name="viewport" content="width=device-width, initial-scale=0.8"/><title>5&nbsp;Package-Building API</title><link rel="stylesheet" type="text/css" href="../scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="../racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-style.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../doc-site.css" title="default"/><script type="text/javascript" src="../scribble-common.js"></script><script type="text/javascript" src="../manual-racket.js"></script><script type="text/javascript" src="../manual-racket.js"></script><script type="text/javascript" src="../doc-site.js"></script><script type="text/javascript" src="../local-redirect/local-redirect.js"></script><script type="text/javascript" src="../local-redirect/local-user-redirect.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="doc-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9660;</a></td><td></td><td><a href="index.html" class="tocviewlink" data-pltdoc="x">Pkg-<wbr></wbr>Build:<span class="mywbr"> &nbsp;</span> Building and Testing All Racket Packages</a></td></tr></table></div><div class="tocviewsublistonly" style="display: block;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="Building_Packages_with_Docker.html" class="tocviewlink" data-pltdoc="x">Building Packages with Docker</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="Building_Packages_with_VirtualBox.html" class="tocviewlink" data-pltdoc="x">Building Packages with Virtual<span class="mywbr"> &nbsp;</span>Box</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="starting-image.html" class="tocviewlink" data-pltdoc="x">Starting Image Requirements</a></td></tr><tr><td align="right">4&nbsp;</td><td><a href="work-dir.html" class="tocviewlink" data-pltdoc="x">Work Directory Content</a></td></tr><tr><td align="right">5&nbsp;</td><td><a href="#" class="tocviewselflink" data-pltdoc="x">Package-<wbr></wbr>Building API</a></td></tr></table></div></div></div><div class="tocsub"><div class="tocsubtitle">On this page:</div><table class="tocsublist" cellspacing="0"><tr><td><a href="#%28def._%28%28lib._pkg-build%2Fmain..rkt%29._build-pkgs%29%29" class="tocsublink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">build-<wbr></wbr>pkgs</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._pkg-build%2Fmain..rkt%29._vm~3f%29%29" class="tocsublink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">vm?</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._pkg-build%2Fmain..rkt%29._docker-vm%29%29" class="tocsublink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">docker-<wbr></wbr>vm</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._pkg-build%2Fmain..rkt%29._vbox-vm%29%29" class="tocsublink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">vbox-<wbr></wbr>vm</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._pkg-build%2Fmain..rkt%29._steps-in%29%29" class="tocsublink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">steps-<wbr></wbr>in</span></span></a></td></tr></table></div></div><div class="maincolumn"><div class="main"><div class="navsettop"><span class="navleft"><form class="searchform"><input class="searchbox" id="searchbox" type="text" tabindex="1" placeholder="...search manuals..." title="Enter a search string to search the manuals" onkeypress="return DoSearchKey(event, this, &quot;8.6&quot;, &quot;../&quot;);"/></form>&nbsp;&nbsp;<a href="../index-2.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;8.6&quot;);">top</a><span class="tocsettoggle">&nbsp;&nbsp;<a href="javascript:void(0);" title="show/hide table of contents" onclick="TocsetToggle();">contents</a></span></span><span class="navright">&nbsp;&nbsp;<a href="work-dir.html" title="backward to &quot;4 Work Directory Content&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="index.html" title="up to &quot;Pkg-Build: Building and Testing All Racket Packages&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<span class="nonavigation">next &rarr;</span></span>&nbsp;</div><h3 x-source-module="(lib &quot;pkg-build/pkg-build.scrbl&quot;)" x-source-pkg="pkg-build" x-part-tag="&quot;Package-Building_API&quot;">5<tt>&nbsp;</tt><a name="(part._.Package-.Building_.A.P.I)"></a><a name="(mod-path._pkg-build)"></a>Package-Building API</h3><p><table cellspacing="0" cellpadding="0" class="defmodule"><tr><td align="left"><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._require%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">require</a></span><span class="stt"> </span><a href="#" class="RktModLink" data-pltdoc="x"><span class="RktSym">pkg-build</span></a><span class="RktPn">)</span></td><td align="right"><span class="RpackageSpec"><span class="Smaller">&nbsp;package:</span> <a href="https://pkgs.racket-lang.org/package/pkg-build" title="Install this package using `raco pkg install pkg-build`"><span class="stt">pkg-build</span></a></span></td></tr></table></p><p>The <span class="RktSym"><a href="#%28def._%28%28lib._pkg-build%2Fmain..rkt%29._build-pkgs%29%29" class="RktValLink" data-pltdoc="x">build-pkgs</a></span> function drive a package build, but it relies
on a set of <a name="(tech._vm)"></a><span style="font-style: italic">VMs</span> that are created by <span class="RktSym"><a href="#%28def._%28%28lib._pkg-build%2Fmain..rkt%29._docker-vm%29%29" class="RktValLink" data-pltdoc="x">docker-vm</a></span> or
<span class="RktSym"><a href="#%28def._%28%28lib._pkg-build%2Fmain..rkt%29._vbox-vm%29%29" class="RktValLink" data-pltdoc="x">vbox-vm</a></span>.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><table cellspacing="0" cellpadding="0" class="prototype RForeground"><tr><td valign="top"><span class="RktPn">(</span><a name="(def._((lib._pkg-build/main..rkt)._build-pkgs))"></a><span title="Provided from: pkg-build | Package: pkg-build"><span class="RktSym"><a href="#%28def._%28%28lib._pkg-build%2Fmain..rkt%29._build-pkgs%29%29" class="RktValDef RktValLink" data-pltdoc="x">build-pkgs</a></span></span></td><td valign="top"><span class="hspace">&nbsp;</span><span class="RktOpt">[</span></td><td valign="top"><span class="RktPn">#:work-dir</span><span class="hspace">&nbsp;</span><span class="RktVar">work-dir</span><span class="RktOpt">]</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:snapshot-url</span><span class="hspace">&nbsp;</span><span class="RktVar">snapshot-url</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span><span class="RktOpt">[</span></td><td valign="top"><span class="RktPn">#:installer-name</span><span class="hspace">&nbsp;</span><span class="RktVar">installer-name</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:installer-platform-name</span><span class="hspace">&nbsp;</span><span class="RktVar">installer-platform-name</span><span class="RktOpt">]</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:vms</span><span class="hspace">&nbsp;</span><span class="RktVar">vms</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span><span class="RktOpt">[</span></td><td valign="top"><span class="RktPn">#:pkg-catalogs</span><span class="hspace">&nbsp;</span><span class="RktVar">pkg-catalogs</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:pkgs-for-version</span><span class="hspace">&nbsp;</span><span class="RktVar">pkgs-for-version</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:extra-packages</span><span class="hspace">&nbsp;</span><span class="RktVar">extra-packages</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:only-packages</span><span class="hspace">&nbsp;</span><span class="RktVar">only-packages</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:only-sys+subpath</span><span class="hspace">&nbsp;</span><span class="RktVar">only-sys+subpath</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:compile-any?</span><span class="hspace">&nbsp;</span><span class="RktVar">compile-any?</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:steps</span><span class="hspace">&nbsp;</span><span class="RktVar">steps</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:timeout</span><span class="hspace">&nbsp;</span><span class="RktVar">timeout</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:test-timeout</span><span class="hspace">&nbsp;</span><span class="RktVar">test-timeout</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:jobs</span><span class="hspace">&nbsp;</span><span class="RktVar">jobs</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:on-empty-pkg-updates</span><span class="hspace">&nbsp;</span><span class="RktVar">on-empty-pkg-updates</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:install-doc-list-file</span><span class="hspace">&nbsp;</span><span class="RktVar">install-doc-list-file</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:run-tests?</span><span class="hspace">&nbsp;</span><span class="RktVar">run-tests?</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:built-at-site?</span><span class="hspace">&nbsp;</span><span class="RktVar">built-at-site?</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:site-url</span><span class="hspace">&nbsp;</span><span class="RktVar">site-url</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:site-starting-point</span><span class="hspace">&nbsp;</span><span class="RktVar">site-starting-point</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:compress-site?</span><span class="hspace">&nbsp;</span><span class="RktVar">compress-site?</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:summary-omit-pkgs</span><span class="hspace">&nbsp;</span><span class="RktVar">summary-omit-pkgs</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:max-build-together</span><span class="hspace">&nbsp;</span><span class="RktVar">max-build-together</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:server-port</span><span class="hspace">&nbsp;</span><span class="RktVar">server-port</span><span class="RktOpt">]</span><span class="RktPn">)</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=void.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._void%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">void?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">work-dir</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=Manipulating_Paths.html%23%2528def._%2528%2528lib._racket%252Fprivate%252Fmisc..rkt%2529._path-string%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">path-string?</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=Filesystem.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._current-directory%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">current-directory</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">snapshot-url</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">string?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">installer-name</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">or/c</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">string?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#f</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">installer-platform-name</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">or/c</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">string?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#f</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">vms</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">listof</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._pkg-build%2Fmain..rkt%29._vm~3f%29%29" class="RktValLink" data-pltdoc="x">vm?</a></span><span class="RktPn">)</span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="argcontract"><tr><td valign="top"><span class="hspace">&nbsp;&nbsp;</span></td><td valign="top"><span class="RktVar">pkg-catalogs</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">:</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">(</span><span class="RktSym">listof</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">string?</a></span><span class="RktPn">)</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">=</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._list%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">list</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"https://pkgs.racket-lang.org/"</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">pkgs-for-version</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">string?</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=runtime.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._version%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">version</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">extra-packages</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">listof</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">string?</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._null%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">null</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">only-packages</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">or/c</span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">listof</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">string?</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#f</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">only-sys+subpath</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">or/c</span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._cons%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">cons</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">string?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">string?</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._null%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">null</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">compile-any?</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">any/c</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#f</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">steps</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">listof</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=symbols.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._symbol%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">symbol?</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._pkg-build%2Fmain..rkt%29._steps-in%29%29" class="RktValLink" data-pltdoc="x">steps-in</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">download</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">summary</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">timeout</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=number-types.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._real%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">real?</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">600</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">test-timeout</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">or/c</span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=number-types.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._real%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">real?</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#f</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">jobs</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">or/c</span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=number-types.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._exact-positive-integer%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">exact-positive-integer?</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#f</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">on-empty-pkg-updates</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-&gt;</span></span><span class="hspace">&nbsp;</span><span class="RktSym">any</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=void.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._void%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">void</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">install-doc-list-file</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">or/c</span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=Manipulating_Paths.html%23%2528def._%2528%2528lib._racket%252Fprivate%252Fmisc..rkt%2529._path-string%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">path-string?</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#f</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">run-tests?</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">any/c</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktSym">t</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">built-at-site?</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">any/c</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#f</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">site-url</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">or/c</span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">string?</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#f</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">site-starting-point</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">or/c</span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">string?</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#f</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">compress-site?</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">any/c</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#t</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">summary-omit-pkgs</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">listof</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">string?</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._null%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">null</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">max-build-together</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=number-types.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._exact-positive-integer%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">exact-positive-integer?</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">1</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">server-port</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">or/c</span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">integer-in</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktVal">65535</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">18333</span></td></tr></table></blockquote></div><div class="SIntrapara">Builds packages by
</div><div class="SIntrapara"><ul><li><p>using <span class="RktVar">work-dir</span> as the <a href="work-dir.html" data-pltdoc="x">work directory</a>;</p></li><li><p>downloading initial packages from <span class="RktVar">snapshot-url</span>,
which can be something like <span class="RktVal">"https://mirror.racket-lang.org/releases/7.6/"</span>;</p></li><li><p>using either <span class="RktVar">installer-name</span> or
<span class="RktVar">installer-platform-name</span> (exactly one of them must be supplied as non-<span class="RktVal">#f</span>)
to locate an installer at <span class="RktVar">snapshot-url</span>, where <span class="RktVar">installer-name</span>
is something like <span class="RktVal">"racket-x86_64-linux-natipkg.tgz"</span>, or <span class="RktVar">installer-platform-name</span> is something like
<span class="RktVal">"{1} Racket | {3} Linux | {3} x64_64 (64-bit), natipkg; built on Debian 8 (Jessie)"</span>;
in the latter case, the name should be one of the entries in <span class="stt">"installers/table.rktd"</span> relative
to <span class="RktVar">snapshot-url</span>; in both cases, it should be a <span class="stt">natipkg</span> option consistent with
the <a href="#%28tech._vm%29" class="techoutside" data-pltdoc="x"><span class="techinside">VMs</span></a> specified by <span class="RktVar">vms</span>;
if a minimal installer is used and package tests will be run, include
<span class="RktVal">"compiler-lib"</span> in <span class="RktVar">extra-packages</span>;</p></li><li><p>running the <a href="#%28tech._vm%29" class="techoutside" data-pltdoc="x"><span class="techinside">VMs</span></a> machines specified by <span class="RktVar">vms</span>, which is
a list of results from <span class="RktSym"><a href="#%28def._%28%28lib._pkg-build%2Fmain..rkt%29._docker-vm%29%29" class="RktValLink" data-pltdoc="x">docker-vm</a></span> and/or
<span class="RktSym"><a href="#%28def._%28%28lib._pkg-build%2Fmain..rkt%29._vbox-vm%29%29" class="RktValLink" data-pltdoc="x">vbox-vm</a></span>;</p></li><li><p>installing additional packages from <span class="RktVar">pkg-catalogs</span>
individually in <a href="#%28tech._vm%29" class="techoutside" data-pltdoc="x"><span class="techinside">VMs</span></a>.</p></li></ul></div></p><p>Additional configuration options:</p><ul><li><p><span class="RktVar">pkgs-for-version</span> &#8212;<wbr></wbr> The Racket version to use in
 queries to archived catalogs. This version should be
 consistent with <span class="RktVar">snapshot-url</span>.</p></li><li><p><span class="RktVar">extra-packages</span> &#8212;<wbr></wbr> Extra packages to install within an
installation so that they&rsquo;re treated like packages that are included in
the installer. These should be built packages (normally from
the snapshot site), or else the generated built packages will
not work right (especially when using multiple <a href="#%28tech._vm%29" class="techoutside" data-pltdoc="x"><span class="techinside">VMs</span></a>).</p></li><li><p><span class="RktVar">only-packages</span> &#8212;<wbr></wbr> When not <span class="RktVal">#f</span>, specifies a
subset of packages available from <span class="RktVar">pkg-catalogs</span> to be
built and recorded in a catalog. Any dependencies of a
specified package are also included.</p></li><li><p><span class="RktVar">only-sys+subpath</span> &#8212;<wbr></wbr> When not <span class="RktVal">#f</span> and when
<span class="RktVar">only-packages</span> is not <span class="RktVal">#f</span>, considers only
dependencies for the indicated specific platform. The platform is described
by <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._cons%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">cons</a></span>ing a symbol matching the result of
<span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=runtime.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._system-type%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">system-type</a></span><span class="RktPn">)</span> to a string matching the result of
<span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=runtime.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._system-library-subpath%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">system-library-subpath</a></span><span class="stt"> </span><span class="RktVal">#f</span><span class="RktPn">)</span>.</p></li><li><p><span class="RktVar">compile-any?</span> &#8212;<wbr></wbr> When not <span class="RktVal">#f</span>,
compiles bytecode in built packages to machine-independent
form. The installer specified by <span class="RktVar">installer-name</span> or
<span class="RktVar">installer-platform-name</span> and the packages provided by
<span class="RktVar">pkg-catalogs</span> must also have machine-independent
bytecode.</p></li><li><p><span class="RktVar">steps</span> &#8212;<wbr></wbr> Steps to perform the package-build process.
The possible steps, in order, are</p><ul><li><p><span class="RktVal">'</span><span class="RktVal">download</span>: download installer from snapshot
site.</p></li><li><p><span class="RktVal">'</span><span class="RktVal">archive</span>: archive catalogs byt downloading
all packages to the work directory.</p></li><li><p><span class="RktVal">'</span><span class="RktVal">install</span>: run the installer to set up each <a href="#%28tech._vm%29" class="techoutside" data-pltdoc="x"><span class="techinside">VM</span></a>.</p></li><li><p><span class="RktVal">'</span><span class="RktVal">build</span>: build packages that have changed.</p></li><li><p><span class="RktVal">'</span><span class="RktVal">docs</span>: extract and assemble documentation.</p></li><li><p><span class="RktVal">'</span><span class="RktVal">summary</span>: summarize the results as a web page.</p></li><li><p><span class="RktVal">'</span><span class="RktVal">site</span>: assemble web-friendly pieces to an archive.</p></li></ul><p>You can skip steps at the beginning if you know that they&rsquo;re already
done, and you can skip tests at the end if you don&rsquo;t want them,
but any included steps must be contiguous and in order.</p></li><li><p><span class="RktVar">timeout</span> &#8212;<wbr></wbr> Timeout in seconds for any one package
or step.</p></li><li><p><span class="RktVar">test-timeout</span> &#8212;<wbr></wbr> If not <span class="RktVal">#f</span>, supplied with
<span class="nobreak"><span class="stt">--timeout</span></span> to <span class="stt">raco test</span> to configure the default
testing timeout.</p></li><li><p><span class="RktVar">jobs</span> &#8212;<wbr></wbr> If not <span class="RktVal">#f</span>, supplied with
<span class="nobreak"><span class="stt">--jobs</span></span> to <span class="stt">raco pkg install</span>, <span class="stt">raco setup</span>,
and/or <span class="stt">raco test</span> to configure the number of concurrent
jobs that run.</p></li><li><p><span class="RktVar">on-empty-pkg-updates</span> &#8212;<wbr></wbr> A thunk that is called in the
case that no packages need to be rebuilt.</p></li><li><p><span class="RktVar">install-doc-list-file</span> &#8212;<wbr></wbr> If not <span class="RktVal">#f</span>, save a
list of files in the original installation&rsquo;s <span class="stt">"doc"</span>
directory to the specified file as part of the
<span class="RktVal">'</span><span class="RktVal">install</span> step.</p></li><li><p><span class="RktVar">run-tests?</span> &#8212;<wbr></wbr> Determines whether each package&rsquo;s
tests are run after building the package.</p></li><li><p><span class="RktVar">built-at-site?</span> &#8212;<wbr></wbr> Determines whether to include a
catalog of built packages in an assembled site.</p></li><li><p><span class="RktVar">site-url</span> &#8212;<wbr></wbr> The URL where the assemble site will be
made available (for, e.g., showing help about the catalog).</p></li><li><p><span class="RktVar">site-starting-point</span> &#8212;<wbr></wbr> Text for help to describes
the starting point, where <span class="RktVal">#f</span> means &ldquo;the current
release.&rdquo;</p></li><li><p><span class="RktVar">compress-site?</span> &#8212;<wbr></wbr> Selects whether the
<span class="RktVal">'</span><span class="RktVal">site</span> step produces <span class="stt">"site.tgz"</span> (if true) or
<span class="stt">"site.tar"</span> (otherwise).</p></li><li><p><span class="RktVar">summary-omit-pkgs</span> &#8212;<wbr></wbr> A list of packages to omit from
the build summary.</p></li><li><p><span class="RktVar">max-build-together</span> &#8212;<wbr></wbr> Number of packages to build
at once in a single <a href="#%28tech._vm%29" class="techoutside" data-pltdoc="x"><span class="techinside">VM</span></a>. Building more than one package
at a time can be faster, but it is not recommended: building
multiple packages risks success when a build should have
failed due to missing dependencies, and it risks corruption
due to broken or nefarious packages.</p></li><li><p><span class="RktVar">server-port</span> &#8212;<wbr></wbr> A TCP port to use for serving
packages from the build machine to VirtualBox <a href="#%28tech._vm%29" class="techoutside" data-pltdoc="x"><span class="techinside">VMs</span></a>.
This server is not started if <span class="RktVar">vms</span> contains only
Docker <a href="#%28tech._vm%29" class="techoutside" data-pltdoc="x"><span class="techinside">VMs</span></a>.</p></li></ul><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._pkg-build/main..rkt)._vm~3f))"></a><span title="Provided from: pkg-build | Package: pkg-build"><span class="RktSym"><a href="#%28def._%28%28lib._pkg-build%2Fmain..rkt%29._vm~3f%29%29" class="RktValDef RktValLink" data-pltdoc="x">vm?</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">v</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=booleans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._boolean%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">boolean?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">v</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">any/c</span></td></tr></table></blockquote></div><div class="SIntrapara">Recognizes a <a href="#%28tech._vm%29" class="techoutside" data-pltdoc="x"><span class="techinside">VM</span></a> crreated by <span class="RktSym"><a href="#%28def._%28%28lib._pkg-build%2Fmain..rkt%29._docker-vm%29%29" class="RktValLink" data-pltdoc="x">docker-vm</a></span> or <span class="RktSym"><a href="#%28def._%28%28lib._pkg-build%2Fmain..rkt%29._vbox-vm%29%29" class="RktValLink" data-pltdoc="x">vbox-vm</a></span>.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><table cellspacing="0" cellpadding="0" class="prototype RForeground"><tr><td valign="top"><span class="RktPn">(</span><a name="(def._((lib._pkg-build/main..rkt)._docker-vm))"></a><span title="Provided from: pkg-build | Package: pkg-build"><span class="RktSym"><a href="#%28def._%28%28lib._pkg-build%2Fmain..rkt%29._docker-vm%29%29" class="RktValDef RktValLink" data-pltdoc="x">docker-vm</a></span></span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:name</span><span class="hspace">&nbsp;</span><span class="RktVar">name</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:from-image</span><span class="hspace">&nbsp;</span><span class="RktVar">from-image</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span><span class="RktOpt">[</span></td><td valign="top"><span class="RktPn">#:dir</span><span class="hspace">&nbsp;</span><span class="RktVar">dir</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:env</span><span class="hspace">&nbsp;</span><span class="RktVar">env</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:shell</span><span class="hspace">&nbsp;</span><span class="RktVar">shell</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:memory-mb</span><span class="hspace">&nbsp;</span><span class="RktVar">memory-mb</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:swap-mb</span><span class="hspace">&nbsp;</span><span class="RktVar">swap-mb</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:minimal-variant</span><span class="hspace">&nbsp;</span><span class="RktVar">minimal-variant</span><span class="RktOpt">]</span><span class="RktPn">)</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">&rarr;</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktSym"><a href="#%28def._%28%28lib._pkg-build%2Fmain..rkt%29._vm~3f%29%29" class="RktValLink" data-pltdoc="x">vm?</a></span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">name</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">string?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">from-image</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">string?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">dir</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">string?</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">"/home/root/"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">env</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">listof</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cons/c</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">string?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">string?</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._null%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">null</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">shell</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">listof</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">string?</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">"/bin/sh"</span><span class="hspace">&nbsp;</span><span class="RktVal">"-c"</span><span class="RktVal">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">memory-mb</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">or/c</span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=number-types.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._exact-positive-integer%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">exact-positive-integer?</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#f</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">swap-mb</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">or/c</span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=number-types.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._exact-positive-integer%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">exact-positive-integer?</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#f</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">minimal-variant</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">or/c</span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._pkg-build%2Fmain..rkt%29._vm~3f%29%29" class="RktValLink" data-pltdoc="x">vm?</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#f</span></td></tr></table></blockquote></div><div class="SIntrapara">Creates a <a href="#%28tech._vm%29" class="techoutside" data-pltdoc="x"><span class="techinside">VM</span></a> that specifies a Docker image and container. The
given <span class="RktVar">name</span> will be used to name a new image (replacing any
existing <span class="RktVar">name</span> image) that is built starting with
<span class="RktVar">from-image</span> and that holds the Racket installation.
<span class="refelem"><span class="refcolumn"><span class="refcontent">At the time of writing, <span class="RktVal">"racket/pkg-build:pkg-build-deps"</span>
and/or <span class="RktVal">"racket/pkg-build:pkg-build-deps-min"</span> is suitable as
<span class="RktVar">from-image</span>.</span></span></span> The given <span class="RktVar">name</span> is also used for a
container that is an instance of the image; the container is created
fresh (replacing any existing <span class="RktVar">name</span> container) for each
package to build.</div></p><p>The <span class="RktVar">dir</span> argument specifies a working directory within the
Docker container; it must be a <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=Manipulating_Paths.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._complete-path%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">complete-path?</a></span>, when viewed
as a unix path, i.e.,
<span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=Manipulating_Paths.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._complete-path%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">complete-path?</a></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=Manipulating_Paths.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._bytes-%7E3epath%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">bytes-&gt;path</a></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=bytestrings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string-%7E3ebytes%252Futf-8%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">string-&gt;bytes/utf-8</a></span><span class="stt"> </span><span class="RktVar">dir</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktVal">'</span><span class="RktVal">unix</span><span class="RktPn">)</span><span class="RktPn">)</span>
must return <span class="RktVal">#t</span>.</p><p>The <span class="RktVar">env</span> argument specifies environment variable settings that
prefix every command.</p><p>The <span class="RktVar">shell</span> argument determines the shell command that is used
to run shell-command strings in the container.</p><p>The <span class="RktVar">memory-mb</span> and <span class="RktVar">swap-mb</span> arguments set memory-use
constraints on the created container. The <span class="RktVar">memory-mb</span> value
corresponds to &ldquo;real&rdquo; memory in megabytes, and <span class="RktVar">swap-mb</span> is
additional swap space. If either is non-<span class="RktVal">#f</span>, the same value is
used in place of a <span class="RktVal">#f</span> for the other. If both are <span class="RktVal">#f</span>,
no specific limit is imposed.</p><p>The <span class="RktVar">minimal-variant</span> argument, if not <span class="RktVal">#f</span>, specifies a
<a href="#%28tech._vm%29" class="techoutside" data-pltdoc="x"><span class="techinside">VM</span></a> to try before this one. If installation fails with the
<span class="RktVar">minimal-variant</span> <a href="#%28tech._vm%29" class="techoutside" data-pltdoc="x"><span class="techinside">VM</span></a>, it is tried again with this one.
Tests run in this <a href="#%28tech._vm%29" class="techoutside" data-pltdoc="x"><span class="techinside">VM</span></a>, however, instead of
<span class="RktVar">minimal-variant</span>.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><table cellspacing="0" cellpadding="0" class="prototype RForeground"><tr><td valign="top"><span class="RktPn">(</span><a name="(def._((lib._pkg-build/main..rkt)._vbox-vm))"></a><span title="Provided from: pkg-build | Package: pkg-build"><span class="RktSym"><a href="#%28def._%28%28lib._pkg-build%2Fmain..rkt%29._vbox-vm%29%29" class="RktValDef RktValLink" data-pltdoc="x">vbox-vm</a></span></span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:name</span><span class="hspace">&nbsp;</span><span class="RktVar">name</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:host</span><span class="hspace">&nbsp;</span><span class="RktVar">host</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span><span class="RktOpt">[</span></td><td valign="top"><span class="RktPn">#:user</span><span class="hspace">&nbsp;</span><span class="RktVar">user</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:ssh-key</span><span class="hspace">&nbsp;</span><span class="RktVar">ssh-key</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:dir</span><span class="hspace">&nbsp;</span><span class="RktVar">dir</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:env</span><span class="hspace">&nbsp;</span><span class="RktVar">env</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:shell</span><span class="hspace">&nbsp;</span><span class="RktVar">shell</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:init-shapshot</span><span class="hspace">&nbsp;</span><span class="RktVar">init-snapshot</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:installed-shapshot</span><span class="hspace">&nbsp;</span><span class="RktVar">installed-snapshot</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:minimal-variant</span><span class="hspace">&nbsp;</span><span class="RktVar">minimal-variant</span><span class="RktOpt">]</span><span class="RktPn">)</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">&rarr;</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktSym"><a href="#%28def._%28%28lib._pkg-build%2Fmain..rkt%29._vm~3f%29%29" class="RktValLink" data-pltdoc="x">vm?</a></span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">name</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">string?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">host</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">string?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">user</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">string?</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">"racket"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">ssh-key</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">or/c</span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=Manipulating_Paths.html%23%2528def._%2528%2528lib._racket%252Fprivate%252Fmisc..rkt%2529._path-string%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">path-string?</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#f</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">dir</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">string?</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">"/home/racket/build-pkgs"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">env</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">listof</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cons/c</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">string?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">string?</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._null%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">null</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">shell</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">listof</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">string?</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">"/bin/sh"</span><span class="hspace">&nbsp;</span><span class="RktVal">"-c"</span><span class="RktVal">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">init-snapshot</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">string?</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">"init"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">installed-snapshot</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">string?</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">"installed"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">minimal-variant</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">or/c</span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._pkg-build%2Fmain..rkt%29._vm~3f%29%29" class="RktValLink" data-pltdoc="x">vm?</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#f</span></td></tr></table></blockquote></div><div class="SIntrapara">Creates a <a href="#%28tech._vm%29" class="techoutside" data-pltdoc="x"><span class="techinside">VM</span></a> that specifies a VirtualBox virtual machine with
the given <span class="RktVar">name</span>. The <span class="RktVar">host</span> string specifies the IP
address of the machine to access it using <span class="stt">ssh</span>, and
<span class="RktVar">user</span> is the user for that <span class="stt">ssh</span>. You must configure the
virtual machine and the host&rsquo;s SSH settings so that <span class="stt">ssh</span> works
without a password. The <span class="RktVar">ssh-key</span> argument can name a file
containing private key to use for <span class="stt">ssh</span> as <span class="RktVar">user</span>.</div></p><p>The <span class="RktVar">dir</span> argument specifies a working directory
within the virtual machine, with the same checks as
<span class="RktSym"><a href="#%28def._%28%28lib._pkg-build%2Fmain..rkt%29._docker-vm%29%29" class="RktValLink" data-pltdoc="x">docker-vm</a></span>&rsquo;s <span class="RktVar">dir</span> argument.</p><p>The <span class="RktVar">env</span> argument specifies environment variable settings that
prefix every command.</p><p>The <span class="RktVar">shell</span> argument determines the shell command that is used
to run shell-command strings in the virtual machine.</p><p>The <span class="RktVar">init-snapshot</span> string names a snapshot that exists as the
starting point in the virtual machine, so that it can be reset to a
state before any Racket installation. You must configure the virtual
machine to have this snapshot.</p><p>The <span class="RktVar">installed-snapshot</span> string names a snapshot that will be
created by <span class="RktSym"><a href="#%28def._%28%28lib._pkg-build%2Fmain..rkt%29._build-pkgs%29%29" class="RktValLink" data-pltdoc="x">build-pkgs</a></span> after it installs Racket in the virtual
machine. If a snapshot using this name already exists, it may be
replaced.</p><p>The <span class="RktVar">minimal-variant</span> argument, if not <span class="RktVal">#f</span>, specifies a
<a href="#%28tech._vm%29" class="techoutside" data-pltdoc="x"><span class="techinside">VM</span></a> to try before this one. If installation fails with the
<span class="RktVar">minimal-variant</span> <a href="#%28tech._vm%29" class="techoutside" data-pltdoc="x"><span class="techinside">VM</span></a>, it is tried again with this one.
Tests run in this <a href="#%28tech._vm%29" class="techoutside" data-pltdoc="x"><span class="techinside">VM</span></a>, however, instead of
<span class="RktVar">minimal-variant</span>.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._pkg-build/main..rkt)._steps-in))"></a><span title="Provided from: pkg-build | Package: pkg-build"><span class="RktSym"><a href="#%28def._%28%28lib._pkg-build%2Fmain..rkt%29._steps-in%29%29" class="RktValDef RktValLink" data-pltdoc="x">steps-in</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">start</span><span class="hspace">&nbsp;</span><span class="RktVar">end</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">listof</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=symbols.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._symbol%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">symbol?</a></span><span class="RktPn">)</span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">start</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=symbols.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._symbol%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">symbol?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">end</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=symbols.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._symbol%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">symbol?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">A helper to generate a <span class="RktPn">#:steps</span> argument to <span class="RktSym"><a href="#%28def._%28%28lib._pkg-build%2Fmain..rkt%29._build-pkgs%29%29" class="RktValLink" data-pltdoc="x">build-pkgs</a></span>
that has steps <span class="RktVar">start</span> through <span class="RktVar">end</span> inclusive. See
<span class="RktSym"><a href="#%28def._%28%28lib._pkg-build%2Fmain..rkt%29._build-pkgs%29%29" class="RktValLink" data-pltdoc="x">build-pkgs</a></span> for the allowed step symbols.</div></p><div class="navsetbottom"><span class="navleft"><form class="searchform"><input class="searchbox" id="searchbox" type="text" tabindex="1" placeholder="...search manuals..." title="Enter a search string to search the manuals" onkeypress="return DoSearchKey(event, this, &quot;8.6&quot;, &quot;../&quot;);"/></form>&nbsp;&nbsp;<a href="../index-2.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;8.6&quot;);">top</a><span class="tocsettoggle">&nbsp;&nbsp;<a href="javascript:void(0);" title="show/hide table of contents" onclick="TocsetToggle();">contents</a></span></span><span class="navright">&nbsp;&nbsp;<a href="work-dir.html" title="backward to &quot;4 Work Directory Content&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="index.html" title="up to &quot;Pkg-Build: Building and Testing All Racket Packages&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<span class="nonavigation">next &rarr;</span></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body>
<!-- Mirrored from docs.racket-lang.org/pkg-build/Package-Building_API.html by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 07 Sep 2022 03:29:42 GMT -->
</html>