<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- Mirrored from docs.racket-lang.org/pkg-build/work-dir.html by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 07 Sep 2022 03:29:42 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><meta name="viewport" content="width=device-width, initial-scale=0.8"/><title>4&nbsp;Work Directory Content</title><link rel="stylesheet" type="text/css" href="../scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="../racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-style.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../doc-site.css" title="default"/><script type="text/javascript" src="../scribble-common.js"></script><script type="text/javascript" src="../manual-racket.js"></script><script type="text/javascript" src="../manual-racket.js"></script><script type="text/javascript" src="../doc-site.js"></script><script type="text/javascript" src="../local-redirect/local-redirect.js"></script><script type="text/javascript" src="../local-redirect/local-user-redirect.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="doc-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9660;</a></td><td></td><td><a href="index.html" class="tocviewlink" data-pltdoc="x">Pkg-<wbr></wbr>Build:<span class="mywbr"> &nbsp;</span> Building and Testing All Racket Packages</a></td></tr></table></div><div class="tocviewsublistonly" style="display: block;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="Building_Packages_with_Docker.html" class="tocviewlink" data-pltdoc="x">Building Packages with Docker</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="Building_Packages_with_VirtualBox.html" class="tocviewlink" data-pltdoc="x">Building Packages with Virtual<span class="mywbr"> &nbsp;</span>Box</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="starting-image.html" class="tocviewlink" data-pltdoc="x">Starting Image Requirements</a></td></tr><tr><td align="right">4&nbsp;</td><td><a href="#" class="tocviewselflink" data-pltdoc="x">Work Directory Content</a></td></tr><tr><td align="right">5&nbsp;</td><td><a href="Package-Building_API.html" class="tocviewlink" data-pltdoc="x">Package-<wbr></wbr>Building API</a></td></tr></table></div></div></div></div><div class="maincolumn"><div class="main"><div class="navsettop"><span class="navleft"><form class="searchform"><input class="searchbox" id="searchbox" type="text" tabindex="1" placeholder="...search manuals..." title="Enter a search string to search the manuals" onkeypress="return DoSearchKey(event, this, &quot;8.6&quot;, &quot;../&quot;);"/></form>&nbsp;&nbsp;<a href="../index-2.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;8.6&quot;);">top</a><span class="tocsettoggle">&nbsp;&nbsp;<a href="javascript:void(0);" title="show/hide table of contents" onclick="TocsetToggle();">contents</a></span></span><span class="navright">&nbsp;&nbsp;<a href="starting-image.html" title="backward to &quot;3 Starting Image Requirements&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="index.html" title="up to &quot;Pkg-Build: Building and Testing All Racket Packages&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="Package-Building_API.html" title="forward to &quot;5 Package-Building API&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div><h3 x-source-module="(lib &quot;pkg-build/pkg-build.scrbl&quot;)" x-source-pkg="pkg-build" x-part-tag="&quot;work-dir&quot;">4<tt>&nbsp;</tt><a name="(part._work-dir)"></a>Work Directory Content</h3><p>The <span class="RktSym"><a href="Package-Building_API.html#%28def._%28%28lib._pkg-build%2Fmain..rkt%29._build-pkgs%29%29" class="RktValLink" data-pltdoc="x">build-pkgs</a></span> function needs a work directory where it will
assemble packages and results. The generated content of the work
directory can be used as a catalog of built packages plus web-friendly
files that report build and test results.</p><p>If the work directory content persists across calls to
<span class="RktSym"><a href="Package-Building_API.html#%28def._%28%28lib._pkg-build%2Fmain..rkt%29._build-pkgs%29%29" class="RktValLink" data-pltdoc="x">build-pkgs</a></span>, then <span class="RktSym"><a href="Package-Building_API.html#%28def._%28%28lib._pkg-build%2Fmain..rkt%29._build-pkgs%29%29" class="RktValLink" data-pltdoc="x">build-pkgs</a></span> will incrementally
rebuild changed packages and other packages that depends on them.
However, a work directory must be reused only when the configuration
supplied to <span class="RktSym"><a href="Package-Building_API.html#%28def._%28%28lib._pkg-build%2Fmain..rkt%29._build-pkgs%29%29" class="RktValLink" data-pltdoc="x">build-pkgs</a></span> does not change.</p><p>The work directory will include the following files and directories,
most of which are output, some of which record state for the purpose
of incremental builds, and very few of which are treated as extra
inputs:</p><ul><li><p><span class="stt">"installer/"</span> &#8212;<wbr></wbr> Holds an installer downloaded
from a snapshot site.</p></li><li><p><span class="stt">"install-uuids.rktd"</span> &#8212;<wbr></wbr> Holds a mapping of <a href="Package-Building_API.html#%28tech._vm%29" class="techoutside" data-pltdoc="x"><span class="techinside">VM</span></a>
 names to IDs for prepared Docker containers or VirtualBox
 snapshots.</p></li><li><p><span class="stt">"install-list.rktd"</span> &#8212;<wbr></wbr> A list of packages found in
the installation.</p></li><li><p><span class="stt">"install-adds.rkt"</span> &#8212;<wbr></wbr> A table of documentation,
libraries, etc. in the installation, which is used to detect
conflicts.</p></li><li><p><span class="stt">"install-doc.tgz"</span> &#8212;<wbr></wbr> A copy of installation&rsquo;s
documentation.</p></li><li><p><span class="stt">"server/archive"</span> &#8212;<wbr></wbr> Archived packages from the
snapshot site plus additional specified catalogs.</p></li><li><p><span class="stt">"state.sqlite"</span> &#8212;<wbr></wbr> Records the state of
<span class="stt">"server/archive"</span> for incremental updates.</p></li><li><p><span class="stt">"all-pkgs.rktd"</span> &#8212;<wbr></wbr> A list of available package at
most recent build, which is used to avoid re-building packages
that will fail again due to missing dependencies.</p></li><li><p><span class="stt">"force-pkgs.rktd"</span> &#8212;<wbr></wbr> A list of packages to force a
rebuild; this file is an input, and it is deleted after it is
used.</p></li><li><p><span class="stt">"server/built"</span> &#8212;<wbr></wbr> Built packages. For each package
<span style="font-style: italic">P</span>, this directory contains one of the following:</p><ul><li><p><span class="stt">"pkgs/<span style="font-style: italic">P</span>.orig-CHECKSUM"</span> (same as the
checksum in the archived catalog),
<span class="stt">"pkgs/<span style="font-style: italic">P</span>.zip"</span> (built package), and
<span class="stt">"pkgs/<span style="font-style: italic">P</span>.zip.CHECKSUM"</span> (built
package&rsquo;s checksum) &#8212;<wbr></wbr> An up-to-date package that
successfully built.</p><p>Additional files:</p><ul><li><p><span class="stt">"docs/<span style="font-style: italic">P</span>-adds.rktd"</span> &#8212;<wbr></wbr> a
listing of documentation, executables, etc.</p></li><li><p><span class="stt">"success/<span style="font-style: italic">P</span>.txt"</span> &#8212;<wbr></wbr> records success</p></li><li><p><span class="stt">"install/<span style="font-style: italic">P</span>.txt"</span> &#8212;<wbr></wbr> records installation</p></li><li><p><span class="stt">"install/<span style="font-style: italic">P</span>.txt"</span> &#8212;<wbr></wbr> records dependency-checking failure</p></li><li><p><span class="stt">"test-success/<span style="font-style: italic">P</span>.txt"</span>
or <span class="stt">"test-fail/<span style="font-style: italic">P</span>.txt"</span> &#8212;<wbr></wbr> records <span class="stt">raco test</span> result</p></li><li><p>possibly <span class="stt">"min-fail/<span style="font-style: italic">P</span>.txt"</span> &#8212;<wbr></wbr> records failure on minimal-host attempt</p></li></ul></li><li><p><span class="stt">"pkgs/<span style="font-style: italic">P</span>.orig-CHECKSUM"</span> (same as the
checksum in the archived catalog) and
<span class="stt">"fail/<span style="font-style: italic">P</span>.txt"</span> &#8212;<wbr></wbr> An up-to-date
package that failed to build.
An <span class="stt">"install/<span style="font-style: italic">P</span>.txt"</span> file may
nevertheless report installation success in the sense that
<span class="stt">raco pkg install</span> failed only in its <span class="stt">raco setup</span> step.</p></li><li><p><span class="stt">"archive-fail/<span style="font-style: italic">P</span>.orig-CHECKSUM"</span> &#8212;<wbr></wbr> Archiving failure.</p></li></ul></li><li><p><span class="stt">"dumpster/"</span> &#8212;<wbr></wbr> Saved builds of failed packages if
the package at least installs (and failure was in the
<span class="stt">raco setup</span> step), because maybe the attempt built some
documentation.</p></li><li><p><span class="stt">"doc/"</span> &#8212;<wbr></wbr> Unpacked documentation with non-conflicting
packages installed.</p></li><li><p><span class="stt">"all-doc.tgz"</span> &#8212;<wbr></wbr> The same content as
<span class="stt">"doc/"</span>, but still packed.</p></li><li><p><span class="stt">"summary.rktd"</span> &#8212;<wbr></wbr>A summary of build results as a
hash table mapping each package name to another hash table
with the following keys:</p><ul><li><p><span class="RktVal">'</span><span class="RktVal">success-log</span> &#8212;<wbr></wbr> <span class="RktVal">#f</span> or relative path</p></li><li><p><span class="RktVal">'</span><span class="RktVal">failure-log</span> &#8212;<wbr></wbr> <span class="RktVal">#f</span> or relative path</p></li><li><p><span class="RktVal">'</span><span class="RktVal">dep-failure-log</span> &#8212;<wbr></wbr> <span class="RktVal">#f</span> or relative path</p></li><li><p><span class="RktVal">'</span><span class="RktVal">test-success-log</span> &#8212;<wbr></wbr> <span class="RktVal">#f</span> or relative path</p></li><li><p><span class="RktVal">'</span><span class="RktVal">test-failure-log</span> &#8212;<wbr></wbr> <span class="RktVal">#f</span> or relative path</p></li><li><p><span class="RktVal">'</span><span class="RktVal">min-failure-log</span> &#8212;<wbr></wbr> <span class="RktVal">#f</span> or relative path</p></li><li><p><div class="SIntrapara"><span class="RktVal">'</span><span class="RktVal">docs</span> &#8212;<wbr></wbr> a list of elements, each one of
</div><div class="SIntrapara"><ul><li><p><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._list%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">list</a></span><span class="stt"> </span><span class="RktVal">'</span><span class="RktVal">docs/none</span><span class="stt"> </span><span class="RktVar">name</span><span class="RktPn">)</span></p></li><li><p><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._list%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">list</a></span><span class="stt"> </span><span class="RktVal">'</span><span class="RktVal">docs/main</span><span class="stt"> </span><span class="RktVar">name</span><span class="stt"> </span><span class="RktVar">path</span><span class="RktPn">)</span></p></li></ul></div></p></li><li><p><span class="RktVal">'</span><span class="RktVal">conflict-log</span> &#8212;<wbr></wbr> <span class="RktVal">#f</span>, a relative path, or
<span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._list%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">list</a></span><span class="stt"> </span><span class="RktVal">'</span><span class="RktVal">conflicts/indirect</span><span class="stt"> </span><span class="RktVar">path</span><span class="RktPn">)</span></p></li></ul></li><li><p><span class="stt">"index.html"</span> (and <span class="stt">"robots.txt"</span>, etc.) &#8212;<wbr></wbr> A summary of results in
web-page form.</p></li><li><p><span class="stt">"site.tgz"</span> or <span class="stt">"site.tar"</span> &#8212;<wbr></wbr> All files meant to populate a
web site, including a <span class="stt">"doc/"</span> directory of documentation and a
<span class="stt">"server/built/catalog/"</span> catalog of built packages that are in
<span class="stt">"server/built/pkgs/"</span>. The packed form <span class="stt">"site.tgz"</span> is
created unless <span class="RktPn">#:compress-site?</span> is provided as <span class="RktVal">#f</span>.</p></li></ul><p>Using this information, the <span class="RktSym"><a href="Package-Building_API.html#%28def._%28%28lib._pkg-build%2Fmain..rkt%29._build-pkgs%29%29" class="RktValLink" data-pltdoc="x">build-pkgs</a></span> rebuilds a package is
if its checksum changes or if one of its declared dependencies
changes.</p><div class="navsetbottom"><span class="navleft"><form class="searchform"><input class="searchbox" id="searchbox" type="text" tabindex="1" placeholder="...search manuals..." title="Enter a search string to search the manuals" onkeypress="return DoSearchKey(event, this, &quot;8.6&quot;, &quot;../&quot;);"/></form>&nbsp;&nbsp;<a href="../index-2.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;8.6&quot;);">top</a><span class="tocsettoggle">&nbsp;&nbsp;<a href="javascript:void(0);" title="show/hide table of contents" onclick="TocsetToggle();">contents</a></span></span><span class="navright">&nbsp;&nbsp;<a href="starting-image.html" title="backward to &quot;3 Starting Image Requirements&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="index.html" title="up to &quot;Pkg-Build: Building and Testing All Racket Packages&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="Package-Building_API.html" title="forward to &quot;5 Package-Building API&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body>
<!-- Mirrored from docs.racket-lang.org/pkg-build/work-dir.html by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 07 Sep 2022 03:29:42 GMT -->
</html>