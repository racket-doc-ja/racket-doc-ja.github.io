<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- Mirrored from docs.racket-lang.org/goblins/api.html by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 07 Sep 2022 03:27:03 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><meta name="viewport" content="width=device-width, initial-scale=0.8"/><title>3&nbsp;Goblins API</title><link rel="stylesheet" type="text/css" href="../scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="../racket.css" title="default"/><link rel="stylesheet" type="text/css" href="footnote.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-style.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../doc-site.css" title="default"/><script type="text/javascript" src="../scribble-common.js"></script><script type="text/javascript" src="../manual-racket.js"></script><script type="text/javascript" src="../manual-racket.js"></script><script type="text/javascript" src="../doc-site.js"></script><script type="text/javascript" src="../local-redirect/local-redirect.js"></script><script type="text/javascript" src="../local-redirect/local-user-redirect.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="doc-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9660;</a></td><td></td><td><a href="index.html" class="tocviewlink" data-pltdoc="x">Goblins:<span class="mywbr"> &nbsp;</span> a transactional, distributed actor model environment</a></td></tr></table></div><div class="tocviewsublisttop" style="display: block;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="intro.html" class="tocviewlink" data-pltdoc="x">What is Goblins?</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="tutorial.html" class="tocviewlink" data-pltdoc="x">A tutorial</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="#" class="tocviewselflink" data-pltdoc="x">Goblins API</a></td></tr><tr><td align="right">4&nbsp;</td><td><a href="actor-lib.html" class="tocviewlink" data-pltdoc="x">Actor lib:<span class="mywbr"> &nbsp;</span> a collection of utilities</a></td></tr><tr><td align="right">5&nbsp;</td><td><a href="captp.html" class="tocviewlink" data-pltdoc="x">Distributed programming with Cap<span class="mywbr"> &nbsp;</span>TP</a></td></tr></table></div></div><div class="tocviewlist"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_1&quot;);">&#9658;</a></td><td>3&nbsp;</td><td><a href="#" class="tocviewselflink" data-pltdoc="x">Goblins API</a></td></tr></table><div class="tocviewsublistbottom" style="display: none;" id="tocview_1"><table cellspacing="0" cellpadding="0"><tr><td align="right">3.1&nbsp;</td><td><a href="#%28part._actors%29" class="tocviewlink" data-pltdoc="x">Actors</a></td></tr><tr><td align="right">3.2&nbsp;</td><td><a href="#%28part._core-procedures%29" class="tocviewlink" data-pltdoc="x">Core procedures</a></td></tr><tr><td align="right">3.3&nbsp;</td><td><a href="#%28part._.References%29" class="tocviewlink" data-pltdoc="x">References</a></td></tr><tr><td align="right">3.4&nbsp;</td><td><a href="#%28part._.Actormaps%29" class="tocviewlink" data-pltdoc="x">Actormaps</a></td></tr><tr><td align="right">3.5&nbsp;</td><td><a href="#%28part._.Vats%29" class="tocviewlink" data-pltdoc="x">Vats</a></td></tr><tr><td align="right">3.6&nbsp;</td><td><a href="#%28part._.Promises%29" class="tocviewlink" data-pltdoc="x">Promises</a></td></tr><tr><td align="right">3.7&nbsp;</td><td><a href="#%28part._.Detecting_network_failures%29" class="tocviewlink" data-pltdoc="x">Detecting network failures</a></td></tr></table></div></div></div><div class="tocsub"><div class="tocsubtitle">On this page:</div><table class="tocsublist" cellspacing="0"><tr><td><span class="tocsublinknumber">3.1<tt>&nbsp;</tt></span><a href="#%28part._actors%29" class="tocsubseclink" data-pltdoc="x">Actors</a></td></tr><tr><td><span class="tocsublinknumber">3.1.1<tt>&nbsp;</tt></span><a href="#%28part._what-is-an-actor%29" class="tocsubseclink" data-pltdoc="x">What is an "actor" in Goblins?</a></td></tr><tr><td><span class="tocsublinknumber">3.1.2<tt>&nbsp;</tt></span><a href="#%28part._.Constructors_and_bcom%29" class="tocsubseclink" data-pltdoc="x">Constructors and bcom</a></td></tr><tr><td><span class="tocsublinknumber">3.2<tt>&nbsp;</tt></span><a href="#%28part._core-procedures%29" class="tocsubseclink" data-pltdoc="x">Core procedures</a></td></tr><tr><td><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._spawn%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">spawn</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._~24%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">$</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._~3c-%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">&lt;-</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._~3c-np%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">&lt;-<wbr></wbr>np</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._on%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">on</span></span></a></td></tr><tr><td><span class="tocsublinknumber">3.3<tt>&nbsp;</tt></span><a href="#%28part._.References%29" class="tocsubseclink" data-pltdoc="x">References</a></td></tr><tr><td><span class="tocsublinknumber">3.3.1<tt>&nbsp;</tt></span><a href="#%28part._.Live_vs_.Sturdy_references%29" class="tocsubseclink" data-pltdoc="x">Live vs Sturdy references</a></td></tr><tr><td><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._live-refr~3f%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">live-<wbr></wbr>refr?</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._sturdy-refr~3f%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">sturdy-<wbr></wbr>refr?</span></span></a></td></tr><tr><td><span class="tocsublinknumber">3.3.2<tt>&nbsp;</tt></span><a href="#%28part._.Near_vs_far_references%29" class="tocsubseclink" data-pltdoc="x">Near vs far references</a></td></tr><tr><td><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._near-refr~3f%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">near-<wbr></wbr>refr?</span></span></a></td></tr><tr><td><span class="tocsublinknumber">3.3.3<tt>&nbsp;</tt></span><a href="#%28part._.Local_vs_remote_references%29" class="tocsubseclink" data-pltdoc="x">Local vs remote references</a></td></tr><tr><td><span class="tocsublinknumber">3.4<tt>&nbsp;</tt></span><a href="#%28part._.Actormaps%29" class="tocsubseclink" data-pltdoc="x">Actormaps</a></td></tr><tr><td><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._make-actormap%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">make-<wbr></wbr>actormap</span></span></a></td></tr><tr><td><span class="tocsublinknumber">3.4.1<tt>&nbsp;</tt></span><a href="#%28part._.Actormap_methods%29" class="tocsubseclink" data-pltdoc="x">Actormap methods</a></td></tr><tr><td><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._actormap~3f%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">actormap?</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._actormap-spawn%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">actormap-<wbr></wbr>spawn</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._actormap-spawn%21%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">actormap-<wbr></wbr>spawn!</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._actormap-turn%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">actormap-<wbr></wbr>turn</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._actormap-reckless-poke%21%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">actormap-<wbr></wbr>reckless-<wbr></wbr>poke!</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._actormap-poke%21%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">actormap-<wbr></wbr>poke!</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._actormap-peek%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">actormap-<wbr></wbr>peek</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._actormap-run%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">actormap-<wbr></wbr>run</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._actormap-run%21%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">actormap-<wbr></wbr>run!</span></span></a></td></tr><tr><td><span class="tocsublinknumber">3.4.2<tt>&nbsp;</tt></span><a href="#%28part._whactormap%29" class="tocsubseclink" data-pltdoc="x">whactormap</a></td></tr><tr><td><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._make-whactormap%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">make-<wbr></wbr>whactormap</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._whactormap~3f%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">whactormap?</span></span></a></td></tr><tr><td><span class="tocsublinknumber">3.4.3<tt>&nbsp;</tt></span><a href="#%28part._transactormap%29" class="tocsubseclink" data-pltdoc="x">transactormap</a></td></tr><tr><td><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._transactormap~3f%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">transactormap?</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._make-transactormap%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">make-<wbr></wbr>transactormap</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._transactormap-merge%21%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">transactormap-<wbr></wbr>merge!</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._transactormap-merged~3f%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">transactormap-<wbr></wbr>merged?</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._transactormap-parent%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">transactormap-<wbr></wbr>parent</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._transactormap-delta%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">transactormap-<wbr></wbr>delta</span></span></a></td></tr><tr><td><span class="tocsublinknumber">3.4.4<tt>&nbsp;</tt></span><a href="#%28part._.Snapshotting_and_restoring_actormaps%29" class="tocsubseclink" data-pltdoc="x">Snapshotting and restoring actormaps</a></td></tr><tr><td><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._snapshot-whactormap%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">snapshot-<wbr></wbr>whactormap</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._hasheq-~3ewhactormap%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">hasheq-<wbr></wbr>&gt;whactormap</span></span></a></td></tr><tr><td><span class="tocsublinknumber">3.4.5<tt>&nbsp;</tt></span><a href="#%28part._.Extra_actormap_procedures%29" class="tocsubseclink" data-pltdoc="x">Extra actormap procedures</a></td></tr><tr><td><span class="tocsublinknumber">3.4.6<tt>&nbsp;</tt></span><a href="#%28part._.Vat_connectors%29" class="tocsubseclink" data-pltdoc="x">Vat connectors</a></td></tr><tr><td><span class="tocsublinknumber">3.5<tt>&nbsp;</tt></span><a href="#%28part._.Vats%29" class="tocsubseclink" data-pltdoc="x">Vats</a></td></tr><tr><td><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._make-vat%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">make-<wbr></wbr>vat</span></span></a></td></tr><tr><td><span class="tocsublinknumber">3.6<tt>&nbsp;</tt></span><a href="#%28part._.Promises%29" class="tocsubseclink" data-pltdoc="x">Promises</a></td></tr><tr><td><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._spawn-promise-values%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">spawn-<wbr></wbr>promise-<wbr></wbr>values</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._spawn-promise-cons%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">spawn-<wbr></wbr>promise-<wbr></wbr>cons</span></span></a></td></tr><tr><td><span class="tocsublinknumber">3.7<tt>&nbsp;</tt></span><a href="#%28part._.Detecting_network_failures%29" class="tocsubseclink" data-pltdoc="x">Detecting network failures</a></td></tr><tr><td><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._on-sever%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">on-<wbr></wbr>sever</span></span></a></td></tr></table></div></div><div class="maincolumn"><div class="main"><div class="versionbox"><span class="version">8.6</span></div><div class="navsettop"><span class="navleft"><form class="searchform"><input class="searchbox" id="searchbox" type="text" tabindex="1" placeholder="...search manuals..." title="Enter a search string to search the manuals" onkeypress="return DoSearchKey(event, this, &quot;8.6&quot;, &quot;../&quot;);"/></form>&nbsp;&nbsp;<a href="../index-2.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;8.6&quot;);">top</a><span class="tocsettoggle">&nbsp;&nbsp;<a href="javascript:void(0);" title="show/hide table of contents" onclick="TocsetToggle();">contents</a></span></span><span class="navright">&nbsp;&nbsp;<a href="tutorial.html" title="backward to &quot;2 A tutorial&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="index.html" title="up to &quot;Goblins: a transactional, distributed actor model environment&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="actor-lib.html" title="forward to &quot;4 Actor lib: a collection of utilities&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div><h3 x-source-module="(lib &quot;goblins/scribblings/goblins.scrbl&quot;)" x-source-pkg="goblins" x-part-tag="&quot;api&quot;">3<tt>&nbsp;</tt><a name="(part._api)"></a><a name="(mod-path._goblins)"></a>Goblins API</h3><p><table cellspacing="0" cellpadding="0" class="defmodule"><tr><td align="left"><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._require%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">require</a></span><span class="stt"> </span><a href="#" class="RktModLink" data-pltdoc="x"><span class="RktSym">goblins</span></a><span class="RktPn">)</span></td><td align="right"><span class="RpackageSpec"><span class="Smaller">&nbsp;package:</span> <a href="https://pkgs.racket-lang.org/package/goblins" title="Install this package using `raco pkg install goblins`"><span class="stt">goblins</span></a></span></td></tr></table></p><h4 x-source-module="(lib &quot;goblins/scribblings/goblins.scrbl&quot;)" x-source-pkg="goblins" x-part-tag="&quot;actors&quot;">3.1<tt>&nbsp;</tt><a name="(part._actors)"></a>Actors</h4><h5 x-source-module="(lib &quot;goblins/scribblings/goblins.scrbl&quot;)" x-source-pkg="goblins" x-part-tag="&quot;what-is-an-actor&quot;">3.1.1<tt>&nbsp;</tt><a name="(part._what-is-an-actor)"></a>What is an "actor" in Goblins?</h5><p>Goblins implements the
<a href="https://en.wikipedia.org/wiki/Actor_model">actor model</a>
on top of Racket / scheme.<span class="Footnote"><span class="FootnoteRef"><span style="vertical-align: super; font-size: 80%"><a href="#%28counter-%28%29._%28gentag._3._%28lib._goblins%2Fscribblings%2Fgoblins..scrbl%29%29%29" data-pltdoc="x">1</a></span></span><span class="FootnoteContent">Sussman and Steele famously came to the conclusion that there was in
fact no difference between actor-style message passing and procedure
application in the lambda calculus, and indeed both are similar.
However, there is a significant difference between synchronous
call-and-return procedure application (which is what scheme implements
in its most general form, and between actors in Goblins is handled
by <span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._~24%29%29" class="RktValLink" data-pltdoc="x">$</a></span>) and asynchronous message passing (which in Goblins
is handled with <span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._~3c-%29%29" class="RktValLink" data-pltdoc="x">&lt;-</a></span>).</span></span></p><p>The
<a href="https://en.wikipedia.org/wiki/Actor_model#Fundamental_concepts">fundamental operations of actors</a><span class="Footnote"><span class="FootnoteRef"><span style="vertical-align: super; font-size: 80%"><a href="#%28counter-%28%29._%28gentag._4._%28lib._goblins%2Fscribblings%2Fgoblins..scrbl%29%29%29" data-pltdoc="x">2</a></span></span><span class="FootnoteContent">Emphasis on "fundamental" operations.
Extensions happen from here and vary widely between different systems
that call themselves "actors".</span></span>
are:</p><ul><li><p>An actor can send messages to other actors of which it has the
address.
(In Goblins, <span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._~3c-%29%29" class="RktValLink" data-pltdoc="x">&lt;-</a></span>, possibly arguably <span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._~24%29%29" class="RktValLink" data-pltdoc="x">$</a></span> as well.)</p></li><li><p>An actor may create new actors.
(In Goblins, <span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._spawn%29%29" class="RktValLink" data-pltdoc="x">spawn</a></span>.)</p></li><li><p>An actor may designate its behavior for the next message it
handles.
(In Goblins, this means returning a new message handler by
wrapping that message handler in the actor&rsquo;s <a href="#%28tech._bcom%29" class="techoutside" data-pltdoc="x"><span class="techinside">bcom</span></a>
capability.)</p></li></ul><p>Goblins&rsquo; extensions to these ideas are:</p><ul><li><p><span class="emph">Both</span> synchronous and asynchronous calls are defined and
supported, between <span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._~24%29%29" class="RktValLink" data-pltdoc="x">$</a></span> and <span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._~3c-%29%29" class="RktValLink" data-pltdoc="x">&lt;-</a></span> respectively.
However, <span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._~24%29%29" class="RktValLink" data-pltdoc="x">$</a></span> is both convenient and important for systems
that much be transactionally atomic (eg
<a href="http://erights.org/elib/capability/ode/ode-capabilities.html">implementing money</a>),
it is limited to objects that are within the same <a href="#%28tech._vat%29" class="techoutside" data-pltdoc="x"><span class="techinside">vat</span></a>.
<span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._~3c-%29%29" class="RktValLink" data-pltdoc="x">&lt;-</a></span> is more universal in that any actor on any <a href="#%28tech._vat%29" class="techoutside" data-pltdoc="x"><span class="techinside">vat</span></a>
may communicate with each other, but is asynchronous and cannot
immediately return a resolved value.<span class="Footnote"><span class="FootnoteRef"><span style="vertical-align: super; font-size: 80%"><a href="#%28counter-%28%29._%28gentag._5._%28lib._goblins%2Fscribblings%2Fgoblins..scrbl%29%29%29" data-pltdoc="x">3</a></span></span><span class="FootnoteContent">For more on why this is, see chapters 13-15 of
<a href="http://www.erights.org/talks/thesis/">Mark Miller&rsquo;s dissertation</a>..
This was very influential on Goblins&rsquo; design, including the decision
to move from a coroutine-centric approach to an
<a href="http://www.erights.org/">E</a>-style promise approach.
It could be that coroutines are re-added, but would have to be done
with extreme care; section 18.2 of that same thesis for an
explaination of the challenges and a possible solution for
introducing coroutines.</span></span></p></li><li><p>Raw message passing without a clear way to get values back can
be painful.
For this reason, <span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._~3c-%29%29" class="RktValLink" data-pltdoc="x">&lt;-</a></span> implicitly returns a promise that
can be resolved with <span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._on%29%29" class="RktValLink" data-pltdoc="x">on</a></span> (and, for extra convenience and
fewer round trips, supports
<a href="tutorial.html#%28part._promise._pipelining._%28tutorial%29%29" data-pltdoc="x">Promise pipelining</a>).<span class="Footnote"><span class="FootnoteRef"><span style="vertical-align: super; font-size: 80%"><a href="#%28counter-%28%29._%28gentag._6._%28lib._goblins%2Fscribblings%2Fgoblins..scrbl%29%29%29" data-pltdoc="x">4</a></span></span><span class="FootnoteContent">In this sense, <span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._~3c-np%29%29" class="RktValLink" data-pltdoc="x">&lt;-np</a></span>, which does not return a promise,
is closer to the foundational actors message passing.
The kind of value that promises give us can be constructed manually
by providing return addresses to <span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._~3c-np%29%29" class="RktValLink" data-pltdoc="x">&lt;-np</a></span>, but this is painful
given how common needing to operate on the result of an operation is.</span></span></p></li><li><p>Goblins composes with all the existing machinery of Racket/scheme,
including normal procedure calls.
Instead, Goblins builds its abstractions on top of it, but none of this
needs to be thrown away.<span class="Footnote"><span class="FootnoteRef"><span style="vertical-align: super; font-size: 80%"><a href="#%28counter-%28%29._%28gentag._7._%28lib._goblins%2Fscribblings%2Fgoblins..scrbl%29%29%29" data-pltdoc="x">5</a></span></span><span class="FootnoteContent">Scheme is a beautiful language to build Goblins on top of, but
actually we could build a Goblins-like abstraction layer on top
of any programming language with sane lexical scoping and weak
hash tables (so that actors which are no longer referenced can be
garbage collected).</span></span></p></li></ul><h5 x-source-module="(lib &quot;goblins/scribblings/goblins.scrbl&quot;)" x-source-pkg="goblins" x-part-tag="&quot;Constructors_and_bcom&quot;">3.1.2<tt>&nbsp;</tt><a name="(part._.Constructors_and_bcom)"></a>Constructors and bcom</h5><p>A <a name="(tech._constructor)"></a><span style="font-style: italic">constructor</span> is a procedure which builds the first message
handler an actor will use to process messages / invocations.
The constructor has one mandatory argument, traditionally called
<a href="#%28tech._bcom%29" class="techoutside" data-pltdoc="x"><span class="techinside">bcom</span></a> (pronounced "become" or "bee-com") which can be used
to set up a new message handler for future invocations.</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._require%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">require</a></span><span class="hspace">&nbsp;</span><span class="RktSym">goblins</span><span class="RktPn">)</span></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">am</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._make-actormap%29%29" class="RktValLink" data-pltdoc="x">make-actormap</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">Outer procedure is the constructor.</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">Implicitly takes a bcom argument.</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">count argument may or may not be supplied by spawner.</span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">^noisy-incrementer</span><span class="hspace">&nbsp;</span><span class="RktSym">bcom</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528lib._racket%252Flist..rkt%2529._count%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">count</a></span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">Our message handler.</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=lambda.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._lambda%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">lambda</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">increment-by</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=let.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fletstx-scheme..rkt%2529._let%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">let</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">new-count</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=generic-numbers.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._%252B%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528lib._racket%252Flist..rkt%2529._count%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">count</a></span><span class="hspace">&nbsp;</span><span class="RktSym">increment-by</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">Here we create a new version of ^noisy-incrementer</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">with count scoped to a new incremented version.</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">The second argument to bcom specifies a return value,</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">would return void if unspecified.</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">bcom</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">^noisy-incrementer</span><span class="hspace">&nbsp;</span><span class="RktSym">bcom</span><span class="hspace">&nbsp;</span><span class="RktSym">new-count</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=Writing.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._format%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">format</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"My new count is: ~a"</span><span class="hspace">&nbsp;</span><span class="RktSym">new-count</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">incr1</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._actormap-spawn%21%29%29" class="RktValLink" data-pltdoc="x">actormap-spawn!</a></span><span class="hspace">&nbsp;</span><span class="RktSym">am</span><span class="hspace">&nbsp;</span><span class="RktSym">^noisy-incrementer</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._actormap-poke%21%29%29" class="RktValLink" data-pltdoc="x">actormap-poke!</a></span><span class="hspace">&nbsp;</span><span class="RktSym">am</span><span class="hspace">&nbsp;</span><span class="RktSym">incr1</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">"My new count is: 1"</span></p></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._actormap-poke%21%29%29" class="RktValLink" data-pltdoc="x">actormap-poke!</a></span><span class="hspace">&nbsp;</span><span class="RktSym">am</span><span class="hspace">&nbsp;</span><span class="RktSym">incr1</span><span class="hspace">&nbsp;</span><span class="RktVal">20</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">"My new count is: 21"</span></p></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">incr2</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._actormap-spawn%21%29%29" class="RktValLink" data-pltdoc="x">actormap-spawn!</a></span><span class="hspace">&nbsp;</span><span class="RktSym">am</span><span class="hspace">&nbsp;</span><span class="RktSym">^noisy-incrementer</span><span class="hspace">&nbsp;</span><span class="RktVal">18</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._actormap-poke%21%29%29" class="RktValLink" data-pltdoc="x">actormap-poke!</a></span><span class="hspace">&nbsp;</span><span class="RktSym">am</span><span class="hspace">&nbsp;</span><span class="RktSym">incr2</span><span class="hspace">&nbsp;</span><span class="RktVal">42</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">"My new count is: 60"</span></p></td></tr></table></blockquote><p><a name="(tech._bcom)"></a><span style="font-style: italic">bcom</span>, as shown above, is a capability (or technically a
"sealer") to become another object.
However, <a href="#%28tech._bcom%29" class="techoutside" data-pltdoc="x"><span class="techinside">bcom</span></a> does not apply a side effect; instead,
it wraps the procedure and must be returned from the actor handler
to set that to be its new message handler.
Since this clobbers the space we would normally use to return a value
(for whatever is waiting on the other end of a <span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._~24%29%29" class="RktValLink" data-pltdoc="x">$</a></span> or a <a href="#%28tech._promise%29" class="techoutside" data-pltdoc="x"><span class="techinside">promise</span></a>),
<a href="#%28tech._bcom%29" class="techoutside" data-pltdoc="x"><span class="techinside">bcom</span></a> supports an optional second argument, which is that return value.
If not provided, this defaults to <span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=void.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._void%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">void</a></span><span class="RktPn">)</span>.</p><a name="(part._(gentag._2._(lib._goblins/scribblings/goblins..scrbl)))"></a><p class="FootnoteBlock"><div class="SIntrapara"><p class="FootnoteBlockContent"><span class="FootnoteTarget"><span style="vertical-align: super; font-size: 80%"><a name="(counter-()._(gentag._3._(lib._goblins/scribblings/goblins..scrbl)))"></a>1</span></span>Sussman and Steele famously came to the conclusion that there was in
fact no difference between actor-style message passing and procedure
application in the lambda calculus, and indeed both are similar.
However, there is a significant difference between synchronous
call-and-return procedure application (which is what scheme implements
in its most general form, and between actors in Goblins is handled
by <span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._~24%29%29" class="RktValLink" data-pltdoc="x">$</a></span>) and asynchronous message passing (which in Goblins
is handled with <span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._~3c-%29%29" class="RktValLink" data-pltdoc="x">&lt;-</a></span>).</p></div><div class="SIntrapara"><p class="FootnoteBlockContent"><span class="FootnoteTarget"><span style="vertical-align: super; font-size: 80%"><a name="(counter-()._(gentag._4._(lib._goblins/scribblings/goblins..scrbl)))"></a>2</span></span>Emphasis on "fundamental" operations.
Extensions happen from here and vary widely between different systems
that call themselves "actors".</p></div><div class="SIntrapara"><p class="FootnoteBlockContent"><span class="FootnoteTarget"><span style="vertical-align: super; font-size: 80%"><a name="(counter-()._(gentag._5._(lib._goblins/scribblings/goblins..scrbl)))"></a>3</span></span>For more on why this is, see chapters 13-15 of
<a href="http://www.erights.org/talks/thesis/">Mark Miller&rsquo;s dissertation</a>..
This was very influential on Goblins&rsquo; design, including the decision
to move from a coroutine-centric approach to an
<a href="http://www.erights.org/">E</a>-style promise approach.
It could be that coroutines are re-added, but would have to be done
with extreme care; section 18.2 of that same thesis for an
explaination of the challenges and a possible solution for
introducing coroutines.</p></div><div class="SIntrapara"><p class="FootnoteBlockContent"><span class="FootnoteTarget"><span style="vertical-align: super; font-size: 80%"><a name="(counter-()._(gentag._6._(lib._goblins/scribblings/goblins..scrbl)))"></a>4</span></span>In this sense, <span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._~3c-np%29%29" class="RktValLink" data-pltdoc="x">&lt;-np</a></span>, which does not return a promise,
is closer to the foundational actors message passing.
The kind of value that promises give us can be constructed manually
by providing return addresses to <span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._~3c-np%29%29" class="RktValLink" data-pltdoc="x">&lt;-np</a></span>, but this is painful
given how common needing to operate on the result of an operation is.</p></div><div class="SIntrapara"><p class="FootnoteBlockContent"><span class="FootnoteTarget"><span style="vertical-align: super; font-size: 80%"><a name="(counter-()._(gentag._7._(lib._goblins/scribblings/goblins..scrbl)))"></a>5</span></span>Scheme is a beautiful language to build Goblins on top of, but
actually we could build a Goblins-like abstraction layer on top
of any programming language with sane lexical scoping and weak
hash tables (so that actors which are no longer referenced can be
garbage collected).</p></div></p><h4 x-source-module="(lib &quot;goblins/scribblings/goblins.scrbl&quot;)" x-source-pkg="goblins" x-part-tag="&quot;core-procedures&quot;">3.2<tt>&nbsp;</tt><a name="(part._core-procedures)"></a>Core procedures</h4><p>The following procedures are the core API used to write Goblins code.
All of them must be run within an "actor context", which is to say
either from an actor running within a <a href="#%28tech._vat%29" class="techoutside" data-pltdoc="x"><span class="techinside">vat</span></a> or an <a href="#%28tech._actormap%29" class="techoutside" data-pltdoc="x"><span class="techinside">actormap</span></a>
or within one of the procedures used to bootstrap the vat/actormap.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._goblins/main..rkt)._spawn))"></a><span title="Provided from: goblins | Package: goblins"><span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._spawn%29%29" class="RktValDef RktValLink" data-pltdoc="x">spawn</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">constructor</span><span class="hspace">&nbsp;</span><span class="RktVar">argument</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._live-refr~3f%29%29" class="RktValLink" data-pltdoc="x">live-refr?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">constructor</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=procedures.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._procedure%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">procedure?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">argument</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">any/c</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Spawn an actor built by <span class="RktVar">constructor</span> with the rest
of the <span class="RktVar">argument</span>s being passed to that constructor.
Returns a live reference to the newly spawned actor.</div></p><p>The <span class="RktVar">constructor</span> is, as the name sounds, a goblins
<a href="#%28tech._constructor%29" class="techoutside" data-pltdoc="x"><span class="techinside">constructor</span></a>, and is first passed a <span class="RktSym">bcom</span> argument (which
is a way specify how it will behave on its next invocation) and then
is passed the remaining <span class="RktVar">argument</span>s.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._goblins/main..rkt)._~24))"></a><span title="Provided from: goblins | Package: goblins"><span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._~24%29%29" class="RktValDef RktValLink" data-pltdoc="x">$</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">actor-refr</span><span class="hspace">&nbsp;</span><span class="RktVar">arg</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">any/c</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">actor-refr</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._near-refr~3f%29%29" class="RktValLink" data-pltdoc="x">near-refr?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">arg</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">any/c</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Pronounced "call", "dollar call", or "money-call".<span class="Footnote"><span class="FootnoteRef"><span style="vertical-align: super; font-size: 80%"><a href="#%28counter-%28%29._%28gentag._9._%28lib._goblins%2Fscribblings%2Fgoblins..scrbl%29%29%29" data-pltdoc="x">1</a></span></span><span class="FootnoteContent">Why "money call"?
Because you need <span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._~24%29%29" class="RktValLink" data-pltdoc="x">$</a></span> to make
<a href="http://erights.org/elib/capability/ode/index.html">distributed ocap financial instruments</a>!</span></span></div></p><p>Provide a synchronous call against the current message handler of
<span class="RktVar">actor-refr</span>, which must be a <a href="#%28tech._near%29" class="techoutside" data-pltdoc="x"><span class="techinside">near</span></a> <span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._live-refr~3f%29%29" class="RktValLink" data-pltdoc="x">live-refr?</a></span>
in the same vat as the currently running actor context.
The value returned is that which is returned by the
<span class="RktVar">actor-refr</span>&rsquo;s message handler upon invocation (or, if
<span class="RktSym">actor-ref</span> chose to <span class="RktSym">bcom</span> something else, the second
argument passed to its <span class="RktSym">bcom</span>, or void if not provided.)
Exceptions raised by <span class="RktVar">actor-refr</span>&rsquo;s invocation will be
propagated and can be captured.</p><p>Note that excape continuations can be set up between a caller of
<span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._~24%29%29" class="RktValLink" data-pltdoc="x">$</a></span> and can be used by the callee.  However, a
<a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=eval-model.html%23%2528tech._continuation._barrier%2529&amp;version=8.6" class="techoutside Sq" data-pltdoc="x"><span class="techinside">continuation barrier</span></a>
is installed and so capturing of the continuation is not possible.
(Note that in the future this may be relaxed so that async/await
coroutines can be used with mutual consent of caller/callee; whether
or not this is a good idea is up for debate.)</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._goblins/main..rkt)._~3c-))"></a><span title="Provided from: goblins | Package: goblins"><span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._~3c-%29%29" class="RktValDef RktValLink" data-pltdoc="x">&lt;-</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">actor-refr</span><span class="hspace">&nbsp;</span><span class="RktVar">arg</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">promise</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._live-refr~3f%29%29" class="RktValLink" data-pltdoc="x">live-refr?</a></span><span class="RktPn">]</span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">actor-refr</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._live-refr~3f%29%29" class="RktValLink" data-pltdoc="x">live-refr?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">arg</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">any/c</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Like <span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._~24%29%29" class="RktValLink" data-pltdoc="x">$</a></span>, but called asynchronously and returns a <a href="#%28tech._promise%29" class="techoutside" data-pltdoc="x"><span class="techinside">promise</span></a>,
which may be handled with <span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._on%29%29" class="RktValLink" data-pltdoc="x">on</a></span>.
Unlike <span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._~24%29%29" class="RktValLink" data-pltdoc="x">$</a></span>, <span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._~3c-%29%29" class="RktValLink" data-pltdoc="x">&lt;-</a></span> is not limited to only <a href="#%28tech._near%29" class="techoutside" data-pltdoc="x"><span class="techinside">near</span></a>
<span class="RktVar">actor-refr</span>s; interaction with <a href="#%28tech._far%29" class="techoutside" data-pltdoc="x"><span class="techinside">far</span></a> actors are permitted
as well.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._goblins/main..rkt)._~3c-np))"></a><span title="Provided from: goblins | Package: goblins"><span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._~3c-np%29%29" class="RktValDef RktValLink" data-pltdoc="x">&lt;-np</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">actor-refr</span><span class="hspace">&nbsp;</span><span class="RktVar">arg</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=void.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._void%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">void?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">actor-refr</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._live-refr~3f%29%29" class="RktValLink" data-pltdoc="x">live-refr?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">arg</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">any/c</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Like <span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._~3c-%29%29" class="RktValLink" data-pltdoc="x">&lt;-</a></span> but does not return (or require the overhead of) a
promise.
<span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._~3c-np%29%29" class="RktValLink" data-pltdoc="x">&lt;-np</a></span> is effectively an optimization; where promises are not
needed, using <span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._~3c-np%29%29" class="RktValLink" data-pltdoc="x">&lt;-np</a></span> over <span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._~3c-%29%29" class="RktValLink" data-pltdoc="x">&lt;-</a></span> is a good idea.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><table cellspacing="0" cellpadding="0" class="prototype RForeground"><tr><td valign="top"><span class="RktPn">(</span><a name="(def._((lib._goblins/main..rkt)._on))"></a><span title="Provided from: goblins | Package: goblins"><span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._on%29%29" class="RktValDef RktValLink" data-pltdoc="x">on</a></span></span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">vow</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span><span class="RktOpt">[</span></td><td valign="top"><span class="RktVar">fulfilled-handler</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:catch</span><span class="hspace">&nbsp;</span><span class="RktVar">broken-handler</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:finally</span><span class="hspace">&nbsp;</span><span class="RktVar">finally-handler</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:promise?</span><span class="hspace">&nbsp;</span><span class="RktVar">promise?</span><span class="RktOpt">]</span><span class="RktPn">)</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">&rarr;</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._live-refr~3f%29%29" class="RktValLink" data-pltdoc="x">live-refr?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=void.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._void%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">void?</a></span><span class="RktPn">)</span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">vow</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._live-refr~3f%29%29" class="RktValLink" data-pltdoc="x">live-refr?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">any/c</a></span><span class="RktPn">)</span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="argcontract"><tr><td valign="top"><span class="hspace">&nbsp;&nbsp;</span></td><td valign="top"><span class="RktVar">fulfilled-handler</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">:</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=procedures.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._procedure%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">procedure?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._live-refr~3f%29%29" class="RktValLink" data-pltdoc="x">live-refr?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._sturdy-refr~3f%29%29" class="RktValLink" data-pltdoc="x">sturdy-refr?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span></td></tr></table></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">=</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVal">#f</span></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="argcontract"><tr><td valign="top"><span class="hspace">&nbsp;&nbsp;</span></td><td valign="top"><span class="RktVar">broken-handler</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">:</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=procedures.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._procedure%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">procedure?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._live-refr~3f%29%29" class="RktValLink" data-pltdoc="x">live-refr?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._sturdy-refr~3f%29%29" class="RktValLink" data-pltdoc="x">sturdy-refr?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span></td></tr></table></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">=</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVal">#f</span></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="argcontract"><tr><td valign="top"><span class="hspace">&nbsp;&nbsp;</span></td><td valign="top"><span class="RktVar">finally-handler</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">:</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=procedures.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._procedure%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">procedure?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._live-refr~3f%29%29" class="RktValLink" data-pltdoc="x">live-refr?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._sturdy-refr~3f%29%29" class="RktValLink" data-pltdoc="x">sturdy-refr?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span></td></tr></table></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">=</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVal">#f</span></td></tr></table></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">promise?</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=booleans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._boolean%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">boolean?</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#f</span></td></tr></table></blockquote></div><div class="SIntrapara">Sets up promise handlers for <span class="RktVar">vow</span>, which is typically a
<span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._live-refr~3f%29%29" class="RktValLink" data-pltdoc="x">live-refr?</a></span> to a <a href="#%28tech._promise%29" class="techoutside" data-pltdoc="x"><span class="techinside">promise</span></a> but may be anything.</div></p><p><span class="RktVar">fulfilled-handler</span>, <span class="RktVar">broken-handler</span>, and <span class="RktVar">finally-handler</span>
all, if specified, may be either a procedure (the most common case)
which is run when <span class="RktVar">vow</span> becomes resolved, or a reference to an
actor that should be messaged when the promise is resolved with the
same arguments that would be passed to an equivalent procedure.
As their names suggest, <span class="RktVar">fulfilled-handler</span> will run if a promise is
fulfilled and takes one argument, the fulfilled value.
<span class="RktVar">broken-handler</span> will run if a promise is broken and takes one
argument, the error value.
<span class="RktVar">finally-handler</span> will run when a promise is resolved, no matter the
outcome and is called with no arguments.</p><p>If <span class="RktSym">#:promise?</span> is set to <span class="RktVal">#t</span>, then <span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._on%29%29" class="RktValLink" data-pltdoc="x">on</a></span>
will itself return a promise.
The promise will be resolved as follows:</p><ul><li><p>If <span class="RktVar">vow</span> is fulfilled and <span class="RktVar">fulfilled-handler</span> is not
provided, the promise returned will share <span class="RktVar">vow</span>&rsquo;s resolution.</p></li><li><p>If <span class="RktVar">vow</span> is broken and <span class="RktVar">broken-handler</span> is not
provided, the promise returned will share <span class="RktVar">vow</span>&rsquo;s broken result.</p></li><li><p>If <span class="RktVar">vow</span> is fulfilled and <span class="RktVar">fulfilled-handler</span> is provided,
the resolution will be whatever is returned from <span class="RktVar">fulfilled-handler</span>,
unless <span class="RktVar">fulfilled-handler</span> raises an error, in which case the promise
will be broken with its error-value set to this exception.</p></li><li><p>If <span class="RktVar">vow</span> is broken and <span class="RktVar">broken-handler</span> is provided,
the resolution will be whatever is returned from <span class="RktVar">broken-handler</span>,
unless <span class="RktVar">broken-handler</span> raises an error, in which case the promise
will be broken with its error-value set to this exception (which
may even be the original exception).</p></li></ul><a name="(part._(gentag._8._(lib._goblins/scribblings/goblins..scrbl)))"></a><p class="FootnoteBlock"><div class="SIntrapara"><p class="FootnoteBlockContent"><span class="FootnoteTarget"><span style="vertical-align: super; font-size: 80%"><a name="(counter-()._(gentag._9._(lib._goblins/scribblings/goblins..scrbl)))"></a>1</span></span>Why "money call"?
Because you need <span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._~24%29%29" class="RktValLink" data-pltdoc="x">$</a></span> to make
<a href="http://erights.org/elib/capability/ode/index.html">distributed ocap financial instruments</a>!</p></div></p><h4 x-source-module="(lib &quot;goblins/scribblings/goblins.scrbl&quot;)" x-source-pkg="goblins" x-part-tag="&quot;References&quot;">3.3<tt>&nbsp;</tt><a name="(part._.References)"></a>References</h4><p>A <a name="(tech._reference)"></a><span style="font-style: italic">reference</span> is a capability to communicate with an actor.
References are an indirection and abstractly correspond to an actor handler
in an <a href="#%28tech._actormap%29" class="techoutside" data-pltdoc="x"><span class="techinside">actormap</span></a> somewhere, often in a <a href="#%28tech._vat%29" class="techoutside" data-pltdoc="x"><span class="techinside">vat</span></a>.</p><h5 x-source-module="(lib &quot;goblins/scribblings/goblins.scrbl&quot;)" x-source-pkg="goblins" x-part-tag="&quot;Live_vs_Sturdy_references&quot;">3.3.1<tt>&nbsp;</tt><a name="(part._.Live_vs_.Sturdy_references)"></a>Live vs Sturdy references</h5><p>The most common kind of reference is a <a name="(tech._live)"></a><span style="font-style: italic">live</span> reference,
meaning that they correspond to some actor which we have an
established connection to.
However some references may be <a name="(tech._sturdy)"></a><span style="font-style: italic">sturdy</span> references, meaning
they are serialized in such a way that they probably refer to some
actor, but the connection to it is dormant in this reference itself.
A sturdy reference must be enlivened with <span class="RktSym">enliven</span> before it
can be used.
(<span style="font-weight: bold">TODO:</span> or do we just want to reuse <span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._~3c-%29%29" class="RktValLink" data-pltdoc="x">&lt;-</a></span>?  Dunno.)</p><p><span style="font-weight: bold">NOTE:</span> Sturdy references aren&rsquo;t implemented yet, and neither is
<span class="RktSym">enliven</span>.
Change that!</p><p><span style="font-weight: bold">NOTE:</span> Update: it also seems like sturdyrefs are becoming an
ocapn thing?  Maybe this also means that live-refr? and refr? should
become synonyms?</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._goblins/main..rkt)._live-refr~3f))"></a><span title="Provided from: goblins | Package: goblins"><span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._live-refr~3f%29%29" class="RktValDef RktValLink" data-pltdoc="x">live-refr?</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">obj</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=booleans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._boolean%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">boolean?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">obj</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">any/c</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Returns <span class="RktVal">#t</span> if <span class="RktVar">obj</span> is a <a href="#%28tech._live%29" class="techoutside" data-pltdoc="x"><span class="techinside">live</span></a> reference.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._goblins/main..rkt)._sturdy-refr~3f))"></a><span title="Provided from: goblins | Package: goblins"><span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._sturdy-refr~3f%29%29" class="RktValDef RktValLink" data-pltdoc="x">sturdy-refr?</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">obj</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=booleans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._boolean%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">boolean?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">obj</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">any/c</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Returns <span class="RktVal">#t</span> if <span class="RktVar">obj</span> is a <a href="#%28tech._sturdy%29" class="techoutside" data-pltdoc="x"><span class="techinside">sturdy</span></a> reference.</div></p><p><span style="font-weight: bold">TODO:</span> Define and document <span class="RktSym">enliven</span>, maybe.</p><h5 x-source-module="(lib &quot;goblins/scribblings/goblins.scrbl&quot;)" x-source-pkg="goblins" x-part-tag="&quot;Near_vs_far_references&quot;">3.3.2<tt>&nbsp;</tt><a name="(part._.Near_vs_far_references)"></a>Near vs far references</h5><p>An actor is <a name="(tech._near)"></a><span style="font-style: italic">near</span> if it is in the same vat as the actor being
called in an actor context.
An actor is <a name="(tech._far)"></a><span style="font-style: italic">far</span> if it is not.
The significance here is that only <a href="#%28tech._near%29" class="techoutside" data-pltdoc="x"><span class="techinside">near</span></a> actors may perform immediate
calls with <span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._~24%29%29" class="RktValLink" data-pltdoc="x">$</a></span>, whereas any actor may perform asynchronous message
sends with <span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._~3c-%29%29" class="RktValLink" data-pltdoc="x">&lt;-</a></span> and <span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._~3c-np%29%29" class="RktValLink" data-pltdoc="x">&lt;-np</a></span>.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._goblins/main..rkt)._near-refr~3f))"></a><span title="Provided from: goblins | Package: goblins"><span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._near-refr~3f%29%29" class="RktValDef RktValLink" data-pltdoc="x">near-refr?</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">obj</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=booleans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._boolean%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">boolean?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">obj</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">any/c</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Returns <span class="RktVal">#t</span> if <span class="RktVar">obj</span> is a <a href="#%28tech._near%29" class="techoutside" data-pltdoc="x"><span class="techinside">near</span></a> <a href="#%28tech._reference%29" class="techoutside" data-pltdoc="x"><span class="techinside">reference</span></a>.</div></p><h5 x-source-module="(lib &quot;goblins/scribblings/goblins.scrbl&quot;)" x-source-pkg="goblins" x-part-tag="&quot;Local_vs_remote_references&quot;">3.3.3<tt>&nbsp;</tt><a name="(part._.Local_vs_remote_references)"></a>Local vs remote references</h5><p>Well, once <font class="badlink"><span class="techoutside"><span class="techinside">machine</span></span></font>s exist, this will matter, but they don&rsquo;t yet :P</p><h4 x-source-module="(lib &quot;goblins/scribblings/goblins.scrbl&quot;)" x-source-pkg="goblins" x-part-tag="&quot;Actormaps&quot;">3.4<tt>&nbsp;</tt><a name="(part._.Actormaps)"></a>Actormaps</h4><p>An <a name="(tech._actormap)"></a><span style="font-style: italic">actormap</span> is the key abstraction that maps actor
references to their current method handlers.
There are actually two kinds of actormaps, <a href="#%28tech._whactormap%29" class="techoutside" data-pltdoc="x"><span class="techinside">whactormap</span></a>s and
<a href="#%28tech._transactormap%29" class="techoutside" data-pltdoc="x"><span class="techinside">transactormap</span></a>s.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._goblins/main..rkt)._make-actormap))"></a><span title="Provided from: goblins | Package: goblins"><span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._make-actormap%29%29" class="RktValDef RktValLink" data-pltdoc="x">make-actormap</a></span></span><span class="hspace">&nbsp;</span><span class="RktOpt">[</span><span class="RktPn">#:vat-connector</span><span class="hspace">&nbsp;</span><span class="RktVar">vat-connector</span><span class="RktOpt">]</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._whactormap~3f%29%29" class="RktValLink" data-pltdoc="x">whactormap?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">vat-connector</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=procedures.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._procedure%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">procedure?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#f</span></td></tr></table></blockquote></div><div class="SIntrapara">Alias for <span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._make-whactormap%29%29" class="RktValLink" data-pltdoc="x">make-whactormap</a></span>, since this is the most common
actormap users make.</div></p><p>Actormaps are also wrapped by <a href="#%28tech._vat%29" class="techoutside" data-pltdoc="x"><span class="techinside">vat</span></a>s.
More commonly, users will use vats than actormaps directly; however,
there are some powerful aspects to doing so, namely for
strictly-synchronous programs (such as games) or for snapshotting
actormaps for time-traveling purposese.</p><p>In general, there are really two key operations for operating on
actormaps.
The first is <span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._actormap-spawn%29%29" class="RktValLink" data-pltdoc="x">actormap-spawn</a></span>, which is really just used to
bootstrap an actormap with some interesting actors.
Actors then operate on <a name="(tech._turn)"></a><span style="font-style: italic">turns</span>, which are
basically a top-level invocation; the core operation for that is
<span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._actormap-turn%29%29" class="RktValLink" data-pltdoc="x">actormap-turn</a></span>.
This can be thought of as like a toplevel invocation of a procedure at
a REPL: the procedure called may create other objects, instantiate and
call other procedures, etc, but (unless some portion of computation
goes into an infinite loop) will eventually return to the REPL with
some value.
Actormap turns are similar; actors may do
<a href="#%28part._core-procedures%29" data-pltdoc="x">anything that actors can normally do</a>
within the turn, including spawning new actors and calling other actors,
but the turn should ideally end in some result (as well as some new
messages to possibly dispatch).<span class="Footnote"><span class="FootnoteRef"><span style="vertical-align: super; font-size: 80%"><a href="#%28counter-%28%29._%28gentag._11._%28lib._goblins%2Fscribblings%2Fgoblins..scrbl%29%29%29" data-pltdoc="x">1</a></span></span><span class="FootnoteContent">Due to the
<a href="https://en.wikipedia.org/wiki/Halting_problem">halting problem</a>,
this cannot be pre-guaranteed in a turing-complete environment such as
what Goblins runs in.
Actors can indeed go into an infinite loop; in general the security model
of Goblins is to assume that actors in the same <a href="#%28tech._vat%29" class="techoutside" data-pltdoc="x"><span class="techinside">vat</span></a> can
thus "hose their vat" (but really this means, an actormap turn might not
end on its own, and vats currently don&rsquo;t try to stop it).
Pre-emption can be layered manually though when operating on the actormap
directly; if you want to do this, see
<a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=threads.html%23%2528part._threadkill%2529&amp;version=8.6" class="Sq" data-pltdoc="x">Suspending, Resuming, and Killing Threads</a>.</span></span></p><h5 x-source-module="(lib &quot;goblins/scribblings/goblins.scrbl&quot;)" x-source-pkg="goblins" x-part-tag="&quot;Actormap_methods&quot;">3.4.1<tt>&nbsp;</tt><a name="(part._.Actormap_methods)"></a>Actormap methods</h5><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._goblins/main..rkt)._actormap~3f))"></a><span title="Provided from: goblins | Package: goblins"><span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._actormap~3f%29%29" class="RktValDef RktValLink" data-pltdoc="x">actormap?</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">obj</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=booleans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._boolean%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">boolean?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">obj</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">any/c</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Determines if <span class="RktVar">obj</span> is an <a href="#%28tech._actormap%29" class="techoutside" data-pltdoc="x"><span class="techinside">actormap</span></a>.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._goblins/main..rkt)._actormap-spawn))"></a><span title="Provided from: goblins | Package: goblins"><span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._actormap-spawn%29%29" class="RktValDef RktValLink" data-pltdoc="x">actormap-spawn</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">actormap</span><span class="hspace">&nbsp;</span><span class="RktVar">constructor</span><span class="hspace">&nbsp;</span><span class="RktVar">arg</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span></p></blockquote></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="prototype"><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">&rarr;</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><table cellspacing="0" cellpadding="0"><tr><td><span class="RktPn">[</span><span class="RktSym">actor-refr</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._live-refr~3f%29%29" class="RktValLink" data-pltdoc="x">live-refr?</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="RktPn">[</span><span class="RktSym">new-actormap</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._transactormap~3f%29%29" class="RktValLink" data-pltdoc="x">transactormap?</a></span><span class="RktPn">]</span></td></tr></table></td></tr></table></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">actormap</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._actormap~3f%29%29" class="RktValLink" data-pltdoc="x">actormap?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">constructor</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=procedures.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._procedure%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">procedure?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">arg</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">any/c</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Like <span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._spawn%29%29" class="RktValLink" data-pltdoc="x">spawn</a></span>, but low-level and transactional.
Returns two values to its continuation, the new actor <a href="#%28tech._live%29" class="techoutside" data-pltdoc="x"><span class="techinside">live</span></a>
<a href="#%28tech._reference%29" class="techoutside" data-pltdoc="x"><span class="techinside">reference</span></a>, and a <a href="#%28tech._transactormap%29" class="techoutside" data-pltdoc="x"><span class="techinside">transactormap</span></a> representing the change.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><table cellspacing="0" cellpadding="0" class="prototype RForeground"><tr><td valign="top"><span class="RktPn">(</span><a name="(def._((lib._goblins/main..rkt)._actormap-spawn!))"></a><span title="Provided from: goblins | Package: goblins"><span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._actormap-spawn%21%29%29" class="RktValDef RktValLink" data-pltdoc="x">actormap-spawn!</a></span></span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">actormap</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">constructor</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">arg</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">&rarr;</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">[</span><span class="RktSym">actor-refr</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._live-refr~3f%29%29" class="RktValLink" data-pltdoc="x">live-refr?</a></span><span class="RktPn">]</span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">actormap</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._actormap~3f%29%29" class="RktValLink" data-pltdoc="x">actormap?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">constructor</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=procedures.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._procedure%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">procedure?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">arg</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">any/c</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Like <span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._actormap-spawn%29%29" class="RktValLink" data-pltdoc="x">actormap-spawn</a></span>, but directly commits the actor to
<span class="RktVar">actormap</span>.
Only returns the tech{reference} of the new actor.
No changes are committed in an exceptional condition.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._goblins/main..rkt)._actormap-turn))"></a><span title="Provided from: goblins | Package: goblins"><span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._actormap-turn%29%29" class="RktValDef RktValLink" data-pltdoc="x">actormap-turn</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">actormap</span><span class="hspace">&nbsp;</span><span class="RktVar">to-refr</span><span class="hspace">&nbsp;</span><span class="RktVar">args</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span></p></blockquote></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="prototype"><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">&rarr;</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><table cellspacing="0" cellpadding="0"><tr><td><span class="RktPn">[</span><span class="RktSym">result</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">any/c</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="RktPn">[</span><span class="RktSym">new-actormap</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._transactormap~3f%29%29" class="RktValLink" data-pltdoc="x">transactormap?</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="RktPn">[</span><span class="RktSym">to-near</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._listof%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">listof</a></span><span class="hspace">&nbsp;</span><span class="RktSym">message?</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="RktPn">[</span><span class="RktSym">to-far</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._listof%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">listof</a></span><span class="hspace">&nbsp;</span><span class="RktSym">message?</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr></table></td></tr></table></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">actormap</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._actormap~3f%29%29" class="RktValLink" data-pltdoc="x">actormap?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">to-refr</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._live-refr~3f%29%29" class="RktValLink" data-pltdoc="x">live-refr?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">args</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">any/c</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Similar to performing <span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._~24%29%29" class="RktValLink" data-pltdoc="x">$</a></span>, applying <span class="RktVar">args</span> to
<span class="RktVar">to-refr</span>, but transactional and a little bit cumbersome to use.
(In many cases, you&rsquo;ll prefer to use <span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._actormap-peek%29%29" class="RktValLink" data-pltdoc="x">actormap-peek</a></span>,
<span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._actormap-poke%21%29%29" class="RktValLink" data-pltdoc="x">actormap-poke!</a></span>, <span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._actormap-run%29%29" class="RktValLink" data-pltdoc="x">actormap-run</a></span>, or <span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._actormap-run%21%29%29" class="RktValLink" data-pltdoc="x">actormap-run!</a></span>
which are easier.)
Returns three values to its continuation: the result of applying
<span class="RktVar">args</span> to <span class="RktVar">to-refr</span>, a transactional new actormap, and
a list of messages that may need to be sent.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><table cellspacing="0" cellpadding="0" class="prototype RForeground"><tr><td valign="top"><span class="RktPn">(</span><a name="(def._((lib._goblins/main..rkt)._actormap-reckless-poke!))"></a><span title="Provided from: goblins | Package: goblins"><span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._actormap-reckless-poke%21%29%29" class="RktValDef RktValLink" data-pltdoc="x">actormap-reckless-poke!</a></span></span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">actormap</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">to-refr</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">arg</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">&rarr;</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">[</span><span class="RktSym">actor-refr</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._live-refr~3f%29%29" class="RktValLink" data-pltdoc="x">live-refr?</a></span><span class="RktPn">]</span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">actormap</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._whactormap~3f%29%29" class="RktValLink" data-pltdoc="x">whactormap?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">to-refr</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._live-refr~3f%29%29" class="RktValLink" data-pltdoc="x">live-refr?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">arg</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">any/c</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Like <span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._actormap-poke%21%29%29" class="RktValLink" data-pltdoc="x">actormap-poke!</a></span>, but only usable on a <a href="#%28tech._whactormap%29" class="techoutside" data-pltdoc="x"><span class="techinside">whactormap</span></a>
and mutates all bcom-effects immediately to the mapping.
A little bit faster but non-transactional... corrupt state can occur
in the case of exceptional conditions, as the system will not "roll
back".
<span class="emph">Use with caution!</span></div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._goblins/main..rkt)._actormap-poke!))"></a><span title="Provided from: goblins | Package: goblins"><span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._actormap-poke%21%29%29" class="RktValDef RktValLink" data-pltdoc="x">actormap-poke!</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">actormap</span><span class="hspace">&nbsp;</span><span class="RktVar">to-refr</span><span class="hspace">&nbsp;</span><span class="RktVar">args</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">any/c</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">actormap</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._actormap~3f%29%29" class="RktValLink" data-pltdoc="x">actormap?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">to-refr</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._live-refr~3f%29%29" class="RktValLink" data-pltdoc="x">live-refr?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">args</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">any/c</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Similar to performing <span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._~24%29%29" class="RktValLink" data-pltdoc="x">$</a></span>, applying <span class="RktVar">args</span> to
<span class="RktVar">to-refr</span>.
Commits its result immediately, barring an exceptional condition.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._goblins/main..rkt)._actormap-peek))"></a><span title="Provided from: goblins | Package: goblins"><span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._actormap-peek%29%29" class="RktValDef RktValLink" data-pltdoc="x">actormap-peek</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">actormap</span><span class="hspace">&nbsp;</span><span class="RktVar">to-refr</span><span class="hspace">&nbsp;</span><span class="RktVar">args</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=void.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._void%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">void?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">actormap</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._actormap~3f%29%29" class="RktValLink" data-pltdoc="x">actormap?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">to-refr</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._live-refr~3f%29%29" class="RktValLink" data-pltdoc="x">live-refr?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">args</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">any/c</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Like <span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._actormap-poke%21%29%29" class="RktValLink" data-pltdoc="x">actormap-poke!</a></span>, but does not commit its result.
Useful for interrogating an actor in an actormap without allowing for
become-effects within it.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._goblins/main..rkt)._actormap-run))"></a><span title="Provided from: goblins | Package: goblins"><span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._actormap-run%29%29" class="RktValDef RktValLink" data-pltdoc="x">actormap-run</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">actormap</span><span class="hspace">&nbsp;</span><span class="RktVar">proc</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">any/c</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">actormap</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._actormap~3f%29%29" class="RktValLink" data-pltdoc="x">actormap?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">proc</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=function-contracts.html%23%2528form._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._-%7E3e%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">any/c</a></span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Run <span class="RktVar">proc</span>, which is a thunk (procedure with no arguments) in the
actormap context, but do not commit its results, instead returning its
value.</div></p><p>Like <span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._actormap-peek%29%29" class="RktValLink" data-pltdoc="x">actormap-peek</a></span>, this is useful for interrogating an
actormap, but can be useful for doing several things at once.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><table cellspacing="0" cellpadding="0" class="prototype RForeground"><tr><td valign="top"><span class="RktPn">(</span><a name="(def._((lib._goblins/main..rkt)._actormap-run!))"></a><span title="Provided from: goblins | Package: goblins"><span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._actormap-run%21%29%29" class="RktValDef RktValLink" data-pltdoc="x">actormap-run!</a></span></span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">actormap</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">proc</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span><span class="RktOpt">[</span></td><td valign="top"><span class="RktPn">#:reckless?</span><span class="hspace">&nbsp;</span><span class="RktVar">reckless?</span><span class="RktOpt">]</span><span class="RktPn">)</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">&rarr;</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528form._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">any</a></span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">actormap</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._actormap~3f%29%29" class="RktValLink" data-pltdoc="x">actormap?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">proc</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=function-contracts.html%23%2528form._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._-%7E3e%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528form._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">any</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">reckless?</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">any/c</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#f</span></td></tr></table></blockquote></div><div class="SIntrapara">Like <span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._actormap-run%29%29" class="RktValLink" data-pltdoc="x">actormap-run</a></span>, but commits results like <span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._actormap-poke%21%29%29" class="RktValLink" data-pltdoc="x">actormap-poke!</a></span> when
<span class="RktVar">reckless?</span> is #f, else it commits results like <span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._actormap-reckless-poke%21%29%29" class="RktValLink" data-pltdoc="x">actormap-reckless-poke!</a></span>.
Unlike <span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._actormap-run%29%29" class="RktValLink" data-pltdoc="x">actormap-run</a></span>, it can return multiple values.</div></p><h5 x-source-module="(lib &quot;goblins/scribblings/goblins.scrbl&quot;)" x-source-pkg="goblins" x-part-tag="&quot;whactormap&quot;">3.4.2<tt>&nbsp;</tt><a name="(part._whactormap)"></a>whactormap</h5><p>A <a name="(tech._whactormap)"></a><span style="font-style: italic">whactormap</span> is the default kind of <a href="#%28tech._actormap%29" class="techoutside" data-pltdoc="x"><span class="techinside">actormap</span></a>; uses a weak
hashtable for mapping.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._goblins/main..rkt)._make-whactormap))"></a><span title="Provided from: goblins | Package: goblins"><span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._make-whactormap%29%29" class="RktValDef RktValLink" data-pltdoc="x">make-whactormap</a></span></span><span class="hspace">&nbsp;</span><span class="RktOpt">[</span><span class="RktPn">#:vat-connector</span><span class="hspace">&nbsp;</span><span class="RktVar">vat-connector</span><span class="RktOpt">]</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._whactormap~3f%29%29" class="RktValLink" data-pltdoc="x">whactormap?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">vat-connector</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=procedures.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._procedure%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">procedure?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#f</span></td></tr></table></blockquote></div><div class="SIntrapara">Makes a weak hashtable actormap.
Used to mutably track the current state of actors.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._goblins/main..rkt)._whactormap~3f))"></a><span title="Provided from: goblins | Package: goblins"><span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._whactormap~3f%29%29" class="RktValDef RktValLink" data-pltdoc="x">whactormap?</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">obj</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=booleans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._boolean%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">boolean?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">obj</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">any/c</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Determines if <span class="RktVar">obj</span> is a <a href="#%28tech._whactormap%29" class="techoutside" data-pltdoc="x"><span class="techinside">whactormap</span></a>.</div></p><h5 x-source-module="(lib &quot;goblins/scribblings/goblins.scrbl&quot;)" x-source-pkg="goblins" x-part-tag="&quot;transactormap&quot;">3.4.3<tt>&nbsp;</tt><a name="(part._transactormap)"></a>transactormap</h5><p>A <a name="(tech._transactormap)"></a><span style="font-style: italic">transactormap</span> is an <a href="#%28tech._actormap%29" class="techoutside" data-pltdoc="x"><span class="techinside">actormap</span></a> that stores a delta of
its changes and points at a previous actormap.
It must be committed using <span class="RktSym">transactormap-commit!</span> before its changes
officially make it into its parent.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._goblins/main..rkt)._transactormap~3f))"></a><span title="Provided from: goblins | Package: goblins"><span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._transactormap~3f%29%29" class="RktValDef RktValLink" data-pltdoc="x">transactormap?</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">obj</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=booleans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._boolean%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">boolean?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">obj</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">any/c</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Returns <span class="RktVal">#t</span> if <span class="RktVar">obj</span> is a <a href="#%28tech._transactormap%29" class="techoutside" data-pltdoc="x"><span class="techinside">transactormap</span></a>.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><table cellspacing="0" cellpadding="0" class="prototype RForeground"><tr><td valign="top"><span class="RktPn">(</span><a name="(def._((lib._goblins/main..rkt)._make-transactormap))"></a><span title="Provided from: goblins | Package: goblins"><span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._make-transactormap%29%29" class="RktValDef RktValLink" data-pltdoc="x">make-transactormap</a></span></span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">parent</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span><span class="RktOpt">[</span></td><td valign="top"><span class="RktPn">#:vat-connector</span><span class="hspace">&nbsp;</span><span class="RktVar">vat-connector</span><span class="RktOpt">]</span><span class="RktPn">)</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._transactormap~3f%29%29" class="RktValLink" data-pltdoc="x">transactormap?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">parent</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._actormap~3f%29%29" class="RktValLink" data-pltdoc="x">actormap?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">vat-connector</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=procedures.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._procedure%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">procedure?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#f</span></td></tr></table></blockquote></div><div class="SIntrapara">Makes a new transactormap which is not yet committed and does not have
any new changes.
It is unlikely you will need this procedure, since <span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._actormap-turn%29%29" class="RktValLink" data-pltdoc="x">actormap-turn</a></span>,
<span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._actormap-spawn%29%29" class="RktValLink" data-pltdoc="x">actormap-spawn</a></span> and friends produce it for you.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._goblins/main..rkt)._transactormap-merge!))"></a><span title="Provided from: goblins | Package: goblins"><span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._transactormap-merge%21%29%29" class="RktValDef RktValLink" data-pltdoc="x">transactormap-merge!</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">transactormap</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym">void/c</span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">transactormap</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._transactormap~3f%29%29" class="RktValLink" data-pltdoc="x">transactormap?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Recursively merges this and any parent <a href="#%28tech._transactormap%29" class="techoutside" data-pltdoc="x"><span class="techinside">transactormap</span></a>s until it reaches
the root <a href="#%28tech._whactormap%29" class="techoutside" data-pltdoc="x"><span class="techinside">whactormap</span></a>.</div></p><p>Note that creating two forking timelines of transactormaps upon a
whactormap and merging them may corrupt your whactormap.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._goblins/main..rkt)._transactormap-merged~3f))"></a><span title="Provided from: goblins | Package: goblins"><span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._transactormap-merged~3f%29%29" class="RktValDef RktValLink" data-pltdoc="x">transactormap-merged?</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">transactormap</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=booleans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._boolean%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">boolean?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">transactormap</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._transactormap~3f%29%29" class="RktValLink" data-pltdoc="x">transactormap?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Returns <span class="RktVal">#t</span> if this <a href="#%28tech._transactormap%29" class="techoutside" data-pltdoc="x"><span class="techinside">transactormap</span></a> has been merged.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._goblins/main..rkt)._transactormap-parent))"></a><span title="Provided from: goblins | Package: goblins"><span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._transactormap-parent%29%29" class="RktValDef RktValLink" data-pltdoc="x">transactormap-parent</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">transactormap</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._actormap~3f%29%29" class="RktValLink" data-pltdoc="x">actormap?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">transactormap</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._transactormap~3f%29%29" class="RktValLink" data-pltdoc="x">transactormap?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Returns the parent actormap of this transactormap.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._goblins/main..rkt)._transactormap-delta))"></a><span title="Provided from: goblins | Package: goblins"><span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._transactormap-delta%29%29" class="RktValDef RktValLink" data-pltdoc="x">transactormap-delta</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">transactormap</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym">hasheq?</span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">transactormap</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._transactormap~3f%29%29" class="RktValLink" data-pltdoc="x">transactormap?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Returns the delta of changes to this transactormap.
Mutating this yourself is not prevented but is highly inadvisable.</div></p><h5 x-source-module="(lib &quot;goblins/scribblings/goblins.scrbl&quot;)" x-source-pkg="goblins" x-part-tag="&quot;Snapshotting_and_restoring_actormaps&quot;">3.4.4<tt>&nbsp;</tt><a name="(part._.Snapshotting_and_restoring_actormaps)"></a>Snapshotting and restoring actormaps</h5><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._goblins/main..rkt)._snapshot-whactormap))"></a><span title="Provided from: goblins | Package: goblins"><span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._snapshot-whactormap%29%29" class="RktValDef RktValLink" data-pltdoc="x">snapshot-whactormap</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">whactormap</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym">hasheq?</span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">whactormap</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._whactormap~3f%29%29" class="RktValLink" data-pltdoc="x">whactormap?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Snapshots a whactormap by transforming it into a <span class="RktSym">hasheq?</span>
table mapping <a href="#%28tech._reference%29" class="techoutside" data-pltdoc="x"><span class="techinside">reference</span></a>s to
<a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=ephemerons.html%23%2528tech._ephemeron%2529&amp;version=8.6" class="techoutside Sq" data-pltdoc="x"><span class="techinside">ephemeron</span></a>
wrapped actor handlers.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._goblins/main..rkt)._hasheq-~3ewhactormap))"></a><span title="Provided from: goblins | Package: goblins"><span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._hasheq-~3ewhactormap%29%29" class="RktValDef RktValLink" data-pltdoc="x">hasheq-&gt;whactormap</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">ht</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._whactormap~3f%29%29" class="RktValLink" data-pltdoc="x">whactormap?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">ht</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">hasheq?</span></td></tr></table></blockquote></div><div class="SIntrapara">Restores a <a href="#%28tech._whactormap%29" class="techoutside" data-pltdoc="x"><span class="techinside">whactormap</span></a> from the <span class="RktVar">ht</span> snapshot.</div></p><h5 x-source-module="(lib &quot;goblins/scribblings/goblins.scrbl&quot;)" x-source-pkg="goblins" x-part-tag="&quot;Extra_actormap_procedures&quot;">3.4.5<tt>&nbsp;</tt><a name="(part._.Extra_actormap_procedures)"></a><a name="(mod-path._(submod._goblins/core._actormap-extra))"></a>Extra actormap procedures</h5><p><table cellspacing="0" cellpadding="0" class="defmodule"><tr><td align="left" colspan="2"><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._require%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">require</a></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._submod%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">submod</a></span><span class="stt"> </span><span class="RktSym">goblins/core</span><span class="stt"> </span><span class="RktSym">actormap-extra</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></p><p>These are very low level but can be useful for interrogating an
actormap.</p><p><span style="font-weight: bold">TODO:</span> document.</p><h5 x-source-module="(lib &quot;goblins/scribblings/goblins.scrbl&quot;)" x-source-pkg="goblins" x-part-tag="&quot;Vat_connectors&quot;">3.4.6<tt>&nbsp;</tt><a name="(part._.Vat_connectors)"></a>Vat connectors</h5><p>Somewhat awkwardly named since they most visibly show up in actormaps,
a <a name="(tech._vat._connector)"></a><span style="font-style: italic">vat connector</span> is a procedure (or <span class="RktVal">#f</span>) which is
attached to an actormap.  It serves two purposes:</p><ul><li><p>To tell whether or not two actor references are <a href="#%28tech._near%29" class="techoutside" data-pltdoc="x"><span class="techinside">near</span></a>
each other.
If both share the same <a href="#%28tech._vat._connector%29" class="techoutside" data-pltdoc="x"><span class="techinside">vat connector</span></a>, then they are
considered <a href="#%28tech._near%29" class="techoutside" data-pltdoc="x"><span class="techinside">near</span></a>.<span class="Footnote"><span class="FootnoteRef"><span style="vertical-align: super; font-size: 80%"><a href="#%28counter-%28%29._%28gentag._12._%28lib._goblins%2Fscribblings%2Fgoblins..scrbl%29%29%29" data-pltdoc="x">2</a></span></span><span class="FootnoteContent">There is one case in which this could be misleading: if both
references are spawned in different actormaps that have no
vat connector (ie, it is <span class="RktVal">#f</span>), then they likely
won&rsquo;t appear in each others&rsquo; vats.</span></span></p></li><li><p>In case actors are not near each other, this specifies how to
reach the actor.
The procedure is called to communicate with the remote actormap,
probably by dropping a message into the queue of its vat event
loop.</p></li></ul><p>If you are using <span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._make-actormap%29%29" class="RktValLink" data-pltdoc="x">make-actormap</a></span>, this defaults to <span class="RktVal">#f</span>,
meaning that all other actors that also have no vat connector will
assume they are likewise near.
This of course also means that an actor which <span class="emph">is</span> in a vat will
have no way of communicate with an actor which isn&rsquo;t.</p><p>On the other hand, <a href="#%28tech._vat%29" class="techoutside" data-pltdoc="x"><span class="techinside">vats</span></a> built with
<span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._make-vat%29%29" class="RktValLink" data-pltdoc="x">make-vat</a></span> set up their own vat connectors for you.</p><a name="(part._(gentag._10._(lib._goblins/scribblings/goblins..scrbl)))"></a><p class="FootnoteBlock"><div class="SIntrapara"><p class="FootnoteBlockContent"><span class="FootnoteTarget"><span style="vertical-align: super; font-size: 80%"><a name="(counter-()._(gentag._11._(lib._goblins/scribblings/goblins..scrbl)))"></a>1</span></span>Due to the
<a href="https://en.wikipedia.org/wiki/Halting_problem">halting problem</a>,
this cannot be pre-guaranteed in a turing-complete environment such as
what Goblins runs in.
Actors can indeed go into an infinite loop; in general the security model
of Goblins is to assume that actors in the same <a href="#%28tech._vat%29" class="techoutside" data-pltdoc="x"><span class="techinside">vat</span></a> can
thus "hose their vat" (but really this means, an actormap turn might not
end on its own, and vats currently don&rsquo;t try to stop it).
Pre-emption can be layered manually though when operating on the actormap
directly; if you want to do this, see
<a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=threads.html%23%2528part._threadkill%2529&amp;version=8.6" class="Sq" data-pltdoc="x">Suspending, Resuming, and Killing Threads</a>.</p></div><div class="SIntrapara"><p class="FootnoteBlockContent"><span class="FootnoteTarget"><span style="vertical-align: super; font-size: 80%"><a name="(counter-()._(gentag._12._(lib._goblins/scribblings/goblins..scrbl)))"></a>2</span></span>There is one case in which this could be misleading: if both
references are spawned in different actormaps that have no
vat connector (ie, it is <span class="RktVal">#f</span>), then they likely
won&rsquo;t appear in each others&rsquo; vats.</p></div></p><h4 x-source-module="(lib &quot;goblins/scribblings/goblins.scrbl&quot;)" x-source-pkg="goblins" x-part-tag="&quot;Vats&quot;">3.5<tt>&nbsp;</tt><a name="(part._.Vats)"></a>Vats</h4><p>A <a name="(tech._vat)"></a><span style="font-style: italic">vat</span><span class="Footnote"><span class="FootnoteRef"><span style="vertical-align: super; font-size: 80%"><a href="#%28counter-%28%29._%28gentag._14._%28lib._goblins%2Fscribblings%2Fgoblins..scrbl%29%29%29" data-pltdoc="x">1</a></span></span><span class="FootnoteContent">"Vat" might strike you as a strange name; if so, you&rsquo;re not alone.
The term apparently refers to the musing, "How do you know if you&rsquo;re a
brain in a vat?"
Previously "vat" was called "hive" in Goblins (and its predecessors,
<a href="https://www.gnu.org/software/8sync/">8sync</a> and
<a href="https://xudd.readthedocs.io/en/latest/">XUDD</a>);
it was an independent discovery of the same concept in
<a href="http://www.erights.org/">E</a>.
Initially, Goblins stuck with "hive" because the primary author of
Goblins thought it was a more descriptive term; various ocap people
implored the author to not further fragment ocap vocabulary and so
the term was switched.
Since then, a number of readers of this documentation have complained
that "vat" is confusing, and upon hearing this story have asked for
the term to be switched back.
Whether it&rsquo;s better to avoid naming fragmentation or possibly increase
naming clarity is currently up for debate; your feedback welcome!</span></span>
is an event loop that wraps an <a href="#%28tech._actormap%29" class="techoutside" data-pltdoc="x"><span class="techinside">actormap</span></a>.
In most cases, users will use vats rather than the more low-level
actormaps.</p><p>Actors in vats can communicate with actors in other vats on the same
machine over a <a href="#%28tech._vat._connector%29" class="techoutside" data-pltdoc="x"><span class="techinside">vat connector</span></a>.
For inter-machine communication, see <font class="badlink"><span class="techoutside"><span class="techinside">machines</span></span></font>.
Nonetheless, for the most part users don&rsquo;t need to worry about this
as most inter-vat communication happens using <span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._~3c-%29%29" class="RktValLink" data-pltdoc="x">&lt;-</a></span>.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._goblins/main..rkt)._make-vat))"></a><span title="Provided from: goblins | Package: goblins"><span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._make-vat%29%29" class="RktValDef RktValLink" data-pltdoc="x">make-vat</a></span></span><span class="RktPn"></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=procedures.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._procedure%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">procedure?</a></span></p></blockquote></td></tr></table></blockquote></div><div class="SIntrapara">Starts up a vat event loop.</div></p><p>Returns a procedure that can be invoked to communicate with the vat
(documented below).</p><p>The returned procedure uses symbol-based method dispatch.</p><p>The procedure returned from <span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._make-vat%29%29" class="RktValLink" data-pltdoc="x">make-vat</a></span> is called the
<a name="(tech._vat._dispatcher)"></a><span style="font-style: italic">vat dispatcher</span> and is mostly used for bootstrapping or
otherwise poking at a vat.
Once the actors are bootstrapped in a vat they tend to do their
own thing.</p><p>The <a href="#%28tech._vat._dispatcher%29" class="techoutside" data-pltdoc="x"><span class="techinside">vat dispatcher</span></a> supports the following symbol-dispatched
methods:</p><ul><li><p><span class="RktVal">'</span><span class="RktVal">spawn</span>: Behaves like <span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._spawn%29%29" class="RktValLink" data-pltdoc="x">spawn</a></span> or <span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._actormap-spawn%21%29%29" class="RktValLink" data-pltdoc="x">actormap-spawn!</a></span>.</p></li><li><p><span class="RktVal">'</span><span class="RktVal">run</span>: Behaves like <span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._actormap-run%21%29%29" class="RktValLink" data-pltdoc="x">actormap-run!</a></span></p></li><li><p><span class="RktVal">'</span><span class="RktVal">call</span>: Behaves like <span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._~24%29%29" class="RktValLink" data-pltdoc="x">$</a></span> or <span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._actormap-poke%21%29%29" class="RktValLink" data-pltdoc="x">actormap-poke!</a></span></p></li><li><p><span class="RktVal">'</span><span class="RktVal">is-running?</span>: Is this vat still running?</p></li><li><p><span class="RktVal">'</span><span class="RktVal">halt</span>: Stops the next turn from happening in the vat loop.
Does not terminate the current turn, but maybe it should.</p></li></ul><a name="(part._(gentag._13._(lib._goblins/scribblings/goblins..scrbl)))"></a><p class="FootnoteBlock"><div class="SIntrapara"><p class="FootnoteBlockContent"><span class="FootnoteTarget"><span style="vertical-align: super; font-size: 80%"><a name="(counter-()._(gentag._14._(lib._goblins/scribblings/goblins..scrbl)))"></a>1</span></span>"Vat" might strike you as a strange name; if so, you&rsquo;re not alone.
The term apparently refers to the musing, "How do you know if you&rsquo;re a
brain in a vat?"
Previously "vat" was called "hive" in Goblins (and its predecessors,
<a href="https://www.gnu.org/software/8sync/">8sync</a> and
<a href="https://xudd.readthedocs.io/en/latest/">XUDD</a>);
it was an independent discovery of the same concept in
<a href="http://www.erights.org/">E</a>.
Initially, Goblins stuck with "hive" because the primary author of
Goblins thought it was a more descriptive term; various ocap people
implored the author to not further fragment ocap vocabulary and so
the term was switched.
Since then, a number of readers of this documentation have complained
that "vat" is confusing, and upon hearing this story have asked for
the term to be switched back.
Whether it&rsquo;s better to avoid naming fragmentation or possibly increase
naming clarity is currently up for debate; your feedback welcome!</p></div></p><h4 x-source-module="(lib &quot;goblins/scribblings/goblins.scrbl&quot;)" x-source-pkg="goblins" x-part-tag="&quot;Promises&quot;">3.6<tt>&nbsp;</tt><a name="(part._.Promises)"></a>Promises</h4><p>An eventual send with <span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._~3c-%29%29" class="RktValLink" data-pltdoc="x">&lt;-</a></span> returns a <a name="(tech._promise)"></a><span style="font-style: italic">promise</span>
whose resolution will happen at some future time, either being
<a name="(tech._fulfilled)"></a><span style="font-style: italic">fulfilled</span> or <a name="(tech._broken)"></a><span style="font-style: italic">broken</span>.
Fulfilled promises have resolved to a value, whereas broken promises
have been resolved with an error.</p><p>Every <a href="#%28tech._promise%29" class="techoutside" data-pltdoc="x"><span class="techinside">promise</span></a> has a corresponding <a name="(tech._resolver)"></a><span style="font-style: italic">resolver</span> which is
messaged (often implicitly on completion of a turn)</p><p>It turns out that it is possible to make your own promises using
<span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._spawn-promise-values%29%29" class="RktValLink" data-pltdoc="x">spawn-promise-values</a></span> or <span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._spawn-promise-cons%29%29" class="RktValLink" data-pltdoc="x">spawn-promise-cons</a></span>,
both of which return a <a href="#%28tech._promise%29" class="techoutside" data-pltdoc="x"><span class="techinside">promise</span></a> / <a href="#%28tech._resolver%29" class="techoutside" data-pltdoc="x"><span class="techinside">resolver</span></a> pair.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><table cellspacing="0" cellpadding="0" class="prototype RForeground"><tr><td valign="top"><span class="RktPn">(</span><a name="(def._((lib._goblins/main..rkt)._spawn-promise-values))"></a><span title="Provided from: goblins | Package: goblins"><span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._spawn-promise-values%29%29" class="RktValDef RktValLink" data-pltdoc="x">spawn-promise-values</a></span></span><span class="RktPn"></span><span class="RktPn">)</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">&rarr;</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><table cellspacing="0" cellpadding="0"><tr><td><span class="RktPn">[</span><span class="RktSym">promise</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._live-refr~3f%29%29" class="RktValLink" data-pltdoc="x">live-refr?</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="RktPn">[</span><span class="RktSym">resolver</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._live-refr~3f%29%29" class="RktValLink" data-pltdoc="x">live-refr?</a></span><span class="RktPn">]</span></td></tr></table></td></tr></table></blockquote></td></tr></table></blockquote></div><div class="SIntrapara">Spawns and returns two values to its continuation: a
<span class="RktVal">"promise"</span> and a <span class="RktVal">"resolver"</span>.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._goblins/main..rkt)._spawn-promise-cons))"></a><span title="Provided from: goblins | Package: goblins"><span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._spawn-promise-cons%29%29" class="RktValDef RktValLink" data-pltdoc="x">spawn-promise-cons</a></span></span><span class="RktPn"></span><span class="RktPn">)</span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._cons%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">cons/c</a></span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">promise</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._live-refr~3f%29%29" class="RktValLink" data-pltdoc="x">live-refr?</a></span><span class="RktPn">]</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">resolver</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._live-refr~3f%29%29" class="RktValLink" data-pltdoc="x">live-refr?</a></span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Just like <span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._spawn-promise-values%29%29" class="RktValLink" data-pltdoc="x">spawn-promise-values</a></span> but returns a cons cell of the
<span class="RktVal">"promise"</span>/<span class="RktVal">"resolver"</span> pair rather than returning multiple
values.
This requires an extra allocation (and thus destructuring on the
receiving side) but can be convenient since actors can only return
one value from their message handler at a time.</div></p><p>Promises in Goblins work closer to <a href="http://erights.org/">E</a>
than some other languages like
<a href="https://en.wikipedia.org/wiki/JavaScript">Javascript</a>;
notable exceptions are that <span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._on%29%29" class="RktValLink" data-pltdoc="x">on</a></span> is used rather than
".then() sausages".
Likewise, having a separate resolver object also comes from E.</p><p>One major, but perhaps not very important, difference that may not be
obvious is that once a promise pointed to by a <a href="#%28tech._reference%29" class="techoutside" data-pltdoc="x"><span class="techinside">reference</span></a> is
resolved to something, it for all intents and purposes appears to act
just like that thing.
If the resolution is to a <a href="#%28tech._near%29" class="techoutside" data-pltdoc="x"><span class="techinside">near</span></a> reference, it can even be
immediately called with <span class="RktVal">"$"</span>.
However, you still need to know when you can finally dollar-call such
a thing, thus you still need to use <span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._on%29%29" class="RktValLink" data-pltdoc="x">on</a></span> anyway.</p><h4 x-source-module="(lib &quot;goblins/scribblings/goblins.scrbl&quot;)" x-source-pkg="goblins" x-part-tag="&quot;Detecting_network_failures&quot;">3.7<tt>&nbsp;</tt><a name="(part._.Detecting_network_failures)"></a>Detecting network failures</h4><p>You can detect when a network failure occurs by using
<span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._on-sever%29%29" class="RktValLink" data-pltdoc="x">on-sever</a></span>, which registers a procedure to be notified when a
connection to the remote object goes down.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._goblins/main..rkt)._on-sever))"></a><span title="Provided from: goblins | Package: goblins"><span class="RktSym"><a href="#%28def._%28%28lib._goblins%2Fmain..rkt%29._on-sever%29%29" class="RktValDef RktValLink" data-pltdoc="x">on-sever</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">remote-object-refr</span><span class="hspace">&nbsp;</span><span class="RktVar">sever-handler</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">local-refr?</span></span></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">remote-object-refr</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">remote-refr?</span></span></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">sever-handler</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=function-contracts.html%23%2528form._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._-%7E3e%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">any/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">any/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">any/c</a></span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Inform <span class="RktVar">sever-handler</span> when <span class="RktVar">remote-object-refr</span> might break.
<span class="RktVar">sever-handler</span> is passed two arguments, its</div></p><p>Returns a object which may be messaged to signal future disinterest
in hearing about the severance.</p><p>As of the time of writing, what Goblins does not yet do is notify all
waiting promises that they will not be resolved.  We would like to
handle this properly in the future.</p><div class="navsetbottom"><span class="navleft"><form class="searchform"><input class="searchbox" id="searchbox" type="text" tabindex="1" placeholder="...search manuals..." title="Enter a search string to search the manuals" onkeypress="return DoSearchKey(event, this, &quot;8.6&quot;, &quot;../&quot;);"/></form>&nbsp;&nbsp;<a href="../index-2.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;8.6&quot;);">top</a><span class="tocsettoggle">&nbsp;&nbsp;<a href="javascript:void(0);" title="show/hide table of contents" onclick="TocsetToggle();">contents</a></span></span><span class="navright">&nbsp;&nbsp;<a href="tutorial.html" title="backward to &quot;2 A tutorial&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="index.html" title="up to &quot;Goblins: a transactional, distributed actor model environment&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="actor-lib.html" title="forward to &quot;4 Actor lib: a collection of utilities&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body>
<!-- Mirrored from docs.racket-lang.org/goblins/api.html by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 07 Sep 2022 03:27:03 GMT -->
</html>