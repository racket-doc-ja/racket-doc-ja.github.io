<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- Mirrored from docs.racket-lang.org/crypto/misc.html by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 07 Sep 2022 03:26:23 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><meta name="viewport" content="width=device-width, initial-scale=0.8"/><title>8&nbsp;Miscellaneous Notes</title><link rel="stylesheet" type="text/css" href="../scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="../racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-style.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../doc-site.css" title="default"/><script type="text/javascript" src="../scribble-common.js"></script><script type="text/javascript" src="../manual-racket.js"></script><script type="text/javascript" src="../manual-racket.js"></script><script type="text/javascript" src="../doc-site.js"></script><script type="text/javascript" src="../local-redirect/local-redirect.js"></script><script type="text/javascript" src="../local-redirect/local-user-redirect.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="doc-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9660;</a></td><td></td><td><a href="index.html" class="tocviewlink" data-pltdoc="x">Crypto:<span class="mywbr"> &nbsp;</span> Cryptographic Operations</a></td></tr></table></div><div class="tocviewsublisttop" style="display: block;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="intro.html" class="tocviewlink" data-pltdoc="x">Introduction to the Crypto Library</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="factory.html" class="tocviewlink" data-pltdoc="x">Cryptography Factories</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="digest.html" class="tocviewlink" data-pltdoc="x">Message Digests</a></td></tr><tr><td align="right">4&nbsp;</td><td><a href="cipher.html" class="tocviewlink" data-pltdoc="x">Symmetric Encryption</a></td></tr><tr><td align="right">5&nbsp;</td><td><a href="pk.html" class="tocviewlink" data-pltdoc="x">Public-<wbr></wbr>Key Cryptography</a></td></tr><tr><td align="right">6&nbsp;</td><td><a href="kdf.html" class="tocviewlink" data-pltdoc="x">Key Derivation and Password Hashing</a></td></tr><tr><td align="right">7&nbsp;</td><td><a href="util.html" class="tocviewlink" data-pltdoc="x">Miscellaneous Utilities</a></td></tr><tr><td align="right">8&nbsp;</td><td><a href="#" class="tocviewselflink" data-pltdoc="x">Miscellaneous Notes</a></td></tr></table></div></div><div class="tocviewlist"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_1&quot;);">&#9658;</a></td><td>8&nbsp;</td><td><a href="#" class="tocviewselflink" data-pltdoc="x">Miscellaneous Notes</a></td></tr></table><div class="tocviewsublistbottom" style="display: none;" id="tocview_1"><table cellspacing="0" cellpadding="0"><tr><td align="right">8.1&nbsp;</td><td><a href="#%28part._provider-notes%29" class="tocviewlink" data-pltdoc="x">Notes on Cryptography Providers</a></td></tr></table></div></div></div><div class="tocsub"><div class="tocsubtitle">On this page:</div><table class="tocsublist" cellspacing="0"><tr><td><span class="tocsublinknumber">8.1<tt>&nbsp;</tt></span><a href="#%28part._provider-notes%29" class="tocsubseclink" data-pltdoc="x">Notes on Cryptography Providers</a></td></tr><tr><td><span class="tocsublinknumber">8.1.1<tt>&nbsp;</tt></span><a href="#%28part._random%29" class="tocsubseclink" data-pltdoc="x">CSPRNG Initialization</a></td></tr><tr><td><span class="tocsublinknumber">8.1.2<tt>&nbsp;</tt></span><a href="#%28part._libcrypto-notes%29" class="tocsubseclink" data-pltdoc="x">Libcrypto Quirks</a></td></tr><tr><td><span class="tocsublinknumber">8.1.3<tt>&nbsp;</tt></span><a href="#%28part._gcrypt-notes%29" class="tocsubseclink" data-pltdoc="x">GCrypt Quirks</a></td></tr><tr><td><span class="tocsublinknumber">8.1.4<tt>&nbsp;</tt></span><a href="#%28part._sodium-notes%29" class="tocsubseclink" data-pltdoc="x">Sodium Quirks</a></td></tr></table></div></div><div class="maincolumn"><div class="main"><div class="navsettop"><span class="navleft"><form class="searchform"><input class="searchbox" id="searchbox" type="text" tabindex="1" placeholder="...search manuals..." title="Enter a search string to search the manuals" onkeypress="return DoSearchKey(event, this, &quot;8.6&quot;, &quot;../&quot;);"/></form>&nbsp;&nbsp;<a href="../index-2.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;8.6&quot;);">top</a><span class="tocsettoggle">&nbsp;&nbsp;<a href="javascript:void(0);" title="show/hide table of contents" onclick="TocsetToggle();">contents</a></span></span><span class="navright">&nbsp;&nbsp;<a href="util.html" title="backward to &quot;7 Miscellaneous Utilities&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="index.html" title="up to &quot;Crypto: Cryptographic Operations&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<span class="nonavigation">next &rarr;</span></span>&nbsp;</div><h3 x-source-module="(lib &quot;crypto/scribblings/crypto.scrbl&quot;)" x-source-pkg="crypto-doc" x-part-tag="&quot;misc&quot;">8<tt>&nbsp;</tt><a name="(part._misc)"></a>Miscellaneous Notes</h3><h4 x-source-module="(lib &quot;crypto/scribblings/crypto.scrbl&quot;)" x-source-pkg="crypto-doc" x-part-tag="&quot;provider-notes&quot;">8.1<tt>&nbsp;</tt><a name="(part._provider-notes)"></a>Notes on Cryptography Providers</h4><h5 x-source-module="(lib &quot;crypto/scribblings/crypto.scrbl&quot;)" x-source-pkg="crypto-doc" x-part-tag="&quot;random&quot;">8.1.1<tt>&nbsp;</tt><a name="(part._random)"></a>CSPRNG Initialization</h5><p>Some cryptographic operations require a source of cryptographically
secure pseudo-random numbers. Some of these, such as
<span class="RktSym"><a href="cipher.html#%28def._%28%28lib._crypto%2Fmain..rkt%29._generate-cipher-key%29%29" class="RktValLink" data-pltdoc="x">generate-cipher-key</a></span>, are handled at the Racket level and use
<span class="RktSym"><a href="util.html#%28def._%28%28lib._crypto%2Fmain..rkt%29._crypto-random-bytes%29%29" class="RktValLink" data-pltdoc="x">crypto-random-bytes</a></span>. Other operations, such as
<span class="RktSym"><a href="pk.html#%28def._%28%28lib._crypto%2Fmain..rkt%29._generate-private-key%29%29" class="RktValLink" data-pltdoc="x">generate-private-key</a></span>, RSA signing with PSS padding, and many
more, use the crypto provider&rsquo;s internal CSPRNG. This section contains
notes on crypto providers&rsquo; CSPRNG initialization.</p><p><span style="font-weight: bold">libcrypto</span> The libcrypto foreign library automatically seeds its
CSPRNG using entropy obtained from the operating system
(<a href="https://wiki.openssl.org/index.php/Random_Numbers">as
described here</a>).</p><p><span style="font-weight: bold">gcrypt</span> The libgcrypt foreign library seems to perform some
default CSPRNG initialization, but I don&rsquo;t know the details.</p><p><span style="font-weight: bold">nettle</span> The <a href="index.html" class="RktModLink" data-pltdoc="x"><span class="RktSym">crypto</span></a> library creates a Yarrow-256
instance and seeds it with entropy obtained from
<span class="RktSym"><a href="util.html#%28def._%28%28lib._crypto%2Fmain..rkt%29._crypto-random-bytes%29%29" class="RktValLink" data-pltdoc="x">crypto-random-bytes</a></span>. The instance is reseeded when a certain
number of entropy-consuming operations have been performed since the
last reseed.</p><h5 x-source-module="(lib &quot;crypto/scribblings/crypto.scrbl&quot;)" x-source-pkg="crypto-doc" x-part-tag="&quot;libcrypto-notes&quot;">8.1.2<tt>&nbsp;</tt><a name="(part._libcrypto-notes)"></a>Libcrypto Quirks</h5><p>PSS padding for RSA signatures is, in principle, parameterized by the
salt length. A standard choice is the length of the digest to be
signed. By default, libcrypto uses the maximum possible salt length
when signing and infers the salt length when verifying, as documented
for <a href="https://www.openssl.org/docs/manmaster/man3/EVP_PKEY_CTX_set_rsa_pss_saltlen.html">EVP_PKEY_CTX_set_rsa_pss_saltlen</a>.
See also <a href="https://crypto.stackexchange.com/questions/1217/rsa-pss-salt-size">this
discussion</a>. Unfortunately, other libraries do not directly support this behavior and it is nontrivial to work around it.
Thus for greater compatibility, this library defines <span class="RktVal">'</span><span class="RktVal">pss</span>
padding to use the digest length and <span class="RktVal">'</span><span class="RktVal">pss*</span> to be the
libcrypto-specific behavior.</p><h5 x-source-module="(lib &quot;crypto/scribblings/crypto.scrbl&quot;)" x-source-pkg="crypto-doc" x-part-tag="&quot;gcrypt-notes&quot;">8.1.3<tt>&nbsp;</tt><a name="(part._gcrypt-notes)"></a>GCrypt Quirks</h5><p>If ECDSA is used with a digest longer than the bit-length of the
curve, gcrypt either fails to correctly truncate the digest or
otherwise handles it by default in a way incompatible with libcrypto
and nettle. Consequently, this library truncates the digest before
passing it to gcrypt for signing.</p><p>GCrypt does not expose operations to compute EC and EdDSA public keys
from the private keys, so reading a private key in PrivateKeyInfo or
OneAsymmetricKey form may fail if the optional public key field is
missing.</p><h5 x-source-module="(lib &quot;crypto/scribblings/crypto.scrbl&quot;)" x-source-pkg="crypto-doc" x-part-tag="&quot;sodium-notes&quot;">8.1.4<tt>&nbsp;</tt><a name="(part._sodium-notes)"></a>Sodium Quirks</h5><p>Sodium provides only &ldquo;all-at-once&rdquo; encryption and decryption
functions. Consequently, encryption and decryption contexts using
sodium ciphers produce no output until <span class="RktSym"><a href="cipher.html#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-final%29%29" class="RktValLink" data-pltdoc="x">cipher-final</a></span> is
called.</p><div class="navsetbottom"><span class="navleft"><form class="searchform"><input class="searchbox" id="searchbox" type="text" tabindex="1" placeholder="...search manuals..." title="Enter a search string to search the manuals" onkeypress="return DoSearchKey(event, this, &quot;8.6&quot;, &quot;../&quot;);"/></form>&nbsp;&nbsp;<a href="../index-2.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;8.6&quot;);">top</a><span class="tocsettoggle">&nbsp;&nbsp;<a href="javascript:void(0);" title="show/hide table of contents" onclick="TocsetToggle();">contents</a></span></span><span class="navright">&nbsp;&nbsp;<a href="util.html" title="backward to &quot;7 Miscellaneous Utilities&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="index.html" title="up to &quot;Crypto: Cryptographic Operations&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<span class="nonavigation">next &rarr;</span></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body>
<!-- Mirrored from docs.racket-lang.org/crypto/misc.html by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 07 Sep 2022 03:26:23 GMT -->
</html>