<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- Mirrored from docs.racket-lang.org/crypto/pk.html by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 07 Sep 2022 03:26:23 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><meta name="viewport" content="width=device-width, initial-scale=0.8"/><title>5&nbsp;Public-Key Cryptography</title><link rel="stylesheet" type="text/css" href="../scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="../racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-style.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../doc-site.css" title="default"/><script type="text/javascript" src="../scribble-common.js"></script><script type="text/javascript" src="../manual-racket.js"></script><script type="text/javascript" src="../manual-racket.js"></script><script type="text/javascript" src="../doc-site.js"></script><script type="text/javascript" src="../local-redirect/local-redirect.js"></script><script type="text/javascript" src="../local-redirect/local-user-redirect.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="doc-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9660;</a></td><td></td><td><a href="index.html" class="tocviewlink" data-pltdoc="x">Crypto:<span class="mywbr"> &nbsp;</span> Cryptographic Operations</a></td></tr></table></div><div class="tocviewsublisttop" style="display: block;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="intro.html" class="tocviewlink" data-pltdoc="x">Introduction to the Crypto Library</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="factory.html" class="tocviewlink" data-pltdoc="x">Cryptography Factories</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="digest.html" class="tocviewlink" data-pltdoc="x">Message Digests</a></td></tr><tr><td align="right">4&nbsp;</td><td><a href="cipher.html" class="tocviewlink" data-pltdoc="x">Symmetric Encryption</a></td></tr><tr><td align="right">5&nbsp;</td><td><a href="#" class="tocviewselflink" data-pltdoc="x">Public-<wbr></wbr>Key Cryptography</a></td></tr><tr><td align="right">6&nbsp;</td><td><a href="kdf.html" class="tocviewlink" data-pltdoc="x">Key Derivation and Password Hashing</a></td></tr><tr><td align="right">7&nbsp;</td><td><a href="util.html" class="tocviewlink" data-pltdoc="x">Miscellaneous Utilities</a></td></tr><tr><td align="right">8&nbsp;</td><td><a href="misc.html" class="tocviewlink" data-pltdoc="x">Miscellaneous Notes</a></td></tr></table></div></div><div class="tocviewlist"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_1&quot;);">&#9658;</a></td><td>5&nbsp;</td><td><a href="#" class="tocviewselflink" data-pltdoc="x">Public-<wbr></wbr>Key Cryptography</a></td></tr></table><div class="tocviewsublistbottom" style="display: none;" id="tocview_1"><table cellspacing="0" cellpadding="0"><tr><td align="right">5.1&nbsp;</td><td><a href="#%28part._pk-keys%29" class="tocviewlink" data-pltdoc="x">PK Keys and Parameters</a></td></tr><tr><td align="right">5.2&nbsp;</td><td><a href="#%28part._pk-sign%29" class="tocviewlink" data-pltdoc="x">PK Signatures</a></td></tr><tr><td align="right">5.3&nbsp;</td><td><a href="#%28part._pk-encrypt%29" class="tocviewlink" data-pltdoc="x">PK Encryption</a></td></tr><tr><td align="right">5.4&nbsp;</td><td><a href="#%28part._pk-keyagree%29" class="tocviewlink" data-pltdoc="x">PK Key Agreement</a></td></tr><tr><td align="right">5.5&nbsp;</td><td><a href="#%28part._pk-external%29" class="tocviewlink" data-pltdoc="x">PK External Representations</a></td></tr><tr><td align="right">5.6&nbsp;</td><td><a href="#%28part._pkcs8%29" class="tocviewlink" data-pltdoc="x">PKCS #8 Encrypted Private Keys</a></td></tr><tr><td align="right"></td><td><a href="#%28part._pk-bibliography%29" class="tocviewlink" data-pltdoc="x">Bibliography</a></td></tr></table></div></div></div><div class="tocsub"><div class="tocsubtitle">On this page:</div><table class="tocsublist" cellspacing="0"><tr><td><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-spec~3f%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">pk-<wbr></wbr>spec?</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-impl~3f%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">pk-<wbr></wbr>impl?</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._get-pk%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">get-<wbr></wbr>pk</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-can-sign~3f%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">pk-<wbr></wbr>can-<wbr></wbr>sign?</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-can-encrypt~3f%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">pk-<wbr></wbr>can-<wbr></wbr>encrypt?</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-can-key-agree~3f%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">pk-<wbr></wbr>can-<wbr></wbr>key-<wbr></wbr>agree?</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-has-parameters~3f%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">pk-<wbr></wbr>has-<wbr></wbr>parameters?</span></span></a></td></tr><tr><td><span class="tocsublinknumber">5.1<tt>&nbsp;</tt></span><a href="#%28part._pk-keys%29" class="tocsubseclink" data-pltdoc="x">PK Keys and Parameters</a></td></tr><tr><td><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-key~3f%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">pk-<wbr></wbr>key?</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._private-key~3f%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">private-<wbr></wbr>key?</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._public-only-key~3f%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">public-<wbr></wbr>only-<wbr></wbr>key?</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-parameters~3f%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">pk-<wbr></wbr>parameters?</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-key-~3eparameters%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">pk-<wbr></wbr>key-<wbr></wbr>&gt;parameters</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-security-strength%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">pk-<wbr></wbr>security-<wbr></wbr>strength</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._public-key~3d~3f%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">public-<wbr></wbr>key=?</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-key-~3epublic-only-key%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">pk-<wbr></wbr>key-<wbr></wbr>&gt;public-<wbr></wbr>only-<wbr></wbr>key</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._generate-pk-parameters%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">generate-<wbr></wbr>pk-<wbr></wbr>parameters</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._generate-private-key%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">generate-<wbr></wbr>private-<wbr></wbr>key</span></span></a></td></tr><tr><td><span class="tocsublinknumber">5.2<tt>&nbsp;</tt></span><a href="#%28part._pk-sign%29" class="tocsubseclink" data-pltdoc="x">PK Signatures</a></td></tr><tr><td><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-sign%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">pk-<wbr></wbr>sign</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-verify%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">pk-<wbr></wbr>verify</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._digest%2Fsign%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">digest/<span class="mywbr"> &nbsp;</span>sign</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._digest%2Fverify%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">digest/<span class="mywbr"> &nbsp;</span>verify</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-sign-digest%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">pk-<wbr></wbr>sign-<wbr></wbr>digest</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-verify-digest%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">pk-<wbr></wbr>verify-<wbr></wbr>digest</span></span></a></td></tr><tr><td><span class="tocsublinknumber">5.3<tt>&nbsp;</tt></span><a href="#%28part._pk-encrypt%29" class="tocsubseclink" data-pltdoc="x">PK Encryption</a></td></tr><tr><td><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-encrypt%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">pk-<wbr></wbr>encrypt</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-decrypt%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">pk-<wbr></wbr>decrypt</span></span></a></td></tr><tr><td><span class="tocsublinknumber">5.4<tt>&nbsp;</tt></span><a href="#%28part._pk-keyagree%29" class="tocsubseclink" data-pltdoc="x">PK Key Agreement</a></td></tr><tr><td><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-derive-secret%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">pk-<wbr></wbr>derive-<wbr></wbr>secret</span></span></a></td></tr><tr><td><span class="tocsublinknumber">5.5<tt>&nbsp;</tt></span><a href="#%28part._pk-external%29" class="tocsubseclink" data-pltdoc="x">PK External Representations</a></td></tr><tr><td><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-key-~3edatum%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">pk-<wbr></wbr>key-<wbr></wbr>&gt;datum</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._datum-~3epk-key%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">datum-<wbr></wbr>&gt;pk-<wbr></wbr>key</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-parameters-~3edatum%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">pk-<wbr></wbr>parameters-<wbr></wbr>&gt;datum</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._datum-~3epk-parameters%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">datum-<wbr></wbr>&gt;pk-<wbr></wbr>parameters</span></span></a></td></tr><tr><td><span class="tocsublinknumber">5.6<tt>&nbsp;</tt></span><a href="#%28part._pkcs8%29" class="tocsubseclink" data-pltdoc="x">PKCS #8 Encrypted Private Keys</a></td></tr><tr><td><a href="#%28def._%28%28lib._crypto%2Fpkcs8..rkt%29._pkcs8-encrypt%2Fpbkdf2-hmac%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">pkcs8-<wbr></wbr>encrypt/<span class="mywbr"> &nbsp;</span>pbkdf2-<wbr></wbr>hmac</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._crypto%2Fpkcs8..rkt%29._pkcs8-encrypt%2Fscrypt%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">pkcs8-<wbr></wbr>encrypt/<span class="mywbr"> &nbsp;</span>scrypt</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._crypto%2Fpkcs8..rkt%29._pkcs8-decrypt-bytes%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">pkcs8-<wbr></wbr>decrypt-<wbr></wbr>bytes</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._crypto%2Fpkcs8..rkt%29._pkcs8-decrypt-key%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">pkcs8-<wbr></wbr>decrypt-<wbr></wbr>key</span></span></a></td></tr><tr><td><span class="tocsublinknumber"></span><a href="#%28part._pk-bibliography%29" class="tocsubseclink" data-pltdoc="x">Bibliography</a></td></tr></table></div></div><div class="maincolumn"><div class="main"><div class="navsettop"><span class="navleft"><form class="searchform"><input class="searchbox" id="searchbox" type="text" tabindex="1" placeholder="...search manuals..." title="Enter a search string to search the manuals" onkeypress="return DoSearchKey(event, this, &quot;8.6&quot;, &quot;../&quot;);"/></form>&nbsp;&nbsp;<a href="../index-2.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;8.6&quot;);">top</a><span class="tocsettoggle">&nbsp;&nbsp;<a href="javascript:void(0);" title="show/hide table of contents" onclick="TocsetToggle();">contents</a></span></span><span class="navright">&nbsp;&nbsp;<a href="cipher.html" title="backward to &quot;4 Symmetric Encryption&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="index.html" title="up to &quot;Crypto: Cryptographic Operations&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="kdf.html" title="forward to &quot;6 Key Derivation and Password Hashing&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div><h3 x-source-module="(lib &quot;crypto/scribblings/crypto.scrbl&quot;)" x-source-pkg="crypto-doc" x-part-tag="&quot;pk&quot;">5<tt>&nbsp;</tt><a name="(part._pk)"></a>Public-Key Cryptography</h3><p>Public-key (PK) cryptography covers operations such as
<a href="#%28part._pk-sign%29" data-pltdoc="x">signing</a>, <a href="#%28part._pk-encrypt%29" data-pltdoc="x">encryption</a>, and
<a href="#%28part._pk-keyagree%29" data-pltdoc="x">key agreement</a> between parties that do not
start with any shared secrets. Instead of shared secrets, each party
possesses a keypair consisting of a secret private key and a
widely-published public key. Not all PK cryptosystems support all PK
operations (for example, DSA does not support encryption or secret
derivation), and some PK implementations may support a subset of a PK
cryptosystem&rsquo;s potential operations.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._crypto/main..rkt)._pk-spec~3f))"></a><span title="Provided from: crypto | Package: crypto-lib"><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-spec~3f%29%29" class="RktValDef RktValLink" data-pltdoc="x">pk-spec?</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">v</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=booleans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._boolean%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">boolean?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">v</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">any/c</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Returns <span class="RktVal">#t</span> if <span class="RktVar">v</span> is a PK cryptosystem specifier,
<span class="RktVal">#f</span> otherwise.</div></p><p>A PK cryptosystem specifies the information represented by the public and
private keys and the algorithms that operate on that information. The
following PK systems are supported:</p><ul><li><p><span class="RktVal">'</span><span class="RktVal">rsa</span> &#8212;<wbr></wbr> <a name="(idx._(gentag._2._(lib._crypto/scribblings/crypto..scrbl)))"></a>RSA keys with RSAES-* encryption
and RSASSA-* signing [<a href="#%28cite._.P.K.C.S1%29" data-pltdoc="x">PKCS1</a>].</p></li><li><p><span class="RktVal">'</span><span class="RktVal">dsa</span> &#8212;<wbr></wbr> <a name="(idx._(gentag._3._(lib._crypto/scribblings/crypto..scrbl)))"></a>DSA keys with DSA signing.</p></li><li><p><span class="RktVal">'</span><span class="RktVal">dh</span> &#8212;<wbr></wbr> <a name="(idx._(gentag._4._(lib._crypto/scribblings/crypto..scrbl)))"></a>Diffie-Hellman key agreement using
modular integer arithmetic [<a href="#%28cite._.R.F.C2631%29" data-pltdoc="x">RFC2631</a>].</p></li><li><p><span class="RktVal">'</span><span class="RktVal">ec</span> &#8212;<wbr></wbr> Elliptic curve keys with <a name="(idx._(gentag._5._(lib._crypto/scribblings/crypto..scrbl)))"></a>ECDSA
signing and <a name="(idx._(gentag._6._(lib._crypto/scribblings/crypto..scrbl)))"></a>ECDH key agreement [<a href="#%28cite._.S.E.C1%29" data-pltdoc="x">SEC1</a>]. Only named
curves are supported, and different implementations support different
curves; use <span class="RktSym"><a href="factory.html#%28def._%28%28lib._crypto%2Fmain..rkt%29._factory-print-info%29%29" class="RktValLink" data-pltdoc="x">factory-print-info</a></span> to see supported curves.</p></li><li><p><span class="RktVal">'</span><span class="RktVal">eddsa</span> &#8212;<wbr></wbr> Edwards curve keys with <a name="(idx._(gentag._7._(lib._crypto/scribblings/crypto..scrbl)))"></a>EdDSA signing,
specifically <a name="(idx._(gentag._8._(lib._crypto/scribblings/crypto..scrbl)))"></a>Ed25519 and <a name="(idx._(gentag._9._(lib._crypto/scribblings/crypto..scrbl)))"></a>Ed448.</p></li><li><p><span class="RktVal">'</span><span class="RktVal">ecx</span> &#8212;<wbr></wbr> Montgomery curve keys with ECDH key agreement,
specifically <a name="(idx._(gentag._10._(lib._crypto/scribblings/crypto..scrbl)))"></a>X25519 and <a name="(idx._(gentag._11._(lib._crypto/scribblings/crypto..scrbl)))"></a>X448.</p></li></ul><p class="SHistory">Changed in version 1.1 of package <span class="stt">crypto-lib</span>: Added <span class="RktVal">'</span><span class="RktVal">eddsa</span> and <span class="RktVal">'</span><span class="RktVal">ecx</span>.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._crypto/main..rkt)._pk-impl~3f))"></a><span title="Provided from: crypto | Package: crypto-lib"><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-impl~3f%29%29" class="RktValDef RktValLink" data-pltdoc="x">pk-impl?</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">v</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=booleans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._boolean%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">boolean?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">v</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">any/c</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Returns <span class="RktVal">#t</span> if <span class="RktVar">v</span> is a PK cryptosystem implementation,
<span class="RktVal">#f</span> otherwise.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._crypto/main..rkt)._get-pk))"></a><span title="Provided from: crypto | Package: crypto-lib"><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._get-pk%29%29" class="RktValDef RktValLink" data-pltdoc="x">get-pk</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">pki</span><span class="hspace">&nbsp;</span><span class="RktVar">factories</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-impl~3f%29%29" class="RktValLink" data-pltdoc="x">pk-impl?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">pki</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-spec~3f%29%29" class="RktValLink" data-pltdoc="x">pk-spec?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">factories</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="factory.html#%28def._%28%28lib._crypto%2Fmain..rkt%29._crypto-factory~3f%29%29" class="RktValLink" data-pltdoc="x">crypto-factory?</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._listof%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">listof</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="factory.html#%28def._%28%28lib._crypto%2Fmain..rkt%29._crypto-factory~3f%29%29" class="RktValLink" data-pltdoc="x">crypto-factory?</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Returns an implementation of PK algorithm <span class="RktVar">pki</span> from the given
<span class="RktVar">factories</span>. If no factory in <span class="RktVar">factories</span> implements
<span class="RktVar">pki</span>, returns <span class="RktVal">#f</span>.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><table cellspacing="0" cellpadding="0" class="together"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._crypto/main..rkt)._pk-can-sign~3f))"></a><span title="Provided from: crypto | Package: crypto-lib"><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-can-sign~3f%29%29" class="RktValDef RktValLink" data-pltdoc="x">pk-can-sign?</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">pk</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=booleans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._boolean%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">boolean?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">pk</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-impl~3f%29%29" class="RktValLink" data-pltdoc="x">pk-impl?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-key~3f%29%29" class="RktValLink" data-pltdoc="x">pk-key?</a></span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="together"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._crypto/main..rkt)._pk-can-encrypt~3f))"></a><span title="Provided from: crypto | Package: crypto-lib"><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-can-encrypt~3f%29%29" class="RktValDef RktValLink" data-pltdoc="x">pk-can-encrypt?</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">pk</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=booleans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._boolean%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">boolean?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">pk</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-impl~3f%29%29" class="RktValLink" data-pltdoc="x">pk-impl?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-key~3f%29%29" class="RktValLink" data-pltdoc="x">pk-key?</a></span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="together"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._crypto/main..rkt)._pk-can-key-agree~3f))"></a><span title="Provided from: crypto | Package: crypto-lib"><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-can-key-agree~3f%29%29" class="RktValDef RktValLink" data-pltdoc="x">pk-can-key-agree?</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">pk</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=booleans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._boolean%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">boolean?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">pk</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-impl~3f%29%29" class="RktValLink" data-pltdoc="x">pk-impl?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-key~3f%29%29" class="RktValLink" data-pltdoc="x">pk-key?</a></span><span class="RktPn">)</span></td></tr></table></td></tr></table></blockquote></div><div class="SIntrapara">Indicates whether the cryptosystem implementation <span class="RktVar">pk</span> (or the
implementation corresponding to <span class="RktVar">pk</span>, if <span class="RktVar">pk</span> is a key)
supports signing, encryption, and key agreement, respectively.</div></p><p>Note that the functions only report the capabilities of the
cryptosystem implementation, regardless of the limitations of
<span class="RktVar">pk</span> if <span class="RktVar">pk</span> is a key. For example,
<span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-can-sign~3f%29%29" class="RktValLink" data-pltdoc="x">pk-can-sign?</a></span><span class="stt"> </span><span class="RktVar">pk</span><span class="RktPn">)</span> would return true when <span class="RktVar">pk</span> is an
RSA public-only key, even though signing requires a private key.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._crypto/main..rkt)._pk-has-parameters~3f))"></a><span title="Provided from: crypto | Package: crypto-lib"><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-has-parameters~3f%29%29" class="RktValDef RktValLink" data-pltdoc="x">pk-has-parameters?</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">pk</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=booleans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._boolean%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">boolean?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">pk</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-impl~3f%29%29" class="RktValLink" data-pltdoc="x">pk-impl?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-key~3f%29%29" class="RktValLink" data-pltdoc="x">pk-key?</a></span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Returns <span class="RktVal">#f</span> if the PK cryptosystem represented by <span class="RktVar">pk</span>
uses key parameters, <span class="RktVal">#f</span> otherwise. See <a href="#%28part._pk-keys%29" data-pltdoc="x">PK Keys and Parameters</a> for
more information.</div></p><h4 x-source-module="(lib &quot;crypto/scribblings/crypto.scrbl&quot;)" x-source-pkg="crypto-doc" x-part-tag="&quot;pk-keys&quot;">5.1<tt>&nbsp;</tt><a name="(part._pk-keys)"></a>PK Keys and Parameters</h4><p>A PK keypair consists of public key component and private key
components. A public key is a key that contains the public key
components. In this library, a private key contains both private and
public components, so it can also be used wherever a public key is
required. That is, every private key is also a public key. This
library uses the term &ldquo;public-only key&rdquo; to refer to a public key
that is not a private key.</p><p>In some PK cryptosystems, the public components are further divided
into key-specific values and &ldquo;key parameters.&rdquo; Key parameters are
public quantities that are expensive to compute; they can be generated
once and many keypairs can use the same parameter values. For example,
a DSA key requires a large prime with certain relatively rare
mathematical properties, and so finding such a prime is relatively
expensive, but once a suitable prime is found, generating private keys
is relatively fast, and since the prime is public, many keypairs can
use the same prime. Elliptic curve (EC) cryptography is another
example: the key parameter is the curve equation, and the public and
private key components are points on the curve. In contrast, RSA does
not have key parameters; simple quantities like the size of an RSA
modulus are not key parameters.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._crypto/main..rkt)._pk-key~3f))"></a><span title="Provided from: crypto | Package: crypto-lib"><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-key~3f%29%29" class="RktValDef RktValLink" data-pltdoc="x">pk-key?</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">v</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=booleans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._boolean%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">boolean?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">v</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">any/c</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Returns <span class="RktVal">#t</span> if <span class="RktVar">v</span> is a public key or a private key,
<span class="RktVal">#f</span> otherwise. Since all PK keys contain the public key
components, <span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-key~3f%29%29" class="RktValLink" data-pltdoc="x">pk-key?</a></span> is a predicate for public keys.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._crypto/main..rkt)._private-key~3f))"></a><span title="Provided from: crypto | Package: crypto-lib"><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._private-key~3f%29%29" class="RktValDef RktValLink" data-pltdoc="x">private-key?</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">v</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=booleans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._boolean%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">boolean?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">v</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">any/c</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Returns <span class="RktVal">#t</span> if <span class="RktVar">v</span> is a private key.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._crypto/main..rkt)._public-only-key~3f))"></a><span title="Provided from: crypto | Package: crypto-lib"><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._public-only-key~3f%29%29" class="RktValDef RktValLink" data-pltdoc="x">public-only-key?</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">v</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=booleans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._boolean%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">boolean?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">v</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">any/c</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Returns <span class="RktVal">#t</span> if <span class="RktVar">v</span> is a public key but not a private
key, <span class="RktVal">#f</span> otherwise. Equivalent to <span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=if.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fletstx-scheme..rkt%2529._and%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">and</a></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-key~3f%29%29" class="RktValLink" data-pltdoc="x">pk-key?</a></span><span class="stt"> </span><span class="RktVar">v</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=booleans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._not%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">not</a></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._private-key~3f%29%29" class="RktValLink" data-pltdoc="x">private-key?</a></span><span class="stt"> </span><span class="RktVar">v</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span>.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._crypto/main..rkt)._pk-parameters~3f))"></a><span title="Provided from: crypto | Package: crypto-lib"><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-parameters~3f%29%29" class="RktValDef RktValLink" data-pltdoc="x">pk-parameters?</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">v</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=booleans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._boolean%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">boolean?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">v</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">any/c</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Returns <span class="RktVal">#t</span> if <span class="RktVar">v</span> is a value representing PK key
parameters for some cryptosystem, <span class="RktVal">#f</span> otherwise.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._crypto/main..rkt)._pk-key-~3eparameters))"></a><span title="Provided from: crypto | Package: crypto-lib"><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-key-~3eparameters%29%29" class="RktValDef RktValLink" data-pltdoc="x">pk-key-&gt;parameters</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">pk</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-parameters~3f%29%29" class="RktValLink" data-pltdoc="x">pk-parameters?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">pk</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-key~3f%29%29" class="RktValLink" data-pltdoc="x">pk-key?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Returns a value representing the key parameters of <span class="RktVar">pk</span>, or
<span class="RktVal">#f</span> if <span class="RktVar">pk</span>&rsquo;s cryptosystem does not use key parameters.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._crypto/main..rkt)._pk-security-strength))"></a><span title="Provided from: crypto | Package: crypto-lib"><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-security-strength%29%29" class="RktValDef RktValLink" data-pltdoc="x">pk-security-strength</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">pk</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="util.html#%28def._%28%28lib._crypto%2Fmain..rkt%29._security-strength%2Fc%29%29" class="RktValLink" data-pltdoc="x">security-strength/c</a></span><span class="RktPn">)</span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">pk</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-key~3f%29%29" class="RktValLink" data-pltdoc="x">pk-key?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-parameters~3f%29%29" class="RktValLink" data-pltdoc="x">pk-parameters?</a></span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Returns the <a href="util.html#%28tech._security._strength%29" class="techoutside" data-pltdoc="x"><span class="techinside">security strength</span></a> rating for the given PK key or
parameters. If <span class="RktVar">pk</span> does not support strength calculation,
<span class="RktVal">#f</span> is returned.</div></p><p class="SHistory">Added in version 1.8 of package <span class="stt">crypto-lib</span>.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._crypto/main..rkt)._public-key~3d~3f))"></a><span title="Provided from: crypto | Package: crypto-lib"><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._public-key~3d~3f%29%29" class="RktValDef RktValLink" data-pltdoc="x">public-key=?</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">pk1</span><span class="hspace">&nbsp;</span><span class="RktVar">pk2</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=booleans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._boolean%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">boolean?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">pk1</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-key~3f%29%29" class="RktValLink" data-pltdoc="x">pk-key?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">pk2</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-key~3f%29%29" class="RktValLink" data-pltdoc="x">pk-key?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Returns <span class="RktVal">#t</span> if the public key components of <span class="RktVar">pk1</span> and
<span class="RktVar">pk2</span> are equal, <span class="RktVal">#f</span> otherwise. One use of this
function is to check whether a private key matches some public-only
key.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._crypto/main..rkt)._pk-key-~3epublic-only-key))"></a><span title="Provided from: crypto | Package: crypto-lib"><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-key-~3epublic-only-key%29%29" class="RktValDef RktValLink" data-pltdoc="x">pk-key-&gt;public-only-key</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">pk</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._public-only-key~3f%29%29" class="RktValLink" data-pltdoc="x">public-only-key?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">pk</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-key~3f%29%29" class="RktValLink" data-pltdoc="x">pk-key?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Returns a public-only key <span class="RktVar">pub-pk</span> such that
<span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._public-key~3d~3f%29%29" class="RktValLink" data-pltdoc="x">public-key=?</a></span><span class="stt"> </span><span class="RktVar">pk</span><span class="stt"> </span><span class="RktVar">pub-pk</span><span class="RktPn">)</span>. If <span class="RktVar">pk</span> is already a
public-only key, the function may simply return <span class="RktVar">pk</span>.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><table cellspacing="0" cellpadding="0" class="prototype RForeground"><tr><td valign="top"><span class="RktPn">(</span><a name="(def._((lib._crypto/main..rkt)._generate-pk-parameters))"></a><span title="Provided from: crypto | Package: crypto-lib"><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._generate-pk-parameters%29%29" class="RktValDef RktValLink" data-pltdoc="x">generate-pk-parameters</a></span></span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">pki</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span><span class="RktOpt">[</span></td><td valign="top"><span class="RktVar">paramgen-config</span><span class="RktOpt">]</span><span class="RktPn">)</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">&rarr;</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-parameters~3f%29%29" class="RktValLink" data-pltdoc="x">pk-parameters?</a></span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">pki</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-spec~3f%29%29" class="RktValLink" data-pltdoc="x">pk-spec?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-impl~3f%29%29" class="RktValLink" data-pltdoc="x">pk-impl?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">paramgen-config</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._listof%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">listof</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._list%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">list/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=symbols.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._symbol%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">symbol?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">any/c</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Generate PK parameter values for the cryptosystem of <span class="RktVar">pki</span>
using the given configuration options. The default values of optional
configuration arguments are implementation-dependent.</div></p><p><div class="SIntrapara">The acceptable configuration values depend on <span class="RktVar">pki</span>.
</div><div class="SIntrapara"><ul><li><p><div class="SIntrapara">The following configuration values are recognized for DSA
(<span class="RktVal">'</span><span class="RktVal">dsa</span>):
</div><div class="SIntrapara"><ul><li><p><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._list%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">list</a></span><span class="stt"> </span><span class="RktVal">'</span><span class="RktVal">nbits</span><span class="stt"> </span><span class="RktVar">nbits</span><span class="RktPn">)</span> &#8212;<wbr></wbr> Optional. Generate a prime
modulus of size <span class="RktVar">nbits</span>. Examples include <span class="RktVal">1024</span> and
<span class="RktVal">2048</span>.</p></li></ul></div></p></li><li><p><div class="SIntrapara">The following configuration values are recognized for DH
(<span class="RktVal">'</span><span class="RktVal">dh</span>):
</div><div class="SIntrapara"><ul><li><p><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._list%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">list</a></span><span class="stt"> </span><span class="RktVal">'</span><span class="RktVal">nbits</span><span class="stt"> </span><span class="RktVar">nbits</span><span class="RktPn">)</span> &#8212;<wbr></wbr> Optional. Generate a prime
modulus of size <span class="RktVar">nbits</span>. Examples include <span class="RktVal">1024</span> and
<span class="RktVal">2048</span>.</p></li><li><p><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._list%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">list</a></span><span class="stt"> </span><span class="RktVal">'</span><span class="RktVal">generator</span><span class="stt"> </span><span class="RktVar">generator</span><span class="RktPn">)</span> &#8212;<wbr></wbr> Optional. Use the
given <span class="RktVar">generator</span>; must be either <span class="RktVal">2</span> or <span class="RktVal">5</span>.</p></li></ul></div></p></li><li><p><div class="SIntrapara">The following configuration values are recognized for EC
(<span class="RktVal">'</span><span class="RktVal">ec</span>):
</div><div class="SIntrapara"><ul><li><p><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._list%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">list</a></span><span class="stt"> </span><span class="RktVal">'</span><span class="RktVal">curve</span><span class="stt"> </span><span class="RktVar">curve-name</span><span class="RktPn">)</span> &#8212;<wbr></wbr> Required. Use the standard curve
named <span class="RktVar">curve-name</span>. Examples include <span class="RktVal">"NIST P-256"</span> and
<span class="RktVal">"secp192r1"</span>. Use <span class="RktSym"><a href="factory.html#%28def._%28%28lib._crypto%2Fmain..rkt%29._factory-print-info%29%29" class="RktValLink" data-pltdoc="x">factory-print-info</a></span> to show available curves.</p></li></ul></div></p></li><li><p><div class="SIntrapara">The following configuration values are recognized for EdDSA
(<span class="RktVal">'</span><span class="RktVal">eddsa</span>):
</div><div class="SIntrapara"><ul><li><p><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._list%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">list</a></span><span class="stt"> </span><span class="RktVal">'</span><span class="RktVal">curve</span><span class="stt"> </span><span class="RktVar">curve-sym</span><span class="RktPn">)</span> &#8212;<wbr></wbr> Required. Generate a key
for the given curve. The <span class="RktVar">curve-sym</span> must be <span class="RktVal">'</span><span class="RktVal">ed25519</span>
or <span class="RktVal">'</span><span class="RktVal">ed448</span>.</p></li></ul></div></p></li><li><p><div class="SIntrapara">The following configuration values are recognized for <span class="RktVal">'</span><span class="RktVal">ecx</span>:
</div><div class="SIntrapara"><ul><li><p><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._list%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">list</a></span><span class="stt"> </span><span class="RktVal">'</span><span class="RktVal">curve</span><span class="stt"> </span><span class="RktVar">curve-sym</span><span class="RktPn">)</span> &#8212;<wbr></wbr> Required. Generate a key
for the given curve. The <span class="RktVar">curve-sym</span> must be <span class="RktVal">'</span><span class="RktVal">x25519</span>
or <span class="RktVal">'</span><span class="RktVal">x448</span>.</p></li></ul></div></p></li></ul></div></p><p class="SHistory">Changed in version 1.1 of package <span class="stt">crypto-lib</span>: Added <span class="RktVal">'</span><span class="RktVal">eddsa</span> and <span class="RktVal">'</span><span class="RktVal">ecx</span> options.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._crypto/main..rkt)._generate-private-key))"></a><span title="Provided from: crypto | Package: crypto-lib"><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._generate-private-key%29%29" class="RktValDef RktValLink" data-pltdoc="x">generate-private-key</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">pki</span><span class="hspace">&nbsp;</span><span class="RktOpt">[</span><span class="RktVar">keygen-config</span><span class="RktOpt">]</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._private-key~3f%29%29" class="RktValLink" data-pltdoc="x">private-key?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">pki</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-spec~3f%29%29" class="RktValLink" data-pltdoc="x">pk-spec?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-impl~3f%29%29" class="RktValLink" data-pltdoc="x">pk-impl?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-parameters~3f%29%29" class="RktValLink" data-pltdoc="x">pk-parameters?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">keygen-config</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._listof%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">listof</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._list%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">list/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=symbols.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._symbol%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">symbol?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">any/c</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Generate a private key from the given PK implementation or PK
parameters. The default values of optional configuration arguments are
implementation dependent.</div></p><p><div class="SIntrapara">The accepted configuration arguments depend on <span class="RktVar">pki</span>:
</div><div class="SIntrapara"><ul><li><p>If <span class="RktVar">pki</span> is a PK parameters object (<span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-parameters~3f%29%29" class="RktValLink" data-pltdoc="x">pk-parameters?</a></span>),
then <span class="RktVar">keygen-config</span> must be empty.</p></li><li><p><div class="SIntrapara">The following configuration values are recognized for RSA
(<span class="RktVal">'</span><span class="RktVal">rsa</span>):
</div><div class="SIntrapara"><ul><li><p><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._list%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">list</a></span><span class="stt"> </span><span class="RktVal">'</span><span class="RktVal">nbits</span><span class="stt"> </span><span class="RktVar">nbits</span><span class="RktPn">)</span> &#8212;<wbr></wbr> Optional. Generate a modulus
of size <span class="RktVar">nbits</span>. Examples include <span class="RktVal">1024</span> and
<span class="RktVal">2048</span>.</p></li></ul></div></p></li><li><p>If <span class="RktVar">pki</span> is a PK specifier (<span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-spec~3f%29%29" class="RktValLink" data-pltdoc="x">pk-spec?</a></span>) or PK
implementation (<span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-impl~3f%29%29" class="RktValLink" data-pltdoc="x">pk-impl?</a></span>), then the same configuration
arguments are supported as for <span class="RktSym">generate-parameters</span>. This is
equivalent to <span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._generate-private-key%29%29" class="RktValLink" data-pltdoc="x">generate-private-key</a></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._generate-pk-parameters%29%29" class="RktValLink" data-pltdoc="x">generate-pk-parameters</a></span><span class="stt"> </span><span class="RktVar">pki</span><span class="stt"> </span><span class="RktVar">keygen-config</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">)</span><span class="RktPn">)</span>.</p></li></ul></div></p><h4 x-source-module="(lib &quot;crypto/scribblings/crypto.scrbl&quot;)" x-source-pkg="crypto-doc" x-part-tag="&quot;pk-sign&quot;">5.2<tt>&nbsp;</tt><a name="(part._pk-sign)"></a>PK Signatures</h4><p>In PK signing, the sender uses their own private key to sign a
message; any other party can verify the sender&rsquo;s signature using the
sender&rsquo;s public key.</p><p>In RSA, DSA, and ECDSA, only short messages can be signed directly (limits are
generally proportional to the size of the keys), so a typical process is to
compute a digest of the message and sign the digest. The message and digest
signature are sent together, possibly with additional data.</p><p>In EdDSA, messages are signed directly. (The signing process computes a message
digest internally.)</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._crypto/main..rkt)._pk-sign))"></a><span title="Provided from: crypto | Package: crypto-lib"><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-sign%29%29" class="RktValDef RktValLink" data-pltdoc="x">pk-sign</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">pk</span><span class="hspace">&nbsp;</span><span class="RktVar">msg</span><span class="hspace">&nbsp;</span><span class="RktOpt">[</span><span class="RktPn">#:pad</span><span class="hspace">&nbsp;</span><span class="RktVar">padding</span><span class="hspace">&nbsp;</span><span class="RktPn">#:digest</span><span class="hspace">&nbsp;</span><span class="RktVar">dspec</span><span class="RktOpt">]</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=bytestrings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._bytes%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">bytes?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">pk</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._private-key~3f%29%29" class="RktValLink" data-pltdoc="x">private-key?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">msg</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=bytestrings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._bytes%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">bytes?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">padding</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">pkcs1-v1.5</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">pss</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">pss*</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#f</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">dspec</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="digest.html#%28def._%28%28lib._crypto%2Fmain..rkt%29._digest-spec~3f%29%29" class="RktValLink" data-pltdoc="x">digest-spec?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">none</span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#f</span></td></tr></table></blockquote></div><div class="SIntrapara">Returns the signature using the private key <span class="RktVar">pk</span> of the message
<span class="RktVar">msg</span>.</div></p><p><div class="SIntrapara">If <span class="RktVar">pk</span> is an RSA private key, then <span class="RktVar">padding</span> must be
one of the following:
</div><div class="SIntrapara"><ul><li><p><span class="RktVal">'</span><span class="RktVal">pkcs1-v1.5</span> or <span class="RktVal">#f</span> &#8212;<wbr></wbr> use PKCS#1-v1.5 padding</p></li><li><p><span class="RktVal">'</span><span class="RktVal">pss</span> &#8212;<wbr></wbr> use PSS padding with a salt length equal to
<span class="RktPn">(</span><span class="RktSym"><a href="digest.html#%28def._%28%28lib._crypto%2Fmain..rkt%29._digest-size%29%29" class="RktValLink" data-pltdoc="x">digest-size</a></span><span class="stt"> </span><span class="RktSym">di</span><span class="RktPn">)</span></p></li><li><p><span class="RktVal">'</span><span class="RktVal">pss*</span> &#8212;<wbr></wbr> sign using PSS padding with a salt length
equal to <span class="RktPn">(</span><span class="RktSym"><a href="digest.html#%28def._%28%28lib._crypto%2Fmain..rkt%29._digest-size%29%29" class="RktValLink" data-pltdoc="x">digest-size</a></span><span class="stt"> </span><span class="RktSym">di</span><span class="RktPn">)</span>, but infer the salt length when
verifying</p></li></ul></div><div class="SIntrapara">For all other cryptosystems, <span class="RktVar">padding</span> must be <span class="RktVal">#f</span>.</div></p><p>If <span class="RktVar">pk</span> is an RSA private key, then <span class="RktVar">dspec</span> must be the name
of a digest algorithm, and <span class="RktVar">msg</span> must be a digest computed with
<span class="RktVar">dspec</span> (in particular, it must have the correct size for
<span class="RktVar">dspec</span>). The resulting signature depends on the identity of the
digest algorithm. Different RSA implementations may support different digest
algorithms.</p><p>If <span class="RktVar">pk</span> is a DSA or EC private key, the signature does not depend on
the digest algorithm; the <span class="RktVar">dspec</span> should be omitted. (For backwards
compatibility, the <span class="RktVar">dspec</span> argument is accepted, but it has no effect
other than checking the length of <span class="RktVar">msg</span>.)</p><p>If <span class="RktVar">pk</span> is a EdDSA private key, then <span class="RktVar">dspec</span> must be
<span class="RktVal">#f</span> or <span class="RktVal">'</span><span class="RktVal">none</span> (both values mean the same thing). The message
may be of any length, and the EdDSA signature is computed. Future versions
of this library may accept other values of <span class="RktVar">dspec</span> and compute
HashEdDSA signatures (eg, Ed25519ph) in reponse.</p><p class="SHistory">Added in version 1.1 of package <span class="stt">crypto-lib</span>.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><table cellspacing="0" cellpadding="0" class="prototype RForeground"><tr><td valign="top"><span class="RktPn">(</span><a name="(def._((lib._crypto/main..rkt)._pk-verify))"></a><span title="Provided from: crypto | Package: crypto-lib"><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-verify%29%29" class="RktValDef RktValLink" data-pltdoc="x">pk-verify</a></span></span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">pk</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">msg</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">sig</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span><span class="RktOpt">[</span></td><td valign="top"><span class="RktPn">#:digest</span><span class="hspace">&nbsp;</span><span class="RktVar">dspec</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:pad</span><span class="hspace">&nbsp;</span><span class="RktVar">padding</span><span class="RktOpt">]</span><span class="RktPn">)</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">&rarr;</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=booleans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._boolean%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">boolean?</a></span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">pk</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-key~3f%29%29" class="RktValLink" data-pltdoc="x">pk-key?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">msg</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=bytestrings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._bytes%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">bytes?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">sig</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=bytestrings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._bytes%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">bytes?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">dspec</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="digest.html#%28def._%28%28lib._crypto%2Fmain..rkt%29._digest-spec~3f%29%29" class="RktValLink" data-pltdoc="x">digest-spec?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">none</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#f</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">padding</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">pkcs1-v1.5</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">pss</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#f</span></td></tr></table></blockquote></div><div class="SIntrapara">Returns <span class="RktVal">#t</span> if <span class="RktVar">pk</span> verifies that <span class="RktVar">sig</span> is a valid
signature of the message <span class="RktVar">msg</span>, or <span class="RktVal">#f</span> if the signature is
invalid.</div></p><p>The <span class="RktVar">dspec</span> and <span class="RktVar">padding</span> arguments have the same meanings as
for <span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-sign%29%29" class="RktValLink" data-pltdoc="x">pk-sign</a></span>.</p><p class="SHistory">Added in version 1.1 of package <span class="stt">crypto-lib</span>.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><table cellspacing="0" cellpadding="0" class="together"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._crypto/main..rkt)._digest/sign))"></a><span title="Provided from: crypto | Package: crypto-lib"><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._digest%2Fsign%29%29" class="RktValDef RktValLink" data-pltdoc="x">digest/sign</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">pk</span><span class="hspace">&nbsp;</span><span class="RktVar">di</span><span class="hspace">&nbsp;</span><span class="RktVar">input</span><span class="hspace">&nbsp;</span><span class="RktOpt">[</span><span class="RktPn">#:pad</span><span class="hspace">&nbsp;</span><span class="RktVar">padding</span><span class="RktOpt">]</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=bytestrings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._bytes%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">bytes?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">pk</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._private-key~3f%29%29" class="RktValLink" data-pltdoc="x">private-key?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">di</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="digest.html#%28def._%28%28lib._crypto%2Fmain..rkt%29._digest-spec~3f%29%29" class="RktValLink" data-pltdoc="x">digest-spec?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="digest.html#%28def._%28%28lib._crypto%2Fmain..rkt%29._digest-impl~3f%29%29" class="RktValLink" data-pltdoc="x">digest-impl?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">input</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="util.html#%28def._%28%28lib._crypto%2Fmain..rkt%29._input%2Fc%29%29" class="RktValLink" data-pltdoc="x">input/c</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">padding</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">pkcs1-v1.5</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">pss</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#f</span></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="together"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._crypto/main..rkt)._digest/verify))"></a><span title="Provided from: crypto | Package: crypto-lib"><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._digest%2Fverify%29%29" class="RktValDef RktValLink" data-pltdoc="x">digest/verify</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">pk</span><span class="hspace">&nbsp;</span><span class="RktVar">di</span><span class="hspace">&nbsp;</span><span class="RktVar">input</span><span class="hspace">&nbsp;</span><span class="RktVar">sig</span><span class="hspace">&nbsp;</span><span class="RktOpt">[</span><span class="RktPn">#:pad</span><span class="hspace">&nbsp;</span><span class="RktVar">padding</span><span class="RktOpt">]</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=booleans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._boolean%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">boolean?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">pk</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-key~3f%29%29" class="RktValLink" data-pltdoc="x">pk-key?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">di</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="digest.html#%28def._%28%28lib._crypto%2Fmain..rkt%29._digest-spec~3f%29%29" class="RktValLink" data-pltdoc="x">digest-spec?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="digest.html#%28def._%28%28lib._crypto%2Fmain..rkt%29._digest-impl~3f%29%29" class="RktValLink" data-pltdoc="x">digest-impl?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">input</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="util.html#%28def._%28%28lib._crypto%2Fmain..rkt%29._input%2Fc%29%29" class="RktValLink" data-pltdoc="x">input/c</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">sig</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=bytestrings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._bytes%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">bytes?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">padding</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">pkcs1-v1.5</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">pss</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#f</span></td></tr></table></td></tr></table></blockquote></div><div class="SIntrapara">Computes or verifies signature of the <span class="RktVar">di</span> message digest of
<span class="RktVar">input</span>; equivalent to calling <span class="RktSym"><a href="digest.html#%28def._%28%28lib._crypto%2Fmain..rkt%29._digest%29%29" class="RktValLink" data-pltdoc="x">digest</a></span> then
<span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-sign-digest%29%29" class="RktValLink" data-pltdoc="x">pk-sign-digest</a></span> or <span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-verify-digest%29%29" class="RktValLink" data-pltdoc="x">pk-verify-digest</a></span>, respectively.</div></p><p>Do not use these functions with EdDSA keys; use <span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-sign%29%29" class="RktValLink" data-pltdoc="x">pk-sign</a></span> and
<span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-verify%29%29" class="RktValLink" data-pltdoc="x">pk-verify</a></span> directly on the messages. (This library currently does
not support pre-hashing EdDSA variants, eg Ed25519ph.)</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><table cellspacing="0" cellpadding="0" class="together"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._crypto/main..rkt)._pk-sign-digest))"></a><span title="Provided from: crypto | Package: crypto-lib"><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-sign-digest%29%29" class="RktValDef RktValLink" data-pltdoc="x">pk-sign-digest</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">pk</span><span class="hspace">&nbsp;</span><span class="RktVar">di</span><span class="hspace">&nbsp;</span><span class="RktVar">dgst</span><span class="hspace">&nbsp;</span><span class="RktOpt">[</span><span class="RktPn">#:pad</span><span class="hspace">&nbsp;</span><span class="RktVar">padding</span><span class="RktOpt">]</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=bytestrings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._bytes%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">bytes?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">pk</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._private-key~3f%29%29" class="RktValLink" data-pltdoc="x">private-key?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">di</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="digest.html#%28def._%28%28lib._crypto%2Fmain..rkt%29._digest-spec~3f%29%29" class="RktValLink" data-pltdoc="x">digest-spec?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="digest.html#%28def._%28%28lib._crypto%2Fmain..rkt%29._digest-impl~3f%29%29" class="RktValLink" data-pltdoc="x">digest-impl?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">dgst</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=bytestrings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._bytes%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">bytes?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">padding</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">pkcs1-v1.5</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">pss</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">pss*</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#f</span></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="together"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><table cellspacing="0" cellpadding="0" class="prototype RForeground"><tr><td valign="top"><span class="RktPn">(</span><a name="(def._((lib._crypto/main..rkt)._pk-verify-digest))"></a><span title="Provided from: crypto | Package: crypto-lib"><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-verify-digest%29%29" class="RktValDef RktValLink" data-pltdoc="x">pk-verify-digest</a></span></span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">pk</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">di</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">dgst</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">sig</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span><span class="RktOpt">[</span></td><td valign="top"><span class="RktPn">#:pad</span><span class="hspace">&nbsp;</span><span class="RktVar">padding</span><span class="RktOpt">]</span><span class="RktPn">)</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">&rarr;</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=booleans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._boolean%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">boolean?</a></span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">pk</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-key~3f%29%29" class="RktValLink" data-pltdoc="x">pk-key?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">di</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="digest.html#%28def._%28%28lib._crypto%2Fmain..rkt%29._digest-spec~3f%29%29" class="RktValLink" data-pltdoc="x">digest-spec?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="digest.html#%28def._%28%28lib._crypto%2Fmain..rkt%29._digest-impl~3f%29%29" class="RktValLink" data-pltdoc="x">digest-impl?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">dgst</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=bytestrings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._bytes%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">bytes?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">sig</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=bytestrings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._bytes%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">bytes?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">padding</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">pkcs1-v1.5</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">pss</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#f</span></td></tr></table></td></tr></table></blockquote></div><div class="SIntrapara">Equivalent to <span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-sign%29%29" class="RktValLink" data-pltdoc="x">pk-sign</a></span><span class="stt"> </span><span class="RktVar">pk</span><span class="stt"> </span><span class="RktVar">dgst</span><span class="stt"> </span><span class="RktPn">#:digest</span><span class="stt"> </span><span class="RktVar">di</span><span class="stt"> </span><span class="RktPn">#:pad</span><span class="stt"> </span><span class="RktVar">padding</span><span class="RktPn">)</span> and
<span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-verify%29%29" class="RktValLink" data-pltdoc="x">pk-verify</a></span><span class="stt"> </span><span class="RktVar">pk</span><span class="stt"> </span><span class="RktVar">dgst</span><span class="stt"> </span><span class="RktVar">sig</span><span class="stt"> </span><span class="RktPn">#:digest</span><span class="stt"> </span><span class="RktVar">di</span><span class="stt"> </span><span class="RktPn">#:pad</span><span class="stt"> </span><span class="RktVar">padding</span><span class="RktPn">)</span>, respectively.</div></p><h4 x-source-module="(lib &quot;crypto/scribblings/crypto.scrbl&quot;)" x-source-pkg="crypto-doc" x-part-tag="&quot;pk-encrypt&quot;">5.3<tt>&nbsp;</tt><a name="(part._pk-encrypt)"></a>PK Encryption</h4><p>In PK encryption, the sender uses the public key of the intended
receiver to encrypt a message; the receiver decrypts the message with
the receiver&rsquo;s own private key. Only short messages can be directly
encrypted using PK cryptosystems (limits are generally proportional to
the size of the PK keys), so a typical approach is to encrypt the
message using a symmetric cipher with a randomly-generated key
(sometimes called the bulk encryption key) and encrypt that key using
PK cryptography. The symmetric-key-encrypted message and PK-encrypted
symmetric key are sent together, perhaps with additional data such as
a MAC. PK encryption is supported by the RSA cryptosystem.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><table cellspacing="0" cellpadding="0" class="together"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._crypto/main..rkt)._pk-encrypt))"></a><span title="Provided from: crypto | Package: crypto-lib"><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-encrypt%29%29" class="RktValDef RktValLink" data-pltdoc="x">pk-encrypt</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">pk</span><span class="hspace">&nbsp;</span><span class="RktVar">msg</span><span class="hspace">&nbsp;</span><span class="RktOpt">[</span><span class="RktPn">#:pad</span><span class="hspace">&nbsp;</span><span class="RktVar">padding</span><span class="RktOpt">]</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=bytestrings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._bytes%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">bytes?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">pk</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-key~3f%29%29" class="RktValLink" data-pltdoc="x">pk-key?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">msg</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=bytestrings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._bytes%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">bytes?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">padding</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">pkcs1-v1.5</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">oaep</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#f</span></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="together"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._crypto/main..rkt)._pk-decrypt))"></a><span title="Provided from: crypto | Package: crypto-lib"><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-decrypt%29%29" class="RktValDef RktValLink" data-pltdoc="x">pk-decrypt</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">pk</span><span class="hspace">&nbsp;</span><span class="RktVar">msg</span><span class="hspace">&nbsp;</span><span class="RktOpt">[</span><span class="RktPn">#:pad</span><span class="hspace">&nbsp;</span><span class="RktVar">padding</span><span class="RktOpt">]</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=bytestrings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._bytes%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">bytes?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">pk</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._private-key~3f%29%29" class="RktValLink" data-pltdoc="x">private-key?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">msg</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=bytestrings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._bytes%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">bytes?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">padding</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">pkcs1-v1.5</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">oaep</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#f</span></td></tr></table></td></tr></table></blockquote></div><div class="SIntrapara">Encrypt or decrypt, respectively, the message <span class="RktVar">msg</span> using PK
key <span class="RktVar">pk</span>.</div></p><p>If <span class="RktVar">pk</span> is an RSA key, then <span class="RktVar">padding</span> choses between
PKCS#1-v1.5 padding and OAEP padding [<a href="#%28cite._.P.K.C.S1%29" data-pltdoc="x">PKCS1</a>]. If <span class="RktVar">padding</span>
is <span class="RktVal">#f</span>, then an implementation-dependent mode is chosen. For
all other cryptosystems, <span class="RktVar">padding</span> must be <span class="RktVal">#f</span>.</p><p>If <span class="RktVar">msg</span> is too large to encrypt using <span class="RktVar">pk</span>, then an
exception is raised.</p><h4 x-source-module="(lib &quot;crypto/scribblings/crypto.scrbl&quot;)" x-source-pkg="crypto-doc" x-part-tag="&quot;pk-keyagree&quot;">5.4<tt>&nbsp;</tt><a name="(part._pk-keyagree)"></a>PK Key Agreement</h4><p>In PK <a name="(idx._(gentag._12._(lib._crypto/scribblings/crypto..scrbl)))"></a>key agreement (sometimes called <a name="(idx._(gentag._13._(lib._crypto/scribblings/crypto..scrbl)))"></a>key
exchange or <a name="(idx._(gentag._14._(lib._crypto/scribblings/crypto..scrbl)))"></a>Diffie-Hellman) two parties derive a shared
secret by exchanging public keys. Each party can compute the secret
from their own private key and the other&rsquo;s public key, but it is
believed infeasible for an observer to compute the secret from the two
public keys alone. PK secret derivation is supported by the
<span class="RktVal">'</span><span class="RktVal">dh</span>, <span class="RktVal">'</span><span class="RktVal">ec</span>, and <span class="RktVal">'</span><span class="RktVal">ecx</span> cryptosystems.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._crypto/main..rkt)._pk-derive-secret))"></a><span title="Provided from: crypto | Package: crypto-lib"><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-derive-secret%29%29" class="RktValDef RktValLink" data-pltdoc="x">pk-derive-secret</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">pk</span><span class="hspace">&nbsp;</span><span class="RktVar">peer-pk</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=bytestrings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._bytes%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">bytes?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">pk</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._private-key~3f%29%29" class="RktValLink" data-pltdoc="x">private-key?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">peer-pk</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-key~3f%29%29" class="RktValLink" data-pltdoc="x">pk-key?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=bytestrings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._bytes%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">bytes?</a></span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Returns the shared secret derived from the private key <span class="RktVar">pk</span> and
the public key <span class="RktVar">peer-pk</span>. If <span class="RktVar">peer-pk</span> is a PK key, it
must be a key compatible with <span class="RktVar">pk</span> (same algorithm and same
parameters); otherwise an exception is raised. If <span class="RktVar">peer-pk</span> is
a bytestring, an exception is raised if it cannot be interpreted as
raw public key data.</div></p><p>Note that the derived secret is a deterministic function of the
private keys: if two parties perform secret derivation twice, they
will produce the same secret both times. In addition, the secret is
not uniformly distributed. For these reasons, the derived secret
should not be used directly as a key; instead, it should be used to
generate key material using a key-derivation function (see
<span class="RktSym"><a href="kdf.html#%28def._%28%28lib._crypto%2Fmain..rkt%29._kdf%29%29" class="RktValLink" data-pltdoc="x">kdf</a></span>).</p><h4 x-source-module="(lib &quot;crypto/scribblings/crypto.scrbl&quot;)" x-source-pkg="crypto-doc" x-part-tag="&quot;pk-external&quot;">5.5<tt>&nbsp;</tt><a name="(part._pk-external)"></a>PK External Representations</h4><p>This section describes serialization of public and private keys in
various formats. See also <a href="#%28part._pkcs8%29" data-pltdoc="x">PKCS #8 Encrypted Private Keys</a>.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._crypto/main..rkt)._pk-key-~3edatum))"></a><span title="Provided from: crypto | Package: crypto-lib"><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-key-~3edatum%29%29" class="RktValDef RktValLink" data-pltdoc="x">pk-key-&gt;datum</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">pk</span><span class="hspace">&nbsp;</span><span class="RktVar">fmt</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._printable%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">printable/c</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">pk</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-key~3f%29%29" class="RktValLink" data-pltdoc="x">pk-key?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">fmt</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=symbols.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._symbol%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">symbol?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Returns a datum representing the key <span class="RktVar">pk</span>, where the encoding
is selected by <span class="RktVar">fmt</span>. Unless noted below, the result is a
bytestring (<span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=bytestrings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._bytes%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">bytes?</a></span>). The following <span class="RktVar">fmt</span> options are
supported:</div></p><ul><li><p><span class="RktVal">'</span><span class="RktVal">SubjectPublicKeyInfo</span> &#8212;<wbr></wbr> DER-encoded
SubjectPublicKeyInfo [<a href="#%28cite._.P.K.I.X%29" data-pltdoc="x">PKIX</a>] representation of the public part
of <span class="RktVar">pk</span>. All key types are supported, and an identifier for the
key type is embedded in the encoding.</p><p>For compatibility with OpenSSL, DH keys are encoded using the PKCS #3
identifier and parameters [<a href="#%28cite._.P.K.C.S3%29" data-pltdoc="x">PKCS3</a>] rather than those specified by
[<a href="#%28cite._.P.K.I.X-.Alg.Id%29" data-pltdoc="x">PKIX-AlgId</a>], and EdDSA keys are encoded using the algorithm
identifiers specified in [<a href="#%28cite._.P.K.I.X-.Ed.C%29" data-pltdoc="x">PKIX-EdC</a>].</p></li><li><p><span class="RktVal">'</span><span class="RktVal">PrivateKeyInfo</span> &#8212;<wbr></wbr> DER-encoded PrivateKeyInfo
[<a href="#%28cite._.P.K.C.S8%29" data-pltdoc="x">PKCS8</a>] representation of <span class="RktVar">pk</span>, which must be a private
key. All key types are supported, and an identifier for the key type
is embedded in the encoding.</p><p>For DSA, DH, and EdDSA keys, the PrivateKeyInfo (version 1) format does not
store derived public-key fields. Some implementations (eg GCrypt) do not
expose the ability to recompute the public key, so they may not be able to
read such keys. See also <span class="RktVal">'</span><span class="RktVal">OneAsymmetricKey</span>.</p></li><li><p><span class="RktVal">'</span><span class="RktVal">OneAsymmetricKey</span> &#8212;<wbr></wbr> DER-encoded OneAsymmetricKey
[<a href="#%28cite._.A.K.P%29" data-pltdoc="x">AKP</a>] representation of <span class="RktVar">pk</span>, which must be a private
key. OneAsymmetricKey is essentially PrivateKeyInfo version 2; it adds an
optional field for the public key. Prefer OneAsymmetricKey for storing DSA,
DH, and EdDSA keys.</p></li><li><p><span class="RktVal">'</span><span class="RktVal">RSAPrivateKey</span> &#8212;<wbr></wbr> DER-encoded RSAPrivateKey
[<a href="#%28cite._.P.K.C.S1%29" data-pltdoc="x">PKCS1</a>] representation of <span class="RktVar">pk</span>, which must be an RSA
private key.</p></li><li><p><span class="RktVal">'</span><span class="RktVal">age/v1-private</span> &#8212;<wbr></wbr> String encoded in the
<a href="https://age-encryption.org/v1">age-encryption (v1)</a> format,
representing an X25519 private key. The string is Bech32-encoded and has 74
characters beginning with <span class="RktInBG"><span class="hspace"></span><span class="RktIn">AGE-SECRET-KEY-1</span><span class="hspace"></span></span>.</p></li><li><p><span class="RktVal">'</span><span class="RktVal">age/v1-public</span> &#8212;<wbr></wbr> String encoded in the
<a href="https://age-encryption.org/v1">age-encryption (v1)</a> format,
representing an X25519 public key. The string is Bech32-encoded and has 62
characters beginning with <span class="RktInBG"><span class="hspace"></span><span class="RktIn">age1</span><span class="hspace"></span></span>.</p></li><li><p><span class="RktVal">'</span><span class="RktVal">openssh-public</span> &#8212;<wbr></wbr> A string containing an OpenSSH-format public
key. The string starts with a tag such as <span class="RktInBG"><span class="hspace"></span><span class="RktIn">ssh-rsa</span><span class="hspace"></span></span> or
<span class="RktInBG"><span class="hspace"></span><span class="RktIn">ssh-ed25519</span><span class="hspace"></span></span>, then contains the key data encoded in Base64. Only RSA,
Ed25519, and Ed448 public keys are currently supported.</p></li><li><p><span class="RktVal">'</span><span class="RktVal">rkt-private</span> &#8212;<wbr></wbr> An S-expression of one of the following forms:</p><ul><li><p><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._list%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">list</a></span><span class="stt"> </span><span class="RktVal">'</span><span class="RktVal">rsa</span><span class="stt"> </span><span class="RktVal">'</span><span class="RktVal">private</span><span class="stt"> </span><span class="RktVar">n</span><span class="stt"> </span><span class="RktVar">e</span><span class="stt"> </span><span class="RktVar">d</span><span class="RktPn">)</span></p></li><li><p><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._list%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">list</a></span><span class="stt"> </span><span class="RktVal">'</span><span class="RktVal">dsa</span><span class="stt"> </span><span class="RktVal">'</span><span class="RktVal">private</span><span class="stt"> </span><span class="RktVar">p</span><span class="stt"> </span><span class="RktVar">q</span><span class="stt"> </span><span class="RktVar">g</span><span class="stt"> </span><span class="RktVar">y</span><span class="stt"> </span><span class="RktVar">d</span><span class="RktPn">)</span></p></li><li><p><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._list%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">list</a></span><span class="stt"> </span><span class="RktVal">'</span><span class="RktVal">dh</span><span class="stt"> </span><span class="RktVal">'</span><span class="RktVal">private</span><span class="stt"> </span><span class="RktVar">p</span><span class="stt"> </span><span class="RktVar">g</span><span class="stt"> </span><span class="RktVar">y</span><span class="stt"> </span><span class="RktVar">x</span><span class="RktPn">)</span></p></li><li><p><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._list%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">list</a></span><span class="stt"> </span><span class="RktVal">'</span><span class="RktVal">ec</span><span class="stt"> </span><span class="RktVal">'</span><span class="RktVal">private</span><span class="stt"> </span><span class="RktVar">curve-oid</span><span class="stt"> </span><span class="RktVar">q-bytes</span><span class="stt"> </span><span class="RktVar">x</span><span class="RktPn">)</span></p></li><li><p><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._list%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">list</a></span><span class="stt"> </span><span class="RktVal">'</span><span class="RktVal">eddsa</span><span class="stt"> </span><span class="RktVal">'</span><span class="RktVal">private</span><span class="stt"> </span><span class="RktVar">curve-sym</span><span class="stt"> </span><span class="RktVar">q-bytes</span><span class="stt"> </span><span class="RktVar">d-bytes</span><span class="RktPn">)</span></p></li><li><p><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._list%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">list</a></span><span class="stt"> </span><span class="RktVal">'</span><span class="RktVal">ecx</span><span class="stt"> </span><span class="RktVal">'</span><span class="RktVal">private</span><span class="stt"> </span><span class="RktVar">curve-sym</span><span class="stt"> </span><span class="RktVar">q-bytes</span><span class="stt"> </span><span class="RktVar">d-bytes</span><span class="RktPn">)</span></p></li></ul></li><li><p><span class="RktVal">'</span><span class="RktVal">rkt-public</span> &#8212;<wbr></wbr> An S-expression of one of the following forms:</p><ul><li><p><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._list%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">list</a></span><span class="stt"> </span><span class="RktVal">'</span><span class="RktVal">rsa</span><span class="stt"> </span><span class="RktVal">'</span><span class="RktVal">public</span><span class="stt"> </span><span class="RktVar">n</span><span class="stt"> </span><span class="RktVar">e</span><span class="RktPn">)</span></p></li><li><p><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._list%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">list</a></span><span class="stt"> </span><span class="RktVal">'</span><span class="RktVal">dsa</span><span class="stt"> </span><span class="RktVal">'</span><span class="RktVal">public</span><span class="stt"> </span><span class="RktVar">p</span><span class="stt"> </span><span class="RktVar">q</span><span class="stt"> </span><span class="RktVar">g</span><span class="stt"> </span><span class="RktVar">y</span><span class="RktPn">)</span></p></li><li><p><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._list%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">list</a></span><span class="stt"> </span><span class="RktVal">'</span><span class="RktVal">dh</span><span class="stt"> </span><span class="RktVal">'</span><span class="RktVal">public</span><span class="stt"> </span><span class="RktVar">p</span><span class="stt"> </span><span class="RktVar">g</span><span class="stt"> </span><span class="RktVar">y</span><span class="RktPn">)</span></p></li><li><p><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._list%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">list</a></span><span class="stt"> </span><span class="RktVal">'</span><span class="RktVal">ec</span><span class="stt"> </span><span class="RktVal">'</span><span class="RktVal">public</span><span class="stt"> </span><span class="RktVar">curve-oid</span><span class="stt"> </span><span class="RktVar">q-bytes</span><span class="RktPn">)</span></p></li><li><p><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._list%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">list</a></span><span class="stt"> </span><span class="RktVal">'</span><span class="RktVal">eddsa</span><span class="stt"> </span><span class="RktVal">'</span><span class="RktVal">public</span><span class="stt"> </span><span class="RktVar">curve-sym</span><span class="stt"> </span><span class="RktVar">q-bytes</span><span class="RktPn">)</span></p></li><li><p><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._list%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">list</a></span><span class="stt"> </span><span class="RktVal">'</span><span class="RktVal">ecx</span><span class="stt"> </span><span class="RktVal">'</span><span class="RktVal">public</span><span class="stt"> </span><span class="RktVar">curve-sym</span><span class="stt"> </span><span class="RktVar">q-bytes</span><span class="RktPn">)</span></p></li></ul></li></ul><p>More formats may be added in future versions of this library.</p><p class="SHistory">Changed in version 1.1 of package <span class="stt">crypto-lib</span>: Added <span class="RktVal">'</span><span class="RktVal">OneAsymmetricKey</span>, <span class="RktVal">'</span><span class="RktVal">rkt-private</span>,
and <span class="RktVal">'</span><span class="RktVal">rkt-public</span> formats.<br/>Changed in version 1.9: Added <span class="RktVal">'</span><span class="RktVal">age/v1-public</span>, <span class="RktVal">'</span><span class="RktVal">age/v1-private</span>,
and <span class="RktVal">'</span><span class="RktVal">openssh-public</span> formats.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._crypto/main..rkt)._datum-~3epk-key))"></a><span title="Provided from: crypto | Package: crypto-lib"><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._datum-~3epk-key%29%29" class="RktValDef RktValLink" data-pltdoc="x">datum-&gt;pk-key</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">datum</span><span class="hspace">&nbsp;</span><span class="RktVar">fmt</span><span class="hspace">&nbsp;</span><span class="RktOpt">[</span><span class="RktVar">factories</span><span class="RktOpt">]</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-key~3f%29%29" class="RktValLink" data-pltdoc="x">pk-key?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">datum</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">any/c</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">fmt</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=symbols.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._symbol%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">symbol?</a></span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="argcontract"><tr><td valign="top"><span class="hspace">&nbsp;&nbsp;</span></td><td valign="top"><span class="RktVar">factories</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">:</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="factory.html#%28def._%28%28lib._crypto%2Fmain..rkt%29._crypto-factory~3f%29%29" class="RktValLink" data-pltdoc="x">crypto-factory?</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._listof%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">listof</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="factory.html#%28def._%28%28lib._crypto%2Fmain..rkt%29._crypto-factory~3f%29%29" class="RktValLink" data-pltdoc="x">crypto-factory?</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">=</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">(</span><span class="RktSym"><a href="factory.html#%28def._%28%28lib._crypto%2Fmain..rkt%29._crypto-factories%29%29" class="RktValLink" data-pltdoc="x">crypto-factories</a></span><span class="RktPn">)</span></td></tr></table></td></tr></table></blockquote></div><div class="SIntrapara">Parses <span class="RktVar">datum</span> and returns a PK key associated with an
implementation from <span class="RktVar">factories</span>. If no implementation in
<span class="RktVar">factories</span> supports <span class="RktVar">fmt</span>, an exception is raised.</div></p><p>See <span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-key-~3edatum%29%29" class="RktValLink" data-pltdoc="x">pk-key-&gt;datum</a></span> for information about the <span class="RktVar">fmt</span>
argument.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._crypto/main..rkt)._pk-parameters-~3edatum))"></a><span title="Provided from: crypto | Package: crypto-lib"><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-parameters-~3edatum%29%29" class="RktValDef RktValLink" data-pltdoc="x">pk-parameters-&gt;datum</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">pkp</span><span class="hspace">&nbsp;</span><span class="RktVar">fmt</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._printable%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">printable/c</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">pkp</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-parameters~3f%29%29" class="RktValLink" data-pltdoc="x">pk-parameters?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">fmt</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=symbols.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._symbol%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">symbol?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Returns a datum representing the key parameters <span class="RktVar">pkp</span>, where
the encoding is selected by <span class="RktVar">fmt</span>. Unless noted below, the
result is a bytestring (<span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=bytestrings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._bytes%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">bytes?</a></span>). The following <span class="RktVar">fmt</span>
options are supported:</div></p><ul><li><p><span class="RktVal">'</span><span class="RktVal">AlgorithmIdentifier</span> &#8212;<wbr></wbr> DER-encoded
AlgorithmIdentifier [<a href="#%28cite._.P.K.I.X%29" data-pltdoc="x">PKIX</a>] representation of <span class="RktVar">pkp</span>. All
key parameter types are supported, and an identifier for the key
parameter type is embedded in the encoding.</p><p>For <span class="RktVal">'</span><span class="RktVal">dh</span> parameters, the PKCS #3 identifier and parameter
format [<a href="#%28cite._.P.K.C.S3%29" data-pltdoc="x">PKCS3</a>] are used rather than those specified by
[<a href="#%28cite._.P.K.I.X-.Alg.Id%29" data-pltdoc="x">PKIX-AlgId</a>], for compatibility with OpenSSL.</p></li><li><p><span class="RktVal">'</span><span class="RktVal">DSAParameters</span> &#8212;<wbr></wbr> DER-encoded Dss-Parms [<a href="#%28cite._.P.K.I.X-.Alg.Id%29" data-pltdoc="x">PKIX-AlgId</a>]</p></li><li><p><span class="RktVal">'</span><span class="RktVal">DHParameter</span> &#8212;<wbr></wbr> DER-encoded DHParameter
[<a href="#%28cite._.P.K.C.S3%29" data-pltdoc="x">PKCS3</a>]. Note: this format differs from the DomainParameters
format specified by PKIX.</p></li><li><p><span class="RktVal">'</span><span class="RktVal">EcpkParameters</span> &#8212;<wbr></wbr> DER-encoded EcpkParameters
[<a href="#%28cite._.P.K.I.X-.Alg.Id%29" data-pltdoc="x">PKIX-AlgId</a>] (called ECDomainParameters in [<a href="#%28cite._.S.E.C1%29" data-pltdoc="x">SEC1</a>]).</p></li><li><p><span class="RktVal">'</span><span class="RktVal">rkt-params</span> &#8212;<wbr></wbr> An S-expression of one of the following forms:</p><ul><li><p><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._list%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">list</a></span><span class="stt"> </span><span class="RktVal">'</span><span class="RktVal">dsa</span><span class="stt"> </span><span class="RktVal">'</span><span class="RktVal">params</span><span class="stt"> </span><span class="RktVar">p</span><span class="stt"> </span><span class="RktVar">q</span><span class="stt"> </span><span class="RktVar">g</span><span class="RktPn">)</span></p></li><li><p><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._list%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">list</a></span><span class="stt"> </span><span class="RktVal">'</span><span class="RktVal">dh</span><span class="stt"> </span><span class="RktVal">'</span><span class="RktVal">params</span><span class="stt"> </span><span class="RktVar">p</span><span class="stt"> </span><span class="RktVar">g</span><span class="RktPn">)</span></p></li><li><p><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._list%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">list</a></span><span class="stt"> </span><span class="RktVal">'</span><span class="RktVal">ec</span><span class="stt"> </span><span class="RktVal">'</span><span class="RktVal">params</span><span class="stt"> </span><span class="RktVar">curve-oid</span><span class="RktPn">)</span></p></li><li><p><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._list%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">list</a></span><span class="stt"> </span><span class="RktVal">'</span><span class="RktVal">eddsa</span><span class="stt"> </span><span class="RktVal">'</span><span class="RktVal">params</span><span class="stt"> </span><span class="RktVar">curve-sym</span><span class="RktPn">)</span></p></li><li><p><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._list%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">list</a></span><span class="stt"> </span><span class="RktVal">'</span><span class="RktVal">ecx</span><span class="stt"> </span><span class="RktVal">'</span><span class="RktVal">params</span><span class="stt"> </span><span class="RktVar">curve-sym</span><span class="RktPn">)</span></p></li></ul></li></ul><p>More formats may be added in future versions of this library.</p><p class="SHistory">Changed in version 1.1 of package <span class="stt">crypto-lib</span>: Added <span class="RktVal">'</span><span class="RktVal">rkt-params</span> support.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._crypto/main..rkt)._datum-~3epk-parameters))"></a><span title="Provided from: crypto | Package: crypto-lib"><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._datum-~3epk-parameters%29%29" class="RktValDef RktValLink" data-pltdoc="x">datum-&gt;pk-parameters</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">datum</span><span class="hspace">&nbsp;</span><span class="RktVar">fmt</span><span class="hspace">&nbsp;</span><span class="RktOpt">[</span><span class="RktVar">factories</span><span class="RktOpt">]</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-parameters~3f%29%29" class="RktValLink" data-pltdoc="x">pk-parameters?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">datum</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">any/c</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">fmt</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=symbols.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._symbol%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">symbol?</a></span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="argcontract"><tr><td valign="top"><span class="hspace">&nbsp;&nbsp;</span></td><td valign="top"><span class="RktVar">factories</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">:</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="factory.html#%28def._%28%28lib._crypto%2Fmain..rkt%29._crypto-factory~3f%29%29" class="RktValLink" data-pltdoc="x">crypto-factory?</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._listof%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">listof</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="factory.html#%28def._%28%28lib._crypto%2Fmain..rkt%29._crypto-factory~3f%29%29" class="RktValLink" data-pltdoc="x">crypto-factory?</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">=</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">(</span><span class="RktSym"><a href="factory.html#%28def._%28%28lib._crypto%2Fmain..rkt%29._crypto-factories%29%29" class="RktValLink" data-pltdoc="x">crypto-factories</a></span><span class="RktPn">)</span></td></tr></table></td></tr></table></blockquote></div><div class="SIntrapara">Parses <span class="RktVar">datum</span> and returns a key-parameters value associated
with an implementation in <span class="RktVar">factories</span>. If no implementation is
found that accepts <span class="RktVar">fmt</span>, an exception is raised.</div></p><h4 x-source-module="(lib &quot;crypto/scribblings/crypto.scrbl&quot;)" x-source-pkg="crypto-doc" x-part-tag="&quot;pkcs8&quot;">5.6<tt>&nbsp;</tt><a name="(part._pkcs8)"></a><a name="(mod-path._crypto/pkcs8)"></a>PKCS #8 Encrypted Private Keys</h4><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="defmodule"><tr><td align="left"><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._require%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">require</a></span><span class="stt"> </span><a href="#%28mod-path._crypto%2Fpkcs8%29" class="RktModLink" data-pltdoc="x"><span class="RktSym">crypto/pkcs8</span></a><span class="RktPn">)</span></td><td align="right"><span class="RpackageSpec"><span class="Smaller">&nbsp;package:</span> <a href="https://pkgs.racket-lang.org/package/crypto-lib" title="Install this package using `raco pkg install crypto-lib`"><span class="stt">crypto-lib</span></a></span></td></tr></table></div><div class="SIntrapara"><p class="SHistory">Added in version 1.5 of package <span class="stt">crypto-lib</span>.</p></div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><table cellspacing="0" cellpadding="0" class="together"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><table cellspacing="0" cellpadding="0" class="prototype RForeground"><tr><td valign="top"><span class="RktPn">(</span><a name="(def._((lib._crypto/pkcs8..rkt)._pkcs8-encrypt/pbkdf2-hmac))"></a><span title="Provided from: crypto/pkcs8 | Package: crypto-lib"><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fpkcs8..rkt%29._pkcs8-encrypt%2Fpbkdf2-hmac%29%29" class="RktValDef RktValLink" data-pltdoc="x">pkcs8-encrypt/pbkdf2-hmac</a></span></span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">password</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">pk</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span><span class="RktOpt">[</span></td><td valign="top"><span class="RktPn">#:digest</span><span class="hspace">&nbsp;</span><span class="RktVar">digest-spec</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:iterations</span><span class="hspace">&nbsp;</span><span class="RktVar">iterations</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:cipher</span><span class="hspace">&nbsp;</span><span class="RktVar">cipher-spec</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:key-size</span><span class="hspace">&nbsp;</span><span class="RktVar">key-size</span><span class="RktOpt">]</span><span class="RktPn">)</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">&rarr;</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=bytestrings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._bytes%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">bytes?</a></span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">password</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=bytestrings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._bytes%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">bytes?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">pk</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._private-key~3f%29%29" class="RktValLink" data-pltdoc="x">private-key?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=bytestrings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._bytes%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">bytes?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">digest-spec</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="digest.html#%28def._%28%28lib._crypto%2Fmain..rkt%29._digest-spec~3f%29%29" class="RktValLink" data-pltdoc="x">digest-spec?</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">sha512</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">iterations</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=number-types.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._exact-positive-integer%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">exact-positive-integer?</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=generic-numbers.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._expt%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">expt</a></span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="hspace">&nbsp;</span><span class="RktVal">16</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">cipher-spec</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="cipher.html#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-spec~3f%29%29" class="RktValLink" data-pltdoc="x">cipher-spec?</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">aes</span><span class="hspace">&nbsp;</span><span class="RktVal">cbc</span><span class="RktVal">)</span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="argcontract"><tr><td valign="top"><span class="hspace">&nbsp;&nbsp;</span></td><td valign="top"><span class="RktVar">key-size</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">:</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=number-types.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._exact-positive-integer%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">exact-positive-integer?</a></span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">=</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">(</span><span class="RktSym"><a href="cipher.html#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-default-key-size%29%29" class="RktValLink" data-pltdoc="x">cipher-default-key-size</a></span><span class="hspace">&nbsp;</span><span class="RktVar">cipher-spec</span><span class="RktPn">)</span></td></tr></table></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="together"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><table cellspacing="0" cellpadding="0" class="prototype RForeground"><tr><td valign="top"><span class="RktPn">(</span><a name="(def._((lib._crypto/pkcs8..rkt)._pkcs8-encrypt/scrypt))"></a><span title="Provided from: crypto/pkcs8 | Package: crypto-lib"><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fpkcs8..rkt%29._pkcs8-encrypt%2Fscrypt%29%29" class="RktValDef RktValLink" data-pltdoc="x">pkcs8-encrypt/scrypt</a></span></span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">password</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">pk</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span><span class="RktOpt">[</span></td><td valign="top"><span class="RktPn">#:N</span><span class="hspace">&nbsp;</span><span class="RktVar">N</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:r</span><span class="hspace">&nbsp;</span><span class="RktVar">r</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:p</span><span class="hspace">&nbsp;</span><span class="RktVar">p</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:cipher</span><span class="hspace">&nbsp;</span><span class="RktVar">cipher-spec</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:key-size</span><span class="hspace">&nbsp;</span><span class="RktVar">key-size</span><span class="RktOpt">]</span><span class="RktPn">)</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">&rarr;</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=bytestrings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._bytes%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">bytes?</a></span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">password</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=bytestrings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._bytes%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">bytes?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">pk</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._private-key~3f%29%29" class="RktValLink" data-pltdoc="x">private-key?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=bytestrings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._bytes%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">bytes?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">N</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=number-types.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._exact-positive-integer%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">exact-positive-integer?</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=generic-numbers.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._expt%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">expt</a></span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="hspace">&nbsp;</span><span class="RktVal">14</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">r</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=number-types.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._exact-positive-integer%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">exact-positive-integer?</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">8</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">p</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=number-types.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._exact-positive-integer%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">exact-positive-integer?</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">1</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">cipher-spec</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="cipher.html#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-spec~3f%29%29" class="RktValLink" data-pltdoc="x">cipher-spec?</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">aes</span><span class="hspace">&nbsp;</span><span class="RktVal">cbc</span><span class="RktVal">)</span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="argcontract"><tr><td valign="top"><span class="hspace">&nbsp;&nbsp;</span></td><td valign="top"><span class="RktVar">key-size</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">:</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=number-types.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._exact-positive-integer%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">exact-positive-integer?</a></span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">=</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">(</span><span class="RktSym"><a href="cipher.html#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-default-key-size%29%29" class="RktValLink" data-pltdoc="x">cipher-default-key-size</a></span><span class="hspace">&nbsp;</span><span class="RktVar">cipher-spec</span><span class="RktPn">)</span></td></tr></table></td></tr></table></td></tr></table></blockquote></div><div class="SIntrapara">Produce a DER-encoded EncryptedPrivateKeyInfo [<a href="#%28cite._.P.K.C.S8%29" data-pltdoc="x">PKCS8</a>]
containing the private key <span class="RktVar">pk</span> encrypted with a key derived
from <span class="RktVar">password</span>. If <span class="RktVar">pk</span> is a private key object
(<span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._private-key~3f%29%29" class="RktValLink" data-pltdoc="x">private-key?</a></span>), it is converted to a byte string using
OneAsymmetricKey format. If <span class="RktVar">pk</span> is a byte string, it should be
a OneAsymmetricKey or PrivateKeyInfo encoding, but the structure of
the byte string is not inspected.</div></p><p>See <span class="RktSym"><a href="kdf.html#%28def._%28%28lib._crypto%2Fmain..rkt%29._pbkdf2-hmac%29%29" class="RktValLink" data-pltdoc="x">pbkdf2-hmac</a></span> for the meaning of the <span class="RktVar">iterations</span>
argument, and see <span class="RktSym"><a href="kdf.html#%28def._%28%28lib._crypto%2Fmain..rkt%29._scrypt%29%29" class="RktValLink" data-pltdoc="x">scrypt</a></span> for the meanings of the <span class="RktVar">N</span>,
<span class="RktVar">r</span>, and <span class="RktVar">p</span> arguments.</p><p>The following values of <span class="RktVar">cipher-spec</span> are currently supported:
<span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">aes</span><span class="stt"> </span><span class="RktVal">cbc</span><span class="RktVal">)</span>, <span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">des-ede3</span><span class="stt"> </span><span class="RktVal">cbc</span><span class="RktVal">)</span>, <span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">aes</span><span class="stt"> </span><span class="RktVal">gcm</span><span class="RktVal">)</span>,
and <span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">chacha20-poly1305</span><span class="stt"> </span><span class="RktVal">stream</span><span class="RktVal">)</span>.</p><p>The following values of <span class="RktVar">digest-spec</span> are currently supported:
<span class="RktVal">'</span><span class="RktVal">sha1</span>, <span class="RktVal">'</span><span class="RktVal">sha224</span>, <span class="RktVal">'</span><span class="RktVal">sha256</span>, <span class="RktVal">'</span><span class="RktVal">sha384</span>,
and <span class="RktVal">'</span><span class="RktVal">sha512</span>.</p><p>Compatibility with OpenSSL 1.1.0 has been tested with <span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">aes</span><span class="stt"> </span><span class="RktVal">cbc</span><span class="RktVal">)</span>
and <span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">des-ede3</span><span class="stt"> </span><span class="RktVal">cbc</span><span class="RktVal">)</span>.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._crypto/pkcs8..rkt)._pkcs8-decrypt-bytes))"></a><span title="Provided from: crypto/pkcs8 | Package: crypto-lib"><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fpkcs8..rkt%29._pkcs8-decrypt-bytes%29%29" class="RktValDef RktValLink" data-pltdoc="x">pkcs8-decrypt-bytes</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">password</span><span class="hspace">&nbsp;</span><span class="RktVar">p8-epki</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=bytestrings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._bytes%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">bytes?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">password</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=bytestrings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._bytes%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">bytes?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">p8-epki</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=bytestrings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._bytes%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">bytes?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Decrypts the DER-encoded EncryptedPrivateKeyInfo <span class="RktVar">p8-epki</span>
using <span class="RktVar">password</span> and returns the unencrypted private key as a
byte string. The structure of the decrypted byte string is not inspected.</div></p><p>If the wrong password is given, then an exception will <span class="emph">probably</span>
be raised, but for non-AEAD ciphers (such as AES-CBC), there is a
possibility that the decryption will succeed and return nonsense.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._crypto/pkcs8..rkt)._pkcs8-decrypt-key))"></a><span title="Provided from: crypto/pkcs8 | Package: crypto-lib"><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fpkcs8..rkt%29._pkcs8-decrypt-key%29%29" class="RktValDef RktValLink" data-pltdoc="x">pkcs8-decrypt-key</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">password</span><span class="hspace">&nbsp;</span><span class="RktVar">p8-epki</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._private-key~3f%29%29" class="RktValLink" data-pltdoc="x">private-key?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">password</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=bytestrings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._bytes%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">bytes?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">p8-epki</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=bytestrings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._bytes%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">bytes?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Decrypts the DER-encodedEncryptedPrivateKeyInfo <span class="RktVar">p8-epki</span> using
<span class="RktVar">password</span> and parses the unencrypted private key as
OneAsymmetricKey.</div></p><p><div class="SIntrapara">Equivalent to the following:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._datum-~3epk-key%29%29" class="RktValLink" data-pltdoc="x">datum-&gt;pk-key</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fpkcs8..rkt%29._pkcs8-decrypt-bytes%29%29" class="RktValLink" data-pltdoc="x">pkcs8-decrypt-bytes</a></span><span class="hspace">&nbsp;</span><span class="RktVar">password</span><span class="hspace">&nbsp;</span><span class="RktVar">p8-epki</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">OneAsymmetricKey</span><span class="RktPn">)</span></p></blockquote></div></p><h4 x-source-module="(lib &quot;crypto/scribblings/crypto.scrbl&quot;)" x-source-pkg="crypto-doc" x-part-tag="&quot;pk-bibliography&quot;"><a name="(part._pk-bibliography)"></a>Bibliography</h4><p><table cellspacing="0" cellpadding="0" class="RBibliography"><tr><td><a name="(cite._.A.K.P)"></a>[AKP]</td><td><span class="hspace">&nbsp;</span></td><td><span class="bibentry">&ldquo;RFC 5958: Asymmetric Key Packages.&rdquo; <a href="https://tools.ietf.org/html/rfc5958"><span class="stt">https://tools.ietf.org/html/rfc5958</span></a></span></td></tr><tr><td><a name="(cite._.P.K.C.S1)"></a>[PKCS1]</td><td><span class="hspace">&nbsp;</span></td><td><span class="bibentry">&ldquo;PKCS #1: RSA Cryptography, version 2.1.&rdquo; <a href="https://tools.ietf.org/html/rfc3447"><span class="stt">https://tools.ietf.org/html/rfc3447</span></a></span></td></tr><tr><td><a name="(cite._.P.K.C.S3)"></a>[PKCS3]</td><td><span class="hspace">&nbsp;</span></td><td><span class="bibentry">&ldquo;PKCS #3: Diffie-Hellman Key-Agreement Standard.&rdquo;</span></td></tr><tr><td><a name="(cite._.P.K.C.S8)"></a>[PKCS8]</td><td><span class="hspace">&nbsp;</span></td><td><span class="bibentry">&ldquo;PKCS #8: Private-Key Information Syntax Specification, version 1.2.&rdquo; <a href="https://tools.ietf.org/html/rfc5208"><span class="stt">https://tools.ietf.org/html/rfc5208</span></a></span></td></tr><tr><td><a name="(cite._.P.K.I.X)"></a>[PKIX]</td><td><span class="hspace">&nbsp;</span></td><td><span class="bibentry">&ldquo;RFC 5280: Internet X.509 Public Key Infrastructure: Certificate and CRL Profile.&rdquo; <a href="https://tools.ietf.org/html/rfc5280"><span class="stt">https://tools.ietf.org/html/rfc5280</span></a></span></td></tr><tr><td><a name="(cite._.P.K.I.X-.Alg.Id)"></a>[PKIX-AlgId]</td><td><span class="hspace">&nbsp;</span></td><td><span class="bibentry">&ldquo;RFC 3279: Algorithms and Identifiers for the Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile.&rdquo; <a href="https://tools.ietf.org/html/rfc3279"><span class="stt">https://tools.ietf.org/html/rfc3279</span></a></span></td></tr><tr><td><a name="(cite._.P.K.I.X-.Ed.C)"></a>[PKIX-EdC]</td><td><span class="hspace">&nbsp;</span></td><td><span class="bibentry">&ldquo;RFC 8410: Algorithm Identifiers for Ed25519, Ed448, X25519 and X448 for use in the Internet X.509 Public Key Infrastructure.&rdquo; <a href="https://tools.ietf.org/html/rfc8410"><span class="stt">https://tools.ietf.org/html/rfc8410</span></a></span></td></tr><tr><td><a name="(cite._.R.F.C2631)"></a>[RFC2631]</td><td><span class="hspace">&nbsp;</span></td><td><span class="bibentry">&ldquo;RFC 2631: Diffie-Hellman Key Agreement Method.&rdquo; <a href="https://tools.ietf.org/html/rfc2631"><span class="stt">https://tools.ietf.org/html/rfc2631</span></a></span></td></tr><tr><td><a name="(cite._.S.E.C1)"></a>[SEC1]</td><td><span class="hspace">&nbsp;</span></td><td><span class="bibentry">&ldquo;SEC 1: Elliptic Curve Cryptography.&rdquo; <a href="http://www.secg.org/sec1-v2.pdf"><span class="stt">http://www.secg.org/sec1-v2.pdf</span></a></span></td></tr><tr><td><a name="(cite._.R.F.C7468)"></a>[RFC7468]</td><td><span class="hspace">&nbsp;</span></td><td><span class="bibentry">&ldquo;Textual Encodings of PKIX, PKCS, and CMS Structures.&rdquo; <a href="https://tools.ietf.org/html/rfc7468"><span class="stt">https://tools.ietf.org/html/rfc7468</span></a></span></td></tr></table></p><div class="navsetbottom"><span class="navleft"><form class="searchform"><input class="searchbox" id="searchbox" type="text" tabindex="1" placeholder="...search manuals..." title="Enter a search string to search the manuals" onkeypress="return DoSearchKey(event, this, &quot;8.6&quot;, &quot;../&quot;);"/></form>&nbsp;&nbsp;<a href="../index-2.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;8.6&quot;);">top</a><span class="tocsettoggle">&nbsp;&nbsp;<a href="javascript:void(0);" title="show/hide table of contents" onclick="TocsetToggle();">contents</a></span></span><span class="navright">&nbsp;&nbsp;<a href="cipher.html" title="backward to &quot;4 Symmetric Encryption&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="index.html" title="up to &quot;Crypto: Cryptographic Operations&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="kdf.html" title="forward to &quot;6 Key Derivation and Password Hashing&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body>
<!-- Mirrored from docs.racket-lang.org/crypto/pk.html by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 07 Sep 2022 03:26:23 GMT -->
</html>