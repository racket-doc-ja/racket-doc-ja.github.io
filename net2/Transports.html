<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- Mirrored from docs.racket-lang.org/net2/Transports.html by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 07 Sep 2022 03:27:54 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><meta name="viewport" content="width=device-width, initial-scale=0.8"/><title>2&nbsp;Transports</title><link rel="stylesheet" type="text/css" href="../scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="../racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-style.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../doc-site.css" title="default"/><script type="text/javascript" src="../scribble-common.js"></script><script type="text/javascript" src="../manual-racket.js"></script><script type="text/javascript" src="../manual-racket.js"></script><script type="text/javascript" src="../doc-site.js"></script><script type="text/javascript" src="../local-redirect/local-redirect.js"></script><script type="text/javascript" src="../local-redirect/local-user-redirect.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="doc-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9660;</a></td><td></td><td><a href="index.html" class="tocviewlink" data-pltdoc="x">Net2:<span class="mywbr"> &nbsp;</span> Evolved Networking Libraries</a></td></tr></table></div><div class="tocviewsublisttop" style="display: block;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="Networking_Data_Structures.html" class="tocviewlink" data-pltdoc="x">Networking Data Structures</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="#" class="tocviewselflink" data-pltdoc="x">Transports</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="Transport_Connectors.html" class="tocviewlink" data-pltdoc="x">Transport Connectors</a></td></tr><tr><td align="right">4&nbsp;</td><td><a href="Transport_Listeners.html" class="tocviewlink" data-pltdoc="x">Transport Listeners</a></td></tr><tr><td align="right">5&nbsp;</td><td><a href="Operating_System_Networking.html" class="tocviewlink" data-pltdoc="x">Operating System Networking</a></td></tr></table></div></div><div class="tocviewlist"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_1&quot;);">&#9658;</a></td><td>2&nbsp;</td><td><a href="#" class="tocviewselflink" data-pltdoc="x">Transports</a></td></tr></table><div class="tocviewsublistbottom" style="display: none;" id="tocview_1"><table cellspacing="0" cellpadding="0"><tr><td align="right">2.1&nbsp;</td><td><a href="#%28part._.Transport_.Primitives%29" class="tocviewlink" data-pltdoc="x">Transport Primitives</a></td></tr><tr><td align="right">2.2&nbsp;</td><td><a href="#%28part._transport-cleanup%29" class="tocviewlink" data-pltdoc="x">Transport Cleanup and Disposables</a></td></tr></table></div></div></div><div class="tocsub"><div class="tocsubtitle">On this page:</div><table class="tocsublist" cellspacing="0"><tr><td><span class="tocsublinknumber">2.1<tt>&nbsp;</tt></span><a href="#%28part._.Transport_.Primitives%29" class="tocsubseclink" data-pltdoc="x">Transport Primitives</a></td></tr><tr><td><a href="#%28def._%28%28lib._net2%2Ftransport..rkt%29._transport~3f%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">transport?</span></a></td></tr><tr><td><a href="#%28def._%28%28lib._net2%2Ftransport..rkt%29._transport%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">transport</span></a></td></tr><tr><td><a href="#%28def._%28%28lib._net2%2Ftransport..rkt%29._transport-in%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">transport-<wbr></wbr>in</span></a></td></tr><tr><td><a href="#%28def._%28%28lib._net2%2Ftransport..rkt%29._transport-out%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">transport-<wbr></wbr>out</span></a></td></tr><tr><td><a href="#%28def._%28%28lib._net2%2Ftransport..rkt%29._transport-source%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">transport-<wbr></wbr>source</span></a></td></tr><tr><td><a href="#%28def._%28%28lib._net2%2Ftransport..rkt%29._transport-dest%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">transport-<wbr></wbr>dest</span></a></td></tr><tr><td><span class="tocsublinknumber">2.2<tt>&nbsp;</tt></span><a href="#%28part._transport-cleanup%29" class="tocsubseclink" data-pltdoc="x">Transport Cleanup and Disposables</a></td></tr></table></div></div><div class="maincolumn"><div class="main"><div class="versionbox"><span class="version">8.6</span></div><div class="navsettop"><span class="navleft"><form class="searchform"><input class="searchbox" id="searchbox" type="text" tabindex="1" placeholder="...search manuals..." title="Enter a search string to search the manuals" onkeypress="return DoSearchKey(event, this, &quot;8.6&quot;, &quot;../&quot;);"/></form>&nbsp;&nbsp;<a href="../index-2.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;8.6&quot;);">top</a><span class="tocsettoggle">&nbsp;&nbsp;<a href="javascript:void(0);" title="show/hide table of contents" onclick="TocsetToggle();">contents</a></span></span><span class="navright">&nbsp;&nbsp;<a href="Networking_Data_Structures.html" title="backward to &quot;1 Networking Data Structures&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="index.html" title="up to &quot;Net2: Evolved Networking Libraries&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="Transport_Connectors.html" title="forward to &quot;3 Transport Connectors&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div><h3 x-source-module="(lib &quot;net2/scribblings/main.scrbl&quot;)" x-source-pkg="net2" x-part-tag="&quot;Transports&quot;">2<tt>&nbsp;</tt><a name="(part._.Transports)"></a><a name="(mod-path._net2/transport)"></a>Transports</h3><p><table cellspacing="0" cellpadding="0" class="defmodule"><tr><td align="left"><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._require%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">require</a></span><span class="stt"> </span><a href="#" class="RktModLink" data-pltdoc="x"><span class="RktSym">net2/transport</span></a><span class="RktPn">)</span></td><td align="right"><span class="RpackageSpec"><span class="Smaller">&nbsp;package:</span> <a href="https://pkgs.racket-lang.org/package/net2" title="Install this package using `raco pkg install net2`"><span class="stt">net2</span></a></span></td></tr></table></p><p>A <a name="(tech._transport)"></a><span style="font-style: italic">transport</span> is a means of reliably sending
and receiving bytes between two named parties across some network. TCP
connections over an IP network serve as a canonical example, with the two
parties named by their IP addresses and port numbers. A transport pairs an
<a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=ports.html%23%2528tech._input._port%2529&amp;version=8.6" class="techoutside Sq" data-pltdoc="x"><span class="techinside">input port</span></a> and an <a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=ports.html%23%2528tech._output._port%2529&amp;version=8.6" class="techoutside Sq" data-pltdoc="x"><span class="techinside">output port</span></a> with two
<a href="Networking_Data_Structures.html#%28tech._uri._authority%29" class="techoutside" data-pltdoc="x"><span class="techinside">authorities</span></a>: one naming the party using those ports, and one
naming the party "on the other end" of the connection. Transports can be
directly constructed from ports with <span class="RktSym">transport</span>.</p><p>Transports do not have a notion of clients and servers &#8212;<wbr></wbr> once established, a
transport can be used for arbitrary bidirectional communication. For a
high-level interface to client-server transport creation, see <a href="Transport_Connectors.html#%28tech._connector%29" class="techoutside" data-pltdoc="x"><span class="techinside">connectors</span></a> and <font class="badlink"><span class="techoutside"><span class="techinside">listeners</span></span></font>. Also see the
<a href="Operating_System_Networking.html" class="RktModLink" data-pltdoc="x"><span class="RktSym">net2/system</span></a> module for access to operating system transports
such as TCP connections.</p><p>Transports are not thread safe in the sense that two threads attempting to
serialize and deserialize complex messages directly to the same transport will
interleave their bytes on the wire, leading to mangled and uninterpretable
messages. To prevent threads from concurrently writing messages without opening
multiple transports between the same authorities, use a dedicated thread for
serializing and deserializing messages from a message buffer which other threads
read and write messages to atomically instead of sharing the connection
directly.</p><h4 x-source-module="(lib &quot;net2/scribblings/main.scrbl&quot;)" x-source-pkg="net2" x-part-tag="&quot;Transport_Primitives&quot;">2.1<tt>&nbsp;</tt><a name="(part._.Transport_.Primitives)"></a>Transport Primitives</h4><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._net2/transport..rkt)._transport~3f))"></a><span title="Provided from: net2/transport, net2 | Package: net2"><span class="RktSym"><span class="RktSymDef RktSym">transport?</span></span></span><span class="hspace">&nbsp;</span><span class="RktVar">v</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=booleans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._boolean%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">boolean?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">v</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">any/c</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Returns <span class="RktVal">#t</span> if <span class="RktVar">v</span> is a <a href="#%28tech._transport%29" class="techoutside" data-pltdoc="x"><span class="techinside">transport</span></a>.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><table cellspacing="0" cellpadding="0" class="prototype RForeground"><tr><td valign="top"><span class="RktPn">(</span><a name="(def._((lib._net2/transport..rkt)._transport))"></a><span title="Provided from: net2/transport, net2 | Package: net2"><span class="RktSym"><span class="RktSymDef RktSym">transport</span></span></span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:in</span><span class="hspace">&nbsp;</span><span class="RktVar">in</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:out</span><span class="hspace">&nbsp;</span><span class="RktVar">out</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:source</span><span class="hspace">&nbsp;</span><span class="RktVar">source</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:dest</span><span class="hspace">&nbsp;</span><span class="RktVar">dest</span><span class="RktPn">)</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">&rarr;</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktSym">transport?</span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">in</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=port-ops.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._input-port%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">input-port?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">out</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=port-ops.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._output-port%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">output-port?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">source</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">authority?</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">dest</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">authority?</span></td></tr></table></blockquote></div><div class="SIntrapara">Constructs a <a href="#%28tech._transport%29" class="techoutside" data-pltdoc="x"><span class="techinside">transport</span></a> that acts as <span class="RktVar">source</span>
communicating with <span class="RktVar">dest</span> by reading data from <span class="RktVar">in</span> and sending
data to <span class="RktVar">out</span>. Using this constructor is expected to be rare; most
transports are created with procedures like <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=tcp.html%23%2528def._%2528%2528lib._racket%252Ftcp..rkt%2529._tcp-connect%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">tcp-connect</a></span> or tunneled
over existing transports with procedures like <span class="RktSym">tls-transport</span>.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><table cellspacing="0" cellpadding="0" class="together"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._net2/transport..rkt)._transport-in))"></a><span title="Provided from: net2/transport, net2 | Package: net2"><span class="RktSym"><span class="RktSymDef RktSym">transport-in</span></span></span><span class="hspace">&nbsp;</span><span class="RktVar">trans</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=port-ops.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._input-port%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">input-port?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">trans</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">transport?</span></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="together"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._net2/transport..rkt)._transport-out))"></a><span title="Provided from: net2/transport, net2 | Package: net2"><span class="RktSym"><span class="RktSymDef RktSym">transport-out</span></span></span><span class="hspace">&nbsp;</span><span class="RktVar">trans</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=port-ops.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._output-port%7E3f%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">output-port?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">trans</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">transport?</span></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="together"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._net2/transport..rkt)._transport-source))"></a><span title="Provided from: net2/transport, net2 | Package: net2"><span class="RktSym"><span class="RktSymDef RktSym">transport-source</span></span></span><span class="hspace">&nbsp;</span><span class="RktVar">trans</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym">authority?</span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">trans</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">transport?</span></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="together"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._net2/transport..rkt)._transport-dest))"></a><span title="Provided from: net2/transport, net2 | Package: net2"><span class="RktSym"><span class="RktSymDef RktSym">transport-dest</span></span></span><span class="hspace">&nbsp;</span><span class="RktVar">trans</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym">authority?</span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">trans</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">transport?</span></td></tr></table></td></tr></table></blockquote></div><div class="SIntrapara">Accessors for the various components of a <a href="#%28tech._transport%29" class="techoutside" data-pltdoc="x"><span class="techinside">transport</span></a> as passed in to
the <span class="RktSym">transport</span> constructor.</div></p><h4 x-source-module="(lib &quot;net2/scribblings/main.scrbl&quot;)" x-source-pkg="net2" x-part-tag="&quot;transport-cleanup&quot;">2.2<tt>&nbsp;</tt><a name="(part._transport-cleanup)"></a>Transport Cleanup and Disposables</h4><p>The <a href="#%28tech._transport%29" class="techoutside" data-pltdoc="x"><span class="techinside">transport</span></a> API does not offer any means of directly
overriding how a transport is shut down except for making <a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=customport.html%23%2528tech._custom._port%2529&amp;version=8.6" class="techoutside Sq" data-pltdoc="x"><span class="techinside">custom ports</span></a> that perform special cleanup actions when closed. Broadly, this
is because there are only two kinds of cleanup actions one might want to perform
on a transport:</p><ul><li><p><span class="emph">System cleanup actions</span> that free local operating system resources,
such as releasing file descriptors associated with the input and output
<a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=guide&amp;rel=i_o.html%23%2528tech._port%2529&amp;version=8.6" class="techoutside Sq" data-pltdoc="x"><span class="techinside">ports</span></a>.</p></li><li><p><span class="emph">Connection cleanup actions</span> that send messages to the transport&rsquo;s
destination <a href="Networking_Data_Structures.html#%28tech._uri._authority%29" class="techoutside" data-pltdoc="x"><span class="techinside">authority</span></a> in an attempt to negotiate a graceful
connection termination, such as TCP&rsquo;s use of FIN packets.</p></li></ul><p>System cleanup actions are usually associated directly with a single
<a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=ports.html%23%2528tech._input._port%2529&amp;version=8.6" class="techoutside Sq" data-pltdoc="x"><span class="techinside">input port</span></a> or <a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=ports.html%23%2528tech._output._port%2529&amp;version=8.6" class="techoutside Sq" data-pltdoc="x"><span class="techinside">output port</span></a> &#8212;<wbr></wbr> not with the
transport as a whole. As a result, it&rsquo;s best to implement system cleanup within
a custom port&rsquo;s close procedure and rely on it being called when the port is
closed or when the port&rsquo;s <a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=eval-model.html%23%2528tech._custodian%2529&amp;version=8.6" class="techoutside Sq" data-pltdoc="x"><span class="techinside">custodian</span></a> is shut down.</p><p>Connection cleanup actions involve coordination and communication with another
party over a network. <span style="font-weight: bold">Connection cleanup is inherently unreliable.</span> There
is no way to guarantee that communication with the other party won&rsquo;t abrubtly
terminate at any point. Therefore, connection cleanup should be performed on a
<span class="emph">best effort</span> basis that tolerates failure. It is inappropriate to perform
connection cleanup actions during a custodian shutdown using
<a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=foreign&amp;rel=Custodian_Shutdown_Registration.html&amp;version=8.6" class="RktModLink Sq" data-pltdoc="x"><span class="RktSym">ffi/unsafe/custodian</span></a>, because custodian shutdowns are performed
unsafely and expected to always succeed with very little (if any) IO.</p><p>To properly implement connection cleanup actions in transports, many interfaces
in <a href="index.html" class="RktModLink" data-pltdoc="x"><span class="RktSym">net2</span></a> require that connection cleanup logic is encapsulated in
a <a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=disposable&amp;rel=Basic_Disposable_API_and_Concepts.html%23%2528tech._disposable%2529&amp;version=8.6" class="techoutside Sq" data-pltdoc="x"><span class="techinside">disposable</span></a> from the <a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=disposable&amp;rel=index.html&amp;version=8.6" class="RktModLink Sq" data-pltdoc="x"><span class="RktSym">disposable</span></a> library. This
allows declaratively specifying how and when connection termination logic will
execute, and reduces the complexity involved in adding timeout and early
termination logic. See <span class="RktSym">tcp-connector</span> for an example of constructing
transports with robust and graceful connection termination. Alternatively, refer
to <a href="Transport_Connectors.html#%28tech._connector%29" class="techoutside" data-pltdoc="x"><span class="techinside">connectors</span></a> and <font class="badlink"><span class="techoutside"><span class="techinside">listeners</span></span></font> for information on
how they encapsulate connection termination with disposables and custodians.</p><div class="navsetbottom"><span class="navleft"><form class="searchform"><input class="searchbox" id="searchbox" type="text" tabindex="1" placeholder="...search manuals..." title="Enter a search string to search the manuals" onkeypress="return DoSearchKey(event, this, &quot;8.6&quot;, &quot;../&quot;);"/></form>&nbsp;&nbsp;<a href="../index-2.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;8.6&quot;);">top</a><span class="tocsettoggle">&nbsp;&nbsp;<a href="javascript:void(0);" title="show/hide table of contents" onclick="TocsetToggle();">contents</a></span></span><span class="navright">&nbsp;&nbsp;<a href="Networking_Data_Structures.html" title="backward to &quot;1 Networking Data Structures&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="index.html" title="up to &quot;Net2: Evolved Networking Libraries&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="Transport_Connectors.html" title="forward to &quot;3 Transport Connectors&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body>
<!-- Mirrored from docs.racket-lang.org/net2/Transports.html by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 07 Sep 2022 03:27:54 GMT -->
</html>