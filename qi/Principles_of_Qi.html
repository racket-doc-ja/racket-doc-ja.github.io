<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- Mirrored from docs.racket-lang.org/qi/Principles_of_Qi.html by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 07 Sep 2022 03:13:28 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><meta name="viewport" content="width=device-width, initial-scale=0.8"/><title>8&nbsp;Principles of Qi</title><link rel="stylesheet" type="text/css" href="../scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="../racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-style.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../doc-site.css" title="default"/><script type="text/javascript" src="../scribble-common.js"></script><script type="text/javascript">
(function() {document.write('<scr' + 'ipt type="text/javascript" src="MathJax/MathJax.js?config=default"></scr' + 'ipt>');})();
</script><script type="text/javascript" src="../manual-racket.js"></script><script type="text/javascript" src="../doc-site.js"></script><script type="text/javascript" src="../local-redirect/local-redirect.js"></script><script type="text/javascript" src="../local-redirect/local-user-redirect.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="doc-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9660;</a></td><td></td><td><a href="index.html" class="tocviewlink" data-pltdoc="x">Qi:<span class="mywbr"> &nbsp;</span> A Functional, Flow-<wbr></wbr>Oriented DSL</a></td></tr></table></div><div class="tocviewsublisttop" style="display: block;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="Using_These_Docs.html" class="tocviewlink" data-pltdoc="x">Using These Docs</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="Introduction_and_Usage.html" class="tocviewlink" data-pltdoc="x">Introduction and Usage</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="Tutorial.html" class="tocviewlink" data-pltdoc="x">Tutorial</a></td></tr><tr><td align="right">4&nbsp;</td><td><a href="Language_Interface.html" class="tocviewlink" data-pltdoc="x">Language Interface</a></td></tr><tr><td align="right">5&nbsp;</td><td><a href="Qi_Forms.html" class="tocviewlink" data-pltdoc="x">The Qi Language</a></td></tr><tr><td align="right">6&nbsp;</td><td><a href="Qi_Macros.html" class="tocviewlink" data-pltdoc="x">Qi Macros</a></td></tr><tr><td align="right">7&nbsp;</td><td><a href="Field_Guide.html" class="tocviewlink" data-pltdoc="x">Field Guide</a></td></tr><tr><td align="right">8&nbsp;</td><td><a href="#" class="tocviewselflink" data-pltdoc="x">Principles of Qi</a></td></tr><tr><td align="right">9&nbsp;</td><td><a href="When_Should_I_Use_Qi_.html" class="tocviewlink" data-pltdoc="x">When Should I Use Qi?</a></td></tr></table></div></div><div class="tocviewlist"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_1&quot;);">&#9658;</a></td><td>8&nbsp;</td><td><a href="#" class="tocviewselflink" data-pltdoc="x">Principles of Qi</a></td></tr></table><div class="tocviewsublistbottom" style="display: none;" id="tocview_1"><table cellspacing="0" cellpadding="0"><tr><td align="right">8.1&nbsp;</td><td><a href="#%28part._.What_is_a_.Flow_%29" class="tocviewlink" data-pltdoc="x">What is a Flow?</a></td></tr><tr><td align="right">8.2&nbsp;</td><td><a href="#%28part._.Values__.Paths_and_.Flows%29" class="tocviewlink" data-pltdoc="x">Values, Paths and Flows</a></td></tr><tr><td align="right">8.3&nbsp;</td><td><a href="#%28part._.Values_are_.Not_.Collections%29" class="tocviewlink" data-pltdoc="x">Values are Not Collections</a></td></tr><tr><td align="right">8.4&nbsp;</td><td><a href="#%28part._.Everything_is_a_.Function%29" class="tocviewlink" data-pltdoc="x">Everything is a Function</a></td></tr><tr><td align="right">8.5&nbsp;</td><td><a href="#%28part._.Flowy_.Logic%29" class="tocviewlink" data-pltdoc="x">Flowy Logic</a></td></tr><tr><td align="right">8.6&nbsp;</td><td><a href="#%28part._.Phrases%29" class="tocviewlink" data-pltdoc="x">Phrases</a></td></tr><tr><td align="right">8.7&nbsp;</td><td><a href="#%28part._.Identities%29" class="tocviewlink" data-pltdoc="x">Identities</a></td></tr><tr><td align="right">8.8&nbsp;</td><td><a href="#%28part._.Flows_and_.Arrows%29" class="tocviewlink" data-pltdoc="x">Flows and Arrows</a></td></tr></table></div></div></div><div class="tocsub"><div class="tocsubtitle">On this page:</div><table class="tocsublist" cellspacing="0"><tr><td><span class="tocsublinknumber">8.1<tt>&nbsp;</tt></span><a href="#%28part._.What_is_a_.Flow_%29" class="tocsubseclink" data-pltdoc="x">What is a Flow?</a></td></tr><tr><td><span class="tocsublinknumber">8.2<tt>&nbsp;</tt></span><a href="#%28part._.Values__.Paths_and_.Flows%29" class="tocsubseclink" data-pltdoc="x">Values, Paths and Flows</a></td></tr><tr><td><span class="tocsublinknumber">8.3<tt>&nbsp;</tt></span><a href="#%28part._.Values_are_.Not_.Collections%29" class="tocsubseclink" data-pltdoc="x">Values are Not Collections</a></td></tr><tr><td><span class="tocsublinknumber">8.4<tt>&nbsp;</tt></span><a href="#%28part._.Everything_is_a_.Function%29" class="tocsubseclink" data-pltdoc="x">Everything is a Function</a></td></tr><tr><td><span class="tocsublinknumber">8.5<tt>&nbsp;</tt></span><a href="#%28part._.Flowy_.Logic%29" class="tocsubseclink" data-pltdoc="x">Flowy Logic</a></td></tr><tr><td><span class="tocsublinknumber">8.6<tt>&nbsp;</tt></span><a href="#%28part._.Phrases%29" class="tocsubseclink" data-pltdoc="x">Phrases</a></td></tr><tr><td><span class="tocsublinknumber">8.7<tt>&nbsp;</tt></span><a href="#%28part._.Identities%29" class="tocsubseclink" data-pltdoc="x">Identities</a></td></tr><tr><td><span class="tocsublinknumber">8.8<tt>&nbsp;</tt></span><a href="#%28part._.Flows_and_.Arrows%29" class="tocsubseclink" data-pltdoc="x">Flows and Arrows</a></td></tr></table></div></div><div class="maincolumn"><div class="main"><div class="navsettop"><span class="navleft"><form class="searchform"><input class="searchbox" id="searchbox" type="text" tabindex="1" placeholder="...search manuals..." title="Enter a search string to search the manuals" onkeypress="return DoSearchKey(event, this, &quot;8.6&quot;, &quot;../&quot;);"/></form>&nbsp;&nbsp;<a href="../index-2.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;8.6&quot;);">top</a><span class="tocsettoggle">&nbsp;&nbsp;<a href="javascript:void(0);" title="show/hide table of contents" onclick="TocsetToggle();">contents</a></span></span><span class="navright">&nbsp;&nbsp;<a href="Field_Guide.html" title="backward to &quot;7 Field Guide&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="index.html" title="up to &quot;Qi: A Functional, Flow-Oriented DSL&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="When_Should_I_Use_Qi_.html" title="forward to &quot;9 When Should I Use Qi?&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div><h3 x-source-module="(lib &quot;qi/scribblings/qi.scrbl&quot;)" x-source-pkg="qi-doc" x-part-tag="&quot;Principles_of_Qi&quot;">8<tt>&nbsp;</tt><a name="(part._.Principles_of_.Qi)"></a>Principles of Qi</h3><p>After many patient hours meticulously crafting Qi flows, you may find that you seek a deeper understanding; insight into guiding principles and inner workings, so that you can hone your skills on firmer ground.</p><p>Welcome. Your wanderings have brought you to the right place. In this section, we will cover various topics that will help you have a fuller understanding and a sound conceptual model of how Qi works. This kind of facility with the fundamentals will be useful as you employ Qi for more complex tasks, enabling you to engage in higher level reasoning about the task at hand rather than be mired in conceptual building blocks.</p><table cellspacing="0" cellpadding="0"><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._.What_is_a_.Flow_%29" class="toclink" data-pltdoc="x">8.1<span class="hspace">&nbsp;</span>What is a Flow?</a></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._.Values__.Paths_and_.Flows%29" class="toclink" data-pltdoc="x">8.2<span class="hspace">&nbsp;</span>Values, Paths and Flows</a></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._.Values_are_.Not_.Collections%29" class="toclink" data-pltdoc="x">8.3<span class="hspace">&nbsp;</span>Values are Not Collections</a></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._.Everything_is_a_.Function%29" class="toclink" data-pltdoc="x">8.4<span class="hspace">&nbsp;</span>Everything is a Function</a></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._.Flowy_.Logic%29" class="toclink" data-pltdoc="x">8.5<span class="hspace">&nbsp;</span>Flowy Logic</a></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._.Phrases%29" class="toclink" data-pltdoc="x">8.6<span class="hspace">&nbsp;</span>Phrases</a></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._.Identities%29" class="toclink" data-pltdoc="x">8.7<span class="hspace">&nbsp;</span>Identities</a></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._.Flows_and_.Arrows%29" class="toclink" data-pltdoc="x">8.8<span class="hspace">&nbsp;</span>Flows and Arrows</a></p></td></tr></table><h4 x-source-module="(lib &quot;qi/scribblings/qi.scrbl&quot;)" x-source-pkg="qi-doc" x-part-tag="&quot;What_is_a_Flow_&quot;">8.1<tt>&nbsp;</tt><a name="(part._.What_is_a_.Flow_)"></a>What is a Flow?</h4><p>A <a name="(tech._flow)"></a><span style="font-style: italic">flow</span> is either made up of flows, or is a native (e.g. Racket) <a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=guide&amp;rel=lambda.html&amp;version=8.6" class="Sq" data-pltdoc="x">function</a>. Flows may be composed using a number of combinators that could yield either linear or nonlinear composite flows.</p><p>A flow in general accepts <span class="RktSym">m</span><span class="RktMeta"></span> inputs and yields <span class="RktSym">n</span><span class="RktMeta"></span> outputs, for arbitrary non-negative integers <span class="RktSym">m</span><span class="RktMeta"></span> and <span class="RktSym">n</span><span class="RktMeta"></span>. We say that such a flow is <span class="RktSym">m</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">&#215;</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">n</span><span class="RktMeta"></span>.</p><p>The semantics of a flow is function invocation &ndash; simply invoke a flow with inputs (i.e. ordinary arguments) to obtain the outputs.</p><p>The Qi language allows you to describe and use flows in your code.</p><h4 x-source-module="(lib &quot;qi/scribblings/qi.scrbl&quot;)" x-source-pkg="qi-doc" x-part-tag="&quot;Values__Paths_and_Flows&quot;">8.2<tt>&nbsp;</tt><a name="(part._.Values__.Paths_and_.Flows)"></a>Values, Paths and Flows</h4><p><span class="emph">Flows</span> accept inputs and produce outputs &ndash; they are functions. The things that flow &ndash; the inputs and outputs &ndash; are <span class="emph">values</span>. Yet, values do not actually "move" through a flow, since a flow does not mutate them. The flow simply produces new values that are related to the inputs by a computation.</p><p>Every flow is made up of components that are themselves flows. Thus, each of these components is a relationship between an input set of values and an output set of values, so that at every level, flows produce sequences of sets of values beginning with the inputs and ending with the outputs, with each set related to the preceding one by a computation, and again, no real "motion" of values at all. There may be many such distinct <a name="(tech._path)"></a><span style="font-style: italic">paths</span> over flow components that could be traced (borrowing the term "path" as used in graph theory in this sense), and we may imagine values to flow along these paths.</p><p>So indeed, when we say that values "flow," there is nothing in fact that truly flows, and it is merely a convenient metaphor.</p><h4 x-source-module="(lib &quot;qi/scribblings/qi.scrbl&quot;)" x-source-pkg="qi-doc" x-part-tag="&quot;Values_are_Not_Collections&quot;">8.3<tt>&nbsp;</tt><a name="(part._.Values_are_.Not_.Collections)"></a>Values are Not Collections</h4><p>The things that flow are values. Individual values may happen to be collections such as lists, but the values that are flowing are not, together, a collection of any kind.</p><p>To understand this with an example: when we employ a tee junction in a flow, colloquially, we might say that the junction "divides the flow into two," which might suggest that there are now two flows. But in fact, there is just one flow that divides <span class="emph">values</span> down two separate flows which are part of its makeup. More precisely, <span class="RktSym"><span class="nobreak">-&lt;</span></span> composes two flows to yield a single composite flow. Like any flow, this composite flow accepts values and produces values, not collections of values. There is no way to differentiate, at the output end, which values came from the first channel of the junction and which ones came from the second, since downstream flows have no idea about the structure of upstream flows and only see the values they receive.</p><p>The way to group values, if we need grouping, is to collect them into a data structure (e.g. a list) using a collection prism, <span class="RktSym">&#9661;</span>. In the case of a tee junction, the way to differentiate between values coming from each channel of the junction is for the channels to individually <span class="RktSym">collect</span> their values at the end. That way, the values that are the output of the composite flow are lists generated individually by the various channels of the flow.</p><h4 x-source-module="(lib &quot;qi/scribblings/qi.scrbl&quot;)" x-source-pkg="qi-doc" x-part-tag="&quot;Everything_is_a_Function&quot;">8.4<tt>&nbsp;</tt><a name="(part._.Everything_is_a_.Function)"></a>Everything is a Function</h4><p>Everything in Qi is a <a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=guide&amp;rel=lambda.html&amp;version=8.6" class="Sq" data-pltdoc="x">function</a>. Programs are functions, they are made up of functions. Even <a href="Qi_Forms.html#%28part._.Literals%29" data-pltdoc="x">literals</a> are interpreted as functions generating them.</p><h4 x-source-module="(lib &quot;qi/scribblings/qi.scrbl&quot;)" x-source-pkg="qi-doc" x-part-tag="&quot;Flowy_Logic&quot;">8.5<tt>&nbsp;</tt><a name="(part._.Flowy_.Logic)"></a>Flowy Logic</h4><p>Qi&rsquo;s design is inspired by buddhist &#347;&#363;nyat&#257; logic. To understand it holistically would require a history lesson to put the sunyata development in context, and that would be quite a digression. But in essence, sunyata is about transcension of context or viewpoint. A viewpoint entails a logical span of possibilities (<span class="emph">catu&#7779;ko&#7789;i</span>) in terms of which assertions may be made. Sunyata is the rejection of <span class="emph">all</span> of the available logical possibilities, thus transcending the very framing of the problem (this is signified by the word <span class="emph">mu</span> in Zen). This kind of transcension could suggest alternative points of view, but more precisely, indicates no point of view at all (which isn&rsquo;t the same as being ambivalent!). This idea has implications not just for formal logical systems but also for everyday experience and profound metaphysical questions alike.</p><p>But for the purposes of Qi, what it means is that the existence of a value is a logical span within which it takes on specific forms. Sunyata is the difference between a value taking on a form indicating tangible output (e.g. <span class="RktVal">5</span> or <span class="RktVal">"hello"</span>) or indicating absence (e.g. <span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=void.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._void%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">void</a></span><span class="RktPn">)</span> or <span class="RktVal">""</span>) or failure (e.g. <span class="RktVal">#f</span>), or provisionality (e.g. <span class="RktVal">'</span><span class="RktVal">suspended</span>) or certainty (e.g. <span class="RktVal">#t</span>) &ndash; it&rsquo;s the difference between these, and not existing at all.</p><p>The same considerations extend the other way as well, from nonexistence to existence to existence of more than one. As each value corresponds to an independent logical span of possibilities, sunyata in the context of Qi translates into the core paradigm being the existence/non-existence and consequently also the number of values at each point in the flow.</p><p>In practice, this means that Qi will often opt to either return or not return a value rather than return a value signifying absence or raise an error. This principle even suggests considerations for the design of ordinary functions and the evaluator itself, which from a Qi/sunyata perspective, could model absence and number in positions that typically expect values.</p><p>For example, the following would seem to be in accord with these principles:</p><ul><li><p>Variadic functions, on receiving no input, produce a nullary value (e.g. a monoid identity) if applicable, or no output otherwise, instead of raising an error. For instance, <span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=generic-numbers.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._max%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">max</a></span><span class="RktPn">)</span> currently raises an error, and under this guideline would produce no output, instead.</p></li><li><p>Upon receiving multiple values in positions where a single value is expected, the evaluator "forks" the continuation so that each possibility is independently (combinatorially) evaluated. The results from these parallel computations could be "flattened" as multiple output values, but it may be more correct to evaluate them instead as completely independent computations. These could be manipulated distinctly &ndash; for instance, each forked continuation could be fulfilled by a distinct process, and the evaluator could provide a means to refer to the output of these processes from within the language or in a metalanguage, while keeping the processes themselves abstracted. <span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._cons%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">cons</a></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=values.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._values%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">values</a></span><span class="stt"> </span><span class="RktVal">1</span><span class="stt"> </span><span class="RktVal">2</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._list%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">list</a></span><span class="stt"> </span><span class="RktVal">3</span><span class="RktPn">)</span><span class="RktPn">)</span> independently produces <span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._list%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">list</a></span><span class="stt"> </span><span class="RktVal">1</span><span class="stt"> </span><span class="RktVal">3</span><span class="RktPn">)</span> and <span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._list%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">list</a></span><span class="stt"> </span><span class="RktVal">2</span><span class="stt"> </span><span class="RktVal">3</span><span class="RktPn">)</span>.</p></li><li><p>Upon receiving <span class="emph">no</span> values in positions where a single value is expected, there are a few cases to consider. If no values were received in a position corresponding to the "object" of the function, in the grammatical sense, then the function produces no values. If no values were received in another position, then the function produces the input object(s) (again, objects in the grammatical sense) &ndash; which would be consistent with the expected output type. If there is more than one object position, then the result of the function is empty if <span class="emph">any</span> of the object positions is. If no values were received in a position serving another grammatical role (e.g. a modifier or adverb such as a function-valued argument), the function generally produces nothing. In none of these cases does the function raise an error. <span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._cons%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">cons</a></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=values.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._values%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">values</a></span><span class="RktPn">)</span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._list%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">list</a></span><span class="stt"> </span><span class="RktVal">1</span><span class="stt"> </span><span class="RktVal">2</span><span class="stt"> </span><span class="RktVal">3</span><span class="RktPn">)</span><span class="RktPn">)</span> produces <span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._list%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">list</a></span><span class="stt"> </span><span class="RktVal">1</span><span class="stt"> </span><span class="RktVal">2</span><span class="stt"> </span><span class="RktVal">3</span><span class="RktPn">)</span>, while <span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._cons%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">cons</a></span><span class="stt"> </span><span class="RktVal">1</span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=values.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._values%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">values</a></span><span class="RktPn">)</span><span class="RktPn">)</span>, <span class="RktPn">(</span><span class="RktSym">add-two-numbers</span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=values.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._values%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">values</a></span><span class="RktPn">)</span><span class="stt"> </span><span class="RktVal">5</span><span class="RktPn">)</span>, and <span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528lib._racket%252Fprivate%252Flist..rkt%2529._sort%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">sort</a></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=values.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._values%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">values</a></span><span class="RktPn">)</span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._list%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">list</a></span><span class="stt"> </span><span class="RktVal">2</span><span class="stt"> </span><span class="RktVal">3</span><span class="stt"> </span><span class="RktVal">1</span><span class="RktPn">)</span><span class="RktPn">)</span> (where the first argument position indicates a comparator function to be used in sorting) produce nothing.</p></li><li><p>If the function receives valid inputs but is unable to produce a valid result (for instance, if the inputs fail some runtime requirement), it produces nothing.</p></li><li><p>If an <span class="emph">invalid</span> input (such as one of an unexpected type) is received, the function raises an error.</p></li></ul><p>See <a href="Qi_Macros.html#%28part._.Write_.Yourself_a_.Maybe_.Monad_for_.Great_.Good%29" data-pltdoc="x">Write Yourself a Maybe Monad for Great Good</a> for an example that applies some of these ideas to implement the Maybe monad commonly used in many functional languages. Although, note that if the above design were adopted by the underlying language and interpreter, Maybe would be unnecessary in most cases.</p><h4 x-source-module="(lib &quot;qi/scribblings/qi.scrbl&quot;)" x-source-pkg="qi-doc" x-part-tag="&quot;Phrases&quot;">8.6<tt>&nbsp;</tt><a name="(part._.Phrases)"></a>Phrases</h4><p>When reading languages like English, we understand what we read in terms of words and then phrases and the relationship of these phrases to one another as clauses of a sentence, and then the relationship of sentences to one another, and then paragraphs to one another. The resourceful speed readers among us even do this in the reverse order at first, discerning high level structure before parsing the low level component meanings. Just like human languages, Qi expressions exhibit phrase structure that we can leverage in similar ways. Here are some common phrases in the language to get you started thinking about the language in this way.</p><ul><li><p><span class="RktPn">(</span><span class="RktSym"><a href="Language_Interface.html#%28form._%28%28lib._qi%2Fmain..rkt%29._~7e~3e%29%29" class="RktStxLink" data-pltdoc="x">~&gt;</a></span><span class="stt"> </span><span class="RktSym">&#9651;</span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym">&gt;&lt;</span><span class="stt"> </span><span class="RktSym">f</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktPn">)</span> &ndash; "sep-amp". A standard mapping over values extracted from a list.</p></li><li><p><span class="RktPn">(</span><span class="RktSym"><a href="Language_Interface.html#%28form._%28%28lib._qi%2Fmain..rkt%29._~7e~3e%29%29" class="RktStxLink" data-pltdoc="x">~&gt;</a></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-&lt;</span></span><span class="stt"> </span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529.__%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">_</a></span><span class="stt"> </span><span class="RktSym">f</span><span class="stt"> </span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="stt"> </span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktPn">)</span> &ndash; "augment". The tee junction may augment the flow in any order &ndash; the signature of this phrase is the presence of a <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529.__%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">_</a></span> in the tee junction.</p></li><li><p><span class="RktPn">(</span><span class="RktSym"><a href="Language_Interface.html#%28form._%28%28lib._qi%2Fmain..rkt%29._~7e~3e%29%29" class="RktStxLink" data-pltdoc="x">~&gt;</a></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-&lt;</span></span><span class="stt"> </span><span class="RktSym">f</span><span class="stt"> </span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="stt"> </span><span class="RktSym">g</span><span class="RktPn">)</span> &ndash; "diamond composition". This is one way to adapt a flow <span class="RktSym">f</span> of arity <span class="math">k</span> to a flow <span class="RktSym">g</span> of arity <span class="math">m</span>, that is, by branching the <span class="math">k</span> inputs into <span class="math">m</span> copies of <span class="RktSym">f</span> (assuming <span class="RktSym">f</span> produces one output). It is the same as the "composition operator" used in defining <a href="https://en.wikipedia.org/wiki/Primitive_recursive_function">primitive recursive functions</a>.</p></li><li><p><span class="RktPn">(</span><span class="RktSym">group</span><span class="stt"> </span><span class="RktVal">1</span><span class="stt"> </span><span class="RktSym">car-flo</span><span class="stt"> </span><span class="RktSym">cdr-flo</span><span class="RktPn">)</span> &ndash; "pare". This is analogous to "car and cdr" style destructuring with lists, but for segregating values instead. Note that while it is analogous, this isn&rsquo;t "destructuring," since the values taken together <a href="#%28part._.Values_are_.Not_.Collections%29" data-pltdoc="x">do not form a data structure</a>.</p></li></ul><p>Some of these phrases may someday make it into the language as forms themselves, and there may be higher-level phrases still, made up of such phrases.</p><h4 x-source-module="(lib &quot;qi/scribblings/qi.scrbl&quot;)" x-source-pkg="qi-doc" x-part-tag="&quot;Identities&quot;">8.7<tt>&nbsp;</tt><a name="(part._.Identities)"></a>Identities</h4><p>Here are some useful identities for the core routing forms. They can be used to simplify your code or say things in different ways.</p><p><div class="math">(\sim&gt; (\sim&gt; f g) h) = (\sim&gt; f (\sim&gt; g h)) = (\sim&gt; f g h)</div> [associative law]
<div class="math">(\sim&gt; f \_) = (\sim&gt; \_ f) = (\sim&gt; f) = f</div> [left and right identity]
<div class="math">(== (\sim&gt; f&#8321; g&#8321;) (\sim&gt; f&#8322; g&#8322;)) = (\sim&gt; (== f&#8321; f&#8322;) (== g&#8321; g&#8322;))</div>
<div class="math">(\sim&gt; (&gt;&lt; f) (&gt;&lt; g)) = (&gt;&lt; (\sim&gt; f g))</div>
<div class="math">(\sim&gt; \_ \cdots) = \_</div>
<div class="math">(== \_ \ldots) = \_</div>
<div class="math">(&gt;&lt; \_) = \_</div>
<div class="math">(-&lt; f) = f</div>
<div class="math">(-&lt; (\text{gen} a) (\text{gen} b)) = (-&lt; (\text{gen} a b))</div>
<div class="math">(\sim&gt; &#9651; &#9661;) = \_ = (\sim&gt; &#9661; &#9651;) \text{(the former only holds when the input is a list)}</div></p><h4 x-source-module="(lib &quot;qi/scribblings/qi.scrbl&quot;)" x-source-pkg="qi-doc" x-part-tag="&quot;Flows_and_Arrows&quot;">8.8<tt>&nbsp;</tt><a name="(part._.Flows_and_.Arrows)"></a>Flows and Arrows</h4><p>[<span class="emph">The connection between flows and arrows was pointed out by Sergiu Ivanov (Scolobb on Discourse).</span>]</p><p>It turns out that the core routing forms of Qi fulfill the definition of <a href="https://www.haskell.org/arrows/">arrows</a> in category theory and Haskell (in an unfortunate conflation of terminology, these "arrows" are an entirely different notion than morphisms, which are also sometimes referred to as arrows). The specific correspondence is as follows:</p><ul><li><p>Qi&rsquo;s "base case" of <a href="#%28part._.What_is_a_.Flow_%29" data-pltdoc="x">treating any function as a flow</a> corresponds to the <span class="RktSym">arr</span> method of arrows.</p></li><li><p><span class="RktSym"><a href="Language_Interface.html#%28form._%28%28lib._qi%2Fmain..rkt%29._~7e~3e%29%29" class="RktStxLink" data-pltdoc="x">~&gt;</a></span> is equivalent to the <span class="RktPn">(</span><span class="RktSym">&gt;&gt;&gt;</span><span class="RktPn">)</span> of arrows.</p></li><li><p>The <span class="RktSym">relay</span>, and specifically, <span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=match.html%23%2528form._%2528%2528lib._racket%252Fmatch..rkt%2529._%7E3d%7E3d%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">==</a></span><span class="stt"> </span><span class="RktSym">a</span><span class="stt"> </span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529.__%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">_</a></span><span class="RktPn">)</span>, <span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=match.html%23%2528form._%2528%2528lib._racket%252Fmatch..rkt%2529._%7E3d%7E3d%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">==</a></span><span class="stt"> </span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529.__%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">_</a></span><span class="stt"> </span><span class="RktSym">b</span><span class="RktPn">)</span>, and <span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=match.html%23%2528form._%2528%2528lib._racket%252Fmatch..rkt%2529._%7E3d%7E3d%2529%2529&amp;version=8.6" class="RktStxLink Sq" data-pltdoc="x">==</a></span><span class="stt"> </span><span class="RktSym">a</span><span class="stt"> </span><span class="RktSym">b</span><span class="RktPn">)</span>, respectively correspond to <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528lib._racket%252Flist..rkt%2529._first%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">first</a></span>, <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.6/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528lib._racket%252Flist..rkt%2529._second%2529%2529&amp;version=8.6" class="RktValLink Sq" data-pltdoc="x">second</a></span>, and their composite <span class="RktPn">(</span><span class="RktSym">***</span><span class="RktPn">)</span> in arrows.</p></li><li><p><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-&lt;</span></span><span class="stt"> </span><span class="RktSym">f</span><span class="stt"> </span><span class="RktSym">g</span><span class="RktPn">)</span> corresponds to what is referred to as "fanout composition", <span class="RktPn">(</span><span class="RktSym">&amp;&amp;&amp;</span><span class="RktPn">)</span>, in arrows.</p></li></ul><p>So evidently, flows are just <a href="https://www.sciencedirect.com/science/article/pii/S1571066106001666/pdf">monoids in suitable subcategories of bifunctors</a> (what&rsquo;s the problem?), or, in another way of looking at it, <a href="https://bentnib.org/arrows.pdf">enriched Freyd categories</a>.</p><p>Therefore, any theoretical results about arrows should generally apply to Qi as well (but not necessarily, since Qi is not <span class="emph">just</span> arrows).</p><div class="navsetbottom"><span class="navleft"><form class="searchform"><input class="searchbox" id="searchbox" type="text" tabindex="1" placeholder="...search manuals..." title="Enter a search string to search the manuals" onkeypress="return DoSearchKey(event, this, &quot;8.6&quot;, &quot;../&quot;);"/></form>&nbsp;&nbsp;<a href="../index-2.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;8.6&quot;);">top</a><span class="tocsettoggle">&nbsp;&nbsp;<a href="javascript:void(0);" title="show/hide table of contents" onclick="TocsetToggle();">contents</a></span></span><span class="navright">&nbsp;&nbsp;<a href="Field_Guide.html" title="backward to &quot;7 Field Guide&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="index.html" title="up to &quot;Qi: A Functional, Flow-Oriented DSL&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="When_Should_I_Use_Qi_.html" title="forward to &quot;9 When Should I Use Qi?&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body>
<!-- Mirrored from docs.racket-lang.org/qi/Principles_of_Qi.html by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 07 Sep 2022 03:13:28 GMT -->
</html>